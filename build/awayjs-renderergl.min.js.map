{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "awayjs-renderergl.js",
    "awayjs-renderergl/lib/DefaultRenderer.ts",
    "awayjs-renderergl/lib/DepthRenderer.ts",
    "awayjs-renderergl/lib/DistanceRenderer.ts",
    "awayjs-renderergl/lib/Filter3DRenderer.ts",
    "awayjs-renderergl/lib/RendererBase.ts",
    "awayjs-renderergl/lib/animators/AnimationSetBase.ts",
    "awayjs-renderergl/lib/animators/AnimatorBase.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimator.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimator.ts",
    "awayjs-renderergl/lib/animators/VertexAnimationSet.ts",
    "awayjs-renderergl/lib/animators/VertexAnimator.ts",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache.ts",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry.ts",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint.ts",
    "awayjs-renderergl/lib/animators/data/JointPose.ts",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData.ts",
    "awayjs-renderergl/lib/animators/data/ParticleData.ts",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode.ts",
    "awayjs-renderergl/lib/animators/data/ParticleProperties.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonPose.ts",
    "awayjs-renderergl/lib/animators/data/Skeleton.ts",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode.ts",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode.ts",
    "awayjs-renderergl/lib/animators/states/AnimationClipState.ts",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleUVState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/VertexClipState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition.ts",
    "awayjs-renderergl/lib/base/ParticleGeometry.ts",
    "awayjs-renderergl/lib/errors/AnimationSetError.ts",
    "awayjs-renderergl/lib/events/AnimationStateEvent.ts",
    "awayjs-renderergl/lib/events/AnimatorEvent.ts",
    "awayjs-renderergl/lib/events/ShadingMethodEvent.ts",
    "awayjs-renderergl/lib/filters/Filter3DBase.ts",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase.ts",
    "awayjs-renderergl/lib/managers/RTTBufferManager.ts",
    "awayjs-renderergl/lib/pick/ShaderPicker.ts",
    "awayjs-renderergl/lib/render/BasicMaterialRender.ts",
    "awayjs-renderergl/lib/render/DepthRender.ts",
    "awayjs-renderergl/lib/render/DistanceRender.ts",
    "awayjs-renderergl/lib/render/RenderBase.ts",
    "awayjs-renderergl/lib/render/RenderPassBase.ts",
    "awayjs-renderergl/lib/render/RenderPool.ts",
    "awayjs-renderergl/lib/render/SkyboxRender.ts",
    "awayjs-renderergl/lib/render/passes/BasicMaterialPass.ts",
    "awayjs-renderergl/lib/render/passes/PassBase.ts",
    "awayjs-renderergl/lib/renderables/BillboardRenderable.ts",
    "awayjs-renderergl/lib/renderables/CurveSubMeshRenderable.ts",
    "awayjs-renderergl/lib/renderables/LineSegmentRenderable.ts",
    "awayjs-renderergl/lib/renderables/LineSubMeshRenderable.ts",
    "awayjs-renderergl/lib/renderables/RenderableBase.ts",
    "awayjs-renderergl/lib/renderables/RenderablePool.ts",
    "awayjs-renderergl/lib/renderables/SkyboxRenderable.ts",
    "awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable.ts",
    "awayjs-renderergl/lib/shaders/LightingShader.ts",
    "awayjs-renderergl/lib/shaders/RegisterPool.ts",
    "awayjs-renderergl/lib/shaders/ShaderBase.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterCache.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterData.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterElement.ts",
    "awayjs-renderergl/lib/shaders/compilers/CompilerBase.ts",
    "awayjs-renderergl/lib/shaders/compilers/LightingCompiler.ts",
    "awayjs-renderergl/lib/tools/commands/Merge.ts",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform.ts",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper.ts",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D.ts",
    "awayjs-renderergl/lib/vos/CurveSubGeometryVO.ts",
    "awayjs-renderergl/lib/vos/LineSubGeometryVO.ts",
    "awayjs-renderergl/lib/vos/Sampler2DVO.ts",
    "awayjs-renderergl/lib/vos/SamplerCubeVO.ts",
    "awayjs-renderergl/lib/vos/SamplerVOBase.ts",
    "awayjs-renderergl/lib/vos/Single2DTextureVO.ts",
    "awayjs-renderergl/lib/vos/SingleCubeTextureVO.ts",
    "awayjs-renderergl/lib/vos/SubGeometryVOBase.ts",
    "awayjs-renderergl/lib/vos/SubGeometryVOPool.ts",
    "awayjs-renderergl/lib/vos/TextureVOBase.ts",
    "awayjs-renderergl/lib/vos/TextureVOPool.ts",
    "awayjs-renderergl/lib/vos/TriangleSubGeometryVO.ts"
  ],
  "names": [
    "require",
    "e",
    "t",
    "n",
    "r",
    "s",
    "o",
    "u",
    "a",
    "i",
    "f",
    "Error",
    "code",
    "l",
    "exports",
    "call",
    "length",
    "awayjs-renderergl/lib/DefaultRenderer",
    "module",
    "__extends",
    "this",
    "d",
    "b",
    "p",
    "hasOwnProperty",
    "__",
    "constructor",
    "prototype",
    "BitmapImage2D",
    "Matrix3D",
    "Vector3D",
    "ContextGLCompareMode",
    "ContextGLClearMask",
    "RendererBase",
    "DepthRenderer",
    "DistanceRenderer",
    "Filter3DRenderer",
    "RenderablePool",
    "RTTBufferManager",
    "DefaultRenderer",
    "_super",
    "stage",
    "_skyboxProjection",
    "_pRenderablePool",
    "_pStage",
    "_shareContext",
    "_pRttBufferManager",
    "getInstance",
    "_pDepthRenderer",
    "_pDistanceRenderer",
    "_width",
    "width",
    "window",
    "innerWidth",
    "viewWidth",
    "_height",
    "height",
    "innerHeight",
    "viewHeight",
    "Object",
    "defineProperty",
    "get",
    "_antiAlias",
    "set",
    "value",
    "_pBackBufferInvalid",
    "enumerable",
    "configurable",
    "_depthPrepass",
    "_pFilter3DRenderer",
    "filters",
    "dispose",
    "_pRequireDepthRender",
    "requireDepthRender",
    "_pDepthRender",
    "render",
    "entityCollector",
    "recoverFromDisposal",
    "pUpdateBackBuffer",
    "_pContext",
    "clear",
    "DEPTH",
    "textureRatioX",
    "textureRatioY",
    "pRenderSceneDepthToTexture",
    "pRenderDepthPrepass",
    "_iRender",
    "_pScissorRect",
    "present",
    "bufferClear",
    "pExecuteRender",
    "target",
    "scissorRect",
    "surfaceSelector",
    "updateLights",
    "dirLights",
    "directionalLights",
    "pointLights",
    "len",
    "light",
    "shadowMapper",
    "castsShadows",
    "autoUpdateShadows",
    "_iShadowsInvalid",
    "iRenderDepthMap",
    "pDraw",
    "skyBox",
    "setDepthTest",
    "ALWAYS",
    "drawSkybox",
    "renderable",
    "getItem",
    "camera",
    "updateSkyboxProjection",
    "getRenderPool",
    "renderableOwner",
    "renderOwner",
    "pass",
    "passes",
    "activatePass",
    "deactivatePass",
    "near",
    "copyFrom",
    "_pRttViewProjectionMatrix",
    "copyRowTo",
    "camPos",
    "scenePosition",
    "cx",
    "x",
    "cy",
    "y",
    "cz",
    "z",
    "cw",
    "Math",
    "sqrt",
    "signX",
    "signY",
    "inverse",
    "clone",
    "invert",
    "q",
    "transformVector",
    "w",
    "copyRowFrom",
    "disableColor",
    "_pDepthTextureInvalid",
    "initDepthTexture",
    "context",
    "configureBackBuffer",
    "textureWidth",
    "textureHeight",
    "awayjs-core/lib/data/BitmapImage2D",
    "undefined",
    "awayjs-core/lib/geom/Matrix3D",
    "awayjs-core/lib/geom/Vector3D",
    "awayjs-renderergl/lib/DepthRenderer",
    "awayjs-renderergl/lib/DistanceRenderer",
    "awayjs-renderergl/lib/Filter3DRenderer",
    "awayjs-renderergl/lib/RendererBase",
    "awayjs-renderergl/lib/managers/RTTBufferManager",
    "awayjs-renderergl/lib/renderables/RenderablePool",
    "awayjs-stagegl/lib/base/ContextGLClearMask",
    "awayjs-stagegl/lib/base/ContextGLCompareMode",
    "DepthRender",
    "_iBackgroundR",
    "_iBackgroundG",
    "_iBackgroundB",
    "awayjs-renderergl/lib/render/DepthRender",
    "DistanceRender",
    "awayjs-renderergl/lib/render/DistanceRender",
    "Event",
    "ContextGLBlendFactor",
    "ContextGLVertexBufferFormat",
    "_this",
    "_filterSizesInvalid",
    "_onRTTResizeDelegate",
    "event",
    "onRTTResize",
    "_stage",
    "_rttManager",
    "addEventListener",
    "RESIZE",
    "_requireDepthRender",
    "getMainInputTexture",
    "_filterTasksInvalid",
    "updateFilterTasks",
    "_mainInputTexture",
    "_filters",
    "updateFilterSizes",
    "_tasks",
    "Array",
    "filter",
    "setRenderTargets",
    "concat",
    "tasks",
    "depthTexture",
    "task",
    "indexBuffer",
    "vertexBuffer",
    "renderToTextureVertexBuffer",
    "update",
    "setVertexBufferAt",
    "FLOAT_2",
    "renderToScreenVertexBuffer",
    "setTextureAt",
    "setProgram",
    "getProgram",
    "activate",
    "setBlendFactors",
    "ONE",
    "ZERO",
    "drawTriangles",
    "deactivate",
    "removeEventListener",
    "awayjs-core/lib/events/Event",
    "awayjs-stagegl/lib/base/ContextGLBlendFactor",
    "awayjs-stagegl/lib/base/ContextGLVertexBufferFormat",
    "Point",
    "Rectangle",
    "EventDispatcher",
    "RenderableMergeSort",
    "RendererEvent",
    "EntityCollector",
    "DefaultMaterialManager",
    "AGALMiniAssembler",
    "StageEvent",
    "StageManager",
    "_numUsedStreams",
    "_numUsedTextures",
    "_viewPort",
    "_backgroundR",
    "_backgroundG",
    "_backgroundB",
    "_backgroundAlpha",
    "_localPos",
    "_globalPos",
    "_pNumElements",
    "_disableColor",
    "_renderBlended",
    "_onViewportUpdatedDelegate",
    "onViewportUpdated",
    "_onContextUpdateDelegate",
    "onContextUpdate",
    "renderableSorter",
    "getFreeStage",
    "CONTEXT_CREATED",
    "CONTEXT_RECREATED",
    "VIEWPORT_UPDATED",
    "updateGlobalPos",
    "notifyScissorUpdate",
    "shader",
    "numUsedStreams",
    "numUsedTextures",
    "programData",
    "program",
    "createProgram",
    "vertexByteCode",
    "assemble",
    "vertexString",
    "data",
    "fragmentByteCode",
    "fragmentString",
    "upload",
    "_iActivate",
    "_iDeactivate",
    "_iCreateEntityCollector",
    "_viewportDirty",
    "_scissorDirty",
    "viewProjection",
    "appendScale",
    "_iRenderCascades",
    "numCascades",
    "scissorRects",
    "cameras",
    "_applyCollector",
    "setRenderTarget",
    "LESS",
    "head",
    "_pOpaqueRenderableHead",
    "first",
    "LESS_EQUAL",
    "_pBlendedRenderableHead",
    "item",
    "entityHead",
    "_pCamera",
    "_iEntryPoint",
    "_pCameraForward",
    "transform",
    "forwardVector",
    "entity",
    "_applyRenderer",
    "next",
    "sortOpaqueRenderables",
    "sortBlendedRenderables",
    "_snapshotRequired",
    "_snapshotBitmapImage2D",
    "drawToBitmapImage2D",
    "queueSnapshot",
    "bmd",
    "setColorMask",
    "drawRenderables",
    "renderable2",
    "_renderOwner",
    "alphaThreshold",
    "_scissorUpdated",
    "SCISSOR_UPDATED",
    "dispatchEvent",
    "notifyViewportUpdate",
    "_viewPortUpdated",
    "viewPort",
    "_iApplyRenderableOwner",
    "applyRenderable",
    "getDefaultMaterial",
    "renderId",
    "renderOrderId",
    "cascaded",
    "sourceEntity",
    "position",
    "subtract",
    "zIndex",
    "zOffset",
    "dotProduct",
    "renderSceneTransform",
    "getRenderSceneTransform",
    "requiresBlending",
    "subGeometryVO",
    "subGeometry",
    "numElements",
    "awayjs-core/lib/events/EventDispatcher",
    "awayjs-core/lib/geom/Point",
    "awayjs-core/lib/geom/Rectangle",
    "awayjs-display/lib/events/RendererEvent",
    "awayjs-display/lib/managers/DefaultMaterialManager",
    "awayjs-display/lib/sort/RenderableMergeSort",
    "awayjs-display/lib/traverse/EntityCollector",
    "awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler",
    "awayjs-stagegl/lib/events/StageEvent",
    "awayjs-stagegl/lib/managers/StageManager",
    "awayjs-renderergl/lib/animators/AnimationSetBase",
    "AssetBase",
    "AbstractMethodError",
    "AnimationSetError",
    "AnimationSetBase",
    "_animations",
    "_animationNames",
    "_animationDictionary",
    "_pFindTempReg",
    "exclude",
    "excludeAnother",
    "reg",
    "indexOf",
    "_usesCPU",
    "resetGPUCompatibility",
    "cancelGPUCompatibility",
    "getAGALVertexCode",
    "getAGALFragmentCode",
    "shadedTarget",
    "getAGALUVCode",
    "doneAGALCode",
    "assetType",
    "hasAnimation",
    "name",
    "getAnimation",
    "addAnimation",
    "node",
    "push",
    "awayjs-core/lib/errors/AbstractMethodError",
    "awayjs-core/lib/library/AssetBase",
    "awayjs-renderergl/lib/errors/AnimationSetError",
    "awayjs-renderergl/lib/animators/AnimatorBase",
    "RequestAnimationFrame",
    "getTimer",
    "AnimatorEvent",
    "AnimatorBase",
    "animationSet",
    "_autoUpdate",
    "_time",
    "_playbackSpeed",
    "_pOwners",
    "_pAbsoluteTime",
    "_animationStates",
    "updatePosition",
    "_pAnimationSet",
    "_broadcaster",
    "onEnterFrame",
    "getAnimationState",
    "className",
    "stateClass",
    "uID",
    "id",
    "getAnimationStateByName",
    "_pActiveState",
    "_pActiveAnimationName",
    "start",
    "stop",
    "phase",
    "setRenderState",
    "vertexConstantOffset",
    "vertexStreamOffset",
    "_isPlaying",
    "hasEventListener",
    "START",
    "_startEvent",
    "STOP",
    "_stopEvent",
    "time",
    "dt",
    "playbackSpeed",
    "_pUpdateDeltaTime",
    "reset",
    "offset",
    "addOwner",
    "mesh",
    "removeOwner",
    "splice",
    "applyPositionDelta",
    "delta",
    "positionDelta",
    "dist",
    "translateLocal",
    "dispatchCycleEvent",
    "CYCLE_COMPLETE",
    "_cycleEvent",
    "testGPUCompatibility",
    "getRenderableSubGeometry",
    "sourceSubGeometry",
    "awayjs-core/lib/utils/RequestAnimationFrame",
    "awayjs-core/lib/utils/getTimer",
    "awayjs-renderergl/lib/events/AnimatorEvent",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet",
    "AnimationRegisterCache",
    "AnimationSubGeometry",
    "ParticleAnimationData",
    "ParticleProperties",
    "ParticlePropertiesMode",
    "ParticleTimeNode",
    "ParticleAnimationSet",
    "usesDuration",
    "usesLooping",
    "usesDelay",
    "_animationSubGeometries",
    "_particleNodes",
    "_localDynamicNodes",
    "_localStaticNodes",
    "_totalLenOfOneVertex",
    "_timeNode",
    "_iProcessAnimationSetting",
    "mode",
    "LOCAL_STATIC",
    "_iDataOffset",
    "dataLength",
    "LOCAL_DYNAMIC",
    "priority",
    "_iAnimationRegisterCache",
    "animationRegisterCache",
    "profile",
    "numUsedVertexConstants",
    "vertexAttributesOffset",
    "varyingsOffset",
    "numUsedVaryings",
    "fragmentConstantOffset",
    "numUsedFragmentConstants",
    "hasUVNode",
    "needVelocity",
    "hasBillboard",
    "sourceRegisters",
    "animatableAttributes",
    "targetRegisters",
    "animationTargetRegisters",
    "needFragmentAnimation",
    "usesFragmentAnimation",
    "needUVAnimation",
    "usesUVTransform",
    "hasColorAddNode",
    "hasColorMulNode",
    "getInitCode",
    "POST_PRIORITY",
    "getCombinationCode",
    "COLOR_PRIORITY",
    "initColorRegisters",
    "getColorPassCode",
    "setUVSourceAndTarget",
    "uvSource",
    "uvTarget",
    "uvAttribute",
    "toString",
    "uvVar",
    "getColorCombinationCode",
    "setDataLength",
    "setVertexConst",
    "vertexZeroConst",
    "index",
    "key",
    "getAnimationSubGeometry",
    "subMesh",
    "parentMesh",
    "animationSubGeometry",
    "_iGenerateAnimationSubGeometries",
    "initParticleFunc",
    "geometry",
    "j",
    "k",
    "newAnimationSubGeometry",
    "localNode",
    "subMeshes",
    "shareAnimationGeometry",
    "createVertexData",
    "numVertices",
    "particles",
    "particlesLength",
    "numParticles",
    "particleProperties",
    "particle",
    "oneDataLen",
    "oneDataOffset",
    "counterForVertex",
    "counterForOneData",
    "oneData",
    "vertexData",
    "vertexLength",
    "startingOffset",
    "vertexOffset",
    "total",
    "startTime",
    "duration",
    "delay",
    "initParticleScope",
    "_iGeneratePropertyOfOneParticle",
    "particleIndex",
    "numProcessedVertices",
    "animationParticles",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData",
    "awayjs-renderergl/lib/animators/data/ParticleProperties",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode",
    "awayjs-renderergl/lib/animators/ParticleAnimator",
    "ContextGLProgramType",
    "ParticleAnimator",
    "particleAnimationSet",
    "_animationParticleStates",
    "_animatorParticleStates",
    "_timeParticleStates",
    "_animatorSubGeometries",
    "_particleAnimationSet",
    "state",
    "particleNodes",
    "needUpdateTime",
    "animatorSubGeometry",
    "getAnimatorSubGeometry",
    "setProgramConstantsFromArray",
    "VERTEX",
    "vertexConstantData",
    "numVertexConstant",
    "numFragmentConstant",
    "FRAGMENT",
    "fragmentConstantData",
    "resetTime",
    "awayjs-stagegl/lib/base/ContextGLProgramType",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet",
    "SkeletonAnimationSet",
    "jointsPerVertex",
    "_jointsPerVertex",
    "indexOffset0",
    "indexOffset1",
    "indexOffset2",
    "indexStream",
    "weightStream",
    "indices",
    "weights",
    "temp1",
    "temp2",
    "dot",
    "src",
    "awayjs-renderergl/lib/animators/SkeletonAnimator",
    "SubGeometryEvent",
    "JointPose",
    "SkeletonPose",
    "AnimationStateEvent",
    "SkeletonAnimator",
    "skeleton",
    "forceCPU",
    "_globalPose",
    "_morphedSubGeometry",
    "_morphedSubGeometryDirty",
    "_skeleton",
    "_forceCPU",
    "_numJoints",
    "numJoints",
    "_globalMatrices",
    "_onTransitionCompleteDelegate",
    "onTransitionComplete",
    "_onIndicesUpdateDelegate",
    "onIndicesUpdate",
    "_onVerticesUpdateDelegate",
    "onVerticesUpdate",
    "_globalPropertiesDirty",
    "updateGlobalProperties",
    "_useCondensedIndices",
    "play",
    "transition",
    "NaN",
    "_pActiveNode",
    "getAnimationNode",
    "TRANSITION_COMPLETE",
    "_activeSkeletonState",
    "isNaN",
    "useCondensedIndices",
    "updateCondensedMatrices",
    "condensedIndexLookUp",
    "_condensedMatrices",
    "usesCPU",
    "morphSubGeometry",
    "jointIndexIndex",
    "jointWeightIndex",
    "srcIndex",
    "localToGlobalPose",
    "getSkeletonPose",
    "mtxOffset",
    "globalPoses",
    "jointPoses",
    "raw",
    "ox",
    "oy",
    "oz",
    "ow",
    "xy2",
    "xz2",
    "xw2",
    "yz2",
    "yw2",
    "zw2",
    "n11",
    "n12",
    "n13",
    "n21",
    "n22",
    "n23",
    "n31",
    "n32",
    "n33",
    "m11",
    "m12",
    "m13",
    "m14",
    "m21",
    "m22",
    "m23",
    "m24",
    "m31",
    "m32",
    "m33",
    "m34",
    "joints",
    "pose",
    "quat",
    "vec",
    "orientation",
    "translation",
    "inverseBindPose",
    "targetSubGeometry",
    "autoDeriveNormals",
    "autoDeriveTangents",
    "autoDeriveUVs",
    "INDICES_UPDATED",
    "VERTICES_UPDATED",
    "sourcePositions",
    "positions",
    "sourceNormals",
    "normals",
    "sourceTangents",
    "tangents",
    "jointIndices",
    "jointWeights",
    "targetPositions",
    "targetNormals",
    "targetTangents",
    "vx",
    "vy",
    "vz",
    "nx",
    "ny",
    "nz",
    "tx",
    "ty",
    "tz",
    "weight",
    "vertX",
    "vertY",
    "vertZ",
    "normX",
    "normY",
    "normZ",
    "tangX",
    "tangY",
    "tangZ",
    "setPositions",
    "setNormals",
    "setTangents",
    "sourcePose",
    "targetPose",
    "globalJointPose",
    "numJointPoses",
    "parentIndex",
    "joint",
    "parentPose",
    "or",
    "tr",
    "x1",
    "y1",
    "z1",
    "w1",
    "x2",
    "y2",
    "z2",
    "w2",
    "x3",
    "y3",
    "z3",
    "type",
    "animationNode",
    "animationState",
    "setIndices",
    "morphGeometry",
    "attributesView",
    "uvs",
    "setUVs",
    "secondaryUVs",
    "setSecondaryUVs",
    "awayjs-display/lib/events/SubGeometryEvent",
    "awayjs-renderergl/lib/animators/data/JointPose",
    "awayjs-renderergl/lib/animators/data/SkeletonPose",
    "awayjs-renderergl/lib/events/AnimationStateEvent",
    "awayjs-renderergl/lib/animators/VertexAnimationSet",
    "VertexAnimationMode",
    "VertexAnimationSet",
    "numPoses",
    "blendMode",
    "_numPoses",
    "_blendMode",
    "ABSOLUTE",
    "getAbsoluteAGALCode",
    "getAdditiveAGALCode",
    "regs",
    "constantReg",
    "streamIndex",
    "tangentDependencies",
    "outputsNormals",
    "normalDependencies",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode",
    "awayjs-renderergl/lib/animators/VertexAnimator",
    "SubGeometryVOPool",
    "VertexAnimator",
    "vertexAnimationSet",
    "_poses",
    "_weights",
    "_vertexAnimationSet",
    "_subGeometryVOPool",
    "getPool",
    "_activeVertexState",
    "geometryFlag",
    "currentGeometry",
    "nextGeometry",
    "blendWeight",
    "_iInvalidateRenderableGeometries",
    "subGeom",
    "setNullPose",
    "subGeometries",
    "_iIndex",
    "_indexMappings",
    "indexMappings",
    "activateVertexBufferVO",
    "awayjs-renderergl/lib/vos/SubGeometryVOPool",
    "ShaderRegisterCache",
    "ShaderRegisterElement",
    "indexDictionary",
    "rotationRegisters",
    "positionAttribute",
    "getRegisterFromString",
    "scaleAndRotateTarget",
    "addVertexTempUsages",
    "regName",
    "getFreeVertexConstant",
    "vertexOneConst",
    "vertexTwoConst",
    "positionTarget",
    "getFreeVertexVectorTemp",
    "velocityTarget",
    "vertexTime",
    "vertexLife",
    "tempTime",
    "UVAttribute",
    "UVVaring",
    "setRegisterIndex",
    "parameterIndex",
    "registerIndex",
    "getRegisterIndex",
    "colorMulTarget",
    "colorMulVary",
    "getFreeVarying",
    "colorAddTarget",
    "colorAddVary",
    "colorTarget",
    "addFragmentTempUsages",
    "temp",
    "split",
    "parseInt",
    "_numVertexConstant",
    "_numFragmentConstant",
    "_index",
    "setVertexConstFromArray",
    "setVertexConstFromMatrix",
    "matrix",
    "rawData",
    "setFragmentConst",
    "awayjs-renderergl/lib/shaders/ShaderRegisterCache",
    "awayjs-renderergl/lib/shaders/ShaderRegisterElement",
    "_pVertexBuffer",
    "_pBufferContext",
    "_pBufferDirty",
    "previousTime",
    "Number",
    "NEGATIVE_INFINITY",
    "_iUniqueId",
    "SUBGEOM_ID_COUNT",
    "totalLenOfOneVertex",
    "_numVertices",
    "_pVertexData",
    "activateVertexBuffer",
    "bufferOffset",
    "format",
    "contextIndex",
    "stageIndex",
    "buffer",
    "createVertexBuffer",
    "uploadFromArray",
    "pop",
    "invalidateBuffer",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint",
    "ColorSegmentPoint",
    "life",
    "color",
    "_life",
    "_color",
    "Quaternion",
    "toMatrix3D",
    "appendTranslation",
    "awayjs-core/lib/geom/Quaternion",
    "totalTime",
    "startVertexIndex",
    "awayjs-renderergl/lib/animators/data/ParticleData",
    "ParticleData",
    "GLOBAL",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint",
    "SkeletonJoint",
    "jointPoseFromName",
    "jointName",
    "jointPoseIndex",
    "jointPoseIndexFromName",
    "jointPose",
    "cloneJointPose",
    "thisJointPose",
    "awayjs-renderergl/lib/animators/data/Skeleton",
    "Skeleton",
    "jointFromName",
    "jointIndex",
    "jointIndexFromName",
    "ADDITIVE",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase",
    "AnimationNodeBase",
    "AnimationClipNodeBase",
    "_pLooping",
    "_pTotalDuration",
    "_pStitchDirty",
    "_pStitchFinalFrame",
    "_pNumFrames",
    "_pDurations",
    "_pTotalDelta",
    "fixedFrameRate",
    "_pUpdateStitch",
    "_pLastFrame",
    "awayjs-display/lib/animators/nodes/AnimationNodeBase",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode",
    "ParticleNodeBase",
    "ParticleAccelerationState",
    "ParticleAccelerationNode",
    "acceleration",
    "_pStateClass",
    "_acceleration",
    "pGetAGALVertexCode",
    "accelerationValue",
    "_pMode",
    "getFreeVertexAttribute",
    "ACCELERATION_INDEX",
    "removeVertexTempUsage",
    "animator",
    "param",
    "tempAcceleration",
    "ACCELERATION_VECTOR3D",
    "_pOneData",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode",
    "ParticleBezierCurveState",
    "ParticleBezierCurveNode",
    "controlPoint",
    "endPoint",
    "_iControlPoint",
    "_iEndPoint",
    "controlValue",
    "BEZIER_CONTROL_INDEX",
    "endValue",
    "BEZIER_END_INDEX",
    "rev_time",
    "time_2",
    "time_temp",
    "distance",
    "bezierControl",
    "BEZIER_CONTROL_VECTOR3D",
    "bezierEnd",
    "BEZIER_END_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode",
    "ParticleBillboardState",
    "ParticleBillboardNode",
    "billboardAxis",
    "_iBillboardAxis",
    "rotationMatrixRegister",
    "MATRIX_INDEX",
    "shaderRegisterElement",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode",
    "ColorTransform",
    "ParticleColorState",
    "ParticleColorNode",
    "usesMultiplier",
    "usesOffset",
    "usesCycle",
    "usesPhase",
    "startColor",
    "endColor",
    "cycleDuration",
    "cyclePhase",
    "_iUsesMultiplier",
    "_iUsesOffset",
    "_iUsesCycle",
    "_iUsesPhase",
    "_iStartColor",
    "_iEndColor",
    "_iCycleDuration",
    "_iCyclePhase",
    "cycleConst",
    "CYCLE_INDEX",
    "sin",
    "getFreeVertexSingleTemp",
    "startMultiplierValue",
    "deltaMultiplierValue",
    "START_MULTIPLIER_INDEX",
    "DELTA_MULTIPLIER_INDEX",
    "startOffsetValue",
    "deltaOffsetValue",
    "START_OFFSET_INDEX",
    "DELTA_OFFSET_INDEX",
    "COLOR_START_COLORTRANSFORM",
    "COLOR_END_COLORTRANSFORM",
    "redMultiplier",
    "greenMultiplier",
    "blueMultiplier",
    "alphaMultiplier",
    "redOffset",
    "greenOffset",
    "blueOffset",
    "alphaOffset",
    "awayjs-core/lib/geom/ColorTransform",
    "awayjs-renderergl/lib/animators/states/ParticleColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode",
    "ParticleFollowState",
    "ParticleFollowNode",
    "usesPosition",
    "usesRotation",
    "smooth",
    "_iUsesPosition",
    "_iUsesRotation",
    "_iSmooth",
    "rotationAttribute",
    "FOLLOW_ROTATION_INDEX",
    "temp3",
    "temp4",
    "FOLLOW_POSITION_INDEX",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode",
    "ParticleInitialColorState",
    "ParticleInitialColorNode",
    "initialColor",
    "_iInitialColor",
    "multiplierValue",
    "MULTIPLIER_INDEX",
    "offsetValue",
    "OFFSET_INDEX",
    "COLOR_INITIAL_COLORTRANSFORM",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState",
    "_pDataLength",
    "MODES",
    "_priority",
    1,
    2,
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode",
    "ParticleOrbitState",
    "ParticleOrbitNode",
    "usesEulers",
    "radius",
    "eulers",
    "_iUsesEulers",
    "_iRadius",
    "_iEulers",
    "orbitRegister",
    "ORBIT_INDEX",
    "eulersMatrixRegister",
    "EULERS_INDEX",
    "cos",
    "degree",
    "orbit",
    "ORBIT_VECTOR3D",
    "PI",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode",
    "ParticleOscillatorState",
    "ParticleOscillatorNode",
    "oscillator",
    "_iOscillator",
    "oscillatorRegister",
    "OSCILLATOR_INDEX",
    "dgree",
    "drift",
    "OSCILLATOR_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode",
    "ParticlePositionState",
    "ParticlePositionNode",
    "_iPosition",
    "POSITION_INDEX",
    "POSITION_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode",
    "ParticleRotateToHeadingState",
    "ParticleRotateToHeadingNode",
    "nrmVel",
    "xAxis",
    "R",
    "R_rev",
    "cos2",
    "tempSingle",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode",
    "ParticleRotateToPositionState",
    "ParticleRotateToPositionNode",
    "nrmDirection",
    "o_temp",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode",
    "ParticleRotationalVelocityState",
    "ParticleRotationalVelocityNode",
    "rotationalVelocity",
    "_iRotationalVelocity",
    "rotationRegister",
    "ROTATIONALVELOCITY_INDEX",
    "Rtemp",
    "rotate",
    "ROTATIONALVELOCITY_VECTOR3D",
    "normalize",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode",
    "ParticleScaleState",
    "ParticleScaleNode",
    "minScale",
    "maxScale",
    "_iMinScale",
    "_iMaxScale",
    "scaleRegister",
    "SCALE_INDEX",
    "scale",
    "SCALE_VECTOR3D",
    "abs",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode",
    "ParticleSegmentedColorState",
    "ParticleSegmentedColorNode",
    "numSegmentPoint",
    "segmentPoints",
    "_iNumSegmentPoint",
    "_iSegmentPoints",
    "accMultiplierColor",
    "tempColor",
    "accTime",
    "lifeTimeRegister",
    "TIME_DATA_INDEX",
    "startMulValue",
    "deltaMulValues",
    "deltaOffsetValues",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode",
    "ParticleSpriteSheetState",
    "ParticleSpriteSheetNode",
    "numColumns",
    "numRows",
    "totalFrames",
    "MAX_VALUE",
    "_iNumColumns",
    "_iNumRows",
    "_iTotalFrames",
    "min",
    "uvParamConst1",
    "uvParamConst2",
    "UV_INDEX_0",
    "UV_INDEX_1",
    "uTotal",
    "uStep",
    "vStep",
    "uSpeed",
    "cycle",
    "phaseTime",
    "vOffset",
    "v",
    "uvCycle",
    "UV_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState",
    "ParticleTimeState",
    "_iUsesDuration",
    "_iUsesLooping",
    "_iUsesDelay",
    "timeStreamRegister",
    "TIME_STREAM_INDEX",
    "timeConst",
    "TIME_CONSTANT_INDEX",
    "div",
    "sge",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode",
    "ParticleUVState",
    "ParticleUVNode",
    "axis",
    "_cycle",
    "_scale",
    "_axis",
    "updateUVData",
    "uvConst",
    "UV_INDEX",
    "axisIndex",
    "_iUvData",
    "U_AXIS",
    "V_AXIS",
    "awayjs-renderergl/lib/animators/states/ParticleUVState",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode",
    "ParticleVelocityState",
    "ParticleVelocityNode",
    "velocity",
    "_iVelocity",
    "velocityValue",
    "VELOCITY_INDEX",
    "_tempVelocity",
    "VELOCITY_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode",
    "SkeletonBinaryLERPState",
    "SkeletonBinaryLERPNode",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode",
    "SkeletonClipState",
    "SkeletonClipNode",
    "_frames",
    "highQuality",
    "addFrame",
    "skeletonPose",
    "p1",
    "p2",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode",
    "SkeletonDifferenceState",
    "SkeletonDifferenceNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode",
    "SkeletonDirectionalState",
    "SkeletonDirectionalNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode",
    "SkeletonNaryLERPState",
    "SkeletonNaryLERPNode",
    "_iInputs",
    "_numInputs",
    "getInputIndex",
    "input",
    "getInputAt",
    "addInput",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode",
    "VertexClipState",
    "VertexClipNode",
    "_translations",
    "awayjs-renderergl/lib/animators/states/VertexClipState",
    "awayjs-renderergl/lib/animators/states/AnimationClipState",
    "AnimationStateBase",
    "AnimationClipState",
    "animationClipNode",
    "_pFramesDirty",
    "_animationClipNode",
    "_pUpdateFrames",
    "_pBlendWeight",
    "_pCurrentFrame",
    "_pNextFrame",
    "looping",
    "_pStartTime",
    "totalDuration",
    "_pTime",
    "_pUpdateTime",
    "_pTimeDir",
    "lastFrame",
    "notifyPlaybackComplete",
    "floor",
    "dur",
    "frameTime",
    "durations",
    "_animationStatePlaybackComplete",
    "PLAYBACK_COMPLETE",
    "_pAnimator",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase",
    "_pRootDelta",
    "_pPositionDeltaDirty",
    "_pAnimationNode",
    "_pUpdatePositionDelta",
    "awayjs-renderergl/lib/animators/states/IAnimationState",
    "awayjs-renderergl/lib/animators/states/ISkeletonAnimationState",
    "awayjs-renderergl/lib/animators/states/IVertexAnimationState",
    "ParticleStateBase",
    "particleAccelerationNode",
    "_particleAccelerationNode",
    "updateAccelerationData",
    "FLOAT_3",
    "_halfAcceleration",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase",
    "particleBezierCurveNode",
    "_particleBezierCurveNode",
    "_controlPoint",
    "_endPoint",
    "controlIndex",
    "endIndex",
    "MathConsts",
    "Orientation3D",
    "particleNode",
    "_matrix",
    "_billboardAxis",
    "comps",
    "pos",
    "sceneTransform",
    "look",
    "right",
    "crossProduct",
    "decompose",
    "AXIS_ANGLE",
    "copyColumnFrom",
    "appendRotation",
    "RADIANS_TO_DEGREES",
    "append",
    "inverseSceneTransform",
    "identity",
    "awayjs-core/lib/geom/MathConsts",
    "awayjs-core/lib/geom/Orientation3D",
    "particleColorNode",
    "_particleColorNode",
    "_usesMultiplier",
    "_usesOffset",
    "_usesCycle",
    "_usesPhase",
    "_startColor",
    "_endColor",
    "_cycleDuration",
    "_cyclePhase",
    "updateColorData",
    "dataOffset",
    "_cycleData",
    "FLOAT_4",
    "_startMultiplierData",
    "_deltaMultiplierData",
    "_startOffsetData",
    "_deltaOffsetData",
    "particleFollowNode",
    "_targetPos",
    "_targetEuler",
    "_temp",
    "_particleFollowNode",
    "_smooth",
    "_followTarget",
    "scaleX",
    "scaleY",
    "scaleZ",
    "rotationX",
    "rotationY",
    "rotationZ",
    "scaleBy",
    "DEGREES_TO_RADIANS",
    "_prePos",
    "_preEuler",
    "currentTime",
    "deltaTime",
    "needProcess",
    "processPositionAndRotation",
    "processPosition",
    "precessRotation",
    "changed",
    "interpolatedPos",
    "posVelocity",
    "inc",
    "add",
    "interpolatedRotation",
    "rotationVelocity",
    "particleInitialColorNode",
    "_particleInitialColorNode",
    "_initialColor",
    "_multiplierData",
    "_offsetData",
    "particleOrbitNode",
    "_particleOrbitNode",
    "_usesEulers",
    "_eulers",
    "_radius",
    "updateOrbitData",
    "_orbitData",
    "_eulersMatrix",
    "X_AXIS",
    "Y_AXIS",
    "Z_AXIS",
    "particleOscillatorNode",
    "_particleOscillatorNode",
    "_oscillator",
    "updateOscillatorData",
    "_oscillatorData",
    "particlePositionNode",
    "_particlePositionNode",
    "_position",
    "getPositions",
    "_pDynamicProperties",
    "_pDynamicPropertiesDirty",
    "_pUpdateDynamicProperties",
    "particleRotateToPositionNode",
    "_particleRotateToPositionNode",
    "_offset",
    "particleRotationNode",
    "_particleRotationalVelocityNode",
    "_rotationalVelocity",
    "updateRotationalVelocityData",
    "getRotationalVelocities",
    "setRotationalVelocities",
    "_rotationalVelocityData",
    "rotation",
    "particleScaleNode",
    "_particleScaleNode",
    "_minScale",
    "_maxScale",
    "updateScaleData",
    "_scaleData",
    "particleSegmentedColorNode",
    "_segmentPoints",
    "_numSegmentPoint",
    "_timeLifeData",
    "particleSpriteSheetNode",
    "_particleSpriteSheetNode",
    "_totalFrames",
    "_numColumns",
    "_numRows",
    "updateSpriteSheetData",
    "_spriteSheetData",
    "_particleNode",
    "_pNeedUpdateTime",
    "animationParticle",
    "particleTimeNode",
    "_particleTimeNode",
    "particleTime",
    "particleUVNode",
    "_particleUVNode",
    "particleVelocityNode",
    "_particleVelocityNode",
    "_velocity",
    "getVelocities",
    "setVelocities",
    "skeletonAnimationNode",
    "_blendWeight",
    "_skeletonPose",
    "_skeletonPoseDirty",
    "_skeletonAnimationNode",
    "_inputA",
    "inputA",
    "_inputB",
    "inputB",
    "updateSkeletonPose",
    "deltA",
    "deltB",
    "endPose",
    "endPoses",
    "poses1",
    "poses2",
    "pose1",
    "pose2",
    "lerp",
    "skeletonClipNode",
    "_rootPos",
    "_skeletonClipNode",
    "frames",
    "_currentPose",
    "_nextPose",
    "currentPose",
    "nextPose",
    "slerp",
    "p3",
    "totalDelta",
    "_pOldFrame",
    "dx",
    "dy",
    "dz",
    "stitchFinalFrame",
    "_baseInput",
    "baseInput",
    "_differenceInput",
    "differenceInput",
    "basePoses",
    "diffPoses",
    "base",
    "diff",
    "basePos",
    "diffPos",
    "_tempQuat",
    "multiply",
    "_direction",
    "_blendDirty",
    "_forward",
    "forward",
    "_backward",
    "backward",
    "_left",
    "left",
    "_right",
    "updateBlend",
    "_pUdateTime",
    "_blendWeights",
    "_inputs",
    "numInputs",
    "getBlendWeightAt",
    "setBlendWeightAt",
    "poses",
    "endTr",
    "endQuat",
    "firstPose",
    "w0",
    "x0",
    "y0",
    "z0",
    "vertexClipNode",
    "_vertexClipNode",
    "_currentGeometry",
    "_nextGeometry",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode",
    "CrossfadeTransitionState",
    "CrossfadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState",
    "_crossfadeTransitionNode",
    "startBlend",
    "blendSpeed",
    "_animationStateTransitionComplete",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition",
    "CrossfadeTransition",
    "startNode",
    "endNode",
    "crossFadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/IAnimationTransition",
    "awayjs-renderergl/lib/base/ParticleGeometry",
    "Geometry",
    "ParticleGeometry",
    "apply",
    "arguments",
    "awayjs-display/lib/base/Geometry",
    "message",
    "awayjs-core/lib/errors/Error",
    "_animator",
    "_animationState",
    "_animationNode",
    "awayjs-renderergl/lib/events/ShadingMethodEvent",
    "ShadingMethodEvent",
    "SHADER_INVALIDATED",
    "awayjs-renderergl/lib/filters/Filter3DBase",
    "Filter3DBase",
    "pAddTask",
    "_textureWidth",
    "_textureHeight",
    "mainTarget",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase",
    "ContextGLTextureFormat",
    "Filter3DTaskBase",
    "_scaledTextureWidth",
    "_scaledTextureHeight",
    "_textureDimensionsInvalid",
    "_program3DInvalid",
    "_textureScale",
    "_target",
    "pUpdateTextures",
    "_program3D",
    "pInvalidateProgram",
    "pUpdateProgram",
    "pGetVertexCode",
    "pGetFragmentCode",
    "createTexture",
    "BGRA",
    "awayjs-stagegl/lib/base/ContextGLTextureFormat",
    "ImageUtils",
    "_viewWidth",
    "_viewHeight",
    "_buffersInvalid",
    "_renderToTextureRect",
    "_instances",
    "rttBufferManager",
    "getRTTBufferManagerFromStage",
    "vo",
    "RTTBufferManagerVO",
    "stage3d",
    "rttbfm",
    "c",
    "deleteRTTBufferManager",
    "updateRTTBuffers",
    "_textureRatioX",
    "_textureRatioY",
    "getBestPowerOf2",
    "_renderToTextureVertexBuffer",
    "_renderToScreenVertexBuffer",
    "_indexBuffer",
    "textureVerts",
    "screenVerts",
    "createIndexBuffer",
    "u1",
    "u2",
    "v1",
    "v2",
    "awayjs-core/lib/utils/ImageUtils",
    "awayjs-renderergl/lib/pick/ShaderPicker",
    "Debug",
    "Matrix3DUtils",
    "ContextGLTriangleFace",
    "ShaderPicker",
    "shaderPickingDetails",
    "_onlyMouseEnabled",
    "_interactives",
    "_localHitPosition",
    "_hitUV",
    "_localHitNormal",
    "_rayPos",
    "_rayDir",
    "_shaderPickingDetails",
    "_id",
    "_viewportData",
    "_boundOffsetScale",
    "getViewCollision",
    "view",
    "collector",
    "iEntityCollector",
    "renderer",
    "_context",
    "_projX",
    "_projY",
    "_potentialFound",
    "_blendedRenderableHead",
    "_opaqueRenderableHead",
    "_bitmapImage2D",
    "_hitColor",
    "getPixel",
    "_hitRenderable",
    "_hitEntity",
    "_iIsMouseEnabled",
    "_collisionVO",
    "_iPickingCollisionVO",
    "getHitDetails",
    "localPosition",
    "localNormal",
    "uv",
    "_faceIndex",
    "getSceneCollision",
    "direction",
    "scene",
    "MOUSE_SCISSOR_RECT",
    "_interactiveId",
    "_objectProgram",
    "initObjectProgram",
    "CALCULATION_MATRIX",
    "setCulling",
    "bothSides",
    "NONE",
    "BACK",
    "projection",
    "coordinateSystem",
    "setProgramConstantsFromMatrix",
    "getIndexBufferVO",
    "draw",
    "updateRay",
    "getRay",
    "vertexCode",
    "fragmentCode",
    "throwPIR",
    "initTriangleProgram",
    "_triangleProgram",
    "getApproximatePosition",
    "getPreciseDetails",
    "bounds",
    "getBox",
    "col",
    "scX",
    "scY",
    "scZ",
    "offsX",
    "offsY",
    "offsZ",
    "localViewProjection",
    "depth",
    "setScissorRectangle",
    "t1",
    "t2",
    "t3",
    "v0x",
    "v0y",
    "v0z",
    "v1x",
    "v1y",
    "v1z",
    "v2x",
    "v2y",
    "v2z",
    "ni1",
    "ni2",
    "ni3",
    "n1",
    "n2",
    "n3",
    "nLength",
    "dot00",
    "dot01",
    "dot02",
    "dot11",
    "dot12",
    "invDenom",
    "ui1",
    "ui2",
    "ui3",
    "s0x",
    "s0y",
    "s0z",
    "s1x",
    "s1y",
    "s1z",
    "nl",
    "_pGetSubGeometry",
    "posDim",
    "dimensions",
    "uvDim",
    "normalDim",
    "getPrecisePosition",
    "invSceneTransform",
    "px",
    "py",
    "pz",
    "rx",
    "ry",
    "rz",
    "RAW_DATA_CONTAINER",
    "copyRawDataTo",
    "awayjs-core/lib/geom/Matrix3DUtils",
    "awayjs-core/lib/utils/Debug",
    "awayjs-stagegl/lib/base/ContextGLTriangleFace",
    "awayjs-renderergl/lib/render/BasicMaterialRender",
    "BlendMode",
    "BasicMaterialPass",
    "RenderBase",
    "BasicMaterialRender",
    "pool",
    "material",
    "renderableClass",
    "_material",
    "_pAddPass",
    "_pass",
    "_pUpdateRender",
    "_pRequiresBlending",
    "NORMAL",
    "alphaBlending",
    "colorTransform",
    "preserveAlpha",
    "setBlendMode",
    "LAYER",
    "awayjs-core/lib/data/BlendMode",
    "awayjs-renderergl/lib/render/RenderBase",
    "awayjs-renderergl/lib/render/passes/BasicMaterialPass",
    "RenderPassBase",
    "ShaderBase",
    "_shader",
    "_iIncludeDependencies",
    "projectionDependencies",
    "uvDependencies",
    "_iInitConstantData",
    "_fragmentConstantsIndex",
    "_iGetFragmentCode",
    "registerCache",
    "sharedRegisters",
    "targetReg",
    "dataReg1",
    "getFreeFragmentConstant",
    "dataReg2",
    "getFreeFragmentVectorTemp",
    "projectionFragment",
    "texture",
    "_iInitRegisters",
    "albedo",
    "uvVarying",
    "cutOffReg",
    "removeFragmentTempUsage",
    "awayjs-renderergl/lib/render/RenderPassBase",
    "awayjs-renderergl/lib/shaders/ShaderBase",
    "viewDirDependencies",
    "globalPosDependencies",
    "viewDirVarying",
    "far",
    "awayjs-renderergl/lib/render/IRenderClass",
    "MaterialBase",
    "_forceSeparateMVP",
    "_invalidAnimation",
    "_invalidRender",
    "_passes",
    "_pool",
    "_renderableClass",
    "_onPassChangeDelegate",
    "onPassChange",
    "_updateAnimation",
    "_renderOrderId",
    "useMipmapping",
    "mipmap",
    "useSmoothTextures",
    "useAlphaPremultiplied",
    "alphaPremultiplied",
    "useBothSides",
    "repeatTextures",
    "repeat",
    "animateUVs",
    "usesColorTransform",
    "useColorTransform",
    "getTextureVO",
    "_pClearPasses",
    "disposeItem",
    "invalidateRender",
    "invalidatePasses",
    "invalidatePass",
    "invalidateAnimation",
    "enabledGPUAnimation",
    "_getEnabledGPUAnimation",
    "mult",
    "usesAnimation",
    "invalidateProgram",
    "_pRemovePass",
    "CHANGE",
    "owners",
    "iOwners",
    "numOwners",
    "awayjs-display/lib/materials/MaterialBase",
    "invalidateShader",
    "_iGetPreLightingVertexCode",
    "_iGetPreLightingFragmentCode",
    "_iGetVertexCode",
    "_iGetNormalVertexCode",
    "_iGetNormalFragmentCode",
    "awayjs-renderergl/lib/render/RenderPool",
    "BasicMaterial",
    "Skybox",
    "SkyboxRender",
    "RenderPool",
    "renderClass",
    "_renderClass",
    "_iAddRender",
    "getClass",
    "_iRemoveRender",
    "registerClass",
    "assetClass",
    "_classPool",
    "addDefaults",
    "main",
    "awayjs-display/lib/entities/Skybox",
    "awayjs-display/lib/materials/BasicMaterial",
    "awayjs-renderergl/lib/render/SkyboxRender",
    "skybox",
    "_skybox",
    "_cubeTexture",
    "cubeMap",
    "usesLocalPosFragment",
    "localPositionVarying",
    "PassBase",
    "_diffuseR",
    "_diffuseG",
    "_diffuseB",
    "_diffuseA",
    "regCache",
    "sharedReg",
    "alphaReg",
    "getFreeFragmentSingleTemp",
    "colorBufferIndex",
    "colorVarying",
    "diffuseInputReg",
    "awayjs-renderergl/lib/render/passes/PassBase",
    "awayjs-renderergl/lib/render/passes/ILightingPass",
    "awayjs-renderergl/lib/render/passes/IPass",
    "_preserveAlpha",
    "_render",
    "awayjs-renderergl/lib/renderables/BillboardRenderable",
    "AttributesBuffer",
    "TriangleSubGeometry",
    "Billboard",
    "RenderableBase",
    "BillboardRenderable",
    "billboard",
    "_billboard",
    "billboardRect",
    "_materialGeometry",
    "globalPositionVertex",
    "viewMatrixReg",
    "viewMatrixIndex",
    "_setRenderState",
    "sceneMatrixIndex",
    "matrix3D",
    "awayjs-core/lib/attributes/AttributesBuffer",
    "awayjs-display/lib/base/TriangleSubGeometry",
    "awayjs-display/lib/entities/Billboard",
    "awayjs-renderergl/lib/renderables/RenderableBase",
    "awayjs-renderergl/lib/renderables/CurveSubMeshRenderable",
    "CurveSubMesh",
    "CurveSubMeshRenderable",
    "_constants",
    "sd",
    "standardDerivatives",
    "out",
    "curve",
    "curvex",
    "curvey",
    "curvez",
    "free",
    "free1",
    "free2",
    "d2",
    "fixa",
    "fixb",
    "_aa",
    "_0",
    "_1",
    "applyAA",
    "join",
    "awayjs-display/lib/base/CurveSubMesh",
    "awayjs-renderergl/lib/renderables/IRenderableClass",
    "awayjs-renderergl/lib/renderables/LineSegmentRenderable",
    "LineSubGeometry",
    "LineSegment",
    "LineSegmentRenderable",
    "lineSegment",
    "_thickness",
    "_lineSegment",
    "_calcMatrix",
    "_lineGeometry",
    "startPostion",
    "end",
    "endPosition",
    "thickness",
    "Float32Array",
    "setThickness",
    "colorDependencies",
    "pONE_VECTOR",
    "pFRONT_VECTOR",
    "_pGetOverflowRenderable",
    "indexOffset",
    "awayjs-display/lib/base/LineSubGeometry",
    "awayjs-display/lib/entities/LineSegment",
    "awayjs-renderergl/lib/renderables/LineSubMeshRenderable",
    "LineSubMesh",
    "LineSubMeshRenderable",
    "awayjs-display/lib/base/LineSubMesh",
    "RenderableOwnerEvent",
    "_geometryDirty",
    "_onRenderOwnerUpdatedDelegate",
    "_onRenderOwnerUpdated",
    "RENDER_OWNER_UPDATED",
    "_updateGeometry",
    "_subGeometryVO",
    "invalidateGeometry",
    "awayjs-display/lib/events/RenderableOwnerEvent",
    "SkyboxRenderable",
    "TriangleSubMeshRenderable",
    "_objectPools",
    "_iAddRenderable",
    "_iRemoveRenderable",
    "awayjs-renderergl/lib/renderables/SkyboxRenderable",
    "awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable",
    "_vertexArray",
    "_geometry",
    "TriangleSubMesh",
    "awayjs-display/lib/base/TriangleSubMesh",
    "awayjs-renderergl/lib/shaders/LightingShader",
    "LightSources",
    "ContextGLProfile",
    "LightingCompiler",
    "LightingShader",
    "lightingPass",
    "_includeCasters",
    "_lightingPass",
    "numPointLights",
    "numDirectionalLights",
    "numLightProbes",
    "numAllLights",
    "diffuseLightSources",
    "_iUsesDiffuse",
    "specularLightSources",
    "_iUsesSpecular",
    "combinedLightSources",
    "usesLightFallOff",
    "enableLightFallOff",
    "BASELINE_CONSTRAINED",
    "numLights",
    "usesLights",
    "LIGHTS",
    "usesProbes",
    "PROBES",
    "usesLightsForSpecular",
    "usesProbesForSpecular",
    "usesLightsForDiffuse",
    "usesProbesForDiffuse",
    "usesShadows",
    "_iUsesShadows",
    "createCompiler",
    "lightPicker",
    "collectLights",
    "updateProbes",
    "dirLight",
    "pointLight",
    "dirPos",
    "numLightTypes",
    "ambientR",
    "ambientG",
    "ambientB",
    "lightVertexConstantIndex",
    "lightFragmentConstantIndex",
    "cast",
    "directionalLightsOffset",
    "castingDirectionalLights",
    "sceneDirection",
    "_iAmbientR",
    "_iAmbientG",
    "_iAmbientB",
    "usesTangentSpace",
    "_pInverseSceneMatrix",
    "_iDiffuseR",
    "_iDiffuseG",
    "_iDiffuseB",
    "_iSpecularR",
    "_iSpecularG",
    "_iSpecularB",
    "pointLightsOffset",
    "castingPointLights",
    "usesGlobalPosFragment",
    "_pRadius",
    "_pFallOffFactor",
    "probe",
    "lightProbes",
    "lightProbeWeights",
    "lightProbesOffset",
    "addDiff",
    "addSpec",
    "getImageObject",
    "diffuseMap",
    "lightProbeDiffuseIndices",
    "specularMap",
    "lightProbeSpecularIndices",
    "probeWeightsIndex",
    "awayjs-display/lib/materials/LightSources",
    "awayjs-renderergl/lib/shaders/compilers/LightingCompiler",
    "awayjs-stagegl/lib/base/ContextGLProfile",
    "awayjs-renderergl/lib/shaders/RegisterPool",
    "RegisterPool",
    "regCount",
    "persistent",
    "_regName",
    "_regCount",
    "_persistent",
    "initRegisters",
    "requestFreeVectorReg",
    "isRegisterUsed",
    "_usedVectorCount",
    "_vectorRegisters",
    "requestFreeRegComponent",
    "_usedSingleCount",
    "_registerComponents",
    "addUsage",
    "register",
    "usageCount",
    "_component",
    "removeUsage",
    "hasRegisteredRegs",
    "hash",
    "_initPool",
    "_regPool",
    "_regCompsPool",
    "_initArray",
    "vectorRegisters",
    "registerComponents",
    "val",
    "ArgumentError",
    "CompilerBase",
    "TextureVOPool",
    "_blendFactorSource",
    "_blendFactorDest",
    "_invalidShader",
    "_invalidProgram",
    "_animationVertexCode",
    "_animationFragmentCode",
    "usesBlending",
    "depthCompareMode",
    "writeDepth",
    "_defaultCulling",
    "_textureVOPool",
    "_updateProgram",
    "_programData",
    "secondaryUVDependencies",
    "outputsTangentNormals",
    "pInitRegisterIndices",
    "commonsDataIndex",
    "cameraPositionIndex",
    "uvBufferIndex",
    "uvTransformIndex",
    "colorTransformIndex",
    "secondaryUVBufferIndex",
    "normalBufferIndex",
    "tangentBufferIndex",
    "sceneNormalMatrixIndex",
    "initConstantData",
    "SOURCE_ALPHA",
    "ONE_MINUS_SOURCE_ALPHA",
    "MULTIPLY",
    "SOURCE_COLOR",
    "ADD",
    "ALPHA",
    "uvTransform",
    "compiler",
    "compile",
    "_calcAnimationCode",
    "getProgramData",
    "postAnimationFragmentCode",
    "usages",
    "awayjs-core/lib/errors/ArgumentError",
    "awayjs-renderergl/lib/shaders/compilers/CompilerBase",
    "awayjs-renderergl/lib/vos/TextureVOPool",
    "_numUsedVertexConstants",
    "_numUsedFragmentConstants",
    "_numUsedVaryings",
    "_profile",
    "_fragmentTempCache",
    "_vertexTempCache",
    "_varyingCache",
    "_textureCache",
    "_vertexAttributesCache",
    "_fragmentConstantsCache",
    "_vertexConstantsCache",
    "_fragmentOutputRegister",
    "_vertexOutputRegister",
    "_vertexAttributesOffset",
    "_vertexConstantOffset",
    "_varyingsOffset",
    "_fragmentConstantOffset",
    "getFreeTextureReg",
    "awayjs-renderergl/lib/shaders/ShaderRegisterData",
    "ShaderRegisterData",
    "component",
    "_toStr",
    "COMPONENTS",
    "_pVertexCode",
    "_pFragmentCode",
    "_pPostAnimationFragmentCode",
    "_pRenderableClass",
    "_pRenderPass",
    "_pShader",
    "_pSharedRegisters",
    "_pRegisterCache",
    "pCompileDependencies",
    "console",
    "log",
    "compileColorTransformCode",
    "fragmentOutputRegister",
    "_pAnimatableAttributes",
    "_pAnimationTargetRegisters",
    "_uvSource",
    "_uvTarget",
    "ct1",
    "ct2",
    "compileGlobalPositionCode",
    "compileLocalPositionCode",
    "compileUVCode",
    "compileSecondaryUVCode",
    "compileNormalCode",
    "compileViewDirCode",
    "sceneMatrixReg",
    "globalPositionVarying",
    "uvAttributeReg",
    "varying",
    "uvTransform1",
    "uvTransform2",
    "secondaryUVVarying",
    "cameraPositionReg",
    "viewDirFragment",
    "animatedTangent",
    "normalFragment",
    "normalMatrix",
    "normalVarying",
    "animatedNormal",
    "bitangent",
    "tangentVarying",
    "bitangentVarying",
    "normalInput",
    "commons",
    "tangentInput",
    "colorInput",
    "shaderLightingObject",
    "_shaderLightingObject",
    "pCompileShadowCode",
    "initLightRegisters",
    "compileLightCode",
    "compileLightProbeCode",
    "_iGetPostLightingVertexCode",
    "_iGetPostLightingFragmentCode",
    "shadowTarget",
    "_dirLightVertexConstants",
    "_pointLightVertexConstants",
    "_dirLightFragmentConstants",
    "_pointLightFragmentConstants",
    "diffuseColorReg",
    "specularColorReg",
    "lightPosReg",
    "lightDirReg",
    "vertexRegIndex",
    "fragmentRegIndex",
    "lightVarying",
    "_iGetPerLightDiffuseFragmentCode",
    "_iGetPerLightSpecularFragmentCode",
    "weightReg",
    "weightComponents",
    "weightRegisters",
    "texReg",
    "_pNumProbeRegisters",
    "_iGetPerProbeDiffuseFragmentCode",
    "_iGetPerProbeSpecularFragmentCode",
    "ceil",
    "awayjs-renderergl/lib/tools/commands/Merge",
    "Mesh",
    "Merge",
    "keepMaterial",
    "disposeSources",
    "objectSpace",
    "_keepMaterial",
    "_disposeSources",
    "_objectSpace",
    "applyToContainer",
    "receiver",
    "objectContainer",
    "parseContainer",
    "collect",
    "merge",
    "applyToMeshes",
    "meshes",
    "_toDispose",
    "_geomVOs",
    "destMesh",
    "subIdx",
    "oldGeom",
    "destGeom",
    "useSubMaterials",
    "sub",
    "vertices",
    "addSubGeometry",
    "m",
    "calc",
    "iIdx",
    "vIdx",
    "nIdx",
    "tIdx",
    "uIdx",
    "ind",
    "pd",
    "nd",
    "td",
    "ud",
    "getSubGeomData",
    "transformVectors",
    "deltaTransformVectors",
    "GeometryVO",
    "object",
    "child",
    "numChildren",
    "getChildAt",
    "awayjs-display/lib/entities/Mesh",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform",
    "ParticleGeometryTransform",
    "_defaultVertexTransform",
    "_defaultInvVertexTransform",
    "transpose",
    "_defaultUVTransform",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper",
    "ParticleGeometryHelper",
    "generateGeometry",
    "geometries",
    "transforms",
    "indicesVector",
    "positionsVector",
    "normalsVector",
    "tangentsVector",
    "uvsVector",
    "vertexCounters",
    "sourceSubGeometries",
    "numSubGeometries",
    "vertexCounter",
    "sub2SubMap",
    "tempVertex",
    "tempNormal",
    "tempTangents",
    "tempUV",
    "MAX_VERTEX",
    "particleData",
    "tempLen",
    "compact",
    "product",
    "sourceUVs",
    "particleGeometryTransform",
    "vertexTransform",
    "invVertexTransform",
    "UVTransform",
    "deltaTransformVector",
    "transformPoint",
    "sourceIndices",
    "particleGeometry",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D",
    "PerspectiveMatrix3D",
    "perspectiveFieldOfViewLH",
    "fieldOfViewY",
    "aspectRatio",
    "zNear",
    "zFar",
    "yScale",
    "tan",
    "xScale",
    "copyRawDataFrom",
    "awayjs-renderergl/lib/vos/CurveSubGeometryVO",
    "CurveSubGeometry",
    "SubGeometryVOBase",
    "CurveSubGeometryVO",
    "curveSubGeometry",
    "_curveSubGeometry",
    "invalidateVertices",
    "curves",
    "_pGetOverflowSubGeometry",
    "awayjs-display/lib/base/CurveSubGeometry",
    "awayjs-renderergl/lib/vos/SubGeometryVOBase",
    "awayjs-renderergl/lib/vos/ISubGeometryVOClass",
    "awayjs-renderergl/lib/vos/ITextureVOClass",
    "awayjs-renderergl/lib/vos/LineSubGeometryVO",
    "LineSubGeometryVO",
    "lineSubGeometry",
    "_lineSubGeometry",
    "colors",
    "awayjs-renderergl/lib/vos/Sampler2DVO",
    "SamplerVOBase",
    "Sampler2DVO",
    "initProperties",
    "sampler2D",
    "samplerReg",
    "samplerIndex",
    "imageRect",
    "fragmentReg",
    "fragmentIndex",
    "getFragmentCode",
    "inputReg",
    "wrap",
    "getFormatString",
    "image2D",
    "offsetX",
    "offsetY",
    "awayjs-renderergl/lib/vos/SamplerVOBase",
    "awayjs-renderergl/lib/vos/SamplerCubeVO",
    "SamplerCubeVO",
    "samplerCube",
    "imageCube",
    "bitmap",
    "COMPRESSED",
    "COMPRESSED_ALPHA",
    "awayjs-renderergl/lib/vos/Single2DTextureVO",
    "Single2DTexture",
    "TextureVOBase",
    "Single2DTextureVO",
    "single2DTexture",
    "_single2DTexture",
    "_sampler2DVO",
    "awayjs-display/lib/textures/Single2DTexture",
    "awayjs-renderergl/lib/vos/TextureVOBase",
    "awayjs-renderergl/lib/vos/SingleCubeTextureVO",
    "SingleCubeTexture",
    "SingleCubeTextureVO",
    "singleCubeTexture",
    "_singleCubeTexture",
    "_samplerCubeVO",
    "includeInput",
    "awayjs-display/lib/textures/SingleCubeTexture",
    "SubGeometryUtils",
    "_vertices",
    "_verticesDirty",
    "_subGeometry",
    "_onIndicesUpdatedDelegate",
    "_onIndicesUpdated",
    "_onIndicesDisposedDelegate",
    "_onIndicesDisposed",
    "_onVerticesUpdatedDelegate",
    "_onVerticesUpdated",
    "_onVerticesDisposedDelegate",
    "_onVerticesDisposed",
    "INDICES_DISPOSED",
    "VERTICES_DISPOSED",
    "invalidateIndices",
    "_numElements",
    "_indicesDirty",
    "_updateIndices",
    "getAttributesBufferVO",
    "_indices",
    "getVertexBufferVO",
    "bufferId",
    "_updateVertices",
    "size",
    "disposeIndices",
    "disposeVertices",
    "_overflow",
    "invalidate",
    "invalid",
    "getSubIndices",
    "count",
    "getSubVertices",
    "awayjs-display/lib/utils/SubGeometryUtils",
    "TriangleSubGeometryVO",
    "_iAddSubGeometryVO",
    "_iRemoveSubGeometryVO",
    "subGeometryVOClass",
    "classPool",
    "awayjs-renderergl/lib/vos/TriangleSubGeometryVO",
    "_texture",
    "_iAddTextureVO",
    "_iRemoveTextureVO",
    "textureVOClass",
    "triangleSubGeometry",
    "_triangleSubGeometry"
  ],
  "mappings": "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",
  "file": "awayjs-renderergl.min.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    null,
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DepthRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DepthRenderer\");\nimport DistanceRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DistanceRenderer\");\nimport Filter3DRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/Filter3DRenderer\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport SkyboxRenderable\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/SkyboxRenderable\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\n\n/**\n * The DefaultRenderer class provides the default rendering method. It renders the scene graph objects using the\n * materials assigned to them.\n *\n * @class away.render.DefaultRenderer\n */\nclass DefaultRenderer extends RendererBase\n{\n\tpublic _pRequireDepthRender:boolean;\n\n\tprivate _pDistanceRenderer:DepthRenderer;\n\tprivate _pDepthRenderer:DepthRenderer;\n\tprivate _skyboxProjection:Matrix3D = new Matrix3D();\n\tpublic _pFilter3DRenderer:Filter3DRenderer;\n\n\tpublic _pDepthRender:BitmapImage2D;\n\n\tprivate _antiAlias:number;\n\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(value:number)\n\t{\n\t\tif (this._antiAlias == value)\n\t\t\treturn;\n\n\t\tthis._antiAlias = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get depthPrepass():boolean\n\t{\n\t\treturn this._depthPrepass;\n\t}\n\n\tpublic set depthPrepass(value:boolean)\n\t{\n\t\tthis._depthPrepass = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {*}\n\t */\n\tpublic get filters3d():Array<Filter3DBase>\n\t{\n\t\treturn this._pFilter3DRenderer? this._pFilter3DRenderer.filters : null;\n\t}\n\tpublic set filters3d(value:Array<Filter3DBase>)\n\t{\n\t\tif (value && value.length == 0)\n\t\t\tvalue = null;\n\n\t\tif (this._pFilter3DRenderer && !value) {\n\t\t\tthis._pFilter3DRenderer.dispose();\n\t\t\tthis._pFilter3DRenderer = null;\n\t\t} else if (!this._pFilter3DRenderer && value) {\n\t\t\tthis._pFilter3DRenderer = new Filter3DRenderer(this._pStage);\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t}\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t\tthis._pRequireDepthRender = this._pFilter3DRenderer.requireDepthRender;\n\t\t} else {\n\t\t\tthis._pRequireDepthRender = false;\n\n\t\t\tif (this._pDepthRender) {\n\t\t\t\tthis._pDepthRender.dispose();\n\t\t\t\tthis._pDepthRender = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new DefaultRenderer object.\n\t *\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param renderMode The render mode to use.\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage);\n\t\t\n\t\tif (stage)\n\t\t\tthis._shareContext = true;\n\n\t\tthis._pRttBufferManager = RTTBufferManager.getInstance(this._pStage);\n\n\t\tthis._pDepthRenderer = new DepthRenderer(this._pStage);\n\t\tthis._pDistanceRenderer = new DistanceRenderer(this._pStage);\n\n\t\tif (this._width == 0)\n\t\t\tthis.width = window.innerWidth;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewWidth = this._width;\n\n\t\tif (this._height == 0)\n\t\t\tthis.height = window.innerHeight;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewHeight = this._height;\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._pStage.recoverFromDisposal()) {//if context has Disposed by the OS,don't render at this frame\n\t\t\tthis._pBackBufferInvalid = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pBackBufferInvalid)// reset or update render settings\n\t\t\tthis.pUpdateBackBuffer();\n\n\t\tif (this._shareContext && this._pContext)\n\t\t\tthis._pContext.clear(0, 0, 0, 1, 1, 0, ContextGLClearMask.DEPTH);\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\t\tthis.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\t} else {\n\t\t\tthis.textureRatioX = 1;\n\t\t\tthis.textureRatioY = 1;\n\t\t}\n\n\t\tif (this._pRequireDepthRender)\n\t\t\tthis.pRenderSceneDepthToTexture(<EntityCollector> entityCollector);\n\n\t\tif (this._depthPrepass)\n\t\t\tthis.pRenderDepthPrepass(<EntityCollector> entityCollector);\n\n\t\tif (this._pFilter3DRenderer && this._pContext) { //TODO\n\t\t\t//this._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t\t//this._pFilter3DRenderer.render(this._pStage, entityCollector.camera, this._pDepthRender);\n\n\t\t} else {\n\n\t\t\tif (this._shareContext)\n\t\t\t\tthis._iRender(entityCollector, null, this._pScissorRect);\n\t\t\telse\n\t\t\t\tthis._iRender(entityCollector);\n\t\t}\n\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._shareContext && this._pContext)\n\t\t\tthis._pContext.present();\n\n\t\t// register that a view has been rendered\n\t\tthis._pStage.bufferClear = false;\n\t}\n\n\tpublic pExecuteRender(entityCollector:EntityCollector, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis.updateLights(entityCollector);\n\n\t\tsuper.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\t}\n\n\tprivate updateLights(entityCollector:EntityCollector)\n\t{\n\t\tvar dirLights:Array<DirectionalLight> = entityCollector.directionalLights;\n\t\tvar pointLights:Array<PointLight> = entityCollector.pointLights;\n\t\tvar len:number, i:number;\n\t\tvar light:LightBase;\n\t\tvar shadowMapper:ShadowMapperBase;\n\n\t\tlen = dirLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = dirLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid ))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDepthRenderer);\n\t\t}\n\n\t\tlen = pointLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = pointLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDistanceRenderer);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector)\n\t{\n\t\tif (entityCollector.skyBox) {\n\t\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.ALWAYS);\n\n\t\t\tthis.drawSkybox(entityCollector);\n\t\t}\n\n\t\tsuper.pDraw(entityCollector);\n\t}\n\n\t/**\n\t * Draw the skybox if present.\n\t *\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawSkybox(entityCollector:EntityCollector)\n\t{\n\t\tvar renderable:RenderableBase = this._pRenderablePool.getItem(entityCollector.skyBox);\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis.updateSkyboxProjection(camera);\n\n\t\tvar render:RenderBase = this._pRenderablePool.getRenderPool(renderable.renderableOwner).getItem(renderable.renderOwner);\n\n\t\tvar pass:IPass = render.passes[0];\n\n\t\tthis.activatePass(renderable, pass, camera);\n\t\trenderable._iRender(pass, camera, this._skyboxProjection);\n\t\tthis.deactivatePass(renderable, pass);\n\t}\n\n\tprivate updateSkyboxProjection(camera:Camera)\n\t{\n\t\tvar near:Vector3D = new Vector3D();\n\n\t\tthis._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);\n\t\tthis._skyboxProjection.copyRowTo(2, near);\n\n\t\tvar camPos:Vector3D = camera.scenePosition;\n\n\t\tvar cx:number = near.x;\n\t\tvar cy:number = near.y;\n\t\tvar cz:number = near.z;\n\t\tvar cw:number = -(near.x*camPos.x + near.y*camPos.y + near.z*camPos.z + Math.sqrt(cx*cx + cy*cy + cz*cz));\n\n\t\tvar signX:number = cx >= 0? 1 : -1;\n\t\tvar signY:number = cy >= 0? 1 : -1;\n\n\t\tvar p:Vector3D = new Vector3D(signX, signY, 1, 1);\n\n\t\tvar inverse:Matrix3D = this._skyboxProjection.clone();\n\t\tinverse.invert();\n\n\t\tvar q:Vector3D = inverse.transformVector(p);\n\n\t\tthis._skyboxProjection.copyRowTo(3, p);\n\n\t\tvar a:number = (q.x*p.x + q.y*p.y + q.z*p.z + q.w*p.w)/(cx*q.x + cy*q.y + cz*q.z + cw*q.w);\n\n\t\tthis._skyboxProjection.copyRowFrom(2, new Vector3D(cx*a, cy*a, cz*a, cw*a));\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (!this._shareContext)\n\t\t\tthis._pStage.dispose();\n\n\t\tthis._pRttBufferManager.dispose();\n\t\tthis._pRttBufferManager = null;\n\n\t\tthis._pDepthRenderer.dispose();\n\t\tthis._pDistanceRenderer.dispose();\n\t\tthis._pDepthRenderer = null;\n\t\tthis._pDistanceRenderer = null;\n\n\t\tthis._pDepthRender = null;\n\n\t\tsuper.dispose();\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderDepthPrepass(entityCollector:EntityCollector)\n\t{\n\t\tthis._pDepthRenderer.disableColor = true;\n\n\t\tif (this._pFilter3DRenderer) { //TODO\n//\t\t\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n//\t\t\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n//\t\t\t\tthis._pDepthRenderer._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t} else {\n\t\t\tthis._pDepthRenderer.textureRatioX = 1;\n\t\t\tthis._pDepthRenderer.textureRatioY = 1;\n\t\t\tthis._pDepthRenderer._iRender(entityCollector);\n\t\t}\n\n\t\tthis._pDepthRenderer.disableColor = false;\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderSceneDepthToTexture(entityCollector:EntityCollector)\n\t{\n\t\tif (this._pDepthTextureInvalid || !this._pDepthRender)\n\t\t\tthis.initDepthTexture(<IContextGL> this._pStage.context);\n\n\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\tthis._pDepthRenderer._iRender(entityCollector, this._pDepthRender);\n\t}\n\n\n\t/**\n\t * Updates the backbuffer dimensions.\n\t */\n\tpublic pUpdateBackBuffer()\n\t{\n\t\t// No reason trying to configure back buffer if there is no context available.\n\t\t// Doing this anyway (and relying on _stage to cache width/height for\n\t\t// context does get available) means usesSoftwareRendering won't be reliable.\n\t\tif (this._pStage.context && !this._shareContext) {\n\t\t\tif (this._width && this._height) {\n\t\t\t\tthis._pStage.configureBackBuffer(this._width, this._height, this._antiAlias, true);\n\t\t\t\tthis._pBackBufferInvalid = false;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initDepthTexture(context:IContextGL):void\n\t{\n\t\tthis._pDepthTextureInvalid = false;\n\n\t\tif (this._pDepthRender)\n\t\t\tthis._pDepthRender.dispose();\n\n\t\tthis._pDepthRender = new BitmapImage2D(this._pRttBufferManager.textureWidth, this._pRttBufferManager.textureHeight);\n\t}\n}\n\nexport = DefaultRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DepthRender\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/DepthRender\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n/**\n * The DepthRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DepthRenderer\n */\nclass DepthRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DepthRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage, DepthRender);\n\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n}\n\nexport = DepthRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DistanceRender\t\t\t\t= require(\"awayjs-renderergl/lib/render/DistanceRender\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n\n/**\n * The DistanceRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DistanceRenderer\n */\nclass DistanceRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DistanceRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\t\t\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage, DistanceRender);\n\t\t\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n}\n\nexport = DistanceRenderer;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\n/**\n * @class away.render.Filter3DRenderer\n */\nclass Filter3DRenderer\n{\n\tprivate _filters:Array<Filter3DBase>;\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _filterTasksInvalid:boolean;\n\tprivate _mainInputTexture:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _rttManager:RTTBufferManager;\n\tprivate _stage:Stage;\n\tprivate _filterSizesInvalid:boolean = true;\n\tprivate _onRTTResizeDelegate:(event:Event) => void;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._onRTTResizeDelegate = (event:Event) => this.onRTTResize(event);\n\n\t\tthis._stage = stage;\n\t\tthis._rttManager = RTTBufferManager.getInstance(stage);\n\t\tthis._rttManager.addEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\n\t}\n\n\tprivate onRTTResize(event:Event)\n\t{\n\t\tthis._filterSizesInvalid = true;\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._filterTasksInvalid) {\n\n\t\t\tthis.updateFilterTasks(stage);\n\n\t\t}\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic get filters():Filter3DBase[]\n\t{\n\t\treturn this._filters;\n\t}\n\n\tpublic set filters(value:Filter3DBase[])\n\t{\n\t\tthis._filters = value;\n\n\t\tthis._filterTasksInvalid = true;\n\n\t\tthis._requireDepthRender = false;\n\n\t\tif (!this._filters) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\n\t\t\t// TODO: check logic:\n\t\t\t// this._requireDepthRender ||=  Boolean ( this._filters[i].requireDepthRender )\n\n\t\t\tvar s:any = this._filters[i];\n\t\t\tvar b:boolean = <boolean> ( s.requireDepthRender == null )? false : s.requireDepthRender;\n\n\t\t\tthis._requireDepthRender = this._requireDepthRender || b;\n\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tprivate updateFilterTasks(stage:Stage)\n\t{\n\t\tvar len:number;\n\n\t\tif (this._filterSizesInvalid) {\n\n\t\t\tthis.updateFilterSizes();\n\n\t\t}\n\n\t\tif (!this._filters) {\n\t\t\tthis._tasks = null;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\n\t\tlen = this._filters.length - 1;\n\n\t\tvar filter:Filter3DBase;\n\n\t\tfor (var i:number = 0; i <= len; ++i) {\n\n\t\t\t// make sure all internal tasks are linked together\n\t\t\tfilter = this._filters[i];\n\n\t\t\t// TODO: check logic\n\t\t\t// filter.setRenderTargets(i == len? null : Filter3DBase(_filters[i + 1]).getMainInputTexture(stage), stage);\n\n\t\t\tfilter.setRenderTargets(i == len? null : this._filters[i + 1].getMainInputTexture(stage), stage);\n\n\t\t\tthis._tasks = this._tasks.concat(filter.tasks);\n\n\t\t}\n\n\t\tthis._mainInputTexture = this._filters[0].getMainInputTexture(stage);\n\n\t}\n\n\tpublic render(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t\tvar len:number;\n\t\tvar i:number;\n\t\tvar task:Filter3DTaskBase;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar indexBuffer:IIndexBuffer = this._rttManager.indexBuffer;\n\n\t\tvar vertexBuffer:IVertexBuffer = this._rttManager.renderToTextureVertexBuffer;\n\n\t\tif (!this._filters) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterSizesInvalid) {\n\t\t\tthis.updateFilterSizes();\n\t\t}\n\n\t\tif (this._filterTasksInvalid) {\n\t\t\tthis.updateFilterTasks(stage);\n\t\t}\n\n\t\tlen = this._filters.length;\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._filters[i].update(stage, camera);\n\t\t}\n\n\t\tlen = this._tasks.length;\n\n\t\tif (len > 1) {\n\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i) {\n\n\t\t\ttask = this._tasks[i];\n\n\t\t\t//stage.setRenderTarget(task.target); //TODO\n\n\t\t\tif (!task.target) {\n\n\t\t\t\tstage.scissorRect = null;\n\t\t\t\tvertexBuffer = this._rttManager.renderToScreenVertexBuffer;\n\t\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\n\t\t\t}\n\n\t\t\tcontext.setTextureAt(0, task.getMainInputTexture(stage));\n\t\t\tcontext.setProgram(task.getProgram(stage));\n\t\t\tcontext.clear(0.0, 0.0, 0.0, 0.0);\n\n\t\t\ttask.activate(stage, camera, depthTexture);\n\n\t\t\tcontext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\t\tcontext.drawTriangles(indexBuffer, 0, 2);\n\n\t\t\ttask.deactivate(stage);\n\t\t}\n\n\t\tcontext.setTextureAt(0, null);\n\t\tcontext.setVertexBufferAt(0, null);\n\t\tcontext.setVertexBufferAt(1, null);\n\t}\n\n\tprivate updateFilterSizes()\n\t{\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\t\t\tthis._filters[i].textureWidth = this._rttManager.textureWidth;\n\t\t\tthis._filters[i].textureHeight = this._rttManager.textureHeight;\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._rttManager.removeEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\t\tthis._rttManager = null;\n\t\tthis._stage = null;\n\t}\n}\n\nexport = Filter3DRenderer;",
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport IEntitySorter\t\t\t\t= require(\"awayjs-display/lib/sort/IEntitySorter\");\nimport RenderableMergeSort\t\t\t= require(\"awayjs-display/lib/sort/RenderableMergeSort\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/IRenderer\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport RendererEvent\t\t\t\t= require(\"awayjs-display/lib/events/RendererEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport StageEvent\t\t\t\t\t= require(\"awayjs-stagegl/lib/events/StageEvent\");\nimport StageManager\t\t\t\t\t= require(\"awayjs-stagegl/lib/managers/StageManager\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n\n/**\n * RendererBase forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RendererBase\n */\nclass RendererBase extends EventDispatcher implements IRenderer\n{\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\n\tpublic _pRenderablePool:RenderablePool;\n\n\tpublic _pContext:IContextGL;\n\tpublic _pStage:Stage;\n\n\tpublic _pCamera:Camera;\n\tpublic _iEntryPoint:Vector3D;\n\tpublic _pCameraForward:Vector3D;\n\n\tpublic _pRttBufferManager:RTTBufferManager;\n\tprivate _viewPort:Rectangle = new Rectangle();\n\tprivate _viewportDirty:boolean;\n\tprivate _scissorDirty:boolean;\n\n\tpublic _pBackBufferInvalid:boolean = true;\n\tpublic _pDepthTextureInvalid:boolean = true;\n\tpublic _depthPrepass:boolean = false;\n\tprivate _backgroundR:number = 0;\n\tprivate _backgroundG:number = 0;\n\tprivate _backgroundB:number = 0;\n\tprivate _backgroundAlpha:number = 1;\n\tpublic _shareContext:boolean;\n\n\t// only used by renderers that need to render geometry to textures\n\tpublic _width:number;\n\tpublic _height:number;\n\n\tpublic textureRatioX:number = 1;\n\tpublic textureRatioY:number = 1;\n\n\tprivate _snapshotBitmapImage2D:BitmapImage2D;\n\tprivate _snapshotRequired:boolean;\n\n\tpublic _pRttViewProjectionMatrix:Matrix3D = new Matrix3D();\n\n\tprivate _localPos:Point = new Point();\n\tprivate _globalPos:Point = new Point();\n\tpublic _pScissorRect:Rectangle = new Rectangle();\n\n\tprivate _scissorUpdated:RendererEvent;\n\tprivate _viewPortUpdated:RendererEvent;\n\n\tprivate _onContextUpdateDelegate:Function;\n\tprivate _onViewportUpdatedDelegate;\n\n\tpublic _pNumElements:number = 0;\n\n\tpublic _pOpaqueRenderableHead:RenderableBase;\n\tpublic _pBlendedRenderableHead:RenderableBase;\n\tpublic _disableColor:boolean = false;\n\tpublic _renderBlended:boolean = true;\n\n\n\tpublic get renderBlended():boolean\n\t{\n\t\treturn this._renderBlended;\n\t}\n\n\tpublic set renderBlended(value:boolean)\n\t{\n\t\tthis._renderBlended = value;\n\t}\n\n\n\tpublic get disableColor():boolean\n\t{\n\t\treturn this._disableColor;\n\t}\n\n\tpublic set disableColor(value:boolean)\n\t{\n\t\tthis._disableColor = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numElements():number\n\t{\n\t\treturn this._pNumElements;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic renderableSorter:IEntitySorter;\n\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * A scissor rectangle equivalent of the view size and position.\n\t */\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._pScissorRect;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._localPos.x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tif (this.x == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.x = this._localPos.x = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._localPos.y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tif (this.y == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.y = this._localPos.y = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (this._width == value)\n\t\t\treturn;\n\n\t\tthis._width = value;\n\t\tthis._pScissorRect.width = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewWidth = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (this._height == value)\n\t\t\treturn;\n\n\t\tthis._height = value;\n\t\tthis._pScissorRect.height = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewHeight = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t * Creates a new RendererBase object.\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper();\n\n\t\tthis._onViewportUpdatedDelegate = (event:StageEvent) => this.onViewportUpdated(event);\n\t\tthis._onContextUpdateDelegate = (event:Event) => this.onContextUpdate(event);\n\n\t\t//default sorting algorithm\n\t\tthis.renderableSorter = new RenderableMergeSort();\n\n\t\t//set stage\n\t\tthis._pStage = stage || StageManager.getInstance().getFreeStage();\n\n\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.addEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.stage = value;\n\t\t */\n\t\tif (this._pStage.context)\n\t\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t}\n\n\tpublic activatePass(renderable:RenderableBase, pass:IPass, camera:Camera)\n\t{\n\t\t//clear unused vertex streams\n\t\tfor (var i = pass.shader.numUsedStreams; i < this._numUsedStreams; i++)\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\n\t\t//clear unused texture streams\n\t\tfor (var i = pass.shader.numUsedTextures; i < this._numUsedTextures; i++)\n\t\t\tthis._pContext.setTextureAt(i, null);\n\n\t\t//check program data is uploaded\n\t\tvar programData:ProgramData = pass.shader.programData;\n\n\t\tif (!programData.program) {\n\t\t\tprogramData.program = this._pContext.createProgram();\n\t\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + programData.vertexString + \"endpart\"))['vertex'].data;\n\t\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + programData.fragmentString + \"endpart\"))['fragment'].data;\n\t\t\tprogramData.program.upload(vertexByteCode, fragmentByteCode);\n\t\t}\n\n\t\t//set program data\n\t\tthis._pContext.setProgram(programData.program);\n\n\t\t//activate shader object through renderable\n\t\trenderable._iActivate(pass, camera);\n\t}\n\n\tpublic deactivatePass(renderable:RenderableBase, pass:IPass)\n\t{\n\t\t//deactivate shader object\n\t\trenderable._iDeactivate(pass);\n\n\t\tthis._numUsedStreams = pass.shader.numUsedStreams;\n\t\tthis._numUsedTextures = pass.shader.numUsedTextures;\n\t}\n\n\tpublic _iCreateEntityCollector():CollectorBase\n\t{\n\t\treturn new EntityCollector();\n\t}\n\n\t/**\n\t * The background color's red component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundR():number\n\t{\n\t\treturn this._backgroundR;\n\t}\n\n\tpublic set _iBackgroundR(value:number)\n\t{\n\t\tif (this._backgroundR == value)\n\t\t\treturn;\n\n\t\tthis._backgroundR = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's green component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundG():number\n\t{\n\t\treturn this._backgroundG;\n\t}\n\n\tpublic set _iBackgroundG(value:number)\n\t{\n\t\tif (this._backgroundG == value)\n\t\t\treturn;\n\n\t\tthis._backgroundG = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's blue component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundB():number\n\t{\n\t\treturn this._backgroundB;\n\t}\n\n\tpublic set _iBackgroundB(value:number)\n\t{\n\t\tif (this._backgroundB == value)\n\t\t\treturn;\n\n\t\tthis._backgroundB = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\tpublic get context():IContextGL\n\t{\n\t\treturn this._pContext;\n\t}\n\n\t/**\n\t * The Stage that will provide the ContextGL used for rendering.\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._pStage;\n\t}\n\n\t/**\n\t * Defers control of ContextGL clear() and present() calls to Stage, enabling multiple Stage frameworks\n\t * to share the same ContextGL object.\n\t */\n\tpublic get shareContext():boolean\n\t{\n\t\treturn this._shareContext;\n\t}\n\n\tpublic get renderablePool():RenderablePool\n\t{\n\t\treturn this._pRenderablePool;\n\t}\n\n\t/**\n\t * Disposes the resources used by the RendererBase.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRenderablePool.dispose();\n\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\tthis._pStage = null;\n\t\tthis._pContext = null;\n\t\t/*\n\t\t if (_backgroundImageRenderer) {\n\t\t _backgroundImageRenderer.dispose();\n\t\t _backgroundImageRenderer = null;\n\t\t }\n\t\t */\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tthis._viewportDirty = false;\n\t\tthis._scissorDirty = false;\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic _iRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\t//TODO refactor setTarget so that rendertextures are created before this check\n\t\tif (!this._pStage || !this._pContext)\n\t\t\treturn;\n\n\t\tthis._pRttViewProjectionMatrix.copyFrom(entityCollector.camera.viewProjection);\n\t\tthis._pRttViewProjectionMatrix.appendScale(this.textureRatioX, this.textureRatioY, 1);\n\n\t\tthis.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\n\t\t// generate mip maps on target (if target exists) //TODO\n\t\t//if (target)\n\t\t//\t(<Texture>target).generateMipmaps();\n\n\t\t// clear buffers\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\t\t\tthis._pContext.setTextureAt(i, null);\n\t\t}\n\t}\n\n\tpublic _iRenderCascades(entityCollector:ShadowCasterCollector, target:ImageBase, numCascades:number, scissorRects:Array<Rectangle>, cameras:Array<Camera>)\n\t{\n\t\tthis._applyCollector(entityCollector);\n\n\t\tthis._pStage.setRenderTarget(target, true, 0);\n\t\tthis._pContext.clear(1, 1, 1, 1, 1, 0);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS);\n\n\t\tvar head:RenderableBase = this._pOpaqueRenderableHead;\n\n\t\tvar first:boolean = true;\n\n\t\t//TODO cascades must have separate collectors, rather than separate draw commands\n\t\tfor (var i:number = numCascades - 1; i >= 0; --i) {\n\t\t\tthis._pStage.scissorRect = scissorRects[i];\n\t\t\t//this.drawCascadeRenderables(head, cameras[i], first? null : cameras[i].frustumPlanes);\n\t\t\tfirst = false;\n\t\t}\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\tprivate _applyCollector(entityCollector:CollectorBase)\n\t{\n\t\t//reset head values\n\t\tthis._pBlendedRenderableHead = null;\n\t\tthis._pOpaqueRenderableHead = null;\n\t\tthis._pNumElements = 0;\n\n\t\t//grab entity head\n\t\tvar item:EntityListItem = entityCollector.entityHead;\n\n\t\t//set temp values for entry point and camera forward vector\n\t\tthis._pCamera = entityCollector.camera;\n\t\tthis._iEntryPoint = this._pCamera.scenePosition;\n\t\tthis._pCameraForward = this._pCamera.transform.forwardVector;\n\n\t\t//iterate through all entities\n\t\twhile (item) {\n\t\t\titem.entity._applyRenderer(this);\n\t\t\titem = item.next;\n\t\t}\n\n\t\t//sort the resulting renderables\n\t\tthis._pOpaqueRenderableHead = <RenderableBase> this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);\n\t\tthis._pBlendedRenderableHead = <RenderableBase> this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead);\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture. Only executed if everything is set up.\n\t *\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic pExecuteRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis._pStage.setRenderTarget(target, true, surfaceSelector);\n\n\t\tif ((target || !this._shareContext) && !this._depthPrepass)\n\t\t\tthis._pContext.clear(this._backgroundR, this._backgroundG, this._backgroundB, this._backgroundAlpha, 1, 0);\n\n\t\tthis._pStage.scissorRect = scissorRect;\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.render();\n\t\t */\n\t\tthis._applyCollector(entityCollector);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\n\t\tthis.pDraw(entityCollector);\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\t//this._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL); //oopsie\n\n\t\tif (!this._shareContext) {\n\t\t\tif (this._snapshotRequired && this._snapshotBitmapImage2D) {\n\t\t\t\tthis._pContext.drawToBitmapImage2D(this._snapshotBitmapImage2D);\n\t\t\t\tthis._snapshotRequired = false;\n\t\t\t}\n\t\t}\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\t/*\n\t * Will draw the renderer's output on next render to the provided bitmap data.\n\t * */\n\tpublic queueSnapshot(bmd:BitmapImage2D)\n\t{\n\t\tthis._snapshotRequired = true;\n\t\tthis._snapshotBitmapImage2D = bmd;\n\t}\n\n\t/**\n\t * Performs the actual drawing of geometry to the target.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t */\n\tpublic pDraw(entityCollector:CollectorBase)\n\t{\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(false, false, false, false);\n\n\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\n\t\tif (this._renderBlended)\n\t\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(true, true, true, true);\n\t}\n\n\t//private drawCascadeRenderables(renderable:RenderableBase, camera:Camera, cullPlanes:Array<Plane3D>)\n\t//{\n\t//\tvar renderable2:RenderableBase;\n\t//\tvar render:RenderBase;\n\t//\tvar pass:IPass;\n\t//\n\t//\twhile (renderable) {\n\t//\t\trenderable2 = renderable;\n\t//\t\trender = renderable.render;\n\t//\t\tpass = render.passes[0] //assuming only one pass per material\n\t//\n\t//\t\tthis.activatePass(renderable, pass, camera);\n\t//\n\t//\t\tdo {\n\t//\t\t\t// if completely in front, it will fall in a different cascade\n\t//\t\t\t// do not use near and far planes\n\t//\t\t\tif (!cullPlanes || renderable2.sourceEntity.worldBounds.isInFrustum(cullPlanes, 4)) {\n\t//\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\t//\t\t\t} else {\n\t//\t\t\t\trenderable2.cascaded = true;\n\t//\t\t\t}\n\t//\n\t//\t\t\trenderable2 = renderable2.next;\n\t//\n\t//\t\t} while (renderable2 && renderable2.render == render && !renderable2.cascaded);\n\t//\n\t//\t\tthis.deactivatePass(renderable, pass);\n\t//\n\t//\t\trenderable = renderable2;\n\t//\t}\n\t//}\n\n\t/**\n\t * Draw a list of renderables.\n\t *\n\t * @param renderables The renderables to draw.\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tpublic drawRenderables(renderable:RenderableBase, entityCollector:CollectorBase)\n\t{\n\t\tvar i:number;\n\t\tvar len:number;\n\t\tvar renderable2:RenderableBase;\n\t\tvar render:RenderBase;\n\t\tvar passes:Array<IPass>;\n\t\tvar pass:IPass;\n\t\tvar camera:Camera = entityCollector.camera;\n\n\n\t\twhile (renderable) {\n\t\t\trender = renderable.render;\n\t\t\tpasses = render.passes;\n\n\t\t\t// otherwise this would result in depth rendered anyway because fragment shader kil is ignored\n\t\t\tif (this._disableColor && render._renderOwner.alphaThreshold != 0) {\n\t\t\t\trenderable2 = renderable;\n\t\t\t\t// fast forward\n\t\t\t\tdo {\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.render == render);\n\t\t\t} else {\n\t\t\t\t//iterate through each shader object\n\t\t\t\tlen = passes.length;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\trenderable2 = renderable;\n\t\t\t\t\tpass = passes[i];\n\n\t\t\t\t\tthis.activatePass(renderable, pass, camera);\n\n\t\t\t\t\tdo {\n\t\t\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\n\t\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t\t} while (renderable2 && renderable2.render == render);\n\n\t\t\t\t\tthis.deactivatePass(renderable, pass);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n\n\t/**\n\t * Assign the context once retrieved\n\t */\n\tprivate onContextUpdate(event:Event)\n\t{\n\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t}\n\n\tpublic get _iBackgroundAlpha():number\n\t{\n\t\treturn this._backgroundAlpha;\n\t}\n\n\tpublic set _iBackgroundAlpha(value:number)\n\t{\n\t\tif (this._backgroundAlpha == value)\n\t\t\treturn;\n\n\t\tthis._backgroundAlpha = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/*\n\t public get iBackground():Texture2DBase\n\t {\n\t return this._background;\n\t }\n\t */\n\n\t/*\n\t public set iBackground(value:Texture2DBase)\n\t {\n\t if (this._backgroundImageRenderer && !value) {\n\t this._backgroundImageRenderer.dispose();\n\t this._backgroundImageRenderer = null;\n\t }\n\n\t if (!this._backgroundImageRenderer && value)\n\t {\n\n\t this._backgroundImageRenderer = new BackgroundImageRenderer(this._pStage);\n\n\t }\n\n\n\t this._background = value;\n\n\t if (this._backgroundImageRenderer)\n\t this._backgroundImageRenderer.texture = value;\n\t }\n\t */\n\t/*\n\t public get backgroundImageRenderer():BackgroundImageRenderer\n\t {\n\t return _backgroundImageRenderer;\n\t }\n\t */\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyScissorUpdate()\n\t{\n\t\tif (this._scissorDirty)\n\t\t\treturn;\n\n\t\tthis._scissorDirty = true;\n\n\t\tif (!this._scissorUpdated)\n\t\t\tthis._scissorUpdated = new RendererEvent(RendererEvent.SCISSOR_UPDATED);\n\n\t\tthis.dispatchEvent(this._scissorUpdated);\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyViewportUpdate()\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\tif (!this._viewPortUpdated)\n\t\t\tthis._viewPortUpdated = new RendererEvent(RendererEvent.VIEWPORT_UPDATED);\n\n\t\tthis.dispatchEvent(this._viewPortUpdated);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onViewportUpdated(event:StageEvent)\n\t{\n\t\tthis._viewPort = this._pStage.viewPort;\n\t\t//TODO stop firing viewport updated for every stagegl viewport change\n\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._pStage.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._pStage.y;\n\t\t\tthis.notifyScissorUpdate();\n\t\t}\n\n\t\tthis.notifyViewportUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updateGlobalPos()\n\t{\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._viewPort.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._viewPort.y;\n\t\t} else {\n\t\t\tthis._pScissorRect.x = 0;\n\t\t\tthis._pScissorRect.y = 0;\n\t\t\tthis._viewPort.x = this._globalPos.x;\n\t\t\tthis._viewPort.y = this._globalPos.y;\n\t\t}\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\tpublic _iApplyRenderableOwner(renderableOwner:IRenderableOwner)\n\t{\n\t\tthis.applyRenderable(this._pRenderablePool.getItem(renderableOwner));\n\t}\n\n\t/**\n\t *\n\t * @param renderable\n\t * @protected\n\t */\n\tpublic applyRenderable(renderable:RenderableBase)\n\t{\n\t\t//set local vars for faster referencing\n\t\tvar render:RenderBase = this._pRenderablePool.getRenderPool(renderable.renderableOwner).getItem(renderable.renderOwner || DefaultMaterialManager.getDefaultMaterial(renderable.renderableOwner));\n\t\t\n\t\trenderable.render = render;\n\t\trenderable.renderId = render.renderId;\n\t\trenderable.renderOrderId = render.renderOrderId;\n\n\t\trenderable.cascaded = false;\n\n\t\tvar entity:IEntity = renderable.sourceEntity;\n\t\tvar position:Vector3D = entity.scenePosition;\n\n\t\t// project onto camera's z-axis\n\t\tposition = this._iEntryPoint.subtract(position);\n\t\trenderable.zIndex = entity.zOffset + position.dotProduct(this._pCameraForward);\n\n\t\t//store reference to scene transform\n\t\trenderable.renderSceneTransform = renderable.sourceEntity.getRenderSceneTransform(this._pCamera);\n\n\t\tif (render.requiresBlending) {\n\t\t\trenderable.next = this._pBlendedRenderableHead;\n\t\t\tthis._pBlendedRenderableHead = renderable;\n\t\t} else {\n\t\t\trenderable.next = this._pOpaqueRenderableHead;\n\t\t\tthis._pOpaqueRenderableHead = renderable;\n\t\t}\n\n\t\tthis._pNumElements += renderable.subGeometryVO.subGeometry.numElements;\n\t}\n}\n\nexport = RendererBase;",
    "import IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetError\t\t\t= require(\"awayjs-renderergl/lib/errors/AnimationSetError\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * Provides an abstract base class for data set classes that hold animation data for use in animator classes.\n *\n * @see away.animators.AnimatorBase\n */\nclass AnimationSetBase extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset AnimationSet]\";\n\n\tprivate _usesCPU:boolean;\n\tprivate _animations:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\tprivate _animationNames:Array<string> = new Array<string>();\n\tprivate _animationDictionary:Object = new Object();\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Retrieves a temporary GPU register that's still free.\n\t *\n\t * @param exclude An array of non-free temporary registers.\n\t * @param excludeAnother An additional register that's not free.\n\t * @return A temporary register that can be used.\n\t */\n\tpublic _pFindTempReg(exclude:Array<string>, excludeAnother:string = null):string\n\t{\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar reg:string;\n\n\t\twhile (true) {\n\t\t\treg = \"vt\" + i;\n\t\t\tif (exclude.indexOf(reg) == -1 && excludeAnother != reg)\n\t\t\t\treturn reg;\n\t\t\t++i;\n\t\t}\n\n\t\t// can't be reached\n\t\treturn null;\n\t}\n\n\t/**\n\t * Indicates whether the properties of the animation data contained within the set combined with\n\t * the vertex registers already in use on shading materials allows the animation data to utilise\n\t * GPU calls.\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn this._usesCPU;\n\t}\n\n\t/**\n\t * Called by the material to reset the GPU indicator before testing whether register space in the shader\n\t * is available for running GPU-based animation code.\n\t *\n\t * @private\n\t */\n\tpublic resetGPUCompatibility()\n\t{\n\t\tthis._usesCPU = false;\n\t}\n\n\tpublic cancelGPUCompatibility()\n\t{\n\t\tthis._usesCPU = true;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimationSetBase.assetType;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animations():Array<AnimationNodeBase>\n\t{\n\t\treturn this._animations;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animationNames():Array<string>\n\t{\n\t\treturn this._animationNames;\n\t}\n\n\t/**\n\t * Check to determine whether a state is registered in the animation set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be checked.\n\t */\n\tpublic hasAnimation(name:string):boolean\n\t{\n\t\treturn this._animationDictionary[name] != null;\n\t}\n\n\t/**\n\t * Retrieves the animation state object registered in the animation data set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be retrieved.\n\t */\n\tpublic getAnimation(name:string):AnimationNodeBase\n\t{\n\t\treturn this._animationDictionary[name];\n\t}\n\n\t/**\n\t * Adds an animation state object to the aniamtion data set under the given name.\n\t *\n\t * @param stateName The name under which the animation state object will be stored.\n\t * @param animationState The animation state object to be staored in the set.\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tif (this._animationDictionary[node.name])\n\t\t\tthrow new AnimationSetError(\"root node name '\" + node.name + \"' already exists in the set\");\n\n\t\tthis._animationDictionary[node.name] = node;\n\n\t\tthis._animations.push(node);\n\n\t\tthis._animationNames.push(node.name);\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t */\n\tpublic dispose()\n\t{\n\t}\n}\n\nexport = AnimationSetBase;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport RequestAnimationFrame\t\t= require(\"awayjs-core/lib/utils/RequestAnimationFrame\");\nimport getTimer\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/getTimer\");\n\nimport IAnimationSet\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport IAnimator\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IAnimationState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\nimport AnimatorEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimatorEvent\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * Dispatched when playback of an animation inside the animator object starts.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"start\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation inside the animator object stops.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"stop\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation reaches the end of an animation.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"cycle_complete\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Provides an abstract base class for animator classes that control animation output from a data set subtype of <code>AnimationSetBase</code>.\n *\n * @see away.animators.AnimationSetBase\n */\nclass AnimatorBase extends AssetBase implements IAnimator\n{\n\tpublic static assetType:string = \"[asset Animator]\";\n\n\tprivate _broadcaster:RequestAnimationFrame;\n\tprivate _isPlaying:boolean;\n\tprivate _autoUpdate:boolean = true;\n\tprivate _startEvent:AnimatorEvent;\n\tprivate _stopEvent:AnimatorEvent;\n\tprivate _cycleEvent:AnimatorEvent;\n\tprivate _time:number /*int*/ = 0;\n\tprivate _playbackSpeed:number = 1;\n\n\tpublic _pAnimationSet:IAnimationSet;\n\tpublic _pOwners:Array<Mesh> = new Array<Mesh>();\n\tpublic _pActiveNode:AnimationNodeBase;\n\tpublic _pActiveState:IAnimationState;\n\tpublic _pActiveAnimationName:string;\n\tpublic _pAbsoluteTime:number = 0;\n\n\tprivate _animationStates:Object = new Object();\n\n\t/**\n\t * Enables translation of the animated mesh from data returned per frame via the positionDelta property of the active animation node. Defaults to true.\n\t *\n\t * @see away.animators.IAnimationState#positionDelta\n\t */\n\tpublic updatePosition:boolean = true;\n\n\tpublic getAnimationState(node:AnimationNodeBase):IAnimationState\n\t{\n\t\tvar className:any = node.stateClass;\n\t\tvar uID:number = node.id;\n\n\t\tif (this._animationStates[uID] == null)\n\t\t\tthis._animationStates[uID] = new className(this, node);\n\n\t\treturn this._animationStates[uID];\n\t}\n\n\tpublic getAnimationStateByName(name:string):IAnimationState\n\t{\n\t\treturn this.getAnimationState(this._pAnimationSet.getAnimation(name));\n\t}\n\n\t/**\n\t * Returns the internal absolute time of the animator, calculated by the current time and the playback speed.\n\t *\n\t * @see #time\n\t * @see #playbackSpeed\n\t */\n\tpublic get absoluteTime():number\n\t{\n\t\treturn this._pAbsoluteTime;\n\t}\n\n\t/**\n\t * Returns the animation data set in use by the animator.\n\t */\n\tpublic get animationSet():IAnimationSet\n\t{\n\t\treturn this._pAnimationSet;\n\t}\n\n\t/**\n\t * Returns the current active animation state.\n\t */\n\tpublic get activeState():IAnimationState\n\t{\n\t\treturn this._pActiveState;\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimation():AnimationNodeBase\n\t{\n\t\treturn this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimationName():string\n\t{\n\t\treturn this._pActiveAnimationName;\n\t}\n\n\t/**\n\t * Determines whether the animators internal update mechanisms are active. Used in cases\n\t * where manual updates are required either via the <code>time</code> property or <code>update()</code> method.\n\t * Defaults to true.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic get autoUpdate():boolean\n\t{\n\t\treturn this._autoUpdate;\n\t}\n\n\tpublic set autoUpdate(value:boolean)\n\t{\n\t\tif (this._autoUpdate == value)\n\t\t\treturn;\n\n\t\tthis._autoUpdate = value;\n\n\t\tif (this._autoUpdate)\n\t\t\tthis.start(); else\n\t\t\tthis.stop();\n\t}\n\n\t/**\n\t * Gets and sets the internal time clock of the animator.\n\t */\n\tpublic get time():number /*int*/\n\t{\n\t\treturn this._time;\n\t}\n\n\tpublic set time(value:number /*int*/)\n\t{\n\t\tif (this._time == value)\n\t\t\treturn;\n\n\t\tthis.update(value);\n\t}\n\n\t/**\n\t * Sets the animation phase of the current active state's animation clip(s).\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._pActiveState.phase(value);\n\t}\n\n\t/**\n\t * Creates a new <code>AnimatorBase</code> object.\n\t *\n\t * @param animationSet The animation data set to be used by the animator object.\n\t */\n\tconstructor(animationSet:IAnimationSet)\n\t{\n\t\tsuper();\n\n\t\tthis._pAnimationSet = animationSet;\n\n\t\tthis._broadcaster = new RequestAnimationFrame(this.onEnterFrame, this);\n\t}\n\n\t/**\n\t * The amount by which passed time should be scaled. Used to slow down or speed up animations. Defaults to 1.\n\t */\n\tpublic get playbackSpeed():number\n\t{\n\t\treturn this._playbackSpeed;\n\t}\n\n\tpublic set playbackSpeed(value:number)\n\t{\n\t\tthis._playbackSpeed = value;\n\t}\n\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Resumes the automatic playback clock controling the active state of the animator.\n\t */\n\tpublic start()\n\t{\n\t\tif (this._isPlaying || !this._autoUpdate)\n\t\t\treturn;\n\n\t\tthis._time = this._pAbsoluteTime = getTimer();\n\n\t\tthis._isPlaying = true;\n\n\t\tthis._broadcaster.start();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.START))\n\t\t\treturn;\n\n\t\tif (this._startEvent == null)\n\t\t\tthis._startEvent = new AnimatorEvent(AnimatorEvent.START, this);\n\n\t\tthis.dispatchEvent(this._startEvent);\n\t}\n\n\t/**\n\t * Pauses the automatic playback clock of the animator, in case manual updates are required via the\n\t * <code>time</code> property or <code>update()</code> method.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic stop()\n\t{\n\t\tif (!this._isPlaying)\n\t\t\treturn;\n\n\t\tthis._isPlaying = false;\n\n\t\tthis._broadcaster.stop();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.STOP))\n\t\t\treturn;\n\n\t\tif (this._stopEvent == null)\n\t\t\tthis._stopEvent = new AnimatorEvent(AnimatorEvent.STOP, this);\n\n\t\tthis.dispatchEvent(this._stopEvent);\n\t}\n\n\t/**\n\t * Provides a way to manually update the active state of the animator when automatic\n\t * updates are disabled.\n\t *\n\t * @see #stop()\n\t * @see #autoUpdate\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tvar dt:number = (time - this._time)*this.playbackSpeed;\n\n\t\tthis._pUpdateDeltaTime(dt);\n\n\t\tthis._time = time;\n\t}\n\n\tpublic reset(name:string, offset:number = 0)\n\t{\n\t\tthis.getAnimationState(this._pAnimationSet.getAnimation(name)).offset(offset + this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * Used by the mesh object to which the animator is applied, registers the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic addOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.push(mesh);\n\t}\n\n\t/**\n\t * Used by the mesh object from which the animator is removed, unregisters the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic removeOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.splice(this._pOwners.indexOf(mesh), 1);\n\t}\n\n\t/**\n\t * Internal abstract method called when the time delta property of the animator's contents requires updating.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\n\t\tif (this.updatePosition)\n\t\t\tthis.applyPositionDelta();\n\t}\n\n\t/**\n\t * Enter frame event handler for automatically updating the active state of the animator.\n\t */\n\tprivate onEnterFrame(event:Event = null)\n\t{\n\t\tthis.update(getTimer());\n\t}\n\n\tprivate applyPositionDelta()\n\t{\n\t\tvar delta:Vector3D = this._pActiveState.positionDelta;\n\t\tvar dist:number = delta.length;\n\t\tvar len:number /*uint*/;\n\t\tif (dist > 0) {\n\t\t\tlen = this._pOwners.length;\n\t\t\tfor (var i:number /*uint*/ = 0; i < len; ++i)\n\t\t\t\tthis._pOwners[i].translateLocal(delta, dist);\n\t\t}\n\t}\n\n\t/**\n\t *  for internal use.\n\t *\n\t * @private\n\t */\n\tpublic dispatchCycleEvent()\n\t{\n\t\tif (this.hasEventListener(AnimatorEvent.CYCLE_COMPLETE)) {\n\t\t\tif (this._cycleEvent == null)\n\t\t\t\tthis._cycleEvent = new AnimatorEvent(AnimatorEvent.CYCLE_COMPLETE, this);\n\n\t\t\tthis.dispatchEvent(this._cycleEvent);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimatorBase.assetType;\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = AnimatorBase;",
    "import SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n\n/**\n * The animation data set used by particle-based animators, containing particle animation data.\n *\n * @see away.animators.ParticleAnimator\n */\nclass ParticleAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\t/** @private */\n\tpublic _iAnimationRegisterCache:AnimationRegisterCache;\n\n\t//all other nodes dependent on it\n\tprivate _timeNode:ParticleTimeNode;\n\n\t/**\n\t * Property used by particle nodes that require compilers at the end of the shader\n\t */\n\tpublic static POST_PRIORITY:number /*int*/ = 9;\n\n\t/**\n\t * Property used by particle nodes that require color compilers\n\t */\n\tpublic static COLOR_PRIORITY:number /*int*/ = 18;\n\n\tprivate _animationSubGeometries:Object = new Object();\n\tprivate _particleNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localDynamicNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localStaticNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _totalLenOfOneVertex:number /*int*/ = 0;\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\t/**\n\t * Initialiser function for static particle properties. Needs to reference a with the following format\n\t *\n\t * <code>\n\t * initParticleFunc(prop:ParticleProperties)\n\t * {\n\t * \t\t//code for settings local properties\n\t * }\n\t * </code>\n\t *\n\t * Aside from setting any properties required in particle animation nodes using local static properties, the initParticleFunc function\n\t * is required to time node requirements as they may be needed. These properties on the ParticleProperties object can include\n\t * <code>startTime</code>, <code>duration</code> and <code>delay</code>. The use of these properties is determined by the setting\n\t * arguments passed in the constructor of the particle animation set. By default, only the <code>startTime</code> property is required.\n\t */\n\tpublic initParticleFunc:Function;\n\n\t/**\n\t * Initialiser function scope for static particle properties\n\t */\n\tpublic initParticleScope:Object;\n\n\t/**\n\t * Creates a new <code>ParticleAnimationSet</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the animation set uses the <code>duration</code> data in its static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesLooping     Defines whether the animation set uses a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in its static properties function. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesDelay       Defines whether the animation set uses the <code>delay</code> data in its static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tsuper();\n\n\t\t//automatically add a particle time node to the set\n\t\tthis.addAnimation(this._timeNode = new ParticleTimeNode(usesDuration, usesLooping, usesDelay));\n\t}\n\n\t/**\n\t * Returns a vector of the particle animation nodes contained within the set.\n\t */\n\tpublic get particleNodes():Array<ParticleNodeBase>\n\t{\n\t\treturn this._particleNodes;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tvar i:number /*int*/;\n\t\tvar n:ParticleNodeBase = <ParticleNodeBase> node;\n\t\tn._iProcessAnimationSetting(this);\n\t\tif (n.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tn._iDataOffset = this._totalLenOfOneVertex;\n\t\t\tthis._totalLenOfOneVertex += n.dataLength;\n\t\t\tthis._localStaticNodes.push(n);\n\t\t} else if (n.mode == ParticlePropertiesMode.LOCAL_DYNAMIC)\n\t\t\tthis._localDynamicNodes.push(n);\n\n\t\tfor (i = this._particleNodes.length - 1; i >= 0; i--) {\n\t\t\tif (this._particleNodes[i].priority <= n.priority)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._particleNodes.splice(i + 1, 0, n);\n\n\t\tsuper.addAnimation(node);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tthis._iAnimationRegisterCache = pass.animationRegisterCache;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tvar offset:number /*int*/ = this._iAnimationRegisterCache.vertexAttributesOffset;\n//\t\t\tvar used:number /*int*/ = this._iAnimationRegisterCache.numUsedStreams;\n//\t\t\tfor (var i:number /*int*/ = offset; i < used; i++)\n//\t\t\t\tcontext.setVertexBufferAt(i, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\t//grab animationRegisterCache from the materialpassbase or create a new one if the first time\n\t\tthis._iAnimationRegisterCache = shader.animationRegisterCache;\n\n\t\tif (this._iAnimationRegisterCache == null)\n\t\t\tthis._iAnimationRegisterCache = shader.animationRegisterCache = new AnimationRegisterCache(shader.profile);\n\n\t\t//reset animationRegisterCache\n\t\tthis._iAnimationRegisterCache.vertexConstantOffset = shader.numUsedVertexConstants;\n\t\tthis._iAnimationRegisterCache.vertexAttributesOffset = shader.numUsedStreams;\n\t\tthis._iAnimationRegisterCache.varyingsOffset = shader.numUsedVaryings;\n\t\tthis._iAnimationRegisterCache.fragmentConstantOffset = shader.numUsedFragmentConstants;\n\t\tthis._iAnimationRegisterCache.hasUVNode = this.hasUVNode;\n\t\tthis._iAnimationRegisterCache.needVelocity = this.needVelocity;\n\t\tthis._iAnimationRegisterCache.hasBillboard = this.hasBillboard;\n\t\tthis._iAnimationRegisterCache.sourceRegisters = shader.animatableAttributes;\n\t\tthis._iAnimationRegisterCache.targetRegisters = shader.animationTargetRegisters;\n\t\tthis._iAnimationRegisterCache.needFragmentAnimation = shader.usesFragmentAnimation;\n\t\tthis._iAnimationRegisterCache.needUVAnimation = !shader.usesUVTransform;\n\t\tthis._iAnimationRegisterCache.hasColorAddNode = this.hasColorAddNode;\n\t\tthis._iAnimationRegisterCache.hasColorMulNode = this.hasColorMulNode;\n\t\tthis._iAnimationRegisterCache.reset();\n\n\t\tvar code:string = \"\";\n\n\t\tcode += this._iAnimationRegisterCache.getInitCode();\n\n\t\tvar node:ParticleNodeBase;\n\t\tvar i:number /*int*/;\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority < ParticleAnimationSet.POST_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.getCombinationCode();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.POST_PRIORITY && node.priority < ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.initColorRegisters();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\t\tcode += this._iAnimationRegisterCache.getColorPassCode();\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasUVNode) {\n\t\t\tthis._iAnimationRegisterCache.setUVSourceAndTarget(shader.uvSource, shader.uvTarget);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvTarget + \".xy,\" + this._iAnimationRegisterCache.uvAttribute.toString() + \"\\n\";\n\t\t\tvar node:ParticleNodeBase;\n\t\t\tfor (var i:number /*uint*/ = 0; i < this._particleNodes.length; i++)\n\t\t\t\tnode = this._particleNodes[i];\n\t\t\t\tcode += node.getAGALUVCode(shader, this._iAnimationRegisterCache);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvVar.toString() + \",\" + this._iAnimationRegisterCache.uvTarget + \".xy\\n\";\n\t\t} else\n\t\t\tcode += \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn this._iAnimationRegisterCache.getColorCombinationCode(shadedTarget);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\t\tthis._iAnimationRegisterCache.setDataLength();\n\n\t\t//set vertexZeroConst,vertexOneConst,vertexTwoConst\n\t\tthis._iAnimationRegisterCache.setVertexConst(this._iAnimationRegisterCache.vertexZeroConst.index, 0, 1, 2, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic cancelGPUCompatibility()\n\t{\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animationSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animationSubGeometries[key]).dispose();\n\n\t\tsuper.dispose();\n\t}\n\n\tpublic getAnimationSubGeometry(subMesh:ISubMesh)\n\t{\n\t\tvar mesh:Mesh = subMesh.parentMesh;\n\t\tvar animationSubGeometry:AnimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\n\t\tif (animationSubGeometry)\n\t\t\treturn animationSubGeometry;\n\n\t\tthis._iGenerateAnimationSubGeometries(mesh);\n\n\t\treturn (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t}\n\n\n\t/** @private */\n\tpublic _iGenerateAnimationSubGeometries(mesh:Mesh)\n\t{\n\t\tif (this.initParticleFunc == null)\n\t\t\tthrow(new Error(\"no initParticleFunc set\"));\n\n\t\tvar geometry:ParticleGeometry = <ParticleGeometry> mesh.geometry;\n\n\t\tif (!geometry)\n\t\t\tthrow(new Error(\"Particle animation can only be performed on a ParticleGeometry object\"));\n\n\t\tvar i:number /*int*/, j:number /*int*/, k:number /*int*/;\n\t\tvar animationSubGeometry:AnimationSubGeometry;\n\t\tvar newAnimationSubGeometry:boolean = false;\n\t\tvar subGeometry:SubGeometryBase;\n\t\tvar subMesh:ISubMesh;\n\t\tvar localNode:ParticleNodeBase;\n\n\t\tfor (i = 0; i < mesh.subMeshes.length; i++) {\n\t\t\tsubMesh = mesh.subMeshes[i];\n\t\t\tsubGeometry = subMesh.subGeometry;\n\t\t\tif (mesh.shareAnimationGeometry) {\n\t\t\t\tanimationSubGeometry = this._animationSubGeometries[subGeometry.id];\n\n\t\t\t\tif (animationSubGeometry)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tanimationSubGeometry = new AnimationSubGeometry();\n\n\t\t\tif (mesh.shareAnimationGeometry)\n\t\t\t\tthis._animationSubGeometries[subGeometry.id] = animationSubGeometry;\n\t\t\telse\n\t\t\t\tthis._animationSubGeometries[subMesh.id] = animationSubGeometry;\n\n\t\t\tnewAnimationSubGeometry = true;\n\n\t\t\t//create the vertexData vector that will be used for local node data\n\t\t\tanimationSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\t\t}\n\n\t\tif (!newAnimationSubGeometry)\n\t\t\treturn;\n\n\t\tvar particles:Array<ParticleData> = geometry.particles;\n\t\tvar particlesLength:number /*uint*/ = particles.length;\n\t\tvar numParticles:number /*uint*/ = geometry.numParticles;\n\t\tvar particleProperties:ParticleProperties = new ParticleProperties();\n\t\tvar particle:ParticleData;\n\n\t\tvar oneDataLen:number /*int*/;\n\t\tvar oneDataOffset:number /*int*/;\n\t\tvar counterForVertex:number /*int*/;\n\t\tvar counterForOneData:number /*int*/;\n\t\tvar oneData:Array<number>;\n\t\tvar numVertices:number /*uint*/;\n\t\tvar vertexData:Array<number>;\n\t\tvar vertexLength:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\n\t\t//default values for particle param\n\t\tparticleProperties.total = numParticles;\n\t\tparticleProperties.startTime = 0;\n\t\tparticleProperties.duration = 1000;\n\t\tparticleProperties.delay = 0.1;\n\n\t\ti = 0;\n\t\tj = 0;\n\t\twhile (i < numParticles) {\n\t\t\tparticleProperties.index = i;\n\n\t\t\t//call the init on the particle parameters\n\t\t\tthis.initParticleFunc.call(this.initParticleScope, particleProperties);\n\n\t\t\t//create the next set of node properties for the particle\n\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++)\n\t\t\t\tthis._localStaticNodes[k]._iGeneratePropertyOfOneParticle(particleProperties);\n\n\t\t\t//loop through all particle data for the curent particle\n\t\t\twhile (j < particlesLength && (particle = particles[j]).particleIndex == i) {\n\t\t\t\t//find the target animationSubGeometry\n\t\t\t\tfor (k = 0; k < mesh.subMeshes.length; k++) {\n\t\t\t\t\tsubMesh = mesh.subMeshes[k];\n\t\t\t\t\tif (subMesh.subGeometry == particle.subGeometry) {\n\t\t\t\t\t\tanimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnumVertices = particle.numVertices;\n\t\t\t\tvertexData = animationSubGeometry.vertexData;\n\t\t\t\tvertexLength = numVertices*this._totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationSubGeometry.numProcessedVertices*this._totalLenOfOneVertex;\n\n\t\t\t\t//loop through each static local node in the animation set\n\t\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++) {\n\t\t\t\t\tlocalNode = this._localStaticNodes[k];\n\t\t\t\t\toneData = localNode.oneData;\n\t\t\t\t\toneDataLen = localNode.dataLength;\n\t\t\t\t\toneDataOffset = startingOffset + localNode._iDataOffset;\n\n\t\t\t\t\t//loop through each vertex set in the vertex data\n\t\t\t\t\tfor (counterForVertex = 0; counterForVertex < vertexLength; counterForVertex += this._totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = oneDataOffset + counterForVertex;\n\n\t\t\t\t\t\t//add the data for the local node to the vertex data\n\t\t\t\t\t\tfor (counterForOneData = 0; counterForOneData < oneDataLen; counterForOneData++)\n\t\t\t\t\t\t\tvertexData[vertexOffset + counterForOneData] = oneData[counterForOneData];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//store particle properties if they need to be retreived for dynamic local nodes\n\t\t\t\tif (this._localDynamicNodes.length)\n\t\t\t\t\tanimationSubGeometry.animationParticles.push(new ParticleAnimationData(i, particleProperties.startTime, particleProperties.duration, particleProperties.delay, particle));\n\n\t\t\t\tanimationSubGeometry.numProcessedVertices += numVertices;\n\n\t\t\t\t//next index\n\t\t\t\tj++;\n\t\t\t}\n\n\t\t\t//next particle\n\t\t\ti++;\n\t\t}\n\t}\n}\n\nexport = ParticleAnimationSet;",
    "import ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning paricle-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n *\n * Requires that the containing geometry of the parent mesh is particle geometry\n *\n * @see away.base.ParticleGeometry\n */\nclass ParticleAnimator extends AnimatorBase\n{\n\n\tprivate _particleAnimationSet:ParticleAnimationSet;\n\tprivate _animationParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _animatorParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _timeParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _totalLenOfOneVertex:number /*uint*/ = 0;\n\tprivate _animatorSubGeometries:Object = new Object();\n\n\t/**\n\t * Creates a new <code>ParticleAnimator</code> object.\n\t *\n\t * @param particleAnimationSet The animation data set containing the particle animations used by the animator.\n\t */\n\tconstructor(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tsuper(particleAnimationSet);\n\t\tthis._particleAnimationSet = particleAnimationSet;\n\n\t\tvar state:ParticleStateBase;\n\t\tvar node:ParticleNodeBase;\n\n\t\tfor (var i:number = 0; i < this._particleAnimationSet.particleNodes.length; i++) {\n\t\t\tnode = this._particleAnimationSet.particleNodes[i];\n\t\t\tstate = <ParticleStateBase> this.getAnimationState(node);\n\t\t\tif (node.mode == ParticlePropertiesMode.LOCAL_DYNAMIC) {\n\t\t\t\tthis._animatorParticleStates.push(state);\n\t\t\t\tnode._iDataOffset = this._totalLenOfOneVertex;\n\t\t\t\tthis._totalLenOfOneVertex += node.dataLength;\n\t\t\t} else {\n\t\t\t\tthis._animationParticleStates.push(state);\n\t\t\t}\n\t\t\tif (state.needUpdateTime)\n\t\t\t\tthis._timeParticleStates.push(state);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new ParticleAnimator(this._particleAnimationSet);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tvar animationRegisterCache:AnimationRegisterCache = this._particleAnimationSet._iAnimationRegisterCache;\n\n\t\tvar subMesh:ISubMesh = (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar state:ParticleStateBase;\n\t\tvar i:number;\n\n\t\tif (!subMesh)\n\t\t\tthrow(new Error(\"Must be subMesh\"));\n\n\t\t//process animation sub geometries\n\t\tvar animationSubGeometry:AnimationSubGeometry = this._particleAnimationSet.getAnimationSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animationParticleStates.length; i++)\n\t\t\tthis._animationParticleStates[i].setRenderState(stage, renderable, animationSubGeometry, animationRegisterCache, camera);\n\n\t\t//process animator subgeometries\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this.getAnimatorSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animatorParticleStates.length; i++)\n\t\t\tthis._animatorParticleStates[i].setRenderState(stage, renderable, animatorSubGeometry, animationRegisterCache, camera);\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, animationRegisterCache.vertexConstantOffset, animationRegisterCache.vertexConstantData, animationRegisterCache.numVertexConstant);\n\n\t\tif (animationRegisterCache.numFragmentConstant > 0)\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, animationRegisterCache.fragmentConstantOffset, animationRegisterCache.fragmentConstantData, animationRegisterCache.numFragmentConstant);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic start()\n\t{\n\t\tsuper.start();\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].update(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic resetTime(offset:number /*int*/ = 0)\n\t{\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime + offset);\n\t\tthis.update(this.time);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animatorSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animatorSubGeometries[key]).dispose();\n\t}\n\n\tprivate getAnimatorSubGeometry(subMesh:ISubMesh):AnimationSubGeometry\n\t{\n\t\tif (!this._animatorParticleStates.length)\n\t\t\treturn;\n\n\t\tvar subGeometry:SubGeometryBase = subMesh.subGeometry;\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this._animatorSubGeometries[subGeometry.id] = new AnimationSubGeometry();\n\n\t\t//create the vertexData vector that will be used for local state data\n\t\tanimatorSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\n\t\t//pass the particles data to the animator subGeometry\n\t\tanimatorSubGeometry.animationParticles = this._particleAnimationSet.getAnimationSubGeometry(subMesh).animationParticles;\n\t}\n}\n\nexport = ParticleAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * The animation data set used by skeleton-based animators, containing skeleton animation data.\n *\n * @see away.animators.SkeletonAnimator\n */\nclass SkeletonAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _jointsPerVertex:number /*uint*/;\n\n\t/**\n\t * Returns the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the\n\t * maximum allowed value is 4.\n\t */\n\tpublic get jointsPerVertex():number /*uint*/\n\t{\n\t\treturn this._jointsPerVertex;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimationSet</code> object.\n\t *\n\t * @param jointsPerVertex Sets the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the maximum allowed value is 4. Defaults to 4.\n\t */\n\tconstructor(jointsPerVertex:number /*uint*/ = 4)\n\t{\n\t\tsuper();\n\n\t\tthis._jointsPerVertex = jointsPerVertex;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\n\t\tvar indexOffset0:number /*uint*/ = shader.numUsedVertexConstants;\n\t\tvar indexOffset1:number /*uint*/ = indexOffset0 + 1;\n\t\tvar indexOffset2:number /*uint*/ = indexOffset0 + 2;\n\t\tvar indexStream:string = \"va\" + shader.numUsedStreams;\n\t\tvar weightStream:string = \"va\" + (shader.numUsedStreams + 1);\n\t\tvar indices:Array<string> = [ indexStream + \".x\", indexStream + \".y\", indexStream + \".z\", indexStream + \".w\" ];\n\t\tvar weights:Array<string> = [ weightStream + \".x\", weightStream + \".y\", weightStream + \".z\", weightStream + \".w\" ];\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shader.animationTargetRegisters, temp1);\n\t\tvar dot:string = \"dp4\";\n\t\tvar code:string = \"\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\n\t\t\tvar src:string = shader.animatableAttributes[i];\n\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._jointsPerVertex; ++j) {\n\t\t\t\tcode += dot + \" \" + temp1 + \".x, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset0 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".y, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset1 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".z, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset2 + \"]\\n\" +\n\t\t\t\t\t\"mov \" + temp1 + \".w, \" + src + \".w\\n\" +\n\t\t\t\t\t\"mul \" + temp1 + \", \" + temp1 + \", \" + weights[j] + \"\\n\"; // apply weight\n\n\t\t\t\t// add or mov to target. Need to write to a temp reg first, because an output can be a target\n\t\t\t\tif (j == 0)\n\t\t\t\t\tcode += \"mov \" + temp2 + \", \" + temp1 + \"\\n\"; else\n\t\t\t\t\tcode += \"add \" + temp2 + \", \" + temp2 + \", \" + temp1 + \"\\n\";\n\t\t\t}\n\t\t\t// switch to dp3 once positions have been transformed, from now on, it should only be vectors instead of points\n\t\t\tdot = \"dp3\";\n\t\t\tcode += \"mov \" + shader.animationTargetRegisters[i] + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar streamOffset:number /*uint*/ = pass.numUsedStreams;\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(streamOffset, null);\n//\t\t\tcontext.setVertexBufferAt(streamOffset + 1, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\treturn \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\n\t}\n}\n\nexport = SkeletonAnimationSet;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport SubGeometryEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning skeleton-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass SkeletonAnimator extends AnimatorBase\n{\n\tprivate _globalMatrices:Array<number>;\n\tprivate _globalPose:SkeletonPose = new SkeletonPose();\n\tprivate _globalPropertiesDirty:boolean;\n\tprivate _numJoints:number /*uint*/;\n\tprivate _morphedSubGeometry:Object = new Object();\n\tprivate _morphedSubGeometryDirty:Object = new Object();\n\tprivate _condensedMatrices:Array<number>;\n\n\tprivate _skeleton:Skeleton;\n\tprivate _forceCPU:boolean;\n\tprivate _useCondensedIndices:boolean;\n\tprivate _jointsPerVertex:number /*uint*/;\n\tprivate _activeSkeletonState:ISkeletonAnimationState;\n\tprivate _onTransitionCompleteDelegate:(event:AnimationStateEvent) => void;\n\n\tprivate _onIndicesUpdateDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdateDelegate:(event:SubGeometryEvent) => void;\n\n\t/**\n\t * returns the calculated global matrices of the current skeleton pose.\n\t *\n\t * @see #globalPose\n\t */\n\tpublic get globalMatrices():Array<number>\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalMatrices;\n\t}\n\n\t/**\n\t * returns the current skeleton pose output from the animator.\n\t *\n\t * @see away.animators.data.SkeletonPose\n\t */\n\tpublic get globalPose():SkeletonPose\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalPose;\n\t}\n\n\t/**\n\t * Returns the skeleton object in use by the animator - this defines the number and heirarchy of joints used by the\n\t * skinned geoemtry to which skeleon animator is applied.\n\t */\n\tpublic get skeleton():Skeleton\n\t{\n\t\treturn this._skeleton;\n\t}\n\n\t/**\n\t * Indicates whether the skeleton animator is disabled by default for GPU rendering, something that allows the animator to perform calculation on the GPU.\n\t * Defaults to false.\n\t */\n\tpublic get forceCPU():boolean\n\t{\n\t\treturn this._forceCPU;\n\t}\n\n\t/**\n\t * Offers the option of enabling GPU accelerated animation on skeletons larger than 32 joints\n\t * by condensing the number of joint index values required per mesh. Only applicable to\n\t * skeleton animations that utilise more than one mesh object. Defaults to false.\n\t */\n\tpublic get useCondensedIndices():boolean\n\t{\n\t\treturn this._useCondensedIndices;\n\t}\n\n\tpublic set useCondensedIndices(value:boolean)\n\t{\n\t\tthis._useCondensedIndices = value;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimator</code> object.\n\t *\n\t * @param skeletonAnimationSet The animation data set containing the skeleton animations used by the animator.\n\t * @param skeleton The skeleton object used for calculating the resulting global matrices for transforming skinned mesh data.\n\t * @param forceCPU Optional value that only allows the animator to perform calculation on the CPU. Defaults to false.\n\t */\n\tconstructor(animationSet:SkeletonAnimationSet, skeleton:Skeleton, forceCPU:boolean = false)\n\t{\n\t\tsuper(animationSet);\n\n\t\tthis._skeleton = skeleton;\n\t\tthis._forceCPU = forceCPU;\n\t\tthis._jointsPerVertex = animationSet.jointsPerVertex;\n\n\t\tthis._numJoints = this._skeleton.numJoints;\n\t\tthis._globalMatrices = new Array<number>(this._numJoints*12);\n\n\t\tvar j:number /*int*/ = 0;\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t}\n\n\t\tthis._onTransitionCompleteDelegate = (event:AnimationStateEvent) => this.onTransitionComplete(event);\n\t\tthis._onIndicesUpdateDelegate = (event:SubGeometryEvent) => this.onIndicesUpdate(event);\n\t\tthis._onVerticesUpdateDelegate = (event:SubGeometryEvent) => this.onVerticesUpdate(event);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\t/* The cast to SkeletonAnimationSet should never fail, as _animationSet can only be set\n\t\t through the constructor, which will only accept a SkeletonAnimationSet. */\n\t\treturn new SkeletonAnimator(<SkeletonAnimationSet> this._pAnimationSet, this._skeleton, this._forceCPU);\n\t}\n\n\t/**\n\t * Plays an animation state registered with the given name in the animation data set.\n\t *\n\t * @param name The data set name of the animation state to be played.\n\t * @param transition An optional transition object that determines how the animator will transition from the currently active animation state.\n\t * @param offset An option offset time (in milliseconds) that resets the state's internal clock to the absolute time of the animator plus the offset value. Required for non-looping animation states.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tif (transition && this._pActiveNode) {\n\t\t\t//setup the transition\n\t\t\tthis._pActiveNode = transition.getAnimationNode(this, this._pActiveNode, this._pAnimationSet.getAnimation(name), this._pAbsoluteTime);\n\t\t\tthis._pActiveNode.addEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t} else\n\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// do on request of globalProperties\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> (<TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh).subGeometry;\n\n\t\tsubGeometry.useCondensedIndices = this._useCondensedIndices;\n\n\t\tif (this._useCondensedIndices) {\n\t\t\t// using a condensed data set\n\t\t\tthis.updateCondensedMatrices(subGeometry.condensedIndexLookUp);\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._condensedMatrices, this._condensedMatrices.length/4);\n\t\t} else {\n\t\t\tif (this._pAnimationSet.usesCPU) {\n\t\t\t\tif (this._morphedSubGeometryDirty[subGeometry.id])\n\t\t\t\t\tthis.morphSubGeometry(<TriangleSubMeshRenderable> renderable, subGeometry);\n\n\t\t\t\treturn\n\t\t\t}\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._globalMatrices, this._numJoints*3);\n\t\t}\n\n\t\tshader.jointIndexIndex = vertexStreamOffset++;\n\t\tshader.jointWeightIndex = vertexStreamOffset++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t\tif (!this._useCondensedIndices && (this._forceCPU || this._jointsPerVertex > 4 || shader.numUsedVertexConstants + this._numJoints*3 > 128))\n\t\t\tthis._pAnimationSet.cancelGPUCompatibility();\n\t}\n\n\t/**\n\t * Applies the calculated time delta to the active animation state node or state transition object.\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\t//invalidate pose matrices\n\t\tthis._globalPropertiesDirty = true;\n\n\t\t//trigger geometry invalidation if using CPU animation\n\t\tif (this._pAnimationSet.usesCPU)\n\t\t\tfor (var key in this._morphedSubGeometryDirty)\n\t\t\t\tthis._morphedSubGeometryDirty[key] = true;\n\t}\n\n\tprivate updateCondensedMatrices(condensedIndexLookUp:Array<number>)\n\t{\n\t\tvar j:number = 0, k:number = 0;\n\t\tvar srcIndex:number /*uint*/;\n\n\t\tthis._condensedMatrices = new Array<number>();\n\n\t\tvar len:number = condensedIndexLookUp.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tsrcIndex = condensedIndexLookUp[i]*12; //12 required for the three 4-component vectors that store the matrix\n\t\t\tk = 12;\n\t\t\t// copy into condensed\n\t\t\twhile (k--)\n\t\t\t\tthis._condensedMatrices[j++] = this._globalMatrices[srcIndex++];\n\t\t}\n\t}\n\n\tprivate updateGlobalProperties()\n\t{\n\t\tthis._globalPropertiesDirty = false;\n\n\t\t//get global pose\n\t\tthis.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton), this._globalPose, this._skeleton);\n\n\t\t// convert pose to matrix\n\t\tvar mtxOffset:number /*uint*/ = 0;\n\t\tvar globalPoses:Array<JointPose> = this._globalPose.jointPoses;\n\t\tvar raw:Array<number>;\n\t\tvar ox:number, oy:number, oz:number, ow:number;\n\t\tvar xy2:number, xz2:number, xw2:number;\n\t\tvar yz2:number, yw2:number, zw2:number;\n\t\tvar n11:number, n12:number, n13:number;\n\t\tvar n21:number, n22:number, n23:number;\n\t\tvar n31:number, n32:number, n33:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\t\tvar joints:Array<SkeletonJoint> = this._skeleton.joints;\n\t\tvar pose:JointPose;\n\t\tvar quat:Quaternion;\n\t\tvar vec:Vector3D;\n\t\tvar t:number;\n\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tpose = globalPoses[i];\n\t\t\tquat = pose.orientation;\n\t\t\tvec = pose.translation;\n\t\t\tox = quat.x;\n\t\t\toy = quat.y;\n\t\t\toz = quat.z;\n\t\t\tow = quat.w;\n\n\t\t\txy2 = (t = 2.0*ox)*oy;\n\t\t\txz2 = t*oz;\n\t\t\txw2 = t*ow;\n\t\t\tyz2 = (t = 2.0*oy)*oz;\n\t\t\tyw2 = t*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\n\t\t\tyz2 = 2.0*oy*oz;\n\t\t\tyw2 = 2.0*oy*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\t\t\tox *= ox;\n\t\t\toy *= oy;\n\t\t\toz *= oz;\n\t\t\tow *= ow;\n\n\t\t\tn11 = (t = ox - oy) - oz + ow;\n\t\t\tn12 = xy2 - zw2;\n\t\t\tn13 = xz2 + yw2;\n\t\t\tn21 = xy2 + zw2;\n\t\t\tn22 = -t - oz + ow;\n\t\t\tn23 = yz2 - xw2;\n\t\t\tn31 = xz2 - yw2;\n\t\t\tn32 = yz2 + xw2;\n\t\t\tn33 = -ox - oy + oz + ow;\n\n\t\t\t// prepend inverse bind pose\n\t\t\traw = joints[i].inverseBindPose;\n\t\t\tm11 = raw[0];\n\t\t\tm12 = raw[4];\n\t\t\tm13 = raw[8];\n\t\t\tm14 = raw[12];\n\t\t\tm21 = raw[1];\n\t\t\tm22 = raw[5];\n\t\t\tm23 = raw[9];\n\t\t\tm24 = raw[13];\n\t\t\tm31 = raw[2];\n\t\t\tm32 = raw[6];\n\t\t\tm33 = raw[10];\n\t\t\tm34 = raw[14];\n\n\t\t\tthis._globalMatrices[mtxOffset] = n11*m11 + n12*m21 + n13*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 1] = n11*m12 + n12*m22 + n13*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 2] = n11*m13 + n12*m23 + n13*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 3] = n11*m14 + n12*m24 + n13*m34 + vec.x;\n\t\t\tthis._globalMatrices[mtxOffset + 4] = n21*m11 + n22*m21 + n23*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 5] = n21*m12 + n22*m22 + n23*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 6] = n21*m13 + n22*m23 + n23*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 7] = n21*m14 + n22*m24 + n23*m34 + vec.y;\n\t\t\tthis._globalMatrices[mtxOffset + 8] = n31*m11 + n32*m21 + n33*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 9] = n31*m12 + n32*m22 + n33*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 10] = n31*m13 + n32*m23 + n33*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 11] = n31*m14 + n32*m24 + n33*m34 + vec.z;\n\n\t\t\tmtxOffset = mtxOffset + 12;\n\t\t}\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = true;\n\n\t\t//early out for GPU animations\n\t\tif (!this._pAnimationSet.usesCPU)\n\t\t\treturn sourceSubGeometry;\n\n\t\tvar targetSubGeometry:TriangleSubGeometry;\n\n\t\tif (!(targetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id])) {\n\t\t\t//not yet stored\n\t\t\ttargetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id] = sourceSubGeometry.clone();\n\t\t\t//turn off auto calculations on the morphed geometry\n\t\t\ttargetSubGeometry.autoDeriveNormals = false;\n\t\t\ttargetSubGeometry.autoDeriveTangents = false;\n\t\t\ttargetSubGeometry.autoDeriveUVs = false;\n\t\t\t//add event listeners for any changes in UV values on the source geometry\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdateDelegate);\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdateDelegate);\n\t\t}\n\n\t\treturn targetSubGeometry;\n\t}\n\n\t/**\n\t * If the animation can't be performed on GPU, transform vertices manually\n\t * @param subGeom The subgeometry containing the weights and joint index data per vertex.\n\t * @param pass The material pass for which we need to transform the vertices\n\t */\n\tpublic morphSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry)\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = false;\n\n\t\tvar numVertices:number = sourceSubGeometry.numVertices;\n\t\tvar sourcePositions:Float32Array = sourceSubGeometry.positions.get(numVertices);\n\t\tvar sourceNormals:Float32Array = sourceSubGeometry.normals.get(numVertices);\n\t\tvar sourceTangents:Float32Array = sourceSubGeometry.tangents.get(numVertices);\n\n\t\tvar jointIndices:Float32Array = <Float32Array> sourceSubGeometry.jointIndices.get(numVertices);\n\t\tvar jointWeights:Float32Array = <Float32Array> sourceSubGeometry.jointWeights.get(numVertices);\n\n\t\tvar targetSubGeometry:TriangleSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id];\n\n\t\tvar targetPositions:Float32Array = targetSubGeometry.positions.get(numVertices);\n\t\tvar targetNormals:Float32Array = targetSubGeometry.normals.get(numVertices);\n\t\tvar targetTangents:Float32Array = targetSubGeometry.tangents.get(numVertices);\n\n\t\tvar index:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/;\n\t\tvar vx:number, vy:number, vz:number;\n\t\tvar nx:number, ny:number, nz:number;\n\t\tvar tx:number, ty:number, tz:number;\n\t\tvar len:number /*int*/ = sourcePositions.length;\n\t\tvar weight:number;\n\t\tvar vertX:number, vertY:number, vertZ:number;\n\t\tvar normX:number, normY:number, normZ:number;\n\t\tvar tangX:number, tangY:number, tangZ:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\n\t\twhile (index < len) {\n\t\t\tvertX = sourcePositions[index];\n\t\t\tvertY = sourcePositions[index + 1];\n\t\t\tvertZ = sourcePositions[index + 2];\n\t\t\tnormX = sourceNormals[index];\n\t\t\tnormY = sourceNormals[index + 1];\n\t\t\tnormZ = sourceNormals[index + 2];\n\t\t\ttangX = sourceTangents[index];\n\t\t\ttangY = sourceTangents[index + 1];\n\t\t\ttangZ = sourceTangents[index + 2];\n\t\t\tvx = 0;\n\t\t\tvy = 0;\n\t\t\tvz = 0;\n\t\t\tnx = 0;\n\t\t\tny = 0;\n\t\t\tnz = 0;\n\t\t\ttx = 0;\n\t\t\tty = 0;\n\t\t\ttz = 0;\n\t\t\tk = 0;\n\t\t\twhile (k < this._jointsPerVertex) {\n\t\t\t\tweight = jointWeights[j];\n\t\t\t\tif (weight > 0) {\n\t\t\t\t\t// implicit /3*12 (/3 because indices are multiplied by 3 for gpu matrix access, *12 because it's the matrix size)\n\t\t\t\t\tvar mtxOffset:number /*uint*/ = jointIndices[j++] << 2;\n\t\t\t\t\tm11 = this._globalMatrices[mtxOffset];\n\t\t\t\t\tm12 = this._globalMatrices[mtxOffset + 1];\n\t\t\t\t\tm13 = this._globalMatrices[mtxOffset + 2];\n\t\t\t\t\tm14 = this._globalMatrices[mtxOffset + 3];\n\t\t\t\t\tm21 = this._globalMatrices[mtxOffset + 4];\n\t\t\t\t\tm22 = this._globalMatrices[mtxOffset + 5];\n\t\t\t\t\tm23 = this._globalMatrices[mtxOffset + 6];\n\t\t\t\t\tm24 = this._globalMatrices[mtxOffset + 7];\n\t\t\t\t\tm31 = this._globalMatrices[mtxOffset + 8];\n\t\t\t\t\tm32 = this._globalMatrices[mtxOffset + 9];\n\t\t\t\t\tm33 = this._globalMatrices[mtxOffset + 10];\n\t\t\t\t\tm34 = this._globalMatrices[mtxOffset + 11];\n\t\t\t\t\tvx += weight*(m11*vertX + m12*vertY + m13*vertZ + m14);\n\t\t\t\t\tvy += weight*(m21*vertX + m22*vertY + m23*vertZ + m24);\n\t\t\t\t\tvz += weight*(m31*vertX + m32*vertY + m33*vertZ + m34);\n\t\t\t\t\tnx += weight*(m11*normX + m12*normY + m13*normZ);\n\t\t\t\t\tny += weight*(m21*normX + m22*normY + m23*normZ);\n\t\t\t\t\tnz += weight*(m31*normX + m32*normY + m33*normZ);\n\t\t\t\t\ttx += weight*(m11*tangX + m12*tangY + m13*tangZ);\n\t\t\t\t\tty += weight*(m21*tangX + m22*tangY + m23*tangZ);\n\t\t\t\t\ttz += weight*(m31*tangX + m32*tangY + m33*tangZ);\n\t\t\t\t\t++k;\n\t\t\t\t} else {\n\t\t\t\t\tj += (this._jointsPerVertex - k);\n\t\t\t\t\tk = this._jointsPerVertex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttargetPositions[index] = vx;\n\t\t\ttargetPositions[index + 1] = vy;\n\t\t\ttargetPositions[index + 2] = vz;\n\t\t\ttargetNormals[index] = nx;\n\t\t\ttargetNormals[index + 1] = ny;\n\t\t\ttargetNormals[index + 2] = nz;\n\t\t\ttargetTangents[index] = tx;\n\t\t\ttargetTangents[index + 1] = ty;\n\t\t\ttargetTangents[index + 2] = tz;\n\n\t\t\tindex += 3;\n\t\t}\n\n\t\ttargetSubGeometry.setPositions(targetPositions);\n\t\ttargetSubGeometry.setNormals(targetNormals);\n\t\ttargetSubGeometry.setTangents(targetTangents);\n\t}\n\n\t/**\n\t * Converts a local hierarchical skeleton pose to a global pose\n\t * @param targetPose The SkeletonPose object that will contain the global pose.\n\t * @param skeleton The skeleton containing the joints, and as such, the hierarchical data to transform to global poses.\n\t */\n\tprivate localToGlobalPose(sourcePose:SkeletonPose, targetPose:SkeletonPose, skeleton:Skeleton)\n\t{\n\t\tvar globalPoses:Array<JointPose> = targetPose.jointPoses;\n\t\tvar globalJointPose:JointPose;\n\t\tvar joints:Array<SkeletonJoint> = skeleton.joints;\n\t\tvar len:number /*uint*/ = sourcePose.numJointPoses;\n\t\tvar jointPoses:Array<JointPose> = sourcePose.jointPoses;\n\t\tvar parentIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tvar parentPose:JointPose;\n\t\tvar pose:JointPose;\n\t\tvar or:Quaternion;\n\t\tvar tr:Vector3D;\n\t\tvar t:Vector3D;\n\t\tvar q:Quaternion;\n\n\t\tvar x1:number, y1:number, z1:number, w1:number;\n\t\tvar x2:number, y2:number, z2:number, w2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\n\t\t// :s\n\t\tif (globalPoses.length != len)\n\t\t\tglobalPoses.length = len;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tglobalJointPose = globalPoses[i];\n\n\t\t\tif (globalJointPose == null)\n\t\t\t\tglobalJointPose = globalPoses[i] = new JointPose();\n\n\t\t\tjoint = joints[i];\n\t\t\tparentIndex = joint.parentIndex;\n\t\t\tpose = jointPoses[i];\n\n\t\t\tq = globalJointPose.orientation;\n\t\t\tt = globalJointPose.translation;\n\n\t\t\tif (parentIndex < 0) {\n\t\t\t\ttr = pose.translation;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tq.x = or.x;\n\t\t\t\tq.y = or.y;\n\t\t\t\tq.z = or.z;\n\t\t\t\tq.w = or.w;\n\t\t\t\tt.x = tr.x;\n\t\t\t\tt.y = tr.y;\n\t\t\t\tt.z = tr.z;\n\t\t\t} else {\n\t\t\t\t// append parent pose\n\t\t\t\tparentPose = globalPoses[parentIndex];\n\n\t\t\t\t// rotate point\n\t\t\t\tor = parentPose.orientation;\n\t\t\t\ttr = pose.translation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\t\t\t\tx3 = tr.x;\n\t\t\t\ty3 = tr.y;\n\t\t\t\tz3 = tr.z;\n\n\t\t\t\tw1 = -x2*x3 - y2*y3 - z2*z3;\n\t\t\t\tx1 = w2*x3 + y2*z3 - z2*y3;\n\t\t\t\ty1 = w2*y3 - x2*z3 + z2*x3;\n\t\t\t\tz1 = w2*z3 + x2*y3 - y2*x3;\n\n\t\t\t\t// append parent translation\n\t\t\t\ttr = parentPose.translation;\n\t\t\t\tt.x = -w1*x2 + x1*w2 - y1*z2 + z1*y2 + tr.x;\n\t\t\t\tt.y = -w1*y2 + x1*z2 + y1*w2 - z1*x2 + tr.y;\n\t\t\t\tt.z = -w1*z2 - x1*y2 + y1*x2 + z1*w2 + tr.z;\n\n\t\t\t\t// append parent orientation\n\t\t\t\tx1 = or.x;\n\t\t\t\ty1 = or.y;\n\t\t\t\tz1 = or.z;\n\t\t\t\tw1 = or.w;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\n\t\t\t\tq.w = w1*w2 - x1*x2 - y1*y2 - z1*z2;\n\t\t\t\tq.x = w1*x2 + x1*w2 + y1*z2 - z1*y2;\n\t\t\t\tq.y = w1*y2 - x1*z2 + y1*w2 + z1*x2;\n\t\t\t\tq.z = w1*z2 + x1*y2 - y1*x2 + z1*w2;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onTransitionComplete(event:AnimationStateEvent)\n\t{\n\t\tif (event.type == AnimationStateEvent.TRANSITION_COMPLETE) {\n\t\t\tevent.animationNode.removeEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t\t//if this is the current active state transition, revert control to the active node\n\t\t\tif (this._pActiveState == event.animationState) {\n\t\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t\t\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\t\t\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onIndicesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\n\t\t(<TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id]).setIndices(subGeometry.indices);\n\t}\n\n\tprivate onVerticesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\t\tvar morphGeometry:TriangleSubGeometry = <TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id];\n\n\t\tswitch(event.attributesView) {\n\t\t\tcase subGeometry.uvs:\n\t\t\t\tmorphGeometry.setUVs(subGeometry.uvs.get(subGeometry.numVertices));\n\t\t\tcase subGeometry.secondaryUVs:\n\t\t\t\tmorphGeometry.setSecondaryUVs(subGeometry.secondaryUVs.get(subGeometry.numVertices));\n\t\t}\n\t}\n}\n\nexport = SkeletonAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * The animation data set used by vertex-based animators, containing vertex animation state data.\n *\n * @see VertexAnimator\n */\nclass VertexAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\n\t/**\n\t * Returns the number of poses made available at once to the GPU animation code.\n\t */\n\tpublic get numPoses():number /*uint*/\n\t{\n\t\treturn this._numPoses;\n\t}\n\n\t/**\n\t * Returns the active blend mode of the vertex animator object.\n\t */\n\tpublic get blendMode():string\n\t{\n\t\treturn this._blendMode;\n\t}\n\n\t/**\n\t * Returns whether or not normal data is used in last set GPU pass of the vertex shader.\n\t */\n//\t\tpublic get useNormals():boolean\n//\t\t{\n//\t\t\treturn this._uploadNormals;\n//\t\t}\n\n\t/**\n\t * Creates a new <code>VertexAnimationSet</code> object.\n\t *\n\t * @param numPoses The number of poses made available at once to the GPU animation code.\n\t * @param blendMode Optional value for setting the animation mode of the vertex animator object.\n\t *\n\t * @see away3d.animators.data.VertexAnimationMode\n\t */\n\tconstructor(numPoses:number /*uint*/ = 2, blendMode:string = \"absolute\")\n\t{\n\t\tsuper();\n\t\tthis._numPoses = numPoses;\n\t\tthis._blendMode = blendMode;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\treturn this.getAbsoluteAGALCode(shader);\n\t\telse\n\t\t\treturn this.getAdditiveAGALCode(shader);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tthis._uploadNormals = <boolean> this._useNormals[uID];\n//\t\t\tthis._uploadTangents = <boolean> this._useTangents[uID];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tvar index:number /*uint*/ = this._streamIndices[uID];\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(index, null);\n//\t\t\tif (this._uploadNormals)\n//\t\t\t\tcontext.setVertexBufferAt(index + 1, null);\n//\t\t\tif (this._uploadTangents)\n//\t\t\t\tcontext.setVertexBufferAt(index + 2, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\treturn \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for absolute blending.\n\t */\n\tprivate getAbsoluteAGALCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shader.animationTargetRegisters, temp1);\n\t\tvar regs:Array<string> = new Array<string>(\"x\", \"y\", \"z\", \"w\");\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\t\tvar constantReg:string = \"vc\" + shader.numUsedVertexConstants;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\t\tvar streamIndex:number /*uint*/ = shader.numUsedStreams;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tcode += \"mul \" + temp1 + \", \" + shader.animatableAttributes[i] + \", \" + constantReg + \".\" + regs[0] + \"\\n\";\n\n\t\t\tfor (var j:number /*uint*/ = 1; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp2 + \", va\" + streamIndex + \", \" + constantReg + \".\" + regs[j] + \"\\n\";\n\n\t\t\t\tif (j < this._numPoses - 1)\n\t\t\t\t\tcode += \"add \" + temp1 + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\t\t\t++streamIndex;\n\t\t\t}\n\n\t\t\tcode += \"add \" + shader.animationTargetRegisters[i] + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\t// add code for bitangents if tangents are used\n\t\tif (shader.tangentDependencies > 0 || shader.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shader.animatableAttributes[2] + \", \" + shader.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shader.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shader.animationTargetRegisters[2] + \", \" + shader.animationTargetRegisters[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for additive blending.\n\t */\n\tprivate getAdditiveAGALCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\t\tvar regs:Array<string> = [\"x\", \"y\", \"z\", \"w\"];\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar k:number /*uint*/;\n\n\t\tvar streamIndex:number /*uint*/ = shader.numUsedStreams;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\n\t\tcode += \"mov  \" + shader.animationTargetRegisters[0] + \", \" + shader.animatableAttributes[0] + \"\\n\";\n\t\tif (shader.normalDependencies > 0)\n\t\t\tcode += \"mov \" + shader.animationTargetRegisters[1] + \", \" + shader.animatableAttributes[1] + \"\\n\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp1 + \", va\" + (streamIndex + k) + \", vc\" + shader.numUsedVertexConstants + \".\" + regs[j] + \"\\n\" +\n\t\t\t\t\t\"add \" + shader.animationTargetRegisters[i] + \", \" + shader.animationTargetRegisters[i] + \", \" + temp1 + \"\\n\";\n\t\t\t\tk++;\n\t\t\t}\n\t\t}\n\n\t\tif (shader.tangentDependencies > 0 || shader.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shader.animatableAttributes[2] + \", \" + shader.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shader.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shader.animationTargetRegisters[2] + \", \" + shader.animatableAttributes[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n}\n\nexport = VertexAnimationSet;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport SubGeometryVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n * Provides an interface for assigning vertex-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass VertexAnimator extends AnimatorBase\n{\n\tprivate _subGeometryVOPool:SubGeometryVOPool;\n\tprivate _vertexAnimationSet:VertexAnimationSet;\n\tprivate _poses:Array<Geometry> = new Array<Geometry>();\n\tprivate _weights:Array<number> = Array<number>(1, 0, 0, 0);\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\tprivate _activeVertexState:IVertexAnimationState;\n\n\t/**\n\t * Creates a new <code>VertexAnimator</code> object.\n\t *\n\t * @param vertexAnimationSet The animation data set containing the vertex animations used by the animator.\n\t */\n\tconstructor(vertexAnimationSet:VertexAnimationSet)\n\t{\n\t\tsuper(vertexAnimationSet);\n\n\t\tthis._vertexAnimationSet = vertexAnimationSet;\n\t\tthis._numPoses = vertexAnimationSet.numPoses;\n\t\tthis._blendMode = vertexAnimationSet.blendMode;\n\t\tthis._subGeometryVOPool = SubGeometryVOPool.getPool();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new VertexAnimator(this._vertexAnimationSet);\n\t}\n\n\t/**\n\t * Plays a sequence with a given name. If the sequence is not found, it may not be loaded yet, and it will retry every frame.\n\t * @param sequenceName The name of the clip to be played.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\t//TODO: implement transitions in vertex animator\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeVertexState = <IVertexAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\tvar geometryFlag:boolean = false;\n\n\t\tif (this._poses[0] != this._activeVertexState.currentGeometry) {\n\t\t\tthis._poses[0] = this._activeVertexState.currentGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tif (this._poses[1] != this._activeVertexState.nextGeometry) {\n\t\t\tthis._poses[1] = this._activeVertexState.nextGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tthis._weights[0] = 1 - (this._weights[1] = this._activeVertexState.blendWeight);\n\n\t\tif (geometryFlag) {\n\t\t\t//invalidate meshes\n\t\t\tvar mesh:Mesh;\n\t\t\tvar len:number = this._pOwners.length;\n\t\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\t\tmesh = this._pOwners[i];\n\t\t\t\tmesh._iInvalidateRenderableGeometries();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// todo: add code for when running on cpu\n\t\t// this type of animation can only be SubMesh\n\t\tvar subMesh:TriangleSubMesh = <TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar subGeom:TriangleSubGeometry = subMesh.subGeometry;\n\n\t\t// if no poses defined, set temp data\n\t\tif (!this._poses.length) {\n\t\t\tthis.setNullPose(shader, subGeom, stage, vertexConstantOffset, vertexStreamOffset);\n\t\t\treturn;\n\t\t}\n\n\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/ = this._numPoses;\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\ti = 1;\n\t\telse\n\t\t\ti = 0;\n\n\t\tvar subGeometryVO:SubGeometryVOBase;\n\n\t\tfor (; i < len; ++i) {\n\t\t\tsubGeom = <TriangleSubGeometry> this._poses[i].subGeometries[subMesh._iIndex] || subMesh.subGeometry;\n\n\t\t\tsubGeometryVO = this._subGeometryVOPool.getItem(subGeom);\n\t\t\tsubGeometryVO._indexMappings = this._subGeometryVOPool.getItem(subMesh.subGeometry).indexMappings;\n\n\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeom.positions, stage);\n\n\t\t\tif (shader.normalDependencies > 0)\n\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeom.normals, stage);\n\t\t}\n\t}\n\n\tprivate setNullPose(shader:ShaderBase, subGeometry:TriangleSubGeometry, stage:Stage, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tvar subGeometryVO:SubGeometryVOBase = this._subGeometryVOPool.getItem(subGeometry);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE) {\n\t\t\tvar len:number /*uint*/ = this._numPoses;\n\t\t\tfor (var i:number /*uint*/ = 1; i < len; ++i) {\n\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeometry.positions, stage);\n\n\t\t\t\tif (shader.normalDependencies > 0)\n\t\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeometry.normals, stage);\n\t\t\t}\n\t\t}\n\t\t// todo: set temp data for additive?\n\t}\n\n\t/**\n\t * Verifies if the animation will be used on cpu. Needs to be true for all passes for a material to be able to use it on gpu.\n\t * Needs to be called if gpu code is potentially required.\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t}\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE && this._poses.length)\n\t\t\treturn <TriangleSubGeometry> this._poses[0].subGeometries[renderable.subMesh._iIndex] || sourceSubGeometry;\n\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = VertexAnimator;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n\n/**\n * ...\n */\nclass AnimationRegisterCache extends ShaderRegisterCache\n{\n\t//vertex\n\tpublic positionAttribute:ShaderRegisterElement;\n\tpublic uvAttribute:ShaderRegisterElement;\n\tpublic positionTarget:ShaderRegisterElement;\n\tpublic scaleAndRotateTarget:ShaderRegisterElement;\n\tpublic velocityTarget:ShaderRegisterElement;\n\tpublic vertexTime:ShaderRegisterElement;\n\tpublic vertexLife:ShaderRegisterElement;\n\tpublic vertexZeroConst:ShaderRegisterElement;\n\tpublic vertexOneConst:ShaderRegisterElement;\n\tpublic vertexTwoConst:ShaderRegisterElement;\n\tpublic uvTarget:ShaderRegisterElement;\n\tpublic colorAddTarget:ShaderRegisterElement;\n\tpublic colorMulTarget:ShaderRegisterElement;\n\t//vary\n\tpublic colorAddVary:ShaderRegisterElement;\n\tpublic colorMulVary:ShaderRegisterElement;\n\n\t//fragment\n\n\tpublic uvVar:ShaderRegisterElement;\n\n\t//these are targets only need to rotate ( normal and tangent )\n\tpublic rotationRegisters:Array<ShaderRegisterElement>;\n\n\tpublic needFragmentAnimation:boolean;\n\tpublic needUVAnimation:boolean;\n\n\tpublic sourceRegisters:Array<string>;\n\tpublic targetRegisters:Array<string>;\n\n\tprivate indexDictionary:Object = new Object();\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\tconstructor(profile:string)\n\t{\n\t\tsuper(profile);\n\t}\n\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.rotationRegisters = new Array<ShaderRegisterElement>();\n\t\tthis.positionAttribute = this.getRegisterFromString(this.sourceRegisters[0]);\n\t\tthis.scaleAndRotateTarget = this.getRegisterFromString(this.targetRegisters[0]);\n\t\tthis.addVertexTempUsages(this.scaleAndRotateTarget, 1);\n\n\t\tfor (var i:number /*int*/ = 1; i < this.targetRegisters.length; i++) {\n\t\t\tthis.rotationRegisters.push(this.getRegisterFromString(this.targetRegisters[i]));\n\t\t\tthis.addVertexTempUsages(this.rotationRegisters[i - 1], 1);\n\t\t}\n\n\t\tthis.scaleAndRotateTarget = new ShaderRegisterElement(this.scaleAndRotateTarget.regName, this.scaleAndRotateTarget.index); //only use xyz, w is used as vertexLife\n\n\t\t//allot const register\n\n\t\tthis.vertexZeroConst = this.getFreeVertexConstant();\n\t\tthis.vertexZeroConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 0);\n\t\tthis.vertexOneConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 1);\n\t\tthis.vertexTwoConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 2);\n\n\t\t//allot temp register\n\t\tthis.positionTarget = this.getFreeVertexVectorTemp();\n\t\tthis.addVertexTempUsages(this.positionTarget, 1);\n\t\tthis.positionTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\n\t\tif (this.needVelocity) {\n\t\t\tthis.velocityTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.velocityTarget, 1);\n\t\t\tthis.velocityTarget = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index, 3);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index, 3);\n\t\t} else {\n\t\t\tvar tempTime:ShaderRegisterElement = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(tempTime, 1);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(tempTime.regName, tempTime.index, 0);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(tempTime.regName, tempTime.index, 1);\n\t\t}\n\n\t}\n\n\tpublic setUVSourceAndTarget(UVAttribute:string, UVVaring:string)\n\t{\n\t\tthis.uvVar = this.getRegisterFromString(UVVaring);\n\t\tthis.uvAttribute = this.getRegisterFromString(UVAttribute);\n\t\t//uv action is processed after normal actions,so use offsetTarget as uvTarget\n\t\tthis.uvTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\t}\n\n\tpublic setRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/, registerIndex:number /*int*/)\n\t{\n\t\t//8 should be enough for any node.\n\t\tvar t:Array<number> /*int*/ = this.indexDictionary[node.id];\n\n\t\tif (t == null)\n\t\t\tt = this.indexDictionary[node.id] = new Array<number>(8) /*int*/;\n\n\t\tt[parameterIndex] = registerIndex;\n\t}\n\n\tpublic getRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/):number /*int*/\n\t{\n\t\treturn (<Array<number>> this.indexDictionary[node.id])[parameterIndex];\n\t}\n\n\tpublic getInitCode():string\n\t{\n\t\tvar len:number /*int*/ = this.sourceRegisters.length;\n\t\tvar code:string = \"\";\n\t\tfor (var i:number /*int*/ = 0; i < len; i++)\n\t\t\tcode += \"mov \" + this.targetRegisters[i] + \",\" + this.sourceRegisters[i] + \"\\n\";\n\n\t\tcode += \"mov \" + this.positionTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\tif (this.needVelocity)\n\t\t\tcode += \"mov \" + this.velocityTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic getCombinationCode():string\n\t{\n\t\treturn \"add \" + this.scaleAndRotateTarget + \".xyz,\" + this.scaleAndRotateTarget + \".xyz,\" + this.positionTarget + \".xyz\\n\";\n\t}\n\n\tpublic initColorRegisters():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasColorMulNode) {\n\t\t\tthis.colorMulTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorMulTarget, 1);\n\t\t\tthis.colorMulVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorMulTarget + \",\" + this.vertexOneConst + \"\\n\";\n\t\t}\n\t\tif (this.hasColorAddNode) {\n\t\t\tthis.colorAddTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorAddTarget, 1);\n\t\t\tthis.colorAddVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorAddTarget + \",\" + this.vertexZeroConst + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorPassCode():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mov \" + this.colorMulVary + \",\" + this.colorMulTarget + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"mov \" + this.colorAddVary + \",\" + this.colorAddTarget + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorCombinationCode(shadedTarget:string):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tvar colorTarget:ShaderRegisterElement = this.getRegisterFromString(shadedTarget);\n\t\t\tthis.addFragmentTempUsages(colorTarget, 1);\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mul \" + colorTarget + \",\" + colorTarget + \",\" + this.colorMulVary + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"add \" + colorTarget + \",\" + colorTarget + \",\" + this.colorAddVary + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tprivate getRegisterFromString(code:string):ShaderRegisterElement\n\t{\n\t\tvar temp:Array<string> = code.split(/(\\d+)/);\n\t\treturn new ShaderRegisterElement(temp[0], parseInt(temp[1]));\n\t}\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\tprivate _numVertexConstant:number /*int*/;\n\tprivate _numFragmentConstant:number /*int*/;\n\n\tpublic get numVertexConstant():number /*int*/\n\t{\n\t\treturn this._numVertexConstant;\n\t}\n\n\tpublic get numFragmentConstant():number /*int*/\n\t{\n\t\treturn this._numFragmentConstant;\n\t}\n\n\tpublic setDataLength()\n\t{\n\t\tthis._numVertexConstant = this.numUsedVertexConstants - this.vertexConstantOffset;\n\t\tthis._numFragmentConstant = this.numUsedFragmentConstants - this.fragmentConstantOffset;\n\t\tthis.vertexConstantData.length = this._numVertexConstant*4;\n\t\tthis.fragmentConstantData.length = this._numFragmentConstant*4;\n\t}\n\n\tpublic setVertexConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = x;\n\t\tthis.vertexConstantData[_index++] = y;\n\t\tthis.vertexConstantData[_index++] = z;\n\t\tthis.vertexConstantData[_index] = w;\n\t}\n\n\tpublic setVertexConstFromArray(index:number /*int*/, data:Array<number>)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tfor (var i:number /*int*/ = 0; i < data.length; i++)\n\t\t\tthis.vertexConstantData[_index++] = data[i];\n\t}\n\n\tpublic setVertexConstFromMatrix(index:number /*int*/, matrix:Matrix3D)\n\t{\n\t\tvar rawData:Array<number> = matrix.rawData;\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = rawData[0];\n\t\tthis.vertexConstantData[_index++] = rawData[4];\n\t\tthis.vertexConstantData[_index++] = rawData[8];\n\t\tthis.vertexConstantData[_index++] = rawData[12];\n\t\tthis.vertexConstantData[_index++] = rawData[1];\n\t\tthis.vertexConstantData[_index++] = rawData[5];\n\t\tthis.vertexConstantData[_index++] = rawData[9];\n\t\tthis.vertexConstantData[_index++] = rawData[13];\n\t\tthis.vertexConstantData[_index++] = rawData[2];\n\t\tthis.vertexConstantData[_index++] = rawData[6];\n\t\tthis.vertexConstantData[_index++] = rawData[10];\n\t\tthis.vertexConstantData[_index++] = rawData[14];\n\t\tthis.vertexConstantData[_index++] = rawData[3];\n\t\tthis.vertexConstantData[_index++] = rawData[7];\n\t\tthis.vertexConstantData[_index++] = rawData[11];\n\t\tthis.vertexConstantData[_index] = rawData[15];\n\n\t}\n\n\tpublic setFragmentConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.fragmentConstantOffset)*4;\n\t\tthis.fragmentConstantData[_index++] = x;\n\t\tthis.fragmentConstantData[_index++] = y;\n\t\tthis.fragmentConstantData[_index++] = z;\n\t\tthis.fragmentConstantData[_index] = w;\n\t}\n}\n\nexport = AnimationRegisterCache;",
    "import Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IVertexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\n\n/**\n * ...\n */\nclass AnimationSubGeometry\n{\n\tpublic static SUBGEOM_ID_COUNT:number = 0;\n\n\tpublic _pVertexData:Array<number>;\n\n\tpublic _pVertexBuffer:Array<IVertexBuffer> = new Array<IVertexBuffer>(8);\n\tpublic _pBufferContext:Array<IContextGL> = new Array<IContextGL>(8);\n\tpublic _pBufferDirty:Array<boolean> = new Array<boolean>(8);\n\n\tprivate _numVertices:number /*uint*/;\n\n\tprivate _totalLenOfOneVertex:number /*uint*/;\n\n\tpublic numProcessedVertices:number /*int*/ = 0;\n\n\tpublic previousTime:number = Number.NEGATIVE_INFINITY;\n\n\tpublic animationParticles:Array<ParticleAnimationData> = new Array<ParticleAnimationData>();\n\n\t/**\n\t * An id for this animation subgeometry, used to identify animation subgeometries when using animation sets.\n\t *\n\t * @private\n\t */\n\tpublic _iUniqueId:number;//Arcane\n\n\tconstructor()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\n\t\tthis._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;\n\t}\n\n\tpublic createVertexData(numVertices:number /*uint*/, totalLenOfOneVertex:number /*uint*/)\n\t{\n\t\tthis._numVertices = numVertices;\n\t\tthis._totalLenOfOneVertex = totalLenOfOneVertex;\n\t\tthis._pVertexData = new Array<number>(numVertices*totalLenOfOneVertex);\n\t}\n\n\tpublic activateVertexBuffer(index:number /*int*/, bufferOffset:number /*int*/, stage:Stage, format:string)\n\t{\n\t\tvar contextIndex:number /*int*/ = stage.stageIndex;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar buffer:IVertexBuffer = this._pVertexBuffer[contextIndex];\n\t\tif (!buffer || this._pBufferContext[contextIndex] != context) {\n\t\t\tbuffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex*4);\n\t\t\tthis._pBufferContext[contextIndex] = context;\n\t\t\tthis._pBufferDirty[contextIndex] = true;\n\t\t}\n\t\tif (this._pBufferDirty[contextIndex]) {\n\t\t\tbuffer.uploadFromArray(this._pVertexData, 0, this._numVertices);\n\t\t\tthis._pBufferDirty[contextIndex] = false;\n\t\t}\n\t\tcontext.setVertexBufferAt(index, buffer, bufferOffset*4, format);\n\t}\n\n\tpublic dispose()\n\t{\n\t\twhile (this._pVertexBuffer.length) {\n\t\t\tvar vertexBuffer:IVertexBuffer = this._pVertexBuffer.pop()\n\n\t\t\tif (vertexBuffer)\n\t\t\t\tvertexBuffer.dispose();\n\t\t}\n\t}\n\n\tpublic invalidateBuffer()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\t}\n\n\tpublic get vertexData():Array<number>\n\t{\n\t\treturn this._pVertexData;\n\t}\n\n\tpublic get numVertices():number /*uint*/\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get totalLenOfOneVertex():number /*uint*/\n\t{\n\t\treturn this._totalLenOfOneVertex;\n\t}\n}\n\nexport = AnimationSubGeometry;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\n\nclass ColorSegmentPoint\n{\n\tprivate _color:ColorTransform;\n\tprivate _life:number;\n\n\tconstructor(life:number, color:ColorTransform)\n\t{\n\t\t//0<life<1\n\t\tif (life <= 0 || life >= 1)\n\t\t\tthrow(new Error(\"life exceeds range (0,1)\"));\n\t\tthis._life = life;\n\t\tthis._color = color;\n\t}\n\n\tpublic get color():ColorTransform\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic get life():number\n\t{\n\t\treturn this._life;\n\t}\n\n}\n\nexport = ColorSegmentPoint;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n/**\n * Contains transformation data for a skeleton joint, used for skeleton animation.\n *\n * @see away.animation.Skeleton\n * @see away.animation.SkeletonJoint\n *\n * todo: support (uniform) scale\n */\nclass JointPose\n{\n\t/**\n\t * The name of the joint to which the pose is associated\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The rotation of the pose stored as a quaternion\n\t */\n\tpublic orientation:Quaternion = new Quaternion();\n\n\t/**\n\t * The translation of the pose\n\t */\n\tpublic translation:Vector3D = new Vector3D();\n\n\tconstructor()\n\t{\n\n\t}\n\n\t/**\n\t * Converts the transformation to a Matrix3D representation.\n\t *\n\t * @param target An optional target matrix to store the transformation. If not provided, it will create a new instance.\n\t * @return The transformation matrix of the pose.\n\t */\n\tpublic toMatrix3D(target:Matrix3D = null):Matrix3D\n\t{\n\t\tif (target == null)\n\t\t\ttarget = new Matrix3D();\n\n\t\tthis.orientation.toMatrix3D(target);\n\t\ttarget.appendTranslation(this.translation.x, this.translation.y, this.translation.z);\n\t\treturn target;\n\t}\n\n\t/**\n\t * Copies the transformation data from a source pose object into the existing pose object.\n\t *\n\t * @param pose The source pose to copy from.\n\t */\n\tpublic copyFrom(pose:JointPose)\n\t{\n\t\tvar or:Quaternion = pose.orientation;\n\t\tvar tr:Vector3D = pose.translation;\n\t\tthis.orientation.x = or.x;\n\t\tthis.orientation.y = or.y;\n\t\tthis.orientation.z = or.z;\n\t\tthis.orientation.w = or.w;\n\t\tthis.translation.x = tr.x;\n\t\tthis.translation.y = tr.y;\n\t\tthis.translation.z = tr.z;\n\t}\n}\n\nexport = JointPose;",
    "import ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * ...\n */\nclass ParticleAnimationData\n{\n\tpublic index:number /*uint*/;\n\tpublic startTime:number;\n\tpublic totalTime:number;\n\tpublic duration:number;\n\tpublic delay:number;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\n\tconstructor(index:number /*uint*/, startTime:number, duration:number, delay:number, particle:ParticleData)\n\t{\n\t\tthis.index = index;\n\t\tthis.startTime = startTime;\n\t\tthis.totalTime = duration + delay;\n\t\tthis.duration = duration;\n\t\tthis.delay = delay;\n\t\tthis.startVertexIndex = particle.startVertexIndex;\n\t\tthis.numVertices = particle.numVertices;\n\t}\n}\n\nexport = ParticleAnimationData;",
    "import TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nclass ParticleData\n{\n\tpublic particleIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic subGeometry:TriangleSubGeometry;\n}\n\nexport = ParticleData",
    "/**\n * Options for setting the properties mode of a particle animation node.\n */\nclass ParticlePropertiesMode\n{\n\t/**\n\t * Mode that defines the particle node as acting on global properties (ie. the properties set in the node constructor or the corresponding animation state).\n\t */\n\tpublic static GLOBAL:number /*uint*/ = 0;\n\n\t/**\n\t * Mode that defines the particle node as acting on local static properties (ie. the properties of particles set in the initialising on the animation set).\n\t */\n\tpublic static LOCAL_STATIC:number /*uint*/ = 1;\n\n\t/**\n\t * Mode that defines the particle node as acting on local dynamic properties (ie. the properties of the particles set in the corresponding animation state).\n\t */\n\tpublic static LOCAL_DYNAMIC:number /*uint*/ = 2;\n}\n\nexport = ParticlePropertiesMode;",
    "/**\n * Dynamic class for holding the local properties of a particle, used for processing the static properties\n * of particles in the particle animation set before beginning upload to the GPU.\n */\nclass ParticleProperties\n{\n\t/**\n\t * The index of the current particle being set.\n\t */\n\tpublic index:number /*uint*/;\n\n\t/**\n\t * The total number of particles being processed by the particle animation set.\n\t */\n\tpublic total:number /*uint*/;\n\n\t/**\n\t * The start time of the particle.\n\t */\n\tpublic startTime:number;\n\n\t/**\n\t * The duration of the particle, an optional value used when the particle aniamtion set settings for <code>useDuration</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic duration:number;\n\n\t/**\n\t * The delay between cycles of the particle, an optional value used when the particle aniamtion set settings for <code>useLooping</code> and  <code>useDelay</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic delay:number;\n}\n\nexport = ParticleProperties;",
    "/**\n * A value obect representing a single joint in a skeleton object.\n *\n * @see away.animators.Skeleton\n */\nclass SkeletonJoint\n{\n\t/**\n\t * The index of the parent joint in the skeleton's joints vector.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic parentIndex:number /*int*/ = -1;\n\n\t/**\n\t * The name of the joint\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The inverse bind pose matrix, as raw data, used to transform vertices to bind joint space in preparation for transformation using the joint matrix.\n\t */\n\tpublic inverseBindPose:Array<number>;\n\n\t/**\n\t * Creates a new <code>SkeletonJoint</code> object\n\t */\n\tconstructor()\n\t{\n\t}\n}\n\nexport = SkeletonJoint;",
    "import IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\n\n\n/**\n * A collection of pose objects, determining the pose for an entire skeleton.\n * The <code>jointPoses</code> vector object corresponds to a skeleton's <code>joints</code> vector object, however, there is no\n * reference to a skeleton's instance, since several skeletons can be influenced by the same pose (eg: animation\n * clips are added to any animator with a valid skeleton)\n *\n * @see away.animators.Skeleton\n * @see away.animators.JointPose\n */\nclass SkeletonPose extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset SkeletonPose]\";\n\n\t/**\n\t * A flat list of pose objects that comprise the skeleton pose. The pose indices correspond to the target skeleton's joint indices.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic jointPoses:Array<JointPose>;\n\n\t/**\n\t * The total number of joint poses in the skeleton pose.\n\t */\n\tpublic get numJointPoses():number /*uint*/\n\t{\n\t\treturn this.jointPoses.length;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonPose</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.jointPoses = new Array<JointPose>();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn SkeletonPose.assetType;\n\t}\n\n\t/**\n\t * Returns the joint pose object with the given joint name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object whose pose is to be found.\n\t * @return The pose object with the given joint name.\n\t */\n\tpublic jointPoseFromName(jointName:string):JointPose\n\t{\n\t\tvar jointPoseIndex:number /*int*/ = this.jointPoseIndexFromName(jointName);\n\t\tif (jointPoseIndex != -1)\n\t\t\treturn this.jointPoses[jointPoseIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the pose index, given the joint name. -1 is returned if the joint name is not found in the pose.\n\t *\n\t * @param The name of the joint object whose pose is to be found.\n\t * @return The index of the pose object in the jointPoses Array\n\t *\n\t * @see #jointPoses\n\t */\n\tpublic jointPoseIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access JointPoses,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointPoseIndex:number /*int*/;\n\t\tvar jointPose:JointPose;\n\t\tfor (var i:number /*uint*/; i < this.jointPoses.length; i++) {\n\t\t\tjointPose = this.jointPoses[i];\n\t\t\tif (jointPose.name == jointName)\n\t\t\t\treturn jointPoseIndex;\n\t\t\tjointPoseIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * Creates a copy of the <code>SkeletonPose</code> object, with a dulpicate of its component joint poses.\n\t *\n\t * @return SkeletonPose\n\t */\n\tpublic clone():SkeletonPose\n\t{\n\t\tvar clone:SkeletonPose = new SkeletonPose();\n\t\tvar numJointPoses:number /*uint*/ = this.jointPoses.length;\n\t\tfor (var i:number /*uint*/ = 0; i < numJointPoses; i++) {\n\t\t\tvar cloneJointPose:JointPose = new JointPose();\n\t\t\tvar thisJointPose:JointPose = this.jointPoses[i];\n\t\t\tcloneJointPose.name = thisJointPose.name;\n\t\t\tcloneJointPose.copyFrom(thisJointPose);\n\t\t\tclone.jointPoses[i] = cloneJointPose;\n\t\t}\n\t\treturn clone;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.jointPoses.length = 0;\n\t}\n}\n\nexport = SkeletonPose;",
    "import SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\n\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\n/**\n * A Skeleton object is a hierarchical grouping of joint objects that can be used for skeletal animation.\n *\n * @see away.animators.SkeletonJoint\n */\nclass Skeleton extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset Skeleton]\";\n\n\t/**\n\t * A flat list of joint objects that comprise the skeleton. Every joint except for the root has a parentIndex\n\t * property that is an index into this list.\n\t * A child joint should always have a higher index than its parent.\n\t */\n\tpublic joints:Array<SkeletonJoint>;\n\n\t/**\n\t * The total number of joints in the skeleton.\n\t */\n\tpublic get numJoints():number /*uint*/\n\t{\n\t\treturn this.joints.length;\n\t}\n\n\t/**\n\t * Creates a new <code>Skeleton</code> object\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\t// in the long run, it might be a better idea to not store Joint objects, but keep all data in Vectors, that we can upload easily?\n\t\tthis.joints = new Array<SkeletonJoint>();\n\t}\n\n\t/**\n\t * Returns the joint object in the skeleton with the given name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The joint object with the given name.\n\t *\n\t * @see #joints\n\t */\n\tpublic jointFromName(jointName:string):SkeletonJoint\n\t{\n\t\tvar jointIndex:number /*int*/ = this.jointIndexFromName(jointName);\n\t\tif (jointIndex != -1)\n\t\t\treturn this.joints[jointIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the joint index, given the joint name. -1 is returned if the joint name is not found.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The index of the joint object in the joints Array\n\t *\n\t * @see #joints\n\t */\n\tpublic jointIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access SkeletonJoints,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tfor (var i:number /*int*/; i < this.joints.length; i++) {\n\t\t\tjoint = this.joints[i];\n\t\t\tif (joint.name == jointName)\n\t\t\t\treturn jointIndex;\n\t\t\tjointIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.joints.length = 0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn Skeleton.assetType;\n\t}\n}\n\nexport = Skeleton;",
    "/**\n * Options for setting the animation mode of a vertex animator object.\n *\n * @see away.animators.VertexAnimator\n */\nclass VertexAnimationMode\n{\n\t/**\n\t * Animation mode that adds all outputs from active vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ADDITIVE:string = \"additive\";\n\n\t/**\n\t * Animation mode that picks the output from a single vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ABSOLUTE:string = \"absolute\";\n}\n\nexport = VertexAnimationMode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\n/**\n * Provides an abstract base class for nodes with time-based animation data in an animation blend tree.\n */\nclass AnimationClipNodeBase extends AnimationNodeBase\n{\n\tpublic _pLooping:boolean = true;\n\tpublic _pTotalDuration:number /*uint*/ = 0;\n\tpublic _pLastFrame:number /*uint*/;\n\n\tpublic _pStitchDirty:boolean = true;\n\tpublic _pStitchFinalFrame:boolean = false;\n\tpublic _pNumFrames:number /*uint*/ = 0;\n\n\tpublic _pDurations:Array<number> = new Array<number>();\n\t/*uint*/\n\tpublic _pTotalDelta:Vector3D = new Vector3D();\n\n\tpublic fixedFrameRate:boolean = true;\n\n\t/**\n\t * Determines whether the contents of the animation node have looping characteristics enabled.\n\t */\n\tpublic get looping():boolean\n\t{\n\t\treturn this._pLooping;\n\t}\n\n\tpublic set looping(value:boolean)\n\t{\n\t\tif (this._pLooping == value)\n\t\t\treturn;\n\n\t\tthis._pLooping = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * Defines if looping content blends the final frame of animation data with the first (true) or works on the\n\t * assumption that both first and last frames are identical (false). Defaults to false.\n\t */\n\tpublic get stitchFinalFrame():boolean\n\t{\n\t\treturn this._pStitchFinalFrame;\n\t}\n\n\tpublic set stitchFinalFrame(value:boolean)\n\t{\n\t\tif (this._pStitchFinalFrame == value)\n\t\t\treturn;\n\n\t\tthis._pStitchFinalFrame = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\tpublic get totalDuration():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDuration;\n\t}\n\n\tpublic get totalDelta():Vector3D\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDelta;\n\t}\n\n\tpublic get lastFrame():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pLastFrame;\n\t}\n\n\t/**\n\t * Returns a vector of time values representing the duration (in milliseconds) of each animation frame in the clip.\n\t */\n\tpublic get durations():Array<number> /*uint*/\n\t{\n\t\treturn this._pDurations;\n\t}\n\n\t/**\n\t * Creates a new <code>AnimationClipNodeBase</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Updates the node's final frame stitch state.\n\t *\n\t * @see #stitchFinalFrame\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tthis._pStitchDirty = false;\n\n\t\tthis._pLastFrame = (this._pStitchFinalFrame)? this._pNumFrames : this._pNumFrames - 1;\n\n\t\tthis._pTotalDuration = 0;\n\t\tthis._pTotalDelta.x = 0;\n\t\tthis._pTotalDelta.y = 0;\n\t\tthis._pTotalDelta.z = 0;\n\t}\n}\n\nexport = AnimationClipNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleAccelerationState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleAccelerationState\");\n\n/**\n * A particle animation node used to apply a constant acceleration vector to the motion of a particle.\n */\nclass ParticleAccelerationNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _acceleration:Vector3D;\n\n\t/**\n\t * Reference for acceleration node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of acceleration on the particle.\n\t */\n\tpublic static ACCELERATION_VECTOR3D:string = \"AccelerationVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleAccelerationNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] acceleration    Defines the default acceleration vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, acceleration:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleAcceleration\", mode, 3);\n\n\t\tthis._pStateClass = ParticleAccelerationState;\n\n\t\tthis._acceleration = acceleration || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pGetAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar accelerationValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleAccelerationState.ACCELERATION_INDEX, accelerationValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\n\t\tvar code:string = \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + accelerationValue + \"\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"mul \" + temp2 + \",\" + temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + temp2 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tcode += \"mul \" + temp + \",\" + temp + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + temp + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleAccelerationState\n\t{\n\t\treturn <ParticleAccelerationState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar tempAcceleration:Vector3D = param[ParticleAccelerationNode.ACCELERATION_VECTOR3D];\n\t\tif (!tempAcceleration)\n\t\t\tthrow new Error(\"there is no \" + ParticleAccelerationNode.ACCELERATION_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = tempAcceleration.x/2;\n\t\tthis._pOneData[1] = tempAcceleration.y/2;\n\t\tthis._pOneData[2] = tempAcceleration.z/2;\n\t}\n}\n\nexport = ParticleAccelerationNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBezierCurveState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState\");\n\n/**\n * A particle animation node used to control the position of a particle over time along a bezier curve.\n */\nclass ParticleBezierCurveNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iControlPoint:Vector3D;\n\t/** @private */\n\tpublic _iEndPoint:Vector3D;\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the control point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_CONTROL_VECTOR3D:string = \"BezierControlVector3D\";\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the end point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_END_VECTOR3D:string = \"BezierEndVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleBezierCurveNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] controlPoint    Defines the default control point of the node, used when in global mode.\n\t * @param    [optional] endPoint        Defines the default end point of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, controlPoint:Vector3D = null, endPoint:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBezierCurve\", mode, 6);\n\n\t\tthis._pStateClass = ParticleBezierCurveState;\n\n\t\tthis._iControlPoint = controlPoint || new Vector3D();\n\t\tthis._iEndPoint = endPoint || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar controlValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_CONTROL_INDEX, controlValue.index);\n\n\t\tvar endValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_END_INDEX, endValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar rev_time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar time_2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar time_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + rev_time + \",\" + animationRegisterCache.vertexOneConst + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\n\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexLife + \",\" + rev_time + \"\\n\";\n\t\tcode += \"mul \" + time_temp + \",\" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_temp + \",\" + controlValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_2 + \",\" + endValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sub \" + time_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + controlValue + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + endValue + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBezierCurveState\n\t{\n\t\treturn <ParticleBezierCurveState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar bezierControl:Vector3D = param[ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D];\n\t\tif (!bezierControl)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D + \" in param!\");\n\n\t\tvar bezierEnd:Vector3D = param[ParticleBezierCurveNode.BEZIER_END_VECTOR3D];\n\t\tif (!bezierEnd)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_END_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = bezierControl.x;\n\t\tthis._pOneData[1] = bezierControl.y;\n\t\tthis._pOneData[2] = bezierControl.z;\n\t\tthis._pOneData[3] = bezierEnd.x;\n\t\tthis._pOneData[4] = bezierEnd.y;\n\t\tthis._pOneData[5] = bezierEnd.z;\n\t}\n}\n\nexport = ParticleBezierCurveNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBillboardState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBillboardState\");\n\n/**\n * A particle animation node that controls the rotation of a particle to always face the camera.\n */\nclass ParticleBillboardNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iBillboardAxis:Vector3D;\n\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor(billboardAxis:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBillboard\", ParticlePropertiesMode.GLOBAL, 0, 4);\n\n\t\tthis._pStateClass = ParticleBillboardState;\n\n\t\tthis._iBillboardAxis = billboardAxis;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBillboardState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\tvar code:string = \"m33 \" + temp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\t  \"mov \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\tvar shaderRegisterElement:ShaderRegisterElement;\n\t\tfor (var i:number /*uint*/ = 0; i < animationRegisterCache.rotationRegisters.length; i++) {\n\t\t\tshaderRegisterElement = animationRegisterCache.rotationRegisters[i];\n\t\t\tcode += \"m33 \" + temp + \".xyz,\" + shaderRegisterElement + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\"mov \" + shaderRegisterElement + \".xyz,\" + shaderRegisterElement + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBillboardState\n\t{\n\t\treturn <ParticleBillboardState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasBillboard = true;\n\t}\n}\n\nexport = ParticleBillboardNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleColorState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleColorState\");\n\n/**\n * A particle animation node used to control the color variation of a particle over time.\n */\nclass ParticleColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the start color transform applied to the particle.\n\t */\n\tpublic static COLOR_START_COLORTRANSFORM:string = \"ColorStartColorTransform\";\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the end color transform applied to the particle.\n\t */\n\tpublic static COLOR_END_COLORTRANSFORM:string = \"ColorEndColorTransform\";\n\n\t/**\n\t * Creates a new <code>ParticleColorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesMultiplier  Defines whether the node uses multiplier data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesOffset      Defines whether the node uses offset data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] startColor      Defines the default start color transform of the node, when in global mode.\n\t * @param    [optional] endColor        Defines the default end color transform of the node, when in global mode.\n\t * @param    [optional] cycleDuration   Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, startColor:ColorTransform = null, endColor:ColorTransform = null, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleColor\", mode, (usesMultiplier && usesOffset)? 16 : 8, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iStartColor = startColor || new ColorTransform();\n\t\tthis._iEndColor = endColor || new ColorTransform();\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tif (this._iUsesCycle) {\n\t\t\t\tvar cycleConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.CYCLE_INDEX, cycleConst.index);\n\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\t\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + cycleConst + \".x\\n\";\n\n\t\t\t\tif (this._iUsesPhase)\n\t\t\t\t\tcode += \"add \" + sin + \",\" + sin + \",\" + cycleConst + \".y\\n\";\n\n\t\t\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar startMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tvar deltaMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_MULTIPLIER_INDEX, startMultiplierValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_MULTIPLIER_INDEX, deltaMultiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaMultiplierValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startMultiplierValue + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + temp + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar startOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tvar deltaOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_OFFSET_INDEX, deltaOffsetValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaOffsetValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startOffsetValue + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + temp + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleColorState\n\t{\n\t\treturn <ParticleColorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar startColor:ColorTransform = param[ParticleColorNode.COLOR_START_COLORTRANSFORM];\n\t\tif (!startColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_START_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar endColor:ColorTransform = param[ParticleColorNode.COLOR_END_COLORTRANSFORM];\n\t\tif (!endColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_END_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\tif (!this._iUsesCycle) {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.redMultiplier - startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.greenMultiplier - startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.blueMultiplier - startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.alphaMultiplier - startColor.alphaMultiplier;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = startColor.redOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.greenOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.blueOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaOffset/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.redOffset - startColor.redOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.greenOffset - startColor.greenOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.blueOffset - startColor.blueOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.alphaOffset - startColor.alphaOffset)/255;\n\t\t\t}\n\t\t} else {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier + endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier + endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier + endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier + endColor.alphaMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier - endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier - endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier - endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier - endColor.alphaMultiplier)/2;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset + endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset + endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset + endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset + endColor.alphaOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset - endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset - endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset - endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset - endColor.alphaOffset)/(255*2);\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nexport = ParticleColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleFollowState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleFollowState\");\n\n/**\n * A particle animation node used to create a follow behaviour on a particle system.\n */\nclass ParticleFollowNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesPosition:boolean;\n\n\t/** @private */\n\tpublic _iUsesRotation:boolean;\n\n\t/** @private */\n\tpublic _iSmooth:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleFollowNode</code>\n\t *\n\t * @param    [optional] usesPosition     Defines wehether the individual particle reacts to the position of the target.\n\t * @param    [optional] usesRotation     Defines wehether the individual particle reacts to the rotation of the target.\n\t * @param    [optional] smooth     Defines wehether the state calculate the interpolated value.\n\t */\n\tconstructor(usesPosition:boolean = true, usesRotation:boolean = true, smooth:boolean = false)\n\t{\n\t\tsuper(\"ParticleFollow\", ParticlePropertiesMode.LOCAL_DYNAMIC, (usesPosition && usesRotation)? 6 : 3, ParticleAnimationSet.POST_PRIORITY);\n\n\t\tthis._pStateClass = ParticleFollowState;\n\n\t\tthis._iUsesPosition = usesPosition;\n\t\tthis._iUsesRotation = usesRotation;\n\t\tthis._iSmooth = smooth;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//TODO: use Quaternion to implement this function\n\t\tvar code:string = \"\";\n\t\tif (this._iUsesRotation) {\n\t\t\tvar rotationAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_ROTATION_INDEX, rotationAttribute.index);\n\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar temp4:ShaderRegisterElement;\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp3, 1);\n\t\t\t\ttemp4 = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t}\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp3);\n\n\t\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\t\tvar i:number /*int*/;\n\n\t\t\t//x axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp3 + \".y,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"cos \" + temp3 + \".z,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".z\\n\";\n\t\t\tcode += \"neg \" + temp2 + \".z,\" + temp3 + \".y\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//y axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"cos \" + temp1 + \".x,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"sin \" + temp1 + \".z,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"neg \" + temp3 + \".x,\" + temp1 + \".z\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + temp1 + \".x\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp2 + \".x,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"cos \" + temp2 + \".y,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp2 + \".y\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp2 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tcode += \"sub \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\t} else {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._iUsesPosition) {\n\t\t\tvar positionAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_POSITION_INDEX, positionAttribute.index);\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + positionAttribute + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleFollowState\n\t{\n\t\treturn <ParticleFollowState> animator.getAnimationState(this);\n\t}\n}\n\nexport = ParticleFollowNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleInitialColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleInitialColorState\");\n\n/**\n *\n */\nclass ParticleInitialColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iInitialColor:ColorTransform;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the color transform applied to the particle.\n\t */\n\tpublic static COLOR_INITIAL_COLORTRANSFORM:string = \"ColorInitialColorTransform\";\n\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = false, initialColor:ColorTransform = null)\n\t{\n\t\tsuper(\"ParticleInitialColor\", mode, (usesMultiplier && usesOffset)? 8 : 4, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleInitialColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iInitialColor = initialColor || new ColorTransform();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar multiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.MULTIPLIER_INDEX, multiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + multiplierValue + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar offsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.OFFSET_INDEX, offsetValue.index);\n\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + offsetValue + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar initialColor:ColorTransform = param[ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM];\n\t\tif (!initialColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\t//multiplier\n\t\tif (this._iUsesMultiplier) {\n\t\t\tthis._pOneData[i++] = initialColor.redMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.greenMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.blueMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.alphaMultiplier;\n\t\t}\n\t\t//offset\n\t\tif (this._iUsesOffset) {\n\t\t\tthis._pOneData[i++] = initialColor.redOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.greenOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.blueOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.alphaOffset/255;\n\t\t}\n\n\t}\n\n}\n\nexport = ParticleInitialColorNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\n\n/**\n * Provides an abstract base class for particle animation nodes.\n */\nclass ParticleNodeBase extends AnimationNodeBase\n{\n\tprivate _priority:number /*int*/;\n\n\tpublic _pMode:number /*uint*/;\n\tpublic _pDataLength:number /*uint*/ = 3;\n\tpublic _pOneData:Array<number>;\n\n\tpublic _iDataOffset:number /*uint*/;\n\n\t//modes alias\n\tprivate static GLOBAL:string = 'Global';\n\tprivate static LOCAL_STATIC:string = 'LocalStatic';\n\tprivate static LOCAL_DYNAMIC:string = 'LocalDynamic';\n\n\t//modes list\n\tprivate static MODES:Object =\n\t{\n\t\t0:ParticleNodeBase.GLOBAL,\n\t\t1:ParticleNodeBase.LOCAL_STATIC,\n\t\t2:ParticleNodeBase.LOCAL_DYNAMIC\n\t};\n\n\t/**\n\t * Returns the property mode of the particle animation node. Typically set in the node constructor\n\t *\n\t * @see away.animators.ParticlePropertiesMode\n\t */\n\tpublic get mode():number /*uint*/\n\t{\n\t\treturn this._pMode;\n\t}\n\n\t/**\n\t * Returns the priority of the particle animation node, used to order the agal generated in a particle animation set. Set automatically on instantiation.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get priority():number /*int*/\n\t{\n\t\treturn this._priority;\n\t}\n\n\t/**\n\t * Returns the length of the data used by the node when in <code>LOCAL_STATIC</code> mode. Used to generate the local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get dataLength():number /*int*/\n\t{\n\t\treturn this._pDataLength;\n\t}\n\n\t/**\n\t * Returns the generated data vector of the node after one particle pass during the generation of all local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #generatePropertyOfOneParticle\n\t */\n\tpublic get oneData():Array<number>\n\t{\n\t\treturn this._pOneData;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleNodeBase</code> object.\n\t *\n\t * @param               name            Defines the generic name of the particle animation node.\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param               dataLength      Defines the length of the data used by the node when in <code>LOCAL_STATIC</code> mode.\n\t * @param    [optional] priority        the priority of the particle animation node, used to order the agal generated in a particle animation set. Defaults to 1.\n\t */\n\tconstructor(name:string, mode:number /*uint*/, dataLength:number /*uint*/, priority:number /*int*/ = 1)\n\t{\n\t\tsuper();\n\n\t\tname = name + ParticleNodeBase.MODES[mode];\n\n\t\tthis.name = name;\n\t\tthis._pMode = mode;\n\t\tthis._priority = priority;\n\t\tthis._pDataLength = dataLength;\n\n\t\tthis._pOneData = new Array<number>(this._pDataLength);\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the vertex shader.\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader.\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader when UV coordinates are required.\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when assigning the set of static properties originally defined by the initParticleFunc of the set.\n\t *\n\t * @see away.animators.ParticleAnimationSet#initParticleFunc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when determining the requirements of the particle animation node AGAL.\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\n\t}\n}\n\nexport = ParticleNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOrbitState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOrbitState\");\n\n/**\n * A particle animation node used to control the position of a particle over time around a circular orbit.\n */\nclass ParticleOrbitNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesEulers:boolean;\n\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iRadius:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\t/** @private */\n\tpublic _iEulers:Vector3D;\n\n\t/**\n\t * Reference for orbit node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the radius (x), cycle speed (y) and cycle phase (z) of the motion on the particle.\n\t */\n\tpublic static ORBIT_VECTOR3D:string = \"OrbitVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOrbitNode</code> object.\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesEulers      Defines whether the node uses the <code>eulers</code> property in the shader to calculate a rotation on the orbit. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the orbit independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] radius          Defines the radius of the orbit when in global mode. Defaults to 100.\n\t * @param    [optional] cycleDuration   Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t * @param    [optional] eulers          Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, usesEulers:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, radius:number = 100, cycleDuration:number = 1, cyclePhase:number = 0, eulers:Vector3D = null)\n\t{\n\t\tvar len:number /*int*/ = 3;\n\t\tif (usesPhase)\n\t\t\tlen++;\n\t\tsuper(\"ParticleOrbit\", mode, len);\n\n\t\tthis._pStateClass = ParticleOrbitState;\n\n\t\tthis._iUsesEulers = usesEulers;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iRadius = radius;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iEulers = eulers || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar orbitRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.ORBIT_INDEX, orbitRegister.index);\n\n\t\tvar eulersMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.EULERS_INDEX, eulersMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp1.regName, temp1.index);\n\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 1);\n\t\tvar degree:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 2);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\n\t\tvar code:string = \"\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexTime + \",\" + orbitRegister + \".y\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + degree + \",\" + degree + \",\" + orbitRegister + \".w\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexLife + \",\" + orbitRegister + \".y\\n\";\n\n\t\tcode += \"cos \" + cos + \",\" + degree + \"\\n\";\n\t\tcode += \"sin \" + sin + \",\" + degree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".x,\" + cos + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mul \" + distance + \".y,\" + sin + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mov \" + distance + \".wz\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tif (this._iUsesEulers)\n\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"neg \" + distance + \".x,\" + sin + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".y,\" + cos + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".zw,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tif (this._iUsesEulers)\n\t\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \",\" + distance + \",\" + orbitRegister + \".z\\n\";\n\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + orbitRegister + \".y\\n\";\n\t\t\tif (!this._iUsesCycle)\n\t\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOrbitState\n\t{\n\t\treturn <ParticleOrbitState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//Vector3D.x is radius, Vector3D.y is cycle duration, Vector3D.z is phase\n\t\tvar orbit:Vector3D = param[ParticleOrbitNode.ORBIT_VECTOR3D];\n\t\tif (!orbit)\n\t\t\tthrow new Error(\"there is no \" + ParticleOrbitNode.ORBIT_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = orbit.x;\n\t\tif (this._iUsesCycle && orbit.y <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\tthis._pOneData[1] = Math.PI*2/(!this._iUsesCycle? 1 : orbit.y);\n\t\tthis._pOneData[2] = orbit.x*Math.PI*2;\n\t\tif (this._iUsesPhase)\n\t\t\tthis._pOneData[3] = orbit.z*Math.PI/180;\n\t}\n}\n\nexport = ParticleOrbitNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOscillatorState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOscillatorState\");\n\n/**\n * A particle animation node used to control the position of a particle over time using simple harmonic motion.\n */\nclass ParticleOscillatorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iOscillator:Vector3D;\n\n\t/**\n\t * Reference for ocsillator node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the axis (x,y,z) and cycle speed (w) of the motion on the particle.\n\t */\n\tpublic static OSCILLATOR_VECTOR3D:string = \"OscillatorVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOscillatorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] oscillator      Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, oscillator:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleOscillator\", mode, 4);\n\n\t\tthis._pStateClass = ParticleOscillatorState;\n\n\t\tthis._iOscillator = oscillator || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar oscillatorRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOscillatorState.OSCILLATOR_INDEX, oscillatorRegister.index);\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar dgree:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + dgree + \",\" + animationRegisterCache.vertexTime + \",\" + oscillatorRegister + \".w\\n\";\n\t\tcode += \"sin \" + sin + \",\" + dgree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + sin + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"cos \" + cos + \",\" + dgree + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + cos + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOscillatorState\n\t{\n\t\treturn <ParticleOscillatorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3D.x,Vector3D.y,Vector3D.z) is oscillator axis, Vector3D.w is oscillator cycle duration\n\t\tvar drift:Vector3D = param[ParticleOscillatorNode.OSCILLATOR_VECTOR3D];\n\t\tif (!drift)\n\t\t\tthrow(new Error(\"there is no \" + ParticleOscillatorNode.OSCILLATOR_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = drift.x;\n\t\tthis._pOneData[1] = drift.y;\n\t\tthis._pOneData[2] = drift.z;\n\t\tif (drift.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\tthis._pOneData[3] = Math.PI*2/drift.w;\n\t}\n}\n\nexport = ParticleOscillatorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticlePositionState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticlePositionState\");\n\n/**\n * A particle animation node used to set the starting position of a particle.\n */\nclass ParticlePositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for position node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing position of the particle.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"PositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticlePositionNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] position        Defines the default position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticlePosition\", mode, 3);\n\n\t\tthis._pStateClass = ParticlePositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticlePositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\treturn \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticlePositionState\n\t{\n\t\treturn <ParticlePositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticlePositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticlePositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticlePositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to match its heading vector.\n */\nclass ParticleRotateToHeadingNode extends ParticleNodeBase\n{\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor()\n\t{\n\t\tsuper(\"ParticleRotateToHeading\", ParticlePropertiesMode.GLOBAL, 0, 3);\n\n\t\tthis._pStateClass = ParticleRotateToHeadingState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToHeadingState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the velocity\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\t\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(R.regName, R.index, 3);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\t\t\tvar cos2:ShaderRegisterElement = new ShaderRegisterElement(nrmVel.regName, nrmVel.index, 3);\n\t\t\tvar tempSingle:ShaderRegisterElement = sin;\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t//use R as temp to judge if nrm is (0,0,0).\n\t\t\t//if nrm is (0,0,0) ,change it to (0,0,1).\n\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\n\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t\t//use cos as R_rev.w\n\n\t\t\t//nrmVel and xAxis are used as temp register\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t//code += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" +R_rev + \".w\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\t\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToHeadingState\n\t{\n\t\treturn <ParticleRotateToHeadingState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.needVelocity = true;\n\t}\n}\n\nexport = ParticleRotateToHeadingNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToPositionState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to face to a position\n */\nclass ParticleRotateToPositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for the position the particle will rotate to face for a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the position that the particle must face.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"RotateToPositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotateToPositionNode</code>\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotateToPosition\", mode, 3, 3);\n\n\t\tthis._pStateClass = ParticleRotateToPositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the position\n\t\t\tcode += \"sub \" + temp1 + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + temp1 + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmDirection:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmDirection, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\t\tvar o_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\t\tvar tempSingle:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmDirection);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\n\t\t\t//judgu if nrmDirection=(0,1,0);\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\n\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\t\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t}\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToPositionState\n\t{\n\t\treturn <ParticleRotateToPositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticleRotateToPositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotateToPositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticleRotateToPositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotationalVelocityState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState\");\n\n/**\n * A particle animation node used to set the starting rotational velocity of a particle.\n */\nclass ParticleRotationalVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iRotationalVelocity:Vector3D;\n\n\t/**\n\t * Reference for rotational velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the rotational velocity around an axis of the particle.\n\t */\n\tpublic static ROTATIONALVELOCITY_VECTOR3D:string = \"RotationalVelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotationalVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t */\n\tconstructor(mode:number /*uint*/, rotationalVelocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotationalVelocity\", mode, 4);\n\n\t\tthis._pStateClass = ParticleRotationalVelocityState;\n\n\t\tthis._iRotationalVelocity = rotationalVelocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX, rotationRegister.index);\n\n\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar Rtemp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index);\n\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tR_rev = new ShaderRegisterElement(R_rev.regName, R_rev.index);\n\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(Rtemp.regName, Rtemp.index, 3);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\n\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\n\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\n\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//nrmVel and xAxis are used as temp register\n\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//use cos as R_rev.w\n\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tfor (var i:number /*int*/ = 0; i < len; i++) {\n\t\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\t\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \",\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotationalVelocityState\n\t{\n\t\treturn <ParticleRotationalVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3d.x,Vector3d.y,Vector3d.z) is rotation axis,Vector3d.w is cycle duration\n\t\tvar rotate:Vector3D = param[ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D];\n\t\tif (!rotate)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D + \" in param!\"));\n\n\t\tif (rotate.length <= 0)\n\t\t\trotate.z = 1; //set the default direction\n\t\telse\n\t\t\trotate.normalize();\n\n\t\tthis._pOneData[0] = rotate.x;\n\t\tthis._pOneData[1] = rotate.y;\n\t\tthis._pOneData[2] = rotate.z;\n\t\tif (rotate.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t// it's used as angle/2 in agal\n\t\tthis._pOneData[3] = Math.PI/rotate.w;\n\t}\n}\n\nexport = ParticleRotationalVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleScaleState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleScaleState\");\n\n/**\n * A particle animation node used to control the scale variation of a particle over time.\n */\nclass ParticleScaleNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iMinScale:number;\n\t/** @private */\n\tpublic _iMaxScale:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for scale node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the min scale (x), max scale(y), optional cycle speed (z) and phase offset (w) applied to the particle.\n\t */\n\tpublic static SCALE_VECTOR3D:string = \"ScaleVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleScaleNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the animation cycle. Defaults to false.\n\t * @param    [optional] minScale        Defines the default min scale transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] maxScale        Defines the default max color transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, minScale:number = 1, maxScale:number = 1, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleScale\", mode, (usesCycle && usesPhase)? 4 : ((usesCycle || usesPhase)? 3 : 2), 3);\n\n\t\tthis._pStateClass = ParticleScaleState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iMinScale = minScale;\n\t\tthis._iMaxScale = maxScale;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tvar scaleRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleScaleState.SCALE_INDEX, scaleRegister.index);\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + scaleRegister + \".z\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + scaleRegister + \".w\\n\";\n\n\t\t\tcode += \"sin \" + temp + \",\" + temp + \"\\n\";\n\t\t}\n\n\t\tcode += \"mul \" + temp + \",\" + scaleRegister + \".y,\" + ((this._iUsesCycle)? temp : animationRegisterCache.vertexLife) + \"\\n\";\n\t\tcode += \"add \" + temp + \",\" + scaleRegister + \".x,\" + temp + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleScaleState\n\t{\n\t\treturn <ParticleScaleState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar scale:Vector3D = param[ParticleScaleNode.SCALE_VECTOR3D];\n\t\tif (!scale)\n\t\t\tthrow(new Error(\"there is no \" + ParticleScaleNode.SCALE_VECTOR3D + \" in param!\"));\n\n\t\tif (this._iUsesCycle) {\n\t\t\tthis._pOneData[0] = (scale.x + scale.y)/2;\n\t\t\tthis._pOneData[1] = Math.abs(scale.x - scale.y)/2;\n\t\t\tif (scale.z <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._pOneData[2] = Math.PI*2/scale.z;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[3] = scale.w*Math.PI/180;\n\t\t} else {\n\t\t\tthis._pOneData[0] = scale.x;\n\t\t\tthis._pOneData[1] = scale.y - scale.x;\n\t\t}\n\t}\n}\n\nexport = ParticleScaleNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSegmentedColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState\");\n\n/**\n *\n */\nclass ParticleSegmentedColorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iNumSegmentPoint:number /*int*/;\n\t/** @private */\n\tpublic _iSegmentPoints:Array<ColorSegmentPoint>;\n\n\tconstructor(usesMultiplier:boolean, usesOffset:boolean, numSegmentPoint:number /*int*/, startColor:ColorTransform, endColor:ColorTransform, segmentPoints:Array<ColorSegmentPoint>)\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleSegmentedColor\", ParticlePropertiesMode.GLOBAL, 0, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleSegmentedColorState;\n\n\t\tif (numSegmentPoint > 4)\n\t\t\tthrow(new Error(\"the numSegmentPoint must be less or equal 4\"));\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iNumSegmentPoint = numSegmentPoint;\n\t\tthis._iStartColor = startColor;\n\t\tthis._iEndColor = endColor;\n\t\tthis._iSegmentPoints = segmentPoints;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar accMultiplierColor:ShaderRegisterElement;\n\t\t\t//var accOffsetColor:ShaderRegisterElement;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\taccMultiplierColor = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(accMultiplierColor, 1);\n\t\t\t}\n\n\t\t\tvar tempColor:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(tempColor, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar accTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar tempTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(accMultiplierColor);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(tempColor);\n\n\t\t\t//for saving all the life values (at most 4)\n\t\t\tvar lifeTimeRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.TIME_DATA_INDEX, lifeTimeRegister.index);\n\n\t\t\tvar i:number /*int*/;\n\n\t\t\tvar startMulValue:ShaderRegisterElement;\n\t\t\tvar deltaMulValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tstartMulValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_MULTIPLIER_INDEX, startMulValue.index);\n\t\t\t\tdeltaMulValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaMulValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tvar startOffsetValue:ShaderRegisterElement;\n\t\t\tvar deltaOffsetValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tstartOffsetValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tdeltaOffsetValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaOffsetValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tcode += \"mov \" + accMultiplierColor + \",\" + startMulValue + \"\\n\";\n\t\t\tif (this._iUsesOffset)\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + startOffsetValue + \"\\n\";\n\n\t\t\tfor (i = 0; i < this._iNumSegmentPoint; i++) {\n\t\t\t\tswitch (i) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t\tif (this._iUsesOffset) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//for the last segment:\n\t\t\tif (this._iNumSegmentPoint == 0)\n\t\t\t\ttempTime = animationRegisterCache.vertexLife;\n\t\t\telse {\n\t\t\t\tswitch (this._iNumSegmentPoint) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + animationRegisterCache.colorMulTarget + \",\" + accMultiplierColor + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n}\n\nexport = ParticleSegmentedColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSpriteSheetState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState\");\n\n/**\n * A particle animation node used when a spritesheet texture is required to animate the particle.\n * NB: to enable use of this node, the <code>repeat</code> property on the material has to be set to true.\n */\nclass ParticleSpriteSheetNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iTotalFrames:number /*int*/;\n\t/** @private */\n\tpublic _iNumColumns:number /*int*/;\n\t/** @private */\n\tpublic _iNumRows:number /*int*/;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for spritesheet node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the cycleDuration (x), optional phaseTime (y).\n\t */\n\tpublic static UV_VECTOR3D:string = \"UVVector3D\";\n\n\t/**\n\t * Defines the number of columns in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numColumns():number\n\t{\n\t\treturn this._iNumColumns;\n\t}\n\n\t/**\n\t * Defines the number of rows in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numRows():number\n\t{\n\t\treturn this._iNumRows;\n\t}\n\n\t/**\n\t * Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows. Read only.\n\t */\n\tpublic get totalFrames():number\n\t{\n\t\treturn this._iTotalFrames;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleSpriteSheetNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] numColumns      Defines the number of columns in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] numRows         Defines the number of rows in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default cycle duration in seconds, when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default cycle phase, when in global mode. Defaults to 0.\n\t * @param    [optional] totalFrames     Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows.\n\t * @param    [optional] looping         Defines whether the spritesheet animation is set to loop indefinitely. Defaults to true.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, numColumns:number /*int*/ = 1, numRows:number /*uint*/ = 1, cycleDuration:number = 1, cyclePhase:number = 0, totalFrames:number /*uint*/ = Number.MAX_VALUE)\n\t{\n\t\tsuper(\"ParticleSpriteSheet\", mode, usesCycle? (usesPhase? 3 : 2) : 1, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleSpriteSheetState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iNumColumns = numColumns;\n\t\tthis._iNumRows = numRows;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iTotalFrames = Math.min(totalFrames, numColumns*numRows);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//get 2 vc\n\t\tvar uvParamConst1:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tvar uvParamConst2:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_0, uvParamConst1.index);\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_1, uvParamConst2.index);\n\n\t\tvar uTotal:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 0);\n\t\tvar uStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 1);\n\t\tvar vStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 2);\n\n\t\tvar uSpeed:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 0);\n\t\tvar cycle:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 1);\n\t\tvar phaseTime:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 2);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar vOffset:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\ttemp = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tvar temp2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\tvar u:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 0);\n\t\tvar v:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 1);\n\n\t\tvar code:string = \"\";\n\t\t//scale uv\n\t\tcode += \"mul \" + u + \",\" + u + \",\" + uStep + \"\\n\";\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"mul \" + v + \",\" + v + \",\" + vStep + \"\\n\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + time + \",\" + animationRegisterCache.vertexTime + \",\" + phaseTime + \"\\n\";\n\t\t\telse\n\t\t\t\tcode += \"mov \" + time + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\tcode += \"div \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"frc \" + time + \",\" + time + \"\\n\";\n\t\t\tcode += \"mul \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"mul \" + temp + \",\" + time + \",\" + uSpeed + \"\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + temp.toString() + \",\" + animationRegisterCache.vertexLife + \",\" + uTotal + \"\\n\";\n\n\t\tif (this._iNumRows > 1) {\n\t\t\tcode += \"frc \" + temp2 + \",\" + temp + \"\\n\";\n\t\t\tcode += \"sub \" + vOffset + \",\" + temp + \",\" + temp2 + \"\\n\";\n\t\t\tcode += \"mul \" + vOffset + \",\" + vOffset + \",\" + vStep + \"\\n\";\n\t\t\tcode += \"add \" + v + \",\" + v + \",\" + vOffset + \"\\n\";\n\t\t}\n\n\t\tcode += \"div \" + temp2 + \",\" + temp + \",\" + uStep + \"\\n\";\n\t\tcode += \"frc \" + temp + \",\" + temp2 + \"\\n\";\n\t\tcode += \"sub \" + temp2 + \",\" + temp2 + \",\" + temp + \"\\n\";\n\t\tcode += \"mul \" + temp + \",\" + temp2 + \",\" + uStep + \"\\n\";\n\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"frc \" + temp + \",\" + temp + \"\\n\";\n\t\tcode += \"add \" + u + \",\" + u + \",\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleSpriteSheetState\n\t{\n\t\treturn <ParticleSpriteSheetState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tif (this._iUsesCycle) {\n\t\t\tvar uvCycle:Vector3D = param[ParticleSpriteSheetNode.UV_VECTOR3D];\n\t\t\tif (!uvCycle)\n\t\t\t\tthrow(new Error(\"there is no \" + ParticleSpriteSheetNode.UV_VECTOR3D + \" in param!\"));\n\t\t\tif (uvCycle.x <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tvar uTotal:number = this._iTotalFrames/this._iNumColumns;\n\t\t\tthis._pOneData[0] = uTotal/uvCycle.x;\n\t\t\tthis._pOneData[1] = uvCycle.x;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[2] = uvCycle.y;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleTimeState\");\n\n/**\n * A particle animation node used as the base node for timekeeping inside a particle. Automatically added to a particle animation set on instatiation.\n */\nclass ParticleTimeNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesDuration:boolean;\n\t/** @private */\n\tpublic _iUsesDelay:boolean;\n\t/** @private */\n\tpublic _iUsesLooping:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the node uses the <code>duration</code> data in the static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesDelay       Defines whether the node uses the <code>delay</code> data in the static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesLooping     Defines whether the node creates a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in the static properties function. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tthis._pStateClass = ParticleTimeState;\n\n\t\tthis._iUsesDuration = usesDuration;\n\t\tthis._iUsesLooping = usesLooping;\n\t\tthis._iUsesDelay = usesDelay;\n\n\t\tsuper(\"ParticleTime\", ParticlePropertiesMode.LOCAL_STATIC, 4, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar timeStreamRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute(); //timeStreamRegister.x is start，timeStreamRegister.y is during time\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_STREAM_INDEX, timeStreamRegister.index);\n\t\tvar timeConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_CONSTANT_INDEX, timeConst.index);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + animationRegisterCache.vertexTime + \",\" + timeConst + \",\" + timeStreamRegister + \".x\\n\";\n\t\t//if time=0,set the position to zero.\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\tcode += \"sge \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\t\tif (this._iUsesDuration) {\n\t\t\tif (this._iUsesLooping) {\n\t\t\t\tvar div:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tif (this._iUsesDelay) {\n\t\t\t\t\tcode += \"div \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"slt \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + div + \"\\n\";\n\t\t\t\t} else {\n\t\t\t\t\tcode += \"mul \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar sge:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tcode += \"sge \" + sge + \",\" + timeStreamRegister + \".y,\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + sge + \"\\n\";\n\t\t\t}\n\t\t}\n\t\tcode += \"mul \" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleTimeState\n\t{\n\t\treturn <ParticleTimeState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tthis._pOneData[0] = param.startTime;\n\t\tthis._pOneData[1] = param.duration;\n\t\tthis._pOneData[2] = param.delay + param.duration;\n\t\tthis._pOneData[3] = 1/param.duration;\n\n\t}\n}\n\nexport = ParticleTimeNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleUVState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleUVState\");\n\n/**\n * A particle animation node used to control the UV offset and scale of a particle over time.\n */\nclass ParticleUVNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUvData:Vector3D;\n\n\t/**\n\t *\n\t */\n\tpublic static U_AXIS:string = \"x\";\n\n\t/**\n\t *\n\t */\n\tpublic static V_AXIS:string = \"y\";\n\n\tprivate _cycle:number;\n\tprivate _scale:number;\n\tprivate _axis:string;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] cycle           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] scale           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] axis            Defines whether the time track is in loop mode. Defaults to false.\n\t */\n\tconstructor(mode:number /*uint*/, cycle:number = 1, scale:number = 1, axis:string = \"x\")\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleUV\", ParticlePropertiesMode.GLOBAL, 4, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleUVState;\n\n\t\tthis._cycle = cycle;\n\t\tthis._scale = scale;\n\t\tthis._axis = axis;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get cycle():number\n\t{\n\t\treturn this._cycle;\n\t}\n\n\tpublic set cycle(value:number)\n\t{\n\t\tthis._cycle = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scale():number\n\t{\n\t\treturn this._scale;\n\t}\n\n\tpublic set scale(value:number)\n\t{\n\t\tthis._scale = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get axis():string\n\t{\n\t\treturn this._axis;\n\t}\n\n\tpublic set axis(value:string)\n\t{\n\t\tthis._axis = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tvar uvConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleUVState.UV_INDEX, uvConst.index);\n\n\t\tvar axisIndex:number = this._axis == \"x\"? 0 : (this._axis == \"y\"? 1 : 2);\n\n\t\tvar target:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, axisIndex);\n\n\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tif (this._scale != 1)\n\t\t\tcode += \"mul \" + target + \",\" + target + \",\" + uvConst + \".y\\n\";\n\n\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + uvConst + \".x\\n\";\n\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\tcode += \"add \" + target + \",\" + target + \",\" + sin + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleUVState\n\t{\n\t\treturn <ParticleUVState> animator.getAnimationState(this);\n\t}\n\n\tprivate updateUVData()\n\t{\n\t\tthis._iUvData = new Vector3D(Math.PI*2/this._cycle, this._scale, 0, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n}\n\nexport = ParticleUVNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleVelocityState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleVelocityState\");\n\n/**\n * A particle animation node used to set the starting velocity of a particle.\n */\nclass ParticleVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iVelocity:Vector3D;\n\n\t/**\n\t * Reference for velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of movement on the particle.\n\t */\n\tpublic static VELOCITY_VECTOR3D:string = \"VelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] velocity        Defines the default velocity vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, velocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleVelocity\", mode, 3);\n\n\t\tthis._pStateClass = ParticleVelocityState;\n\n\t\tthis._iVelocity = velocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar velocityValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleVelocityState.VELOCITY_INDEX, velocityValue.index);\n\n\t\tvar distance:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + distance + \",\" + animationRegisterCache.vertexTime + \",\" + velocityValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity)\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + velocityValue + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleVelocityState\n\t{\n\t\treturn <ParticleVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar _tempVelocity:Vector3D = param[ParticleVelocityNode.VELOCITY_VECTOR3D];\n\t\tif (!_tempVelocity)\n\t\t\tthrow new Error(\"there is no \" + ParticleVelocityNode.VELOCITY_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = _tempVelocity.x;\n\t\tthis._pOneData[1] = _tempVelocity.y;\n\t\tthis._pOneData[2] = _tempVelocity.z;\n\t}\n}\n\nexport = ParticleVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonBinaryLERPNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines input node A to use for the blended output.\n\t */\n\tpublic inputA:AnimationNodeBase;\n\n\t/**\n\t * Defines input node B to use for the blended output.\n\t */\n\tpublic inputB:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonBinaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonBinaryLERPState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonBinaryLERPState\n\t{\n\t\treturn <SkeletonBinaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonBinaryLERPNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport SkeletonClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonClipState\");\n\n/**\n * A skeleton animation node containing time-based animation data as individual skeleton poses.\n */\nclass SkeletonClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<SkeletonPose> = new Array<SkeletonPose>();\n\n\t/**\n\t * Determines whether to use SLERP equations (true) or LERP equations (false) in the calculation\n\t * of the output skeleton pose. Defaults to false.\n\t */\n\tpublic highQuality:boolean = false;\n\n\t/**\n\t * Returns a vector of skeleton poses representing the pose of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<SkeletonPose>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonClipState;\n\t}\n\n\t/**\n\t * Adds a skeleton pose frame to the internal timeline of the animation node.\n\t *\n\t * @param skeletonPose The skeleton pose object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t */\n\tpublic addFrame(skeletonPose:SkeletonPose, duration:number /*number /*uint*/)\n\t{\n\t\tthis._frames.push(skeletonPose);\n\t\tthis._pDurations.push(duration);\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonClipState\n\t{\n\t\treturn <SkeletonClipState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._frames[i].jointPoses[0].translation;\n\t\t\tp2 = this._frames[i + 1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pStitchFinalFrame || !this._pLooping) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonClipNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDifferenceState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState\");\n\n/**\n * A skeleton animation node that uses a difference input pose with a base input pose to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDifferenceNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines a base input node to use for the blended output.\n\t */\n\tpublic baseInput:AnimationNodeBase;\n\n\t/**\n\t * Defines a difference input node to use for the blended output.\n\t */\n\tpublic differenceInput:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonAdditiveNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDifferenceState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDifferenceState\n\t{\n\t\treturn <SkeletonDifferenceState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonDifferenceNode",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDirectionalState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState\");\n\n/**\n * A skeleton animation node that uses four directional input poses with an input direction to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDirectionalNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines the forward configured input node to use for the blended output.\n\t */\n\tpublic forward:AnimationNodeBase;\n\n\t/**\n\t * Defines the backwards configured input node to use for the blended output.\n\t */\n\tpublic backward:AnimationNodeBase;\n\n\t/**\n\t * Defines the left configured input node to use for the blended output.\n\t */\n\tpublic left:AnimationNodeBase;\n\n\t/**\n\t * Defines the right configured input node to use for the blended output.\n\t */\n\tpublic right:AnimationNodeBase;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDirectionalState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDirectionalState\n\t{\n\t\treturn <SkeletonDirectionalState> animator.getAnimationState(this);\n\t}\n\n}\n\nexport = SkeletonDirectionalNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonNaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState\");\n\n/**\n * A skeleton animation node that uses an n-dimensional array of animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonNaryLERPNode extends AnimationNodeBase\n{\n\tpublic _iInputs:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\n\tprivate _numInputs:number /*uint*/;\n\n\tpublic get numInputs():number /*uint*/\n\t{\n\t\treturn this._numInputs;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonNaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonNaryLERPState;\n\t}\n\n\t/**\n\t * Returns an integer representing the input index of the given skeleton animation node.\n\t *\n\t * @param input The skeleton animation node for with the input index is requested.\n\t */\n\tpublic getInputIndex(input:AnimationNodeBase):number /*int*/\n\t{\n\t\treturn this._iInputs.indexOf(input);\n\t}\n\n\t/**\n\t * Returns the skeleton animation node object that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node is requested.\n\t */\n\tpublic getInputAt(index:number /*uint*/):AnimationNodeBase\n\t{\n\t\treturn this._iInputs[index];\n\t}\n\n\t/**\n\t * Adds a new skeleton animation node input to the animation node.\n\t */\n\tpublic addInput(input:AnimationNodeBase)\n\t{\n\t\tthis._iInputs[this._numInputs++] = input;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonNaryLERPState\n\t{\n\t\treturn <SkeletonNaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonNaryLERPNode",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport VertexClipState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/VertexClipState\");\n\n/**\n * A vertex animation node containing time-based animation data as individual geometry obejcts.\n */\nclass VertexClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<Geometry> = new Array<Geometry>();\n\tprivate _translations:Array<Vector3D> = new Array<Vector3D>();\n\n\t/**\n\t * Returns a vector of geometry frames representing the vertex values of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<Geometry>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>VertexClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = VertexClipState;\n\t}\n\n\t/**\n\t * Adds a geometry object to the internal timeline of the animation node.\n\t *\n\t * @param geometry The geometry object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t * @param translation The absolute translation of the frame, used in root delta calculations for mesh movement.\n\t */\n\tpublic addFrame(geometry:Geometry, duration:number /*uint*/, translation:Vector3D = null)\n\t{\n\t\tthis._frames.push(geometry);\n\t\tthis._pDurations.push(duration);\n\t\tthis._translations.push(translation || new Vector3D());\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._translations[i];\n\t\t\tp2 = this._translations[i + 1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pNumFrames > 1 && (this._pStitchFinalFrame || !this._pLooping)) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._translations[0];\n\t\t\tp2 = this._translations[1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = VertexClipNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationClipState extends AnimationStateBase\n{\n\tprivate _animationClipNode:AnimationClipNodeBase;\n\tprivate _animationStatePlaybackComplete:AnimationStateEvent;\n\tpublic _pBlendWeight:number;\n\tpublic _pCurrentFrame:number /*uint*/;\n\tpublic _pNextFrame:number /*uint*/;\n\n\tpublic _pOldFrame:number /*uint*/;\n\tpublic _pTimeDir:number /*int*/;\n\tpublic _pFramesDirty:boolean = true;\n\n\t/**\n\t * Returns a fractional value between 0 and 1 representing the blending ratio of the current playhead position\n\t * between the current frame (0) and next frame (1) of the animation.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pBlendWeight;\n\t}\n\n\t/**\n\t * Returns the current frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pCurrentFrame;\n\t}\n\n\t/**\n\t * Returns the next frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pNextFrame;\n\t}\n\n\tconstructor(animator:AnimatorBase, animationClipNode:AnimationClipNodeBase)\n\t{\n\t\tsuper(animator, animationClipNode);\n\n\t\tthis._animationClipNode = animationClipNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tif (!this._animationClipNode.looping) {\n\t\t\tif (time > this._pStartTime + this._animationClipNode.totalDuration)\n\t\t\t\ttime = this._pStartTime + this._animationClipNode.totalDuration; else if (time < this._pStartTime)\n\t\t\t\ttime = this._pStartTime;\n\t\t}\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tvar time:number /*int*/ = value*this._animationClipNode.totalDuration + this._pStartTime;\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._pFramesDirty = true;\n\n\t\tthis._pTimeDir = (time - this._pStartTime > this._pTime)? 1 : -1;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Updates the nodes internal playhead to determine the current and next animation frame, and the blendWeight between the two.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t * @see #blendWeight\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tthis._pFramesDirty = false;\n\n\t\tvar looping:boolean = this._animationClipNode.looping;\n\t\tvar totalDuration:number /*uint*/ = this._animationClipNode.totalDuration;\n\t\tvar lastFrame:number /*uint*/ = this._animationClipNode.lastFrame;\n\t\tvar time:number /*int*/ = this._pTime;\n\n\t\t//trace(\"time\", time, totalDuration)\n\t\tif (looping && (time >= totalDuration || time < 0)) {\n\t\t\ttime %= totalDuration;\n\t\t\tif (time < 0)\n\t\t\t\ttime += totalDuration;\n\t\t}\n\n\t\tif (!looping && time >= totalDuration) {\n\t\t\tthis.notifyPlaybackComplete();\n\t\t\tthis._pCurrentFrame = lastFrame;\n\t\t\tthis._pNextFrame = lastFrame;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (!looping && time <= 0) {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (this._animationClipNode.fixedFrameRate) {\n\t\t\tvar t:number = time/totalDuration*lastFrame;\n\t\t\tthis._pCurrentFrame = Math.floor(t);\n\t\t\tthis._pBlendWeight = t - this._pCurrentFrame;\n\t\t\tthis._pNextFrame = this._pCurrentFrame + 1;\n\t\t} else {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\n\t\t\tvar dur:number /*uint*/ = 0, frameTime:number /*uint*/;\n\t\t\tvar durations:Array<number> /*uint*/ = this._animationClipNode.durations;\n\n\t\t\tdo {\n\t\t\t\tframeTime = dur;\n\t\t\t\tdur += durations[this._pNextFrame];\n\t\t\t\tthis._pCurrentFrame = this._pNextFrame++;\n\t\t\t} while (time > dur);\n\n\t\t\tif (this._pCurrentFrame == lastFrame) {\n\t\t\t\tthis._pCurrentFrame = 0;\n\t\t\t\tthis._pNextFrame = 1;\n\t\t\t}\n\n\t\t\tthis._pBlendWeight = (time - frameTime)/durations[this._pCurrentFrame];\n\t\t}\n\t}\n\n\tprivate notifyPlaybackComplete()\n\t{\n\t\tif (this._animationStatePlaybackComplete == null)\n\t\t\tthis._animationStatePlaybackComplete = new AnimationStateEvent(AnimationStateEvent.PLAYBACK_COMPLETE, this._pAnimator, this, this._animationClipNode);\n\n\t\tthis._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete);\n\t}\n}\n\nexport = AnimationClipState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationStateBase implements IAnimationState\n{\n\tpublic _pAnimationNode:AnimationNodeBase;\n\tpublic _pRootDelta:Vector3D = new Vector3D();\n\tpublic _pPositionDeltaDirty:boolean = true;\n\n\tpublic _pTime:number;\n\tpublic _pStartTime:number = 0;\n\tpublic _pAnimator:AnimatorBase;\n\n\t/**\n\t * Returns a 3d vector representing the translation delta of the animating entity for the current timestep of animation\n\t */\n\tpublic get positionDelta():Vector3D\n\t{\n\t\tif (this._pPositionDeltaDirty) {\n\n\t\t\tthis._pUpdatePositionDelta();\n\t\t}\n\n\t\treturn this._pRootDelta;\n\n\t}\n\n\tconstructor(animator:AnimatorBase, animationNode:AnimationNodeBase)\n\t{\n\t\tthis._pAnimator = animator;\n\t\tthis._pAnimationNode = animationNode;\n\t}\n\n\t/**\n\t * Resets the start time of the node to a  new value.\n\t *\n\t * @param startTime The absolute start time (in milliseconds) of the node's starting time.\n\t */\n\tpublic offset(startTime:number)\n\t{\n\t\tthis._pStartTime = startTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the configuration of the node to its current state.\n\t *\n\t * @param time The absolute time (in milliseconds) of the animator's play head position.\n\t *\n\t * @see AnimatorBase#update()\n\t */\n\tpublic update(time:number)\n\t{\n\t\tif (this._pTime == time - this._pStartTime) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._pUpdateTime(time);\n\n\t}\n\n\t/**\n\t * Sets the animation phase of the node.\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\n\t}\n\n\t/**\n\t * Updates the node's internal playhead position.\n\t *\n\t * @param time The local time (in milliseconds) of the node's playhead position.\n\t */\n\tpublic _pUpdateTime(time:number)\n\t{\n\t\tthis._pTime = time - this._pStartTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the node's root delta position\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t}\n}\n\nexport = AnimationStateBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleAccelerationNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleAccelerationState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ACCELERATION_INDEX:number /*int*/ = 0;\n\n\tprivate _particleAccelerationNode:ParticleAccelerationNode;\n\tprivate _acceleration:Vector3D;\n\tprivate _halfAcceleration:Vector3D;\n\t\n\t/**\n\t * Defines the acceleration vector of the state, used when in global mode.\n\t */\n\tpublic get acceleration():Vector3D\n\t{\n\t\treturn this._acceleration;\n\t}\n\t\n\tpublic set acceleration(value:Vector3D)\n\t{\n\t\tthis._acceleration.x = value.x;\n\t\tthis._acceleration.y = value.y;\n\t\tthis._acceleration.z = value.z;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\tconstructor(animator:ParticleAnimator, particleAccelerationNode:ParticleAccelerationNode)\n\t{\n\t\tsuper(animator, particleAccelerationNode);\n\n\t\tthis._particleAccelerationNode = particleAccelerationNode;\n\t\tthis._acceleration = this._particleAccelerationNode._acceleration;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleAccelerationState.ACCELERATION_INDEX);\n\t\t\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleAccelerationNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._halfAcceleration.x, this._halfAcceleration.y, this._halfAcceleration.z);\n\t}\n\t\n\tprivate updateAccelerationData()\n\t{\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tthis._halfAcceleration = new Vector3D(this._acceleration.x/2, this._acceleration.y/2, this._acceleration.z/2);\n\t}\n}\n\nexport = ParticleAccelerationState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleBezierCurveNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n/**\n * ...\n */\nclass ParticleBezierCurveState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static BEZIER_CONTROL_INDEX:number /*int*/ = 0;\n\n\t/** @private */\n\tpublic static BEZIER_END_INDEX:number /*int*/ = 1;\n\n\tprivate _particleBezierCurveNode:ParticleBezierCurveNode;\n\tprivate _controlPoint:Vector3D;\n\tprivate _endPoint:Vector3D;\n\n\t/**\n\t * Defines the default control point of the node, used when in global mode.\n\t */\n\tpublic get controlPoint():Vector3D\n\t{\n\t\treturn this._controlPoint;\n\t}\n\n\tpublic set controlPoint(value:Vector3D)\n\t{\n\t\tthis._controlPoint = value;\n\t}\n\n\t/**\n\t * Defines the default end point of the node, used when in global mode.\n\t */\n\tpublic get endPoint():Vector3D\n\t{\n\t\treturn this._endPoint;\n\t}\n\n\tpublic set endPoint(value:Vector3D)\n\t{\n\t\tthis._endPoint = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleBezierCurveNode:ParticleBezierCurveNode)\n\t{\n\t\tsuper(animator, particleBezierCurveNode);\n\n\t\tthis._particleBezierCurveNode = particleBezierCurveNode;\n\t\tthis._controlPoint = this._particleBezierCurveNode._iControlPoint;\n\t\tthis._endPoint = this._particleBezierCurveNode._iEndPoint;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar controlIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_CONTROL_INDEX);\n\t\tvar endIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_END_INDEX);\n\n\t\tif (this._particleBezierCurveNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tanimationSubGeometry.activateVertexBuffer(controlIndex, this._particleBezierCurveNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(endIndex, this._particleBezierCurveNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else {\n\t\t\tanimationRegisterCache.setVertexConst(controlIndex, this._controlPoint.x, this._controlPoint.y, this._controlPoint.z);\n\t\t\tanimationRegisterCache.setVertexConst(endIndex, this._endPoint.x, this._endPoint.y, this._endPoint.z);\n\t\t}\n\t}\n}\n\nexport = ParticleBezierCurveState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Orientation3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Orientation3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleBillboardNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleBillboardState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D;\n\n\tprivate _billboardAxis:Vector3D;\n\n\t/**\n\t *\n\t */\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleBillboardNode)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._billboardAxis = particleNode._iBillboardAxis;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar comps:Array<Vector3D>;\n\t\tif (this._billboardAxis) {\n\t\t\tvar pos:Vector3D = renderable.sourceEntity.sceneTransform.position;\n\t\t\tvar look:Vector3D = camera.sceneTransform.position.subtract(pos);\n\t\t\tvar right:Vector3D = look.crossProduct(this._billboardAxis);\n\t\t\tright.normalize();\n\t\t\tlook = this.billboardAxis.crossProduct(right);\n\t\t\tlook.normalize();\n\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\t\t\tthis._matrix.copyColumnFrom(0, right);\n\t\t\tthis._matrix.copyColumnFrom(1, this.billboardAxis);\n\t\t\tthis._matrix.copyColumnFrom(2, look);\n\t\t\tthis._matrix.copyColumnFrom(3, pos);\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t} else {\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\n\t\t\t//decompose using axis angle rotations\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\n\t\t\t//recreate the matrix with just the rotation data\n\t\t\tthis._matrix.identity();\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t}\n\n\t\t//set a new matrix transform constant\n\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBillboardState.MATRIX_INDEX), this._matrix);\n\t}\n\n\t/**\n\t * Defines the billboard axis.\n\t */\n\tpublic get billboardAxis():Vector3D\n\t{\n\t\treturn this.billboardAxis;\n\t}\n\n\tpublic set billboardAxis(value:Vector3D)\n\t{\n\t\tthis.billboardAxis = value? value.clone() : null;\n\t\tif (this.billboardAxis)\n\t\t\tthis.billboardAxis.normalize();\n\t}\n\n}\n\nexport = ParticleBillboardState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleColorNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticleColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static DELTA_MULTIPLIER_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 2;\n\n\t/** @private */\n\tpublic static DELTA_OFFSET_INDEX:number /*uint*/ = 3;\n\n\t/** @private */\n\tpublic static CYCLE_INDEX:number /*uint*/ = 4;\n\n\tprivate _particleColorNode:ParticleColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _cycleData:Vector3D;\n\tprivate _startMultiplierData:Vector3D;\n\tprivate _deltaMultiplierData:Vector3D;\n\tprivate _startOffsetData:Vector3D;\n\tprivate _deltaOffsetData:Vector3D;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleColorNode:ParticleColorNode)\n\t{\n\t\tsuper(animator, particleColorNode);\n\n\t\tthis._particleColorNode = particleColorNode;\n\t\tthis._usesMultiplier = this._particleColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = this._particleColorNode._iUsesOffset;\n\t\tthis._usesCycle = this._particleColorNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleColorNode._iUsesPhase;\n\t\tthis._startColor = this._particleColorNode._iStartColor;\n\t\tthis._endColor = this._particleColorNode._iEndColor;\n\t\tthis._cycleDuration = this._particleColorNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleColorNode._iCyclePhase;\n\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar dataOffset:number /*uint*/ = this._particleColorNode._iDataOffset;\n\t\t\tif (this._usesCycle)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.CYCLE_INDEX), this._cycleData.x, this._cycleData.y, this._cycleData.z, this._cycleData.w);\n\n\t\t\tif (this._usesMultiplier) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), this._startMultiplierData.x, this._startMultiplierData.y, this._startMultiplierData.z, this._startMultiplierData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), this._deltaMultiplierData.x, this._deltaMultiplierData.y, this._deltaMultiplierData.z, this._deltaMultiplierData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._usesOffset) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), this._startOffsetData.x, this._startOffsetData.y, this._startOffsetData.z, this._startOffsetData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), this._deltaOffsetData.x, this._deltaOffsetData.y, this._deltaOffsetData.z, this._deltaOffsetData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._cycleData = new Vector3D(Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180, 0, 0);\n\t\t}\n\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D((this._startColor.redMultiplier + this._endColor.redMultiplier)/2, (this._startColor.greenMultiplier + this._endColor.greenMultiplier)/2, (this._startColor.blueMultiplier + this._endColor.blueMultiplier)/2, (this._startColor.alphaMultiplier + this._endColor.alphaMultiplier)/2);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier)/2, (this._endColor.greenMultiplier - this._startColor.greenMultiplier)/2, (this._endColor.blueMultiplier - this._startColor.blueMultiplier)/2, (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier)/2);\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D((this._startColor.redOffset + this._endColor.redOffset)/(255*2), (this._startColor.greenOffset + this._endColor.greenOffset)/(255*2), (this._startColor.blueOffset + this._endColor.blueOffset)/(255*2), (this._startColor.alphaOffset + this._endColor.alphaOffset)/(255*2));\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/(255*2), (this._endColor.greenOffset - this._startColor.greenOffset)/(255*2), (this._endColor.blueOffset - this._startColor.blueOffset)/(255*2), (this._endColor.alphaOffset - this._startColor.alphaOffset)/(255*2));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier), (this._endColor.greenMultiplier - this._startColor.greenMultiplier), (this._endColor.blueMultiplier - this._startColor.blueMultiplier), (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier));\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset )/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport = ParticleColorState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleFollowNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleFollowNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleFollowState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static FOLLOW_POSITION_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static FOLLOW_ROTATION_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleFollowNode:ParticleFollowNode;\n\tprivate _followTarget:DisplayObject;\n\n\tprivate _targetPos:Vector3D = new Vector3D();\n\tprivate _targetEuler:Vector3D = new Vector3D();\n\tprivate _prePos:Vector3D;\n\tprivate _preEuler:Vector3D;\n\tprivate _smooth:boolean;\n\n\t//temporary vector3D for calculation\n\tprivate _temp:Vector3D = new Vector3D();\n\n\tconstructor(animator:ParticleAnimator, particleFollowNode:ParticleFollowNode)\n\t{\n\t\tsuper(animator, particleFollowNode, true);\n\n\t\tthis._particleFollowNode = particleFollowNode;\n\t\tthis._smooth = particleFollowNode._iSmooth;\n\t}\n\n\tpublic get followTarget():DisplayObject\n\t{\n\t\treturn this._followTarget;\n\t}\n\n\tpublic set followTarget(value:DisplayObject)\n\t{\n\t\tthis._followTarget = value;\n\t}\n\n\tpublic get smooth():boolean\n\t{\n\t\treturn this._smooth;\n\t}\n\n\tpublic set smooth(value:boolean)\n\t{\n\t\tthis._smooth = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._followTarget) {\n\t\t\tif (this._particleFollowNode._iUsesPosition) {\n\t\t\t\tthis._targetPos.x = this._followTarget.transform.position.x/renderable.sourceEntity.scaleX;\n\t\t\t\tthis._targetPos.y = this._followTarget.transform.position.y/renderable.sourceEntity.scaleY;\n\t\t\t\tthis._targetPos.z = this._followTarget.transform.position.z/renderable.sourceEntity.scaleZ;\n\t\t\t}\n\t\t\tif (this._particleFollowNode._iUsesRotation) {\n\t\t\t\tthis._targetEuler.x = this._followTarget.rotationX;\n\t\t\t\tthis._targetEuler.y = this._followTarget.rotationY;\n\t\t\t\tthis._targetEuler.z = this._followTarget.rotationZ;\n\t\t\t\tthis._targetEuler.scaleBy(MathConsts.DEGREES_TO_RADIANS);\n\t\t\t}\n\t\t}\n\t\t//initialization\n\t\tif (!this._prePos)\n\t\t\tthis._prePos = this._targetPos.clone();\n\t\tif (!this._preEuler)\n\t\t\tthis._preEuler = this._targetEuler.clone();\n\n\t\tvar currentTime:number = this._pTime/1000;\n\t\tvar previousTime:number = animationSubGeometry.previousTime;\n\t\tvar deltaTime:number = currentTime - previousTime;\n\n\t\tvar needProcess:boolean = previousTime != currentTime;\n\n\t\tif (this._particleFollowNode._iUsesPosition && this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPositionAndRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesPosition) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPosition(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.precessRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t}\n\n\t\tthis._prePos.copyFrom(this._targetPos);\n\t\tthis._targetEuler.copyFrom(this._targetEuler);\n\t\tanimationSubGeometry.previousTime = currentTime;\n\t}\n\n\tprivate processPosition(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar posVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedPos = this._targetPos;\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate precessRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedRotation:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\n\t\tif (this._smooth) {\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedRotation = this._targetEuler;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedRotation.x || vertexData[inc + 1] != interpolatedRotation.y || vertexData[inc + 2] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate processPositionAndRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar interpolatedRotation:Vector3D;\n\n\t\tvar posVelocity:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else {\n\t\t\tinterpolatedPos = this._targetPos;\n\t\t\tinterpolatedRotation = this._targetEuler;\n\t\t}\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z || vertexData[inc + 3] != interpolatedRotation.x || vertexData[inc + 4] != interpolatedRotation.y || vertexData[inc + 5] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleFollowState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleInitialColorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n*\n*/\nclass ParticleInitialColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MULTIPLIER_INDEX:number /*uint*/ = 0;\n\t/** @private */\n\tpublic static OFFSET_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleInitialColorNode:ParticleInitialColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _initialColor:ColorTransform;\n\tprivate _multiplierData:Vector3D;\n\tprivate _offsetData:Vector3D;\n\n\tconstructor(animator:ParticleAnimator, particleInitialColorNode:ParticleInitialColorNode)\n\t{\n\t\tsuper(animator, particleInitialColorNode);\n\n\t\tthis._particleInitialColorNode = particleInitialColorNode;\n\t\tthis._usesMultiplier = particleInitialColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleInitialColorNode._iUsesOffset;\n\t\tthis._initialColor = particleInitialColorNode._iInitialColor;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the initial color transform of the state, when in global mode.\n\t */\n\tpublic get initialColor():ColorTransform\n\t{\n\t\treturn this._initialColor;\n\t}\n\n\tpublic set initialColor(value:ColorTransform)\n\t{\n\t\tthis._initialColor = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\t// TODO: not used\n\t\trenderable = renderable;\n\t\tcamera = camera;\n\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\tvar dataOffset:number /*uint*/ = this._particleInitialColorNode._iDataOffset;\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t}\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), this._multiplierData.x, this._multiplierData.y, this._multiplierData.z, this._multiplierData.w);\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), this._offsetData.x, this._offsetData.y, this._offsetData.z, this._offsetData.w);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tthis._multiplierData = new Vector3D(this._initialColor.redMultiplier, this._initialColor.greenMultiplier, this._initialColor.blueMultiplier, this._initialColor.alphaMultiplier);\n\t\t\tif (this._usesOffset)\n\t\t\t\tthis._offsetData = new Vector3D(this._initialColor.redOffset/255, this._initialColor.greenOffset/255, this._initialColor.blueOffset/255, this._initialColor.alphaOffset/255);\n\t\t}\n\t}\n\n}\n\nexport = ParticleInitialColorState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOrbitNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOrbitState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ORBIT_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static EULERS_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleOrbitNode:ParticleOrbitNode;\n\tprivate _usesEulers:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _radius:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _eulers:Vector3D;\n\tprivate _orbitData:Vector3D;\n\tprivate _eulersMatrix:Matrix3D;\n\n\t/**\n\t * Defines the radius of the orbit when in global mode. Defaults to 100.\n\t */\n\tpublic get radius():number\n\t{\n\t\treturn this._radius;\n\t}\n\n\tpublic set radius(value:number)\n\t{\n\t\tthis._radius = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tpublic get eulers():Vector3D\n\t{\n\t\treturn this._eulers;\n\t}\n\n\tpublic set eulers(value:Vector3D)\n\t{\n\t\tthis._eulers = value;\n\n\t\tthis.updateOrbitData();\n\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOrbitNode:ParticleOrbitNode)\n\t{\n\t\tsuper(animator, particleOrbitNode);\n\n\t\tthis._particleOrbitNode = particleOrbitNode;\n\t\tthis._usesEulers = this._particleOrbitNode._iUsesEulers;\n\t\tthis._usesCycle = this._particleOrbitNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleOrbitNode._iUsesPhase;\n\t\tthis._eulers = this._particleOrbitNode._iEulers;\n\t\tthis._radius = this._particleOrbitNode._iRadius;\n\t\tthis._cycleDuration = this._particleOrbitNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleOrbitNode._iCyclePhase;\n\t\tthis.updateOrbitData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.ORBIT_INDEX);\n\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesPhase)\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\telse\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._orbitData.x, this._orbitData.y, this._orbitData.z, this._orbitData.w);\n\n\t\tif (this._usesEulers)\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.EULERS_INDEX), this._eulersMatrix);\n\t}\n\n\tprivate updateOrbitData()\n\t{\n\t\tif (this._usesEulers) {\n\t\t\tthis._eulersMatrix = new Matrix3D();\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.x, Vector3D.X_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.y, Vector3D.Y_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.z, Vector3D.Z_AXIS);\n\t\t}\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._orbitData = new Vector3D(this._radius, 0, this._radius*Math.PI*2, this._cyclePhase*Math.PI/180);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._orbitData.y = Math.PI*2/this._cycleDuration;\n\t\t\t} else\n\t\t\t\tthis._orbitData.y = Math.PI*2;\n\t\t}\n\t}\n}\n\nexport = ParticleOrbitState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOscillatorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOscillatorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static OSCILLATOR_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleOscillatorNode:ParticleOscillatorNode;\n\tprivate _oscillator:Vector3D;\n\tprivate _oscillatorData:Vector3D;\n\n\t/**\n\t * Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the state, used when in global mode.\n\t */\n\tpublic get oscillator():Vector3D\n\t{\n\t\treturn this._oscillator;\n\t}\n\n\tpublic set oscillator(value:Vector3D)\n\t{\n\t\tthis._oscillator = value;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOscillatorNode:ParticleOscillatorNode)\n\t{\n\t\tsuper(animator, particleOscillatorNode);\n\n\t\tthis._particleOscillatorNode = particleOscillatorNode;\n\t\tthis._oscillator = this._particleOscillatorNode._iOscillator;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOscillatorState.OSCILLATOR_INDEX);\n\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOscillatorNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._oscillatorData.x, this._oscillatorData.y, this._oscillatorData.z, this._oscillatorData.w);\n\t}\n\n\tprivate updateOscillatorData()\n\t{\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._oscillator.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\n\t\t\tif (this._oscillatorData == null)\n\t\t\t\tthis._oscillatorData = new Vector3D();\n\n\t\t\tthis._oscillatorData.x = this._oscillator.x;\n\t\t\tthis._oscillatorData.y = this._oscillator.y;\n\t\t\tthis._oscillatorData.z = this._oscillator.z;\n\t\t\tthis._oscillatorData.w = Math.PI*2/this._oscillator.w;\n\t\t}\n\t}\n}\n\nexport = ParticleOscillatorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticlePositionNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticlePositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticlePositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*uint*/ = 0;\n\n\tprivate _particlePositionNode:ParticlePositionNode;\n\tprivate _position:Vector3D;\n\n\t/**\n\t * Defines the position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getPositions():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setPositions(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particlePositionNode:ParticlePositionNode)\n\t{\n\t\tsuper(animator, particlePositionNode);\n\n\t\tthis._particlePositionNode = particlePositionNode;\n\t\tthis._position = this._particlePositionNode._iPosition;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticlePositionState.POSITION_INDEX);\n\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._position.x, this._position.y, this._position.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particlePositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticlePositionState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToHeadingState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase)\n\t{\n\t\tsuper(animator, particleNode);\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToHeadingState.MATRIX_INDEX), this._matrix);\n\t\t}\n\t}\n\n}\n\nexport = ParticleRotateToHeadingState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotateToPositionNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToPositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*int*/ = 1;\n\n\tprivate _particleRotateToPositionNode:ParticleRotateToPositionNode;\n\tprivate _position:Vector3D;\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\tprivate _offset:Vector3D;\n\n\t/**\n\t * Defines the position of the point the particle will rotate to face when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotateToPositionNode:ParticleRotateToPositionNode)\n\t{\n\t\tsuper(animator, particleRotateToPositionNode);\n\n\t\tthis._particleRotateToPositionNode = particleRotateToPositionNode;\n\t\tthis._position = this._particleRotateToPositionNode._iPosition;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.POSITION_INDEX);\n\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.MATRIX_INDEX), this._matrix);\n\t\t}\n\n\t\tif (this._particleRotateToPositionNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._offset = renderable.sourceEntity.inverseSceneTransform.transformVector(this._position);\n\t\t\tanimationRegisterCache.setVertexConst(index, this._offset.x, this._offset.y, this._offset.z);\n\t\t} else\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotateToPositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\n\t}\n\n}\n\nexport = ParticleRotateToPositionState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotationalVelocityNode\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotationalVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ROTATIONALVELOCITY_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleRotationalVelocityNode:ParticleRotationalVelocityNode;\n\tprivate _rotationalVelocityData:Vector3D;\n\tprivate _rotationalVelocity:Vector3D;\n\n\t/**\n\t * Defines the default rotationalVelocity of the state, used when in global mode.\n\t */\n\tpublic get rotationalVelocity():Vector3D\n\t{\n\t\treturn this._rotationalVelocity;\n\t}\n\n\tpublic set rotationalVelocity(value:Vector3D)\n\t{\n\t\tthis._rotationalVelocity = value;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getRotationalVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setRotationalVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotationNode:ParticleRotationalVelocityNode)\n\t{\n\t\tsuper(animator, particleRotationNode);\n\n\t\tthis._particleRotationalVelocityNode = particleRotationNode;\n\t\tthis._rotationalVelocity = this._particleRotationalVelocityNode._iRotationalVelocity;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX);\n\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._rotationalVelocityData.x, this._rotationalVelocityData.y, this._rotationalVelocityData.z, this._rotationalVelocityData.w);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotationalVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t}\n\n\tprivate updateRotationalVelocityData()\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._rotationalVelocity.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t\tvar rotation:Vector3D = this._rotationalVelocity.clone();\n\n\t\t\tif (rotation.length <= 0)\n\t\t\t\trotation.z = 1; //set the default direction\n\t\t\telse\n\t\t\t\trotation.normalize();\n\t\t\t// w is used as angle/2 in agal\n\t\t\tthis._rotationalVelocityData = new Vector3D(rotation.x, rotation.y, rotation.z, Math.PI/rotation.w);\n\t\t}\n\t}\n}\n\nexport = ParticleRotationalVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleScaleNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleScaleNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleScaleState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static SCALE_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleScaleNode:ParticleScaleNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _minScale:number;\n\tprivate _maxScale:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _scaleData:Vector3D;\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get minScale():number\n\t{\n\t\treturn this._minScale;\n\t}\n\n\tpublic set minScale(value:number)\n\t{\n\t\tthis._minScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get maxScale():number\n\t{\n\t\treturn this._maxScale;\n\t}\n\n\tpublic set maxScale(value:number)\n\t{\n\t\tthis._maxScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleScaleNode:ParticleScaleNode)\n\t{\n\t\tsuper(animator, particleScaleNode);\n\n\t\tthis._particleScaleNode = particleScaleNode;\n\t\tthis._usesCycle = this._particleScaleNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleScaleNode._iUsesPhase;\n\t\tthis._minScale = this._particleScaleNode._iMinScale;\n\t\tthis._maxScale = this._particleScaleNode._iMaxScale;\n\t\tthis._cycleDuration = this._particleScaleNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleScaleNode._iCyclePhase;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleScaleState.SCALE_INDEX);\n\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesPhase)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\telse\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t} else\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._scaleData.x, this._scaleData.y, this._scaleData.z, this._scaleData.w);\n\t}\n\n\tprivate updateScaleData()\n\t{\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._scaleData = new Vector3D((this._minScale + this._maxScale)/2, Math.abs(this._minScale - this._maxScale)/2, Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180);\n\t\t\t} else\n\t\t\t\tthis._scaleData = new Vector3D(this._minScale, this._maxScale - this._minScale, 0, 0);\n\t\t}\n\t}\n}\n\nexport = ParticleScaleState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSegmentedColorNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n *\n */\nclass ParticleSegmentedColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static TIME_DATA_INDEX:number /*uint*/ = 2;\n\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _segmentPoints:Array<ColorSegmentPoint>;\n\tprivate _numSegmentPoint:number /*int*/;\n\n\tprivate _timeLifeData:Array<number>;\n\tprivate _multiplierData:Array<number>;\n\tprivate _offsetData:Array<number>;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the number of segments.\n\t */\n\tpublic get numSegmentPoint():number /*int*/\n\t{\n\t\treturn this._numSegmentPoint;\n\t}\n\n\t/**\n\t * Defines the key points of color\n\t */\n\tpublic get segmentPoints():Array<ColorSegmentPoint>\n\t{\n\t\treturn this._segmentPoints;\n\t}\n\n\tpublic set segmentPoints(value:Array<ColorSegmentPoint>)\n\t{\n\t\tthis._segmentPoints = value;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic get usesMultiplier():boolean\n\t{\n\t\treturn this._usesMultiplier;\n\t}\n\n\tpublic get usesOffset():boolean\n\t{\n\t\treturn this._usesOffset;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSegmentedColorNode:ParticleSegmentedColorNode)\n\t{\n\t\tsuper(animator, particleSegmentedColorNode);\n\n\t\tthis._usesMultiplier = particleSegmentedColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleSegmentedColorNode._iUsesOffset;\n\t\tthis._startColor = particleSegmentedColorNode._iStartColor;\n\t\tthis._endColor = particleSegmentedColorNode._iEndColor;\n\t\tthis._segmentPoints = particleSegmentedColorNode._iSegmentPoints;\n\t\tthis._numSegmentPoint = particleSegmentedColorNode._iNumSegmentPoint;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._numSegmentPoint > 0)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.TIME_DATA_INDEX), this._timeLifeData[0], this._timeLifeData[1], this._timeLifeData[2], this._timeLifeData[3]);\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_MULTIPLIER_INDEX), this._multiplierData);\n\t\t\tif (this._usesOffset)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_OFFSET_INDEX), this._offsetData);\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tthis._timeLifeData = new Array<number>();\n\t\tthis._multiplierData = new Array<number>();\n\t\tthis._offsetData = new Array<number>();\n\t\tvar i:number /*int*/;\n\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\tif (i == 0)\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life);\n\t\t\telse\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life - this._segmentPoints[i - 1].life);\n\t\t}\n\t\tif (this._numSegmentPoint == 0)\n\t\t\tthis._timeLifeData.push(1);\n\t\telse\n\t\t\tthis._timeLifeData.push(1 - this._segmentPoints[i - 1].life);\n\n\t\tif (this._usesMultiplier) {\n\t\t\tthis._multiplierData.push(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._startColor.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._startColor.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._startColor.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._startColor.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t\telse\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._multiplierData.push(this._endColor.redMultiplier - this._startColor.redMultiplier, this._endColor.greenMultiplier - this._startColor.greenMultiplier, this._endColor.blueMultiplier - this._startColor.blueMultiplier, this._endColor.alphaMultiplier - this._startColor.alphaMultiplier);\n\t\t\telse\n\t\t\t\tthis._multiplierData.push((this._endColor.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._endColor.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._endColor.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._endColor.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t}\n\n\t\tif (this._usesOffset) {\n\t\t\tthis._offsetData.push(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._startColor.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._startColor.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._startColor.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._startColor.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t\telse\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset)/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\telse\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._endColor.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._endColor.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._endColor.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t}\n\t\t//cut off the data\n\t\tthis._timeLifeData.length = 4;\n\t}\n}\n\nexport = ParticleSegmentedColorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSpriteSheetNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleSpriteSheetState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX_0:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static UV_INDEX_1:number /*uint*/ = 1;\n\n\tprivate _particleSpriteSheetNode:ParticleSpriteSheetNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _totalFrames:number /*int*/;\n\tprivate _numColumns:number /*int*/;\n\tprivate _numRows:number /*int*/;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _spriteSheetData:Array<number>;\n\n\t/**\n\t * Defines the cycle phase, when in global mode. Defaults to zero.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\t/**\n\t * Defines the cycle duration in seconds, when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSpriteSheetNode:ParticleSpriteSheetNode)\n\t{\n\t\tsuper(animator, particleSpriteSheetNode);\n\n\t\tthis._particleSpriteSheetNode = particleSpriteSheetNode;\n\n\t\tthis._usesCycle = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._totalFrames = this._particleSpriteSheetNode._iTotalFrames;\n\t\tthis._numColumns = this._particleSpriteSheetNode._iNumColumns;\n\t\tthis._numRows = this._particleSpriteSheetNode._iNumRows;\n\t\tthis._cycleDuration = this._particleSpriteSheetNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleSpriteSheetNode._iCyclePhase;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_0), this._spriteSheetData[0], this._spriteSheetData[1], this._spriteSheetData[2], this._spriteSheetData[3]);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_1);\n\t\t\t\tif (this._particleSpriteSheetNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tif (this._usesPhase)\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t\t\telse\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\t} else\n\t\t\t\t\tanimationRegisterCache.setVertexConst(index, this._spriteSheetData[4], this._spriteSheetData[5]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateSpriteSheetData()\n\t{\n\t\tthis._spriteSheetData = new Array<number>(8);\n\n\t\tvar uTotal:number = this._totalFrames/this._numColumns;\n\n\t\tthis._spriteSheetData[0] = uTotal;\n\t\tthis._spriteSheetData[1] = 1/this._numColumns;\n\t\tthis._spriteSheetData[2] = 1/this._numRows;\n\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._spriteSheetData[4] = uTotal/this._cycleDuration;\n\t\t\tthis._spriteSheetData[5] = this._cycleDuration;\n\t\t\tif (this._usesPhase)\n\t\t\t\tthis._spriteSheetData[6] = this._cyclePhase;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleStateBase extends AnimationStateBase\n{\n\tprivate _particleNode:ParticleNodeBase;\n\n\tpublic _pDynamicProperties:Array<Vector3D> = new Array<Vector3D>();\n\tpublic _pDynamicPropertiesDirty:Object = new Object();\n\n\tpublic _pNeedUpdateTime:boolean;\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase, needUpdateTime:boolean = false)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._particleNode = particleNode;\n\t\tthis._pNeedUpdateTime = needUpdateTime;\n\t}\n\n\tpublic get needUpdateTime():boolean\n\t{\n\t\treturn this._pNeedUpdateTime;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\n\t}\n\n\tpublic _pUpdateDynamicProperties(animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tthis._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId] = true;\n\n\t\tvar animationParticles:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\t\tvar totalLenOfOneVertex:number /*uint*/ = animationSubGeometry.totalLenOfOneVertex;\n\t\tvar dataLength:number /*uint*/ = this._particleNode.dataLength;\n\t\tvar dataOffset:number /*uint*/ = this._particleNode._iDataOffset;\n\t\tvar vertexLength:number /*uint*/;\n\t\t//\t\t\tvar particleOffset:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\t\tvar data:Vector3D;\n\t\tvar animationParticle:ParticleAnimationData;\n\n\t\t//\t\t\tvar numParticles:number /*uint*/ = _positions.length/dataLength;\n\t\tvar numParticles:number /*uint*/ = this._pDynamicProperties.length;\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/ = 0;\n\n\t\t//loop through all particles\n\t\twhile (i < numParticles) {\n\t\t\t//loop through each particle data for the current particle\n\t\t\twhile (j < numParticles && (animationParticle = animationParticles[j]).index == i) {\n\t\t\t\tdata = this._pDynamicProperties[i];\n\t\t\t\tvertexLength = animationParticle.numVertices*totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationParticle.startVertexIndex*totalLenOfOneVertex + dataOffset;\n\t\t\t\t//loop through each vertex in the particle data\n\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t//\t\t\t\t\t\tparticleOffset = i * dataLength;\n\t\t\t\t\t//loop through all vertex data for the current particle data\n\t\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.x;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.y;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.z;\n\n\t\t\t\t\t\tif (dataLength == 4)\n\t\t\t\t\t\t\tvertexData[vertexOffset++] = data.w;\n\t\t\t\t\t}\n\t\t\t\t\t\t//loop through each value in the particle vertex\n\t\t\t\t\t\t//\t\t\t\t\t\tswitch(dataLength) {\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tj++;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\n\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleStateBase;",
    "import Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleTimeState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static TIME_STREAM_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static TIME_CONSTANT_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleTimeNode:ParticleTimeNode;\n\n\tconstructor(animator:ParticleAnimator, particleTimeNode:ParticleTimeNode)\n\t{\n\t\tsuper(animator, particleTimeNode, true);\n\n\t\tthis._particleTimeNode = particleTimeNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_STREAM_INDEX), this._particleTimeNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\n\t\tvar particleTime:number = this._pTime/1000;\n\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_CONSTANT_INDEX), particleTime, particleTime, particleTime, particleTime);\n\t}\n\n}\n\nexport = ParticleTimeState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleUVNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleUVNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleUVState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleUVNode:ParticleUVNode;\n\n\tconstructor(animator:ParticleAnimator, particleUVNode:ParticleUVNode)\n\t{\n\t\tsuper(animator, particleUVNode);\n\n\t\tthis._particleUVNode = particleUVNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleUVState.UV_INDEX);\n\t\t\tvar data:Vector3D = this._particleUVNode._iUvData;\n\t\t\tanimationRegisterCache.setVertexConst(index, data.x, data.y);\n\t\t}\n\t}\n\n}\n\nexport = ParticleUVState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleVelocityNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static VELOCITY_INDEX:number /*int*/ = 0;\n\n\tprivate _particleVelocityNode:ParticleVelocityNode;\n\tprivate _velocity:Vector3D;\n\n\t/**\n\t * Defines the default velocity vector of the state, used when in global mode.\n\t */\n\tpublic get velocity():Vector3D\n\t{\n\t\treturn this._velocity;\n\t}\n\n\tpublic set velocity(value:Vector3D)\n\t{\n\t\tthis._velocity = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleVelocityNode:ParticleVelocityNode)\n\t{\n\t\tsuper(animator, particleVelocityNode);\n\n\t\tthis._particleVelocityNode = particleVelocityNode;\n\t\tthis._velocity = this._particleVelocityNode._iVelocity;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleVelocityState.VELOCITY_INDEX);\n\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._velocity.x, this._velocity.y, this._velocity.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticleVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonBinaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate _skeletonAnimationNode:SkeletonBinaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between inputA (0) and inputB (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see inputA\n\t * @see inputB\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonBinaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._inputA = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputA);\n\t\tthis._inputB = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputB);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis._pRootDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis._pRootDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis._pRootDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n}\n\nexport = SkeletonBinaryLERPState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimator\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonClipState extends AnimationClipState implements ISkeletonAnimationState\n{\n\tprivate _rootPos:Vector3D = new Vector3D();\n\tprivate _frames:Array<SkeletonPose>;\n\tprivate _skeletonClipNode:SkeletonClipNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _currentPose:SkeletonPose;\n\tprivate _nextPose:SkeletonPose;\n\n\t/**\n\t * Returns the current skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentPose;\n\t}\n\n\t/**\n\t * Returns the next skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextPose;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonClipNode:SkeletonClipNode)\n\t{\n\t\tsuper(animator, skeletonClipNode);\n\n\t\tthis._skeletonClipNode = skeletonClipNode;\n\t\tthis._frames = this._skeletonClipNode.frames;\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentPose = this._frames[this._pCurrentFrame];\n\n\t\tif (this._skeletonClipNode.looping && this._pNextFrame >= this._skeletonClipNode.lastFrame) {\n\t\t\tthis._nextPose = this._frames[0];\n\t\t\t(<SkeletonAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextPose = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the internal playhead position.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (!this._skeletonClipNode.totalDuration)\n\t\t\treturn;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar currentPose:Array<JointPose> = this._currentPose.jointPoses;\n\t\tvar nextPose:Array<JointPose> = this._nextPose.jointPoses;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar endPose:JointPose;\n\t\tvar tr:Vector3D;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tif ((numJoints != currentPose.length) || (numJoints != nextPose.length))\n\t\t\tthrow new Error(\"joint counts don't match!\");\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = currentPose[i];\n\t\t\tpose2 = nextPose[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tif (this._skeletonClipNode.highQuality)\n\t\t\t\tendPose.orientation.slerp(pose1.orientation, pose2.orientation, this._pBlendWeight); else\n\t\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._pBlendWeight);\n\n\t\t\tif (i > 0) {\n\t\t\t\ttr = endPose.translation;\n\t\t\t\ttr.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\t\ttr.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\t\ttr.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar p1:Vector3D, p2:Vector3D, p3:Vector3D;\n\t\tvar totalDelta:Vector3D = this._skeletonClipNode.totalDelta;\n\n\t\t// jumping back, need to reset position\n\t\tif ((this._pTimeDir > 0 && this._pNextFrame < this._pOldFrame) || (this._pTimeDir < 0 && this._pNextFrame > this._pOldFrame)) {\n\t\t\tthis._rootPos.x -= totalDelta.x*this._pTimeDir;\n\t\t\tthis._rootPos.y -= totalDelta.y*this._pTimeDir;\n\t\t\tthis._rootPos.z -= totalDelta.z*this._pTimeDir;\n\t\t}\n\n\t\tvar dx:number = this._rootPos.x;\n\t\tvar dy:number = this._rootPos.y;\n\t\tvar dz:number = this._rootPos.z;\n\n\t\tif (this._skeletonClipNode.stitchFinalFrame && this._pNextFrame == this._skeletonClipNode.lastFrame) {\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tp3 = this._currentPose.jointPoses[0].translation;\n\n\t\t\tthis._rootPos.x = p3.x + p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p3.y + p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p3.z + p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t} else {\n\t\t\tp1 = this._currentPose.jointPoses[0].translation;\n\t\t\tp2 = this._frames[this._pNextFrame].jointPoses[0].translation; //cover the instances where we wrap the pose but still want the final frame translation values\n\t\t\tthis._rootPos.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t}\n\n\t\tthis._pRootDelta.x = this._rootPos.x - dx;\n\t\tthis._pRootDelta.y = this._rootPos.y - dy;\n\t\tthis._pRootDelta.z = this._rootPos.z - dz;\n\n\t\tthis._pOldFrame = this._pNextFrame;\n\t}\n}\n\nexport = SkeletonClipState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDifferenceNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDifferenceState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate static _tempQuat:Quaternion = new Quaternion();\n\tprivate _skeletonAnimationNode:SkeletonDifferenceNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _baseInput:ISkeletonAnimationState;\n\tprivate _differenceInput:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between the base input (0) and difference input (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see #baseInput\n\t * @see #differenceInput\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDifferenceNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._baseInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.baseInput);\n\t\tthis._differenceInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.differenceInput);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._baseInput.phase(value);\n\t\tthis._baseInput.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._baseInput.update(time);\n\t\tthis._differenceInput.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._baseInput.positionDelta;\n\t\tvar deltB:Vector3D = this._differenceInput.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*deltB.x;\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*deltB.y;\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*deltB.z;\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between base input and difference input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar basePoses:Array<JointPose> = this._baseInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar diffPoses:Array<JointPose> = this._differenceInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar base:JointPose, diff:JointPose;\n\t\tvar basePos:Vector3D, diffPos:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tbase = basePoses[i];\n\t\t\tdiff = diffPoses[i];\n\t\t\tbasePos = base.translation;\n\t\t\tdiffPos = diff.translation;\n\n\t\t\tSkeletonDifferenceState._tempQuat.multiply(diff.orientation, base.orientation);\n\t\t\tendPose.orientation.lerp(base.orientation, SkeletonDifferenceState._tempQuat, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = basePos.x + this._blendWeight*diffPos.x;\n\t\t\ttr.y = basePos.y + this._blendWeight*diffPos.y;\n\t\t\ttr.z = basePos.z + this._blendWeight*diffPos.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonDifferenceState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDirectionalNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDirectionalState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonDirectionalNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\tprivate _blendWeight:number = 0;\n\tprivate _direction:number = 0;\n\tprivate _blendDirty:boolean = true;\n\tprivate _forward:ISkeletonAnimationState;\n\tprivate _backward:ISkeletonAnimationState;\n\tprivate _left:ISkeletonAnimationState;\n\tprivate _right:ISkeletonAnimationState;\n\n\t/**\n\t * Defines the direction in degrees of the aniamtion between the forwards (0), right(90) backwards (180) and left(270) input nodes,\n\t * used to produce the skeleton pose output.\n\t */\n\tpublic set direction(value:number)\n\t{\n\t\tif (this._direction == value)\n\t\t\treturn;\n\n\t\tthis._direction = value;\n\n\t\tthis._blendDirty = true;\n\n\t\tthis._skeletonPoseDirty = true;\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\tpublic get direction():number\n\t{\n\t\treturn this._direction;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDirectionalNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._forward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.forward);\n\t\tthis._backward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.backward);\n\t\tthis._left = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.left);\n\t\tthis._right = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.right);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the blend value for the animation output based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @private\n\t */\n\tprivate updateBlend()\n\t{\n\t\tthis._blendDirty = false;\n\n\t\tif (this._direction < 0 || this._direction > 360) {\n\t\t\tthis._direction %= 360;\n\t\t\tif (this._direction < 0)\n\t\t\t\tthis._direction += 360;\n\t\t}\n\n\t\tif (this._direction < 90) {\n\t\t\tthis._inputA = this._forward;\n\t\t\tthis._inputB = this._right;\n\t\t\tthis._blendWeight = this._direction/90;\n\t\t} else if (this._direction < 180) {\n\t\t\tthis._inputA = this._right;\n\t\t\tthis._inputB = this._backward;\n\t\t\tthis._blendWeight = (this._direction - 90)/90;\n\t\t} else if (this._direction < 270) {\n\t\t\tthis._inputA = this._backward;\n\t\t\tthis._inputB = this._left;\n\t\t\tthis._blendWeight = (this._direction - 180)/90;\n\t\t} else {\n\t\t\tthis._inputA = this._left;\n\t\t\tthis._inputB = this._forward;\n\t\t\tthis._blendWeight = (this._direction - 270)/90;\n\t\t}\n\t}\n}\n\nexport = SkeletonDirectionalState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonNaryLERPNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonNaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonNaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _blendWeights:Array<number> = new Array<number>();\n\tprivate _inputs:Array<ISkeletonAnimationState> = new Array<ISkeletonAnimationState>();\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonNaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tvar i:number /*uint*/ = this._skeletonAnimationNode.numInputs;\n\n\t\twhile (i--)\n\t\t\tthis._inputs[i] = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode._iInputs[i]);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(value);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(time);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * Returns the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node blend weight is requested.\n\t */\n\tpublic getBlendWeightAt(index:number /*uint*/):number\n\t{\n\t\treturn this._blendWeights[index];\n\t}\n\n\t/**\n\t * Sets the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index on which the skeleton animation node blend weight is to be set.\n\t * @param blendWeight The blend weight value to use for the given skeleton animation node index.\n\t */\n\tpublic setBlendWeightAt(index:number /*uint*/, blendWeight:number)\n\t{\n\t\tthis._blendWeights[index] = blendWeight;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar delta:Vector3D;\n\t\tvar weight:number;\n\n\t\tthis.positionDelta.x = 0;\n\t\tthis.positionDelta.y = 0;\n\t\tthis.positionDelta.z = 0;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (weight) {\n\t\t\t\tdelta = this._inputs[j].positionDelta;\n\t\t\t\tthis.positionDelta.x += weight*delta.x;\n\t\t\t\tthis.positionDelta.y += weight*delta.y;\n\t\t\t\tthis.positionDelta.z += weight*delta.z;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blend weight values given to the input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar weight:number;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses:Array<JointPose>;\n\t\tvar endPose:JointPose, pose:JointPose;\n\t\tvar endTr:Vector3D, tr:Vector3D;\n\t\tvar endQuat:Quaternion, q:Quaternion;\n\t\tvar firstPose:Array<JointPose>;\n\t\tvar i:number /*uint*/;\n\t\tvar w0:number, x0:number, y0:number, z0:number;\n\t\tvar w1:number, x1:number, y1:number, z1:number;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (!weight)\n\t\t\t\tcontinue;\n\n\t\t\tposes = this._inputs[j].getSkeletonPose(skeleton).jointPoses;\n\n\t\t\tif (!firstPose) {\n\t\t\t\tfirstPose = poses;\n\t\t\t\tfor (i = 0; i < numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\n\t\t\t\t\tif (endPose == null)\n\t\t\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\t\t\tpose = poses[i];\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tendQuat = endPose.orientation;\n\n\t\t\t\t\tendQuat.x = weight*q.x;\n\t\t\t\t\tendQuat.y = weight*q.y;\n\t\t\t\t\tendQuat.z = weight*q.z;\n\t\t\t\t\tendQuat.w = weight*q.w;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x = weight*tr.x;\n\t\t\t\t\tendTr.y = weight*tr.y;\n\t\t\t\t\tendTr.z = weight*tr.z;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (i = 0; i < skeleton.numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\t\t\t\t\tpose = poses[i];\n\n\t\t\t\t\tq = firstPose[i].orientation;\n\t\t\t\t\tx0 = q.x;\n\t\t\t\t\ty0 = q.y;\n\t\t\t\t\tz0 = q.z;\n\t\t\t\t\tw0 = q.w;\n\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tx1 = q.x;\n\t\t\t\t\ty1 = q.y;\n\t\t\t\t\tz1 = q.z;\n\t\t\t\t\tw1 = q.w;\n\t\t\t\t\t// find shortest direction\n\t\t\t\t\tif (x0*x1 + y0*y1 + z0*z1 + w0*w1 < 0) {\n\t\t\t\t\t\tx1 = -x1;\n\t\t\t\t\t\ty1 = -y1;\n\t\t\t\t\t\tz1 = -z1;\n\t\t\t\t\t\tw1 = -w1;\n\t\t\t\t\t}\n\t\t\t\t\tendQuat = endPose.orientation;\n\t\t\t\t\tendQuat.x += weight*x1;\n\t\t\t\t\tendQuat.y += weight*y1;\n\t\t\t\t\tendQuat.z += weight*z1;\n\t\t\t\t\tendQuat.w += weight*w1;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x += weight*tr.x;\n\t\t\t\t\tendTr.y += weight*tr.y;\n\t\t\t\t\tendTr.z += weight*tr.z;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < skeleton.numJoints; ++i)\n\t\t\tendPoses[i].orientation.normalize();\n\t}\n}\n\nexport = SkeletonNaryLERPState;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimator\");\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\n\n/**\n *\n */\nclass VertexClipState extends AnimationClipState implements IVertexAnimationState\n{\n\tprivate _frames:Array<Geometry>;\n\tprivate _vertexClipNode:VertexClipNode;\n\tprivate _currentGeometry:Geometry;\n\tprivate _nextGeometry:Geometry;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get currentGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentGeometry;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get nextGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextGeometry;\n\t}\n\n\tconstructor(animator:AnimatorBase, vertexClipNode:VertexClipNode)\n\t{\n\t\tsuper(animator, vertexClipNode);\n\n\t\tthis._vertexClipNode = vertexClipNode;\n\t\tthis._frames = this._vertexClipNode.frames;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentGeometry = this._frames[this._pCurrentFrame];\n\n\t\tif (this._vertexClipNode.looping && this._pNextFrame >= this._vertexClipNode.lastFrame) {\n\t\t\tthis._nextGeometry = this._frames[0];\n\t\t\t(<VertexAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextGeometry = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\t//TODO:implement positiondelta functionality for vertex animations\n\t}\n}\n\nexport = VertexClipState;",
    "import SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport CrossfadeTransitionState\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass CrossfadeTransitionNode extends SkeletonBinaryLERPNode\n{\n\tpublic blendSpeed:number;\n\n\tpublic startBlend:number /*int*/;\n\n\t/**\n\t * Creates a new <code>CrossfadeTransitionNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = CrossfadeTransitionState;\n\t}\n}\n\nexport = CrossfadeTransitionNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass CrossfadeTransitionState extends SkeletonBinaryLERPState\n{\n\tprivate _crossfadeTransitionNode:CrossfadeTransitionNode;\n\tprivate _animationStateTransitionComplete:AnimationStateEvent;\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:CrossfadeTransitionNode)\n\t{\n\t\tsuper(animator, <SkeletonBinaryLERPNode> skeletonAnimationNode);\n\n\t\tthis._crossfadeTransitionNode = skeletonAnimationNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis.blendWeight = Math.abs(time - this._crossfadeTransitionNode.startBlend)/(1000*this._crossfadeTransitionNode.blendSpeed);\n\n\t\tif (this.blendWeight >= 1) {\n\t\t\tthis.blendWeight = 1;\n\n\t\t\tif (this._animationStateTransitionComplete == null)\n\t\t\t\tthis._animationStateTransitionComplete = new AnimationStateEvent(AnimationStateEvent.TRANSITION_COMPLETE, this._pAnimator, this, this._crossfadeTransitionNode);\n\n\t\t\tthis._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n}\n\nexport = CrossfadeTransitionState;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\n\n/**\n *\n */\nclass CrossfadeTransition implements IAnimationTransition\n{\n\tpublic blendSpeed:number = 0.5;\n\n\tconstructor(blendSpeed:number)\n\t{\n\t\tthis.blendSpeed = blendSpeed;\n\t}\n\n\tpublic getAnimationNode(animator:AnimatorBase, startNode:AnimationNodeBase, endNode:AnimationNodeBase, startBlend:number /*int*/):AnimationNodeBase\n\t{\n\t\tvar crossFadeTransitionNode:CrossfadeTransitionNode = new CrossfadeTransitionNode();\n\t\tcrossFadeTransitionNode.inputA = startNode;\n\t\tcrossFadeTransitionNode.inputB = endNode;\n\t\tcrossFadeTransitionNode.blendSpeed = this.blendSpeed;\n\t\tcrossFadeTransitionNode.startBlend = startBlend;\n\n\t\treturn <AnimationNodeBase> crossFadeTransitionNode;\n\t}\n}\n\nexport = CrossfadeTransition;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * @class away.base.ParticleGeometry\n */\nclass ParticleGeometry extends Geometry\n{\n\tpublic particles:Array<ParticleData>;\n\n\tpublic numParticles:number /*uint*/;\n\n}\n\nexport = ParticleGeometry;",
    "import Error\t\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\nclass AnimationSetError extends Error\n{\n\tconstructor(message:string)\n\t{\n\t\tsuper(message);\n\t}\n}\n\nexport = AnimationSetError;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Event\t\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\n/**\n * Dispatched to notify changes in an animation state's state.\n */\nclass AnimationStateEvent extends Event\n{\n\t/**\n\t * Dispatched when a non-looping clip node inside an animation state reaches the end of its timeline.\n\t */\n\tpublic static PLAYBACK_COMPLETE:string = \"playbackComplete\";\n\n\tpublic static TRANSITION_COMPLETE:string = \"transitionComplete\";\n\n\tprivate _animator:AnimatorBase;\n\tprivate _animationState:IAnimationState;\n\tprivate _animationNode:AnimationNodeBase;\n\n\t/**\n\t * Create a new <code>AnimatonStateEvent</code>\n\t *\n\t * @param type The event type.\n\t * @param animator The animation state object that is the subject of this event.\n\t * @param animationNode The animation node inside the animation state from which the event originated.\n\t */\n\tconstructor(type:string, animator:AnimatorBase, animationState:IAnimationState, animationNode:AnimationNodeBase)\n\t{\n\t\tsuper(type);\n\n\t\tthis._animator = animator;\n\t\tthis._animationState = animationState;\n\t\tthis._animationNode = animationNode;\n\t}\n\n\t/**\n\t * The animator object that is the subject of this event.\n\t */\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * The animation state object that is the subject of this event.\n\t */\n\tpublic get animationState():IAnimationState\n\t{\n\t\treturn this._animationState;\n\t}\n\n\t/**\n\t * The animation node inside the animation state from which the event originated.\n\t */\n\tpublic get animationNode():AnimationNodeBase\n\t{\n\t\treturn this._animationNode;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimationStateEvent(this.type, this._animator, this._animationState, this._animationNode);\n\t}\n}\n\nexport = AnimationStateEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\n/**\n * Dispatched to notify changes in an animator's state.\n */\nclass AnimatorEvent extends Event\n{\n\t/**\n\t * Defines the value of the type property of a start event object.\n\t */\n\tpublic static START:string = \"start\";\n\n\t/**\n\t * Defines the value of the type property of a stop event object.\n\t */\n\tpublic static STOP:string = \"stop\";\n\n\t/**\n\t * Defines the value of the type property of a cycle complete event object.\n\t */\n\tpublic static CYCLE_COMPLETE:string = \"cycle_complete\";\n\n\tprivate _animator:AnimatorBase;\n\n\t/**\n\t * Create a new <code>AnimatorEvent</code> object.\n\t *\n\t * @param type The event type.\n\t * @param animator The animator object that is the subject of this event.\n\t */\n\tconstructor(type:string, animator:AnimatorBase)\n\t{\n\t\tsuper(type);\n\t\tthis._animator = animator;\n\t}\n\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current event object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimatorEvent(this.type, this._animator);\n\t}\n}\n\nexport = AnimatorEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass ShadingMethodEvent extends Event\n{\n\tpublic static SHADER_INVALIDATED:string = \"ShaderInvalidated\";\n\n\tconstructor(type:string)\n\t{\n\n\t\tsuper(type);\n\n\t}\n}\n\nexport = ShadingMethodEvent;",
    "import Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\nclass Filter3DBase\n{\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureWidth:number;\n\tprivate _textureHeight:number;\n\n\tconstructor()\n\t{\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic pAddTask(filter:Filter3DTaskBase)\n\t{\n\t\tthis._tasks.push(filter);\n\n\t\tif (this._requireDepthRender == null)\n\t\t\tthis._requireDepthRender = filter.requireDepthRender;\n\t}\n\n\tpublic get tasks():Filter3DTaskBase[]\n\t{\n\t\treturn this._tasks;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\treturn this._tasks[0].getMainInputTexture(stage);\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tthis._textureWidth = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureWidth = value;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tthis._textureHeight = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureHeight = value;\n\t}\n\n\t// link up the filters correctly with the next filter\n\tpublic setRenderTargets(mainTarget:ITexture, stage:Stage)\n\t{\n\t\tthis._tasks[this._tasks.length - 1].target = mainTarget;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].dispose();\n\t}\n\n\tpublic update(stage:Stage, camera:Camera)\n\t{\n\n\t}\n}\n\nexport = Filter3DBase;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nclass Filter3DTaskBase\n{\n\tprivate _mainInputTexture:ITexture;\n\n\tprivate _scaledTextureWidth:number = -1;\n\tprivate _scaledTextureHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _textureDimensionsInvalid:boolean = true;\n\tprivate _program3DInvalid:boolean = true;\n\tprivate _program3D:IProgram;\n\tprivate _target:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureScale:number = 0;\n\n\tconstructor(requireDepthRender:boolean = false)\n\t{\n\n\t\tthis._requireDepthRender = requireDepthRender;\n\n\t}\n\n\t/**\n\t * The texture scale for the input of this texture. This will define the output of the previous entry in the chain\n\t */\n\tpublic get textureScale():number\n\t{\n\t\treturn this._textureScale;\n\t}\n\n\tpublic set textureScale(value:number)\n\t{\n\t\tif (this._textureScale == value)\n\t\t\treturn;\n\n\t\tthis._textureScale = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get target():ITexture\n\t{\n\t\treturn this._target;\n\t}\n\n\tpublic set target(value:ITexture)\n\t{\n\t\tthis._target = value;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tif (this._textureWidth == value)\n\t\t\treturn;\n\n\t\tthis._textureWidth = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tif (this._textureHeight == value)\n\t\t\treturn;\n\n\t\tthis._textureHeight = value;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._textureDimensionsInvalid)\n\t\t\tthis.pUpdateTextures(stage);\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\t}\n\n\tpublic pInvalidateProgram()\n\t{\n\t\tthis._program3DInvalid = true;\n\t}\n\n\tpublic pUpdateProgram(stage:Stage)\n\t{\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\n\t\tthis._program3D = stage.context.createProgram();\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + this.pGetVertexCode() + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + this.pGetFragmentCode() + \"endpart\"))['fragment'].data;\n\t\tthis._program3D.upload(vertexByteCode, fragmentByteCode);\n\t\tthis._program3DInvalid = false;\n\t}\n\n\tpublic pGetVertexCode():string\n\t{\n\t\t// TODO: imeplement AGAL <> GLSL\n\n\t\treturn \"mov op, va0\\n\" + \"mov v0, va1\\n\";\n\t}\n\n\tpublic pGetFragmentCode():string\n\t{\n\t\tthrow new AbstractMethodError();\n\n\t\treturn null;\n\t}\n\n\tpublic pUpdateTextures(stage:Stage)\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tthis._mainInputTexture = stage.context.createTexture(this._scaledTextureWidth, this._scaledTextureHeight, ContextGLTextureFormat.BGRA, true);\n\n\t\tthis._textureDimensionsInvalid = false;\n\t}\n\n\tpublic getProgram(stage:Stage):IProgram\n\t{\n\t\tif (this._program3DInvalid)\n\t\t\tthis.pUpdateProgram(stage);\n\n\t\treturn this._program3D;\n\t}\n\n\tpublic activate(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t}\n\n\tpublic deactivate(stage:Stage)\n\t{\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n}\n\nexport = Filter3DTaskBase;",
    "import Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ImageUtils\t\t\t\t\t= require(\"awayjs-core/lib/utils/ImageUtils\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nclass RTTBufferManager extends EventDispatcher\n{\n\tprivate static _instances:Array<RTTBufferManagerVO>;\n\n\tprivate _renderToTextureVertexBuffer:IVertexBuffer;\n\tprivate _renderToScreenVertexBuffer:IVertexBuffer;\n\n\tprivate _indexBuffer:IIndexBuffer;\n\tprivate _stage:Stage;\n\tprivate _viewWidth:number = -1;\n\tprivate _viewHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _renderToTextureRect:Rectangle;\n\tprivate _buffersInvalid:boolean = true;\n\n\tprivate _textureRatioX:number;\n\tprivate _textureRatioY:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._renderToTextureRect = new Rectangle();\n\n\t\tthis._stage = stage;\n\n\t}\n\n\tpublic static getInstance(stage:Stage):RTTBufferManager\n\t{\n\t\tif (!stage)\n\t\t\tthrow new Error(\"stage key cannot be null!\");\n\n\t\tif (RTTBufferManager._instances == null)\n\t\t\tRTTBufferManager._instances = new Array<RTTBufferManagerVO>();\n\n\t\tvar rttBufferManager:RTTBufferManager = RTTBufferManager.getRTTBufferManagerFromStage(stage);\n\n\t\tif (rttBufferManager == null) {\n\t\t\trttBufferManager = new RTTBufferManager(stage);\n\n\t\t\tvar vo:RTTBufferManagerVO = new RTTBufferManagerVO();\n\n\t\t\tvo.stage3d = stage;\n\t\t\tvo.rttbfm = rttBufferManager;\n\n\t\t\tRTTBufferManager._instances.push(vo);\n\t\t}\n\n\t\treturn rttBufferManager;\n\n\t}\n\n\tprivate static getRTTBufferManagerFromStage(stage:Stage):RTTBufferManager\n\t{\n\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage)\n\t\t\t\treturn r.rttbfm;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate static deleteRTTBufferManager(stage:Stage):void\n\t{\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage) {\n\t\t\t\tRTTBufferManager._instances.splice(c, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get textureRatioX():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioX;\n\t}\n\n\tpublic get textureRatioY():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioY;\n\t}\n\n\tpublic get viewWidth():number\n\t{\n\t\treturn this._viewWidth;\n\t}\n\n\tpublic set viewWidth(value:number)\n\t{\n\t\tif (value == this._viewWidth)\n\t\t\treturn;\n\n\t\tthis._viewWidth = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureWidth = ImageUtils.getBestPowerOf2(this._viewWidth);\n\n\t\tif (this._textureWidth > this._viewWidth) {\n\t\t\tthis._renderToTextureRect.x = Math.floor((this._textureWidth - this._viewWidth)*.5);\n\t\t\tthis._renderToTextureRect.width = this._viewWidth;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.x = 0;\n\t\t\tthis._renderToTextureRect.width = this._textureWidth;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get viewHeight():number\n\t{\n\t\treturn this._viewHeight;\n\t}\n\n\tpublic set viewHeight(value:number)\n\t{\n\t\tif (value == this._viewHeight)\n\t\t\treturn;\n\n\t\tthis._viewHeight = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureHeight = ImageUtils.getBestPowerOf2(this._viewHeight);\n\n\t\tif (this._textureHeight > this._viewHeight) {\n\t\t\tthis._renderToTextureRect.y = Math.floor((this._textureHeight - this._viewHeight)*.5);\n\t\t\tthis._renderToTextureRect.height = this._viewHeight;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.y = 0;\n\t\t\tthis._renderToTextureRect.height = this._textureHeight;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get renderToTextureVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureVertexBuffer;\n\t}\n\n\tpublic get renderToScreenVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToScreenVertexBuffer;\n\n\t}\n\n\tpublic get indexBuffer():IIndexBuffer\n\t{\n\t\treturn this._indexBuffer;\n\t}\n\n\tpublic get renderToTextureRect():Rectangle\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureRect;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tRTTBufferManager.deleteRTTBufferManager(this._stage);\n\n\t\tif (this._indexBuffer) {\n\t\t\tthis._indexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer.dispose();\n\t\t\tthis._renderToTextureVertexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer = null;\n\t\t\tthis._renderToTextureVertexBuffer = null;\n\t\t\tthis._indexBuffer = null;\n\t\t}\n\t}\n\n\t// todo: place all this in a separate model, since it's used all over the place\n\t// maybe it even has a place in the core (together with screenRect etc)?\n\t// needs to be stored per view of course\n\tprivate updateRTTBuffers()\n\t{\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar textureVerts:number[];\n\t\tvar screenVerts:number[];\n\n\t\tvar x:number;\n\t\tvar y:number;\n\n\t\tif (this._renderToTextureVertexBuffer == null)\n\t\t\tthis._renderToTextureVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (this._renderToScreenVertexBuffer == null)\n\t\t\tthis._renderToScreenVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (!this._indexBuffer) {\n\t\t\tthis._indexBuffer = context.createIndexBuffer(6);\n\n\t\t\tthis._indexBuffer.uploadFromArray([2, 1, 0, 3, 2, 0], 0, 6);\n\t\t}\n\n\t\tthis._textureRatioX = x = Math.min(this._viewWidth/this._textureWidth, 1);\n\t\tthis._textureRatioY = y = Math.min(this._viewHeight/this._textureHeight, 1);\n\n\t\tvar u1:number = (1 - x)*.5;\n\t\tvar u2:number = (x + 1)*.5;\n\t\tvar v1:number = (y + 1)*.5;\n\t\tvar v2:number = (1 - y)*.5;\n\n\t\t// last element contains indices for data per vertex that can be passed to the vertex shader if necessary (ie: frustum corners for deferred rendering)\n\t\ttextureVerts = [    -x, -y, u1, v1, 0, x, -y, u2, v1, 1, x, y, u2, v2, 2, -x, y, u1, v2, 3 ];\n\n\t\tscreenVerts = [     -1, -1, u1, v1, 0, 1, -1, u2, v1, 1, 1, 1, u2, v2, 2, -1, 1, u1, v2, 3 ];\n\n\t\tthis._renderToTextureVertexBuffer.uploadFromArray(textureVerts, 0, 4);\n\t\tthis._renderToScreenVertexBuffer.uploadFromArray(screenVerts, 0, 4);\n\n\t\tthis._buffersInvalid = false;\n\t}\n}\n\nexport = RTTBufferManager;\n\nclass RTTBufferManagerVO\n{\n\tpublic stage3d:Stage;\n\n\tpublic rttbfm:RTTBufferManager;\n}",
    "import Debug\t\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/Debug\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Box\t\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Box\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Scene\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport View\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport IPicker\t\t\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPicker\");\nimport PickingCollisionVO\t\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport EntityCollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport AGALMiniAssembler\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLClearMask\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLCompareMode\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTriangleFace\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITextureBase\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITextureBase\");\n\nimport DefaultRenderer\t\t\t\t\t= require(\"awayjs-renderergl/lib/DefaultRenderer\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport SubGeometryVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n * Picks a 3d object from a view or scene by performing a separate render pass on the scene around the area being picked using key color values,\n * then reading back the color value of the pixel in the render representing the picking ray. Requires multiple passes and readbacks for retriving details\n * on an entity that has its shaderPickingDetails property set to true.\n *\n * A read-back operation from any GPU is not a very efficient process, and the amount of processing used can vary significantly between different hardware.\n *\n * @see away.entities.Entity#shaderPickingDetails\n *\n * @class away.pick.ShaderPicker\n */\nclass ShaderPicker implements IPicker\n{\n\tprivate _opaqueRenderableHead:RenderableBase;\n\tprivate _blendedRenderableHead:RenderableBase;\n\n\tprivate _stage:Stage;\n\tprivate _context:IContextGL;\n\tprivate _onlyMouseEnabled:boolean = true;\n\n\tprivate _objectProgram:IProgram;\n\tprivate _triangleProgram:IProgram;\n\tprivate _bitmapImage2D:BitmapImage2D;\n\tprivate _viewportData:Array<number>;\n\tprivate _boundOffsetScale:Array<number>;\n\tprivate _id:Array<number>;\n\n\tprivate _interactives:Array<RenderableBase> = new Array<RenderableBase>();\n\tprivate _interactiveId:number;\n\tprivate _hitColor:number;\n\tprivate _projX:number;\n\tprivate _projY:number;\n\n\tprivate _hitRenderable:RenderableBase;\n\tprivate _hitEntity:IEntity;\n\tprivate _localHitPosition:Vector3D = new Vector3D();\n\tprivate _hitUV:Point = new Point();\n\tprivate _faceIndex:number;\n\tprivate _subGeometryIndex:number;\n\n\tprivate _localHitNormal:Vector3D = new Vector3D();\n\n\tprivate _rayPos:Vector3D = new Vector3D();\n\tprivate _rayDir:Vector3D = new Vector3D();\n\tprivate _potentialFound:boolean;\n\tprivate static MOUSE_SCISSOR_RECT:Rectangle = new Rectangle(0, 0, 1, 1);\n\n\tprivate _shaderPickingDetails:boolean;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get onlyMouseEnabled():boolean\n\t{\n\t\treturn this._onlyMouseEnabled;\n\t}\n\n\tpublic set onlyMouseEnabled(value:boolean)\n\t{\n\t\tthis._onlyMouseEnabled = value;\n\t}\n\n\t/**\n\t * Creates a new <code>ShaderPicker</code> object.\n\t *\n\t * @param shaderPickingDetails Determines whether the picker includes a second pass to calculate extra\n\t * properties such as uv and normal coordinates.\n\t */\n\tconstructor(shaderPickingDetails:boolean = false)\n\t{\n\t\tthis._shaderPickingDetails = shaderPickingDetails;\n\n\t\tthis._id = new Array<number>(4);\n\t\tthis._viewportData = new Array<number>(4); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale = new Array<number>(8); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale[3] = 0;\n\t\tthis._boundOffsetScale[7] = 1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getViewCollision(x:number, y:number, view:View):PickingCollisionVO\n\t{\n\t\tvar collector:EntityCollector = <EntityCollector> view.iEntityCollector;\n\n\t\tthis._stage = (<DefaultRenderer> view.renderer).stage;\n\n\t\tif (!this._stage)\n\t\t\treturn null;\n\n\t\tthis._context = <IContextGL> this._stage.context;\n\n\t\tthis._viewportData[0] = view.width;\n\t\tthis._viewportData[1] = view.height;\n\t\tthis._viewportData[2] = -(this._projX = 2*x/view.width - 1);\n\t\tthis._viewportData[3] = this._projY = 2*y/view.height - 1;\n\n\t\t// _potentialFound will be set to true if any object is actually rendered\n\t\tthis._potentialFound = false;\n\n\t\t//reset head values\n\t\tthis._blendedRenderableHead = null;\n\t\tthis._opaqueRenderableHead = null;\n\n\t\tthis.pDraw(collector, null);\n\n\t\t// clear buffers\n\t\tthis._context.setVertexBufferAt(0, null);\n\n\t\tif (!this._context || !this._potentialFound)\n\t\t\treturn null;\n\n\t\tif (!this._bitmapImage2D)\n\t\t\tthis._bitmapImage2D = new BitmapImage2D(1, 1, false, 0);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\t\tthis._hitColor = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tif (!this._hitColor) {\n\t\t\tthis._context.present();\n\t\t\treturn null;\n\t\t}\n\n\t\tthis._hitRenderable = this._interactives[this._hitColor - 1];\n\t\tthis._hitEntity = this._hitRenderable.sourceEntity;\n\n\t\tif (this._onlyMouseEnabled && !this._hitEntity._iIsMouseEnabled())\n\t\t\treturn null;\n\n\t\tvar _collisionVO:PickingCollisionVO = this._hitEntity._iPickingCollisionVO;\n\t\tif (this._shaderPickingDetails) {\n\t\t\tthis.getHitDetails(view.camera);\n\t\t\t_collisionVO.localPosition = this._localHitPosition;\n\t\t\t_collisionVO.localNormal = this._localHitNormal;\n\t\t\t_collisionVO.uv = this._hitUV;\n\t\t\t_collisionVO.index = this._faceIndex;\n\t\t\t//_collisionVO.subGeometryIndex = this._subGeometryIndex;\n\n\t\t} else {\n\t\t\t_collisionVO.localPosition = null;\n\t\t\t_collisionVO.localNormal = null;\n\t\t\t_collisionVO.uv = null;\n\t\t\t_collisionVO.index = 0;\n\t\t\t//_collisionVO.subGeometryIndex = 0;\n\t\t}\n\n\t\treturn _collisionVO;\n\t}\n\n\t//*/\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getSceneCollision(position:Vector3D, direction:Vector3D, scene:Scene):PickingCollisionVO\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector, target:ITextureBase)\n\t{\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis._context.clear(0, 0, 0, 1);\n\t\tthis._stage.scissorRect = ShaderPicker.MOUSE_SCISSOR_RECT;\n\n\t\tthis._interactives.length = this._interactiveId = 0;\n\n\t\tif (!this._objectProgram)\n\t\t\tthis.initObjectProgram();\n\n\t\tthis._context.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._context.setDepthTest(true, ContextGLCompareMode.LESS);\n\t\tthis._context.setProgram(this._objectProgram);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._viewportData, 1);\n\t\t//this.drawRenderables(entityCollector.opaqueRenderableHead, camera);\n\t\t//this.drawRenderables(entityCollector.blendedRenderableHead, camera);\n\t\t//TODO: reimplement ShaderPicker inheriting from RendererBase\n\t}\n\n\t/**\n\t * Draw a list of renderables.\n\t * @param renderables The renderables to draw.\n\t * @param camera The camera for which to render.\n\t */\n\tprivate drawRenderables(renderable:RenderableBase, camera:Camera)\n\t{\n\t\tvar matrix:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\t\tvar viewProjection:Matrix3D = camera.viewProjection;\n\n\t\twhile (renderable) {\n\t\t\t// it's possible that the renderable was already removed from the scene\n\t\t\tif (!renderable.sourceEntity.scene || !renderable.sourceEntity._iIsMouseEnabled()) {\n\t\t\t\trenderable = renderable.next;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._potentialFound = true;\n\n\t\t\tthis._context.setCulling((<MaterialBase> renderable.renderOwner).bothSides? ContextGLTriangleFace.NONE : ContextGLTriangleFace.BACK, camera.projection.coordinateSystem);\n\n\t\t\tthis._interactives[this._interactiveId++] = renderable;\n\t\t\t// color code so that reading from bitmapdata will contain the correct value\n\t\t\tthis._id[1] = (this._interactiveId >> 8)/255; // on green channel\n\t\t\tthis._id[2] = (this._interactiveId & 0xff)/255; // on blue channel\n\n\t\t\tmatrix.copyFrom(renderable.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix.append(viewProjection);\n\t\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, matrix, true);\n\t\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, this._id, 1);\n\n\t\t\tvar subGeometryVO:SubGeometryVOBase = this._hitRenderable.subGeometryVO;\n\n\t\t\tsubGeometryVO.activateVertexBufferVO(0, (<TriangleSubGeometry> subGeometryVO.subGeometry).positions, this._stage);\n\t\t\tsubGeometryVO.getIndexBufferVO(this._stage).draw(0, subGeometryVO.numElements);\n\n\t\t\trenderable = renderable.next;\n\t\t}\n\n\t}\n\n\tprivate updateRay(camera:Camera)\n\t{\n\t\tthis._rayPos = camera.scenePosition;\n\n\t\tthis._rayDir = camera.getRay(this._projX, this._projY, 1);\n\t\tthis._rayDir.normalize();\n\t}\n\n\t/**\n\t * Creates the Program that color-codes objects.\n\t */\n\tprivate initObjectProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._objectProgram = this._context.createProgram();\n\n\t\tvertexCode = \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, fc0\"; // write identifier\n\n\t\tDebug.throwPIR('ShaderPicker', 'initTriangleProgram', 'Dependency: initObjectProgram')\n\t\t//_objectProgram.upload(new AGALMiniAssembler().assemble(ContextGLProgramType.VERTEX, vertexCode),new AGALMiniAssembler().assemble(ContextGLProgramType.FRAGMENT, fragmentCode));\n\t}\n\n\t/**\n\t * Creates the Program that renders positions.\n\t */\n\n\tprivate initTriangleProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._triangleProgram = this._context.createProgram();\n\n\t\t// todo: add animation code\n\t\tvertexCode = \"add vt0, va0, vc5 \t\t\t\\n\" + \"mul vt0, vt0, vc6 \t\t\t\\n\" + \"mov v0, vt0\t\t\t\t\\n\" + \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, v0\"; // write identifier\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + vertexCode + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + fragmentCode + \"endpart\"))['fragment'].data;\n\t\tthis._triangleProgram.upload(vertexByteCode, fragmentByteCode);\n\t}\n\n\t/**\n\t * Gets more detailed information about the hir position, if required.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getHitDetails(camera:Camera)\n\t{\n\t\tthis.getApproximatePosition(camera);\n\t\tthis.getPreciseDetails(camera);\n\t}\n\n\t/**\n\t * Finds a first-guess approximate position about the hit position.\n\t *\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getApproximatePosition(camera:Camera)\n\t{\n\t\tvar bounds:Box = this._hitRenderable.sourceEntity.getBox();\n\t\tvar col:number;\n\t\tvar scX:number, scY:number, scZ:number;\n\t\tvar offsX:number, offsY:number, offsZ:number;\n\t\tvar localViewProjection:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\tlocalViewProjection.copyFrom(this._hitRenderable.sourceEntity.getRenderSceneTransform(camera));\n\t\tlocalViewProjection.append(camera.viewProjection);\n\t\tif (!this._triangleProgram) {\n\t\t\tthis.initTriangleProgram();\n\t\t}\n\n\t\tthis._boundOffsetScale[4] = 1/(scX = bounds.width);\n\t\tthis._boundOffsetScale[5] = 1/(scY = bounds.height);\n\t\tthis._boundOffsetScale[6] = 1/(scZ = bounds.depth);\n\t\tthis._boundOffsetScale[0] = offsX = -bounds.x;\n\t\tthis._boundOffsetScale[1] = offsY = -bounds.y;\n\t\tthis._boundOffsetScale[2] = offsZ = -bounds.z;\n\n\t\tthis._context.setProgram(this._triangleProgram);\n\t\tthis._context.clear(0, 0, 0, 0, 1, 0, ContextGLClearMask.DEPTH);\n\t\tthis._context.setScissorRectangle(ShaderPicker.MOUSE_SCISSOR_RECT);\n\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, localViewProjection, true);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, this._boundOffsetScale, 2);\n\n\t\tvar subGeometryVO:SubGeometryVOBase = this._hitRenderable.subGeometryVO;\n\n\t\tsubGeometryVO.activateVertexBufferVO(0, (<TriangleSubGeometry> subGeometryVO.subGeometry).positions, this._stage);\n\t\tsubGeometryVO.getIndexBufferVO(this._stage).draw(0, subGeometryVO.numElements);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\n\t\tcol = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tthis._localHitPosition.x = ((col >> 16) & 0xff)*scX/255 - offsX;\n\t\tthis._localHitPosition.y = ((col >> 8) & 0xff)*scY/255 - offsY;\n\t\tthis._localHitPosition.z = (col & 0xff)*scZ/255 - offsZ;\n\t}\n\n\t/**\n\t * Use the approximate position info to find the face under the mouse position from which we can derive the precise\n\t * ray-face intersection point, then use barycentric coordinates to figure out the uv coordinates, etc.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getPreciseDetails(camera:Camera)\n\t{\n\t\tvar len:number = indices.length;\n\t\tvar x1:number, y1:number, z1:number;\n\t\tvar x2:number, y2:number, z2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\t\tvar i:number = 0, j:number = 1, k:number = 2;\n\t\tvar t1:number, t2:number, t3:number;\n\t\tvar v0x:number, v0y:number, v0z:number;\n\t\tvar v1x:number, v1y:number, v1z:number;\n\t\tvar v2x:number, v2y:number, v2z:number;\n\t\tvar ni1:number, ni2:number, ni3:number;\n\t\tvar n1:number, n2:number, n3:number, nLength:number;\n\t\tvar dot00:number, dot01:number, dot02:number, dot11:number, dot12:number;\n\t\tvar s:number, t:number, invDenom:number;\n\t\tvar x:number = this._localHitPosition.x, y:number = this._localHitPosition.y, z:number = this._localHitPosition.z;\n\t\tvar u:number, v:number;\n\t\tvar ui1:number, ui2:number, ui3:number;\n\t\tvar s0x:number, s0y:number, s0z:number;\n\t\tvar s1x:number, s1y:number, s1z:number;\n\t\tvar nl:number;\n\t\tvar subGeom:TriangleSubGeometry = <TriangleSubGeometry> this._hitRenderable._pGetSubGeometry();\n\t\tvar indices:Uint16Array = subGeom.indices.get(subGeom.numElements);\n\n\t\tvar positions:Float32Array = subGeom.positions.get(subGeom.numVertices);\n\t\tvar posDim:number = subGeom.positions.dimensions;\n\n\t\tvar uvs:Float32Array = subGeom.uvs.get(subGeom.numVertices);\n\t\tvar uvDim:number = subGeom.uvs.dimensions;\n\n\t\tvar normals:Float32Array = subGeom.normals.get(subGeom.numVertices);\n\t\tvar normalDim:number = subGeom.normals.dimensions;\n\n\t\tthis.updateRay(camera);\n\n\t\twhile (i < len) {\n\t\t\tt1 = indices[i]*posDim;\n\t\t\tt2 = indices[j]*posDim;\n\t\t\tt3 = indices[k]*posDim;\n\t\t\tx1 = positions[t1];\n\t\t\ty1 = positions[t1 + 1];\n\t\t\tz1 = positions[t1 + 2];\n\t\t\tx2 = positions[t2];\n\t\t\ty2 = positions[t2 + 1];\n\t\t\tz2 = positions[t2 + 2];\n\t\t\tx3 = positions[t3];\n\t\t\ty3 = positions[t3 + 1];\n\t\t\tz3 = positions[t3 + 2];\n\n\t\t\t// if within bounds\n\t\t\tif (!(    (x < x1 && x < x2 && x < x3) || (y < y1 && y < y2 && y < y3) || (z < z1 && z < z2 && z < z3) || (x > x1 && x > x2 && x > x3) || (y > y1 && y > y2 && y > y3) || (z > z1 && z > z2 && z > z3))) {\n\n\t\t\t\t// calculate barycentric coords for approximated position\n\t\t\t\tv0x = x3 - x1;\n\t\t\t\tv0y = y3 - y1;\n\t\t\t\tv0z = z3 - z1;\n\t\t\t\tv1x = x2 - x1;\n\t\t\t\tv1y = y2 - y1;\n\t\t\t\tv1z = z2 - z1;\n\t\t\t\tv2x = x - x1;\n\t\t\t\tv2y = y - y1;\n\t\t\t\tv2z = z - z1;\n\t\t\t\tdot00 = v0x*v0x + v0y*v0y + v0z*v0z;\n\t\t\t\tdot01 = v0x*v1x + v0y*v1y + v0z*v1z;\n\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\tdot11 = v1x*v1x + v1y*v1y + v1z*v1z;\n\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\tinvDenom = 1/(dot00*dot11 - dot01*dot01);\n\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t// if inside the current triangle, fetch details hit information\n\t\t\t\tif (s >= 0 && t >= 0 && (s + t) <= 1) {\n\n\t\t\t\t\tni1 = indices[i]*normalDim;\n\t\t\t\t\tni2 = indices[j]*normalDim;\n\t\t\t\t\tni3 = indices[k]*normalDim;\n\n\t\t\t\t\tn1 = indices[ni1] + indices[ni2] + indices[ni3];\n\t\t\t\t\tn2 = indices[ni1 + 1] + indices[ni2 + 1] + indices[ni3 + 1];\n\t\t\t\t\tn3 = indices[ni1 + 2] + indices[ni2 + 2] + indices[ni3 + 2];\n\n\t\t\t\t\tnLength = Math.sqrt(n1*n1 + n2*n2 + n3*n3);\n\n\t\t\t\t\tn1 /= nLength;\n\t\t\t\t\tn2 /= nLength;\n\t\t\t\t\tn3 /= nLength;\n\n\t\t\t\t\t// this is def the triangle, now calculate precise coords\n\t\t\t\t\tthis.getPrecisePosition(this._hitRenderable.sourceEntity.inverseSceneTransform, n1, n2, n3, x1, y1, z1);\n\n\t\t\t\t\tv2x = this._localHitPosition.x - x1;\n\t\t\t\t\tv2y = this._localHitPosition.y - y1;\n\t\t\t\t\tv2z = this._localHitPosition.z - z1;\n\n\t\t\t\t\ts0x = x2 - x1; // s0 = p1 - p0\n\t\t\t\t\ts0y = y2 - y1;\n\t\t\t\t\ts0z = z2 - z1;\n\t\t\t\t\ts1x = x3 - x1; // s1 = p2 - p0\n\t\t\t\t\ts1y = y3 - y1;\n\t\t\t\t\ts1z = z3 - z1;\n\t\t\t\t\tthis._localHitNormal.x = s0y*s1z - s0z*s1y; // n = s0 x s1\n\t\t\t\t\tthis._localHitNormal.y = s0z*s1x - s0x*s1z;\n\t\t\t\t\tthis._localHitNormal.z = s0x*s1y - s0y*s1x;\n\t\t\t\t\tnl = 1/Math.sqrt(this._localHitNormal.x*this._localHitNormal.x + this._localHitNormal.y*this._localHitNormal.y + this._localHitNormal.z*this._localHitNormal.z); // normalize n\n\t\t\t\t\tthis._localHitNormal.x *= nl;\n\t\t\t\t\tthis._localHitNormal.y *= nl;\n\t\t\t\t\tthis._localHitNormal.z *= nl;\n\n\t\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t\tui1 = indices[i]*uvDim\n\t\t\t\t\tui2 = indices[j]*uvDim\n\t\t\t\t\tui3 = indices[k]*uvDim\n\n\t\t\t\t\tu = uvs[ui1];\n\t\t\t\t\tv = uvs[ui1 + 1];\n\t\t\t\t\tthis._hitUV.x = u + t*(uvs[ui2] - u) + s*(uvs[ui3] - u);\n\t\t\t\t\tthis._hitUV.y = v + t*(uvs[ui2 + 1] - v) + s*(uvs[ui3 + 1] - v);\n\n\t\t\t\t\tthis._faceIndex = i;\n\t\t\t\t\t//TODO add back subGeometryIndex value\n\t\t\t\t\t//this._subGeometryIndex = away.utils.GeometryUtils.getMeshSubGeometryIndex(subGeom);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti += 3;\n\t\t\tj += 3;\n\t\t\tk += 3;\n\t\t}\n\t}\n\n\t/**\n\t * Finds the precise hit position by unprojecting the screen coordinate back unto the hit face's plane and\n\t * calculating the intersection point.\n\t * @param camera The camera used to render the object.\n\t * @param invSceneTransform The inverse scene transformation of the hit object.\n\t * @param nx The x-coordinate of the face's plane normal.\n\t * @param ny The y-coordinate of the face plane normal.\n\t * @param nz The z-coordinate of the face plane normal.\n\t * @param px The x-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param py The y-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param pz The z-coordinate of a point on the face's plane (ie a face vertex)\n\t */\n\n\tprivate getPrecisePosition(invSceneTransform:Matrix3D, nx:number, ny:number, nz:number, px:number, py:number, pz:number)\n\t{\n\t\t// calculate screen ray and find exact intersection position with triangle\n\t\tvar rx:number, ry:number, rz:number;\n\t\tvar ox:number, oy:number, oz:number;\n\t\tvar t:number;\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tvar cx:number = this._rayPos.x, cy:number = this._rayPos.y, cz:number = this._rayPos.z;\n\n\t\t// unprojected projection point, gives ray dir in cam space\n\t\tox = this._rayDir.x;\n\t\toy = this._rayDir.y;\n\t\toz = this._rayDir.z;\n\n\t\t// transform ray dir and origin (cam pos) to object space\n\t\t//invSceneTransform.copyRawDataTo( raw  );\n\t\tinvSceneTransform.copyRawDataTo(raw);\n\t\trx = raw[0]*ox + raw[4]*oy + raw[8]*oz;\n\t\try = raw[1]*ox + raw[5]*oy + raw[9]*oz;\n\t\trz = raw[2]*ox + raw[6]*oy + raw[10]*oz;\n\n\t\tox = raw[0]*cx + raw[4]*cy + raw[8]*cz + raw[12];\n\t\toy = raw[1]*cx + raw[5]*cy + raw[9]*cz + raw[13];\n\t\toz = raw[2]*cx + raw[6]*cy + raw[10]*cz + raw[14];\n\n\t\tt = ((px - ox)*nx + (py - oy)*ny + (pz - oz)*nz)/(rx*nx + ry*ny + rz*nz);\n\n\t\tthis._localHitPosition.x = ox + rx*t;\n\t\tthis._localHitPosition.y = oy + ry*t;\n\t\tthis._localHitPosition.z = oz + rz*t;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._bitmapImage2D.dispose();\n\t\tif (this._triangleProgram)\n\t\t\tthis._triangleProgram.dispose();\n\n\t\tif (this._objectProgram)\n\t\t\tthis._objectProgram.dispose();\n\n\t\tthis._triangleProgram = null;\n\t\tthis._objectProgram = null;\n\t\tthis._bitmapImage2D = null;\n\t\tthis._hitRenderable = null;\n\t\tthis._hitEntity = null;\n\t}\n}\n\nexport = ShaderPicker;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport BasicMaterialPass\t\t\t= require(\"awayjs-renderergl/lib/render/passes/BasicMaterialPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\n\n/**\n * RenderMaterialObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass BasicMaterialRender extends RenderBase\n{\n\tprivate _material:BasicMaterial;\n\tprivate _pass:BasicMaterialPass;\n\n\n\tconstructor(pool:RenderPool, material:BasicMaterial, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, material, renderableClass, stage);\n\n\t\tthis._material = material;\n\n\t\tthis._pAddPass(this._pass = new BasicMaterialPass(this, material, renderableClass, this._stage));\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tsuper._pUpdateRender();\n\n\t\tthis._pRequiresBlending = (this._material.blendMode != BlendMode.NORMAL || this._material.alphaBlending || (this._material.colorTransform && this._material.colorTransform.alphaMultiplier < 1));\n\t\tthis._pass.preserveAlpha = this._material.preserveAlpha;//this._pRequiresBlending;\n\t\tthis._pass.shader.setBlendMode((this._renderOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._material.blendMode);\n\t\t//this._pass.forceSeparateMVP = false;\n\t}\n}\n\nexport = BasicMaterialRender;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * DepthRender forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass DepthRender extends RenderPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\n\t/**\n\t *\n\t * @param pool\n\t * @param renderOwner\n\t * @param renderableClass\n\t * @param stage\n\t */\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.projectionDependencies++;\n\n\t\tif (shader.alphaThreshold > 0)\n\t\t\tshader.uvDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\t\tsuper._iInitConstantData(shader);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\tdata[index] = 1.0;\n\t\tdata[index + 1] = 255.0;\n\t\tdata[index + 2] = 65025.0;\n\t\tdata[index + 3] = 16581375.0;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\tcode += \"div \" + temp1 + \", \" + sharedRegisters.projectionFragment + \", \" + sharedRegisters.projectionFragment + \".w\\n\" + //\"sub ft2.z, fc0.x, ft2.z\\n\" +    //invert\n\t\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\t//codeF += \"mov ft1.w, fc1.w\t\\n\" +\n\t\t//    \"mov ft0.w, fc0.x\t\\n\";\n\n\t\tif (shader.texture && shader.alphaThreshold > 0) {\n\n\t\t\tshader.texture._iInitRegisters(shader, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\tregisterCache.removeFragmentTempUsage(temp1);\n\t\tregisterCache.removeFragmentTempUsage(temp2);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tif (this._shader.texture && this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DepthRender;",
    "﻿import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * DistanceRender is a pass that writes distance values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render omnidirectional shadow maps.\n */\nclass DistanceRender extends RenderPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\n\t/**\n\t * Creates a new DistanceRender object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\t\tsuper._iInitConstantData(shader);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.projectionDependencies++;\n\t\tshader.viewDirDependencies++;\n\n\t\tif (shader.alphaThreshold > 0)\n\t\t\tshader.uvDependencies++;\n\n\t\tif (shader.viewDirDependencies > 0)\n\t\t\tshader.globalPosDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string;\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\t// squared distance to view\n\t\tcode = \"dp3 \" + temp1 + \".z, \" + sharedRegisters.viewDirVarying + \".xyz, \" + sharedRegisters.viewDirVarying + \".xyz\\n\" +\n\t\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\tif (shader.alphaThreshold > 0) {\n\t\t\tshader.texture._iInitRegisters(shader, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar f:number = camera.projection.far;\n\n\t\tf = 1/(2*f*f);\n\t\t// sqrt(f*f+f*f) is largest possible distance for any frustum, so we need to divide by it. Rarely a tight fit, but with 32 bits precision, it's enough.\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\tdata[index] = 1.0*f;\n\t\tdata[index + 1] = 255.0*f;\n\t\tdata[index + 2] = 65025.0*f;\n\t\tdata[index + 3] = 16581375.0*f;\n\n\t\tif (this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tdata[index + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DistanceRender;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport IRender\t\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRender\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n *\n * @class away.pool.Passes\n */\nclass RenderBase extends EventDispatcher implements IRender\n{\n\tpublic _forceSeparateMVP:boolean = false;\n\n\tprivate _pool:RenderPool;\n\tpublic _renderOwner:IRenderOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\n\tprivate _renderOrderId:number;\n\tprivate _invalidAnimation:boolean = true;\n\tprivate _invalidRender:boolean = true;\n\tprivate _passes:Array<IPass> = new Array<IPass>();\n\n\n\n\tpublic _pRequiresBlending:boolean = false;\n\n\tprivate _onPassChangeDelegate:(event:Event) => void;\n\n\tpublic renderId:number;\n\n\t/**\n\t * Indicates whether or not the renderable requires alpha blending during rendering.\n\t */\n\tpublic get requiresBlending():boolean\n\t{\n\t\treturn this._pRequiresBlending;\n\t}\n\n\tpublic get renderOrderId():number\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._renderOrderId;\n\t}\n\n\tpublic get passes():Array<IPass>\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._passes;\n\t}\n\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._pool = pool;\n\t\tthis.renderId = renderOwner.id;\n\t\tthis._renderOwner = renderOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\n\n\t\tthis._onPassChangeDelegate = (event:Event) => this.onPassChange(event);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tthis._renderableClass._iIncludeDependencies(shader);\n\n\t\tshader.alphaThreshold = this._renderOwner.alphaThreshold;\n\t\tshader.useMipmapping = this._renderOwner.mipmap;\n\t\tshader.useSmoothTextures = this._renderOwner.smooth;\n\n\t\tif (this._renderOwner instanceof MaterialBase) {\n\t\t\tvar material:MaterialBase = <MaterialBase> this._renderOwner;\n\t\t\tshader.useAlphaPremultiplied = material.alphaPremultiplied;\n\t\t\tshader.useBothSides = material.bothSides;\n\t\t\tshader.repeatTextures = material.repeat;\n\t\t\tshader.usesUVTransform = material.animateUVs;\n\t\t\tshader.usesColorTransform = material.useColorTransform;\n\t\t\tif (material.texture)\n\t\t\t\tshader.texture = shader.getTextureVO(material.texture);\n\t\t\tshader.color = material.color;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pClearPasses();\n\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].dispose();\n\n\t\tthis._passes = null;\n\n\t\tthis._pool.disposeItem(this._renderOwner);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateRender()\n\t{\n\t\tthis._invalidRender = true;\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidatePasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].invalidatePass();\n\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateAnimation()\n\t{\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t * @param renderOwner\n\t */\n\tprivate _updateAnimation()\n\t{\n\t\tif (this._invalidRender)\n\t\t\tthis._pUpdateRender();\n\n\t\tthis._invalidAnimation = false;\n\n\t\tvar enabledGPUAnimation:boolean = this._getEnabledGPUAnimation();\n\n\t\tvar renderOrderId = 0;\n\t\tvar mult:number = 1;\n\t\tvar shader:ShaderBase;\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tshader = this._passes[i].shader;\n\n\t\t\tif (shader.usesAnimation != enabledGPUAnimation) {\n\t\t\t\tshader.usesAnimation = enabledGPUAnimation;\n\t\t\t\tshader.invalidateProgram();\n\t\t\t}\n\n\t\t\trenderOrderId += shader.programData.id*mult;\n\t\t\tmult *= 1000;\n\t\t}\n\n\t\tthis._renderOrderId = renderOrderId;\n\t}\n\n\t/**\n\t * Performs any processing that needs to occur before any of its passes are used.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tthis._invalidRender = false;\n\n\t\t//overrride to update shader object properties\n\t}\n\n\t/**\n\t * Removes a pass from the renderOwner.\n\t * @param pass The pass to be removed.\n\t */\n\tpublic _pRemovePass(pass:IPass)\n\t{\n\t\tpass.removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t\tthis._passes.splice(this._passes.indexOf(pass), 1);\n\t}\n\n\t/**\n\t * Removes all passes from the renderOwner\n\t */\n\tpublic _pClearPasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._passes[i].removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\n\t\tthis._passes.length = 0;\n\t}\n\n\t/**\n\t * Adds a pass to the renderOwner\n\t * @param pass\n\t */\n\tpublic _pAddPass(pass:IPass)\n\t{\n\t\tthis._passes.push(pass);\n\t\tpass.addEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t}\n\n\t/**\n\t * Listener for when a pass's shader code changes. It recalculates the render order id.\n\t */\n\tprivate onPassChange(event:Event)\n\t{\n\t\tthis.invalidateAnimation();\n\t}\n\n\n\t/**\n\t * test if animation will be able to run on gpu BEFORE compiling materials\n\t * test if the shader objects supports animating the animation set in the vertex shader\n\t * if any object using this material fails to support accelerated animations for any of the shader objects,\n\t * we should do everything on cpu (otherwise we have the cost of both gpu + cpu animations)\n\t */\n\tprivate _getEnabledGPUAnimation():boolean\n\t{\n\t\tif (this._renderOwner.animationSet) {\n\t\t\tthis._renderOwner.animationSet.resetGPUCompatibility();\n\n\t\t\tvar owners:Array<IRenderableOwner> = this._renderOwner.iOwners;\n\t\t\tvar numOwners:number = owners.length;\n\n\t\t\tvar len:number = this._passes.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tfor (var j:number = 0; j < numOwners; j++)\n\t\t\t\t\tif (owners[j].animator)\n\t\t\t\t\t\t(<AnimatorBase> owners[j].animator).testGPUCompatibility(this._passes[i].shader);\n\n\t\t\treturn !this._renderOwner.animationSet.usesCPU;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nexport = RenderBase;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\n\n/**\n * RenderPassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass RenderPassBase extends RenderBase implements IPass\n{\n\tpublic _shader:ShaderBase;\n\n\tpublic get shader():ShaderBase\n\t{\n\t\treturn this._shader;\n\t}\n\n\tpublic get animationSet():AnimationSetBase\n\t{\n\t\treturn <AnimationSetBase> this._renderOwner.animationSet;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis._shader.dispose();\n\n\t\tthis._shader = null;\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling pass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._shader._iRender(renderable, camera, viewProjection);\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tthis._shader._iActivate(camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tthis._shader._iDeactivate();\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic invalidatePass()\n\t{\n\t\tthis._shader.invalidateShader();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = RenderPassBase;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport BasicMaterialRender\t\t\t= require(\"awayjs-renderergl/lib/render/BasicMaterialRender\");\nimport IRenderClass\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/IRenderClass\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport SkyboxRender\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/SkyboxRender\");\n\n/**\n * @class away.pool.RenderPool\n */\nclass RenderPool\n{\n\tprivate static _classPool:Object = new Object();\n\t\n\tprivate _pool:Object = new Object();\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _stage:Stage;\n\tprivate _renderClass:IRenderClass;\n\t\n\t/**\n\t * //TODO\n\t *\n\t * @param renderClass\n\t */\n\tconstructor(renderableClass:IRenderableClass, stage:Stage, renderClass:IRenderClass = null)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t\tthis._renderClass = renderClass;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderOwner:IRenderOwner):RenderBase\n\t{\n\t\treturn (this._pool[renderOwner.id] || (this._pool[renderOwner.id] = renderOwner._iAddRender(new (this._renderClass || RenderPool.getClass(renderOwner))(this, renderOwner, this._renderableClass, this._stage))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t */\n\tpublic disposeItem(renderOwner:IRenderOwner)\n\t{\n\t\trenderOwner._iRemoveRender(this._pool[renderOwner.id]);\n\n\t\tthis._pool[renderOwner.id] = null;\n\t}\n\t\n\t/**\n\t *\n\t * @param imageObjectClass\n\t */\n\tpublic static registerClass(renderClass:IRenderClass, assetClass:IAssetClass)\n\t{\n\t\tRenderPool._classPool[assetClass.assetType] = renderClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(renderOwner:IRenderOwner):IRenderClass\n\t{\n\t\treturn RenderPool._classPool[renderOwner.assetType];\n\t}\n\t\n\n\tprivate static main = RenderPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tRenderPool.registerClass(BasicMaterialRender, BasicMaterial);\n\t\tRenderPool.registerClass(SkyboxRender, Skybox);\n\t}\n}\n\nexport = RenderPool;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\n\n/**\n * SkyboxRender forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass SkyboxRender extends RenderPassBase\n{\n\tpublic _skybox:Skybox;\n\tpublic _cubeTexture:TextureVOBase;\n\n\tconstructor(pool:RenderPool, skybox:Skybox, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, skybox, renderableClass, stage);\n\n\t\tthis._skybox = skybox;\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._cubeTexture = this._shader.getTextureVO(this._skybox.cubeMap);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tsuper._pUpdateRender();\n\n\t\tthis._pRequiresBlending = (this._renderOwner.blendMode != BlendMode.NORMAL);\n\n\t\tthis.shader.setBlendMode((this._renderOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._renderOwner.blendMode);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.usesLocalPosFragment = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tthis._cubeTexture._iInitRegisters(shader, registerCache);\n\n\t\treturn this._cubeTexture._iGetFragmentCode(shader, sharedRegisters.shadedTarget, registerCache, sharedRegisters.localPositionVarying);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setDepthTest(false, ContextGLCompareMode.LESS);\n\t\tthis._cubeTexture.activate(this._shader);\n\t}\n}\n\nexport = SkyboxRender;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n\n/**\n * BasicMaterialPass forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass BasicMaterialPass extends PassBase\n{\n\tprivate _diffuseR:number = 1;\n\tprivate _diffuseG:number = 1;\n\tprivate _diffuseB:number = 1;\n\tprivate _diffuseA:number = 1;\n\n\tprivate _fragmentConstantsIndex:number;\n\n\tconstructor(render:RenderBase, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(render, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tif (shader.texture != null)\n\t\t\tshader.uvDependencies++;\n    }\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n        var alphaReg:ShaderRegisterElement;\n\n        if (this.preserveAlpha) {\n            alphaReg = regCache.getFreeFragmentSingleTemp();\n            regCache.addFragmentTempUsages(alphaReg, 1);\n            code += \"mov \" + alphaReg + \", \" + sharedReg.shadedTarget + \".w\\n\";\n        }\n\n\t\tvar targetReg:ShaderRegisterElement = sharedReg.shadedTarget;\n\n\t\tif (shader.texture != null) {\n\n\t\t\tshader.texture._iInitRegisters(shader, regCache);\n\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, targetReg, regCache, sharedReg.uvVarying);\n\n\t\t\tif (shader.alphaThreshold > 0) {\n\t\t\t\tvar cutOffReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\t\t\t\tthis._fragmentConstantsIndex = cutOffReg.index*4;\n\n\t\t\t\tcode += \"sub \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\" + \"kil \" + targetReg + \".w\\n\" + \"add \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\";\n\t\t\t}\n\t\t} else if (shader.colorBufferIndex != -1) {\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + sharedReg.colorVarying + \"\\n\";\n\t\t} else {\n\t\t\tvar diffuseInputReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\n\t\t\tthis._fragmentConstantsIndex = diffuseInputReg.index*4;\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + diffuseInputReg + \"\\n\";\n\t\t}\n\n        if (this.preserveAlpha) {\n            code += \"mul \" + sharedReg.shadedTarget + \".w, \" + sharedReg.shadedTarget + \".w, \" + alphaReg + \"\\n\";\n            regCache.removeFragmentTempUsage(alphaReg);\n        }\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tif (this._shader.texture != null) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tif (this._shader.alphaThreshold > 0)\n\t\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex] = this._shader.alphaThreshold;\n\t\t} else if (this._shader.colorBufferIndex == -1) {\n\t\t\tvar index:number = this._fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\t\tdata[index] = this._diffuseR;\n\t\t\tdata[index + 1] = this._diffuseG;\n\t\t\tdata[index + 2] = this._diffuseB;\n\t\t\tdata[index + 3] = this._diffuseA;\n\t\t}\n\t}\n}\n\nexport = BasicMaterialPass;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\n\n/**\n * PassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass PassBase extends EventDispatcher implements IPass\n{\n\tprivate _render:RenderBase;\n\tpublic _renderOwner:IRenderOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\t\n\tpublic _shader:ShaderBase;\n\n\tprivate _preserveAlpha:boolean = true;\n\tprivate _forceSeparateMVP:boolean = false;\n\n\tpublic get shader():ShaderBase\n\t{\n\t\treturn this._shader;\n\t}\n\n\tpublic get animationSet():AnimationSetBase\n\t{\n\t\treturn <AnimationSetBase> this._renderOwner.animationSet;\n\t}\n\n\t/**\n\t * Indicates whether the output alpha value should remain unchanged compared to the material's original alpha.\n\t */\n\tpublic get preserveAlpha():boolean\n\t{\n\t\treturn this._preserveAlpha;\n\t}\n\n\tpublic set preserveAlpha(value:boolean)\n\t{\n\t\tif (this._preserveAlpha == value)\n\t\t\treturn;\n\n\t\tthis._preserveAlpha = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Indicates whether the screen projection should be calculated by forcing a separate scene matrix and\n\t * view-projection matrix. This is used to prevent rounding errors when using multiple passes with different\n\t * projection code.\n\t */\n\tpublic get forceSeparateMVP():boolean\n\t{\n\t\treturn this._forceSeparateMVP;\n\t}\n\n\tpublic set forceSeparateMVP(value:boolean)\n\t{\n\t\tif (this._forceSeparateMVP == value)\n\t\t\treturn;\n\n\t\tthis._forceSeparateMVP = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Creates a new PassBase object.\n\t */\n\tconstructor(render:RenderBase, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._render = render;\n\t\tthis._renderOwner = renderOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._shader.dispose();\n\n\t\tthis._shader = null;\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling pass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._shader._iRender(renderable, camera, viewProjection);\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tthis._shader._iActivate(camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tthis._shader._iDeactivate();\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic invalidatePass()\n\t{\n\t\tthis._shader.invalidateShader();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tthis._render._iIncludeDependencies(shader);\n\t\t\n\t\tif (this._forceSeparateMVP)\n\t\t\tshader.globalPosDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = PassBase;",
    "import AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n/**\n * @class away.pool.RenderableListItem\n */\nclass BillboardRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = Billboard;\n\n\tprivate static _materialGeometry:Object = new Object();\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate _billboard:Billboard;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param billboard\n\t */\n\tconstructor(pool:RenderablePool, billboard:Billboard, stage:Stage)\n\t{\n\t\tsuper(pool, billboard, billboard, billboard.material, stage);\n\n\t\tthis._billboard = billboard;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t */\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tvar material:MaterialBase = this._billboard.material;\n\t\tvar billboardRect:Rectangle = this._billboard.billboardRect;\n\n\t\tvar geometry:TriangleSubGeometry = BillboardRenderable._materialGeometry[material.id];\n\n\t\tif (!geometry) {\n\t\t\tgeometry = BillboardRenderable._materialGeometry[material.id] = new TriangleSubGeometry(new AttributesBuffer(11, 4));\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.setIndices(Array<number>(0, 1, 2, 0, 2, 3));\n\t\t\tgeometry.setPositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t\tgeometry.setNormals(Array<number>(1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0));\n\t\t\tgeometry.setTangents(Array<number>(0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1));\n\t\t\tgeometry.setUVs(Array<number>(0, 0, 1, 0, 1, 1, 0, 1));\n\t\t} else {\n\t\t\tgeometry.setPositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t}\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = BillboardRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport CurveSubMesh\t\t\t\t    = require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport CurveSubGeometry\t\t    \t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextWebGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextWebGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\")\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass CurveSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = CurveSubMesh;\n\n\tpublic static vertexAttributesOffset:number = 2;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:CurveSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:CurveSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():CurveSubGeometry\n\t{\n\t\treturn (this.subMesh.animator)? <CurveSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry) : this.subMesh.subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n        shader.usesLocalPosFragment = true;\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \".xyw, \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov v2 va1 \\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\n\t\t} else {\n\t\t\tcode += \"mov v2 va1 \\n\";\n\t\t\tcode += \"m44 op, \" + position + \".xyw, \" + viewMatrixReg + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n    /**\n     * @inheritDoc\n     */\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar sd:boolean = (<ContextWebGL>shader._stage.context).standardDerivatives;\n\t\tvar pos:ShaderRegisterElement = sharedRegisters.localPositionVarying;\n\t\tvar out:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\n\t\tvar curve:string = \"v2\";\n\t\tvar curvex:string = \"v2.x\";\n\t\tvar curvey:string = \"v2.y\";\n\t\tvar curvez:string = pos + \".z\";\n\n\n\t\t//get some free registers\n\t\tvar free:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free, 1);\n\t\tvar free1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free1, 1);\n\t\tvar free2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free2, 1);\n\n\t\t//distance from curve\n\t\tvar d:string = free + \".x\";\n\t\tvar dx:string = free + \".y\";\n\t\tvar dy:string = free + \".z\";\n\t\tvar t:string = free + \".w\";\n\t\tvar d2:string = free1 + \".x\";\n\t\tvar fixa:string = free1 + \".y\";\n\t\tvar fixb:string = free1 + \".z\";\n\n\t\tvar _aa:string = \"fc7.z\";\n\t\tvar _0:string = \"fc7.x\";\n\t\tvar _1:string = \"fc7.y\";\n\n\t\tvar nl:string = \"\\n\";\n\n\t\tvar code:Array<string> =  new Array<string>();\n\n\t\t//distance from curve\n\t\tcode.push(\"mul\",d, curvex, curvex, nl);\n\t\tcode.push(\"sub\",d, d, curvey, nl);\n\t\tcode.push(\"mul\",d, d, curvez, nl);\t//flipper\n\n\t\t//kill based on distance from curve\n\t\tcode.push(\"kil\" ,d, nl);\n\n\t\tvar applyAA:boolean = false;\n\t\tif(applyAA && sd)\n\t\t{\n\n\t\t\t//derivatives\n\t\t\tcode.push(\"ddx\", dx, d, nl);\n\t\t\tcode.push(\"ddy\", dy, d, nl);\n\n\t\t\t//AA\n\t\t\tcode.push(\"mul\",dx, dx, dx, nl);\n\t\t\tcode.push(\"mul\",dy, dy, dy, nl);\n\t\t\tcode.push(\"add\",t, dx, dy, nl);\n\t\t\tcode.push(\"sqt\",t, t, nl);\n\n\t\t\tcode.push(\"mul\",t, t, _aa, nl);\n\t\t\tcode.push(\"div\",d, d, t, nl);\n\n/*\n\t\t\t//code.push(\"sge\", fixa, curvex, _1, nl);\n\t\t\tcode.push(\"slt\", fixb, curvex, _1, nl);\n\t\t\tcode.push(\"sub\", fixa, _1, fixb, nl);\n\t\t\t//code.push(\"sub\", fixb, _1, fixa, nl);\n\n\t\t\tcode.push(\"mul\", d, d, fixb, nl);\n\n*/\n//\t\t\tcode.push(\"abs\", d, d, nl);\n\t\t\tcode.push(\"max\", d, d, _0, nl);\n\t\t\tcode.push(\"min\", d, d, _1, nl);\n\t\t\tcode.push(\"mov\", out+\".w\", d, nl);\n\t\t}\n\n\n\t\tcode.push(\"mov\", out+\".w\", _1, nl);\n\t\treturn code.join(\" \");\n\t}\n    private _constants:Array<number> = new Array<number>(0, 1, 1, 0.5);\n    /**\n     * @inheritDoc\n     */\n    public _iActivate(pass:PassBase, camera:Camera)\n    {\n        super._iActivate(pass, camera);\n\n        var context:IContextGL = this._stage.context;\n\n        context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 7, this._constants, 1);\n\n    }\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = CurveSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSegmentRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = LineSegment;\n\n\tprivate static _lineGeometry:Object = new Object();\n\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tprivate _lineSegment:LineSegment;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePool, lineSegment:LineSegment, stage:Stage)\n\t{\n\t\tsuper(pool, lineSegment, lineSegment, lineSegment.material, stage);\n\n\t\tthis._lineSegment = lineSegment;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\tvar geometry:LineSubGeometry = LineSegmentRenderable._lineGeometry[this._lineSegment.id] || (LineSegmentRenderable._lineGeometry[this._lineSegment.id] = new LineSubGeometry());\n\n\t\tvar start:Vector3D = this._lineSegment.startPostion;\n\t\tvar end:Vector3D = this._lineSegment.endPosition;\n\n\t\tvar positions:Float32Array;\n\t\tvar thickness:Float32Array;\n\n\t\t//if (geometry.indices != null) {\n\t\t//\tpositions = <Float32Array> geometry.positions.get(geometry.numVertices);\n\t\t//\tthickness = geometry.thickness.get(geometry.numVertices);\n\t\t//} else {\n\t\t\tpositions = new Float32Array(6);\n\t\t\tthickness = new Float32Array(1);\n\t\t//}\n\n\t\tpositions[0] = start.x;\n\t\tpositions[1] = start.y;\n\t\tpositions[2] = start.z;\n\t\tpositions[3] = end.x;\n\t\tpositions[4] = end.y;\n\t\tpositions[5] = end.z;\n\t\tthickness[0] = this._lineSegment.thickness;\n\n\t\tgeometry.setPositions(positions);\n\t\tgeometry.setThickness(thickness);\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tshader.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:PassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSegmentRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSegmentRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @private\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new LineSegmentRenderable(this._pool, <LineSegment> this.renderableOwner, this._stage);\n\t}\n}\n\nexport = LineSegmentRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = LineSubMesh;\n\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:LineSubMesh;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:LineSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\treturn this.subMesh.subGeometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tshader.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:PassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSubMeshRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSubMeshRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\t}\n}\n\nexport = LineSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/IRenderer\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport RenderableOwnerEvent\t\t\t= require(\"awayjs-display/lib/events/RenderableOwnerEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n/**\n * @class RenderableListItem\n */\nclass RenderableBase implements IRenderable\n{\n\tprivate _onRenderOwnerUpdatedDelegate:(event:RenderableOwnerEvent) => void;\n\n\tpublic _subGeometryVOPool:SubGeometryVOPool;\n\tpublic _subGeometryVO:SubGeometryVOBase;\n\tprivate _geometryDirty:boolean = true;\n\n\tpublic JOINT_INDEX_FORMAT:string;\n\tpublic JOINT_WEIGHT_FORMAT:string;\n\n\t/**\n\t *\n\t */\n\tpublic _pool:RenderablePool;\n\n\tpublic _stage:Stage;\n\n\t/**\n\t *\n\t */\n\tpublic next:RenderableBase;\n\n\tpublic id:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderOrderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic zIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic cascaded:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic renderSceneTransform:Matrix3D;\n\n\t/**\n\t *\n\t */\n\tpublic sourceEntity:IEntity;\n\n\t/**\n\t *\n\t */\n\tpublic renderableOwner:IRenderableOwner;\n\n\n\t/**\n\t *\n\t */\n\tpublic renderOwner:IRenderOwner;\n\n\t/**\n\t *\n\t */\n\tpublic render:RenderBase;\n\n\n\tpublic get subGeometryVO():SubGeometryVOBase\n\t{\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\treturn this._subGeometryVO;\n\t}\n\t/**\n\t *\n\t * @param sourceEntity\n\t * @param renderableOwner\n\t * @param subGeometry\n\t * @param animationSubGeometry\n\t */\n\tconstructor(pool:RenderablePool, sourceEntity:IEntity, renderableOwner:IRenderableOwner, renderOwner:IRenderOwner, stage:Stage)\n\t{\n\t\tthis._onRenderOwnerUpdatedDelegate = (event:RenderableOwnerEvent) => this._onRenderOwnerUpdated(event);\n\n\t\t//store a reference to the pool for later disposal\n\t\tthis._pool = pool;\n\t\tthis._stage = stage;\n\n\t\tthis._subGeometryVOPool = SubGeometryVOPool.getPool();\n\n\t\tthis.sourceEntity = sourceEntity;\n\n\t\tthis.renderableOwner = renderableOwner;\n\n\t\tthis.renderableOwner.addEventListener(RenderableOwnerEvent.RENDER_OWNER_UPDATED, this._onRenderOwnerUpdatedDelegate)\n\n\t\tthis.renderOwner = renderOwner;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.renderableOwner);\n\t}\n\n\tpublic invalidateGeometry()\n\t{\n\t\tthis._geometryDirty = true;\n\t}\n\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(pass:IPass, camera:Camera)\n\t{\n\t\tpass._iActivate(camera);\n\t}\n\n\t/**\n\t * Renders an object to the current render target.\n\t *\n\t * @private\n\t */\n\tpublic _iRender(pass:IPass, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._setRenderState(pass, camera, viewProjection)\n\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\tthis._subGeometryVO._iRender(pass.shader, this._stage);\n\t}\n\n\tpublic _setRenderState(pass:IPass, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tpass._iRender(this, camera, viewProjection);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate(pass:IPass)\n\t{\n\t\tpass._iDeactivate();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateGeometry()\n\t{\n\t\tthis._subGeometryVO = this._subGeometryVOPool.getItem(this._pGetSubGeometry());\n\n\t\tthis._geometryDirty = false;\n\t}\n\n\tprivate _onRenderOwnerUpdated(event:RenderableOwnerEvent)\n\t{\n\t\t//TODO flag unused renders for deletion\n\t\tthis.renderOwner = event.renderOwner;\n\t}\n}\n\nexport = RenderableBase;",
    "import IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport CurveSubMesh\t\t\t    \t= require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport IRenderClass\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/IRenderClass\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport BillboardRenderable\t\t\t= require(\"awayjs-renderergl/lib/renderables/BillboardRenderable\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport LineSegmentRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/LineSegmentRenderable\");\nimport LineSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/LineSubMeshRenderable\");\nimport CurveSubMeshRenderable\t    = require(\"awayjs-renderergl/lib/renderables/CurveSubMeshRenderable\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport SkyboxRenderable\t\t\t    = require(\"awayjs-renderergl/lib/renderables/SkyboxRenderable\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * RenderablePool forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RenderablePool\n */\nclass RenderablePool\n{\n\tprivate static _classPool:Object = new Object();\n\n\tprivate _stage:Stage;\n\tprivate _pool:Object = new Object();\n\n\tprivate _objectPools:Object = new Object();\n\t\n\t/**\n\t * Creates a new RenderablePool object.\n\t *\n\t * @param stage\n\t * @param renderClass\n\t */\n\tconstructor(stage:Stage, renderClass:IRenderClass = null)\n\t{\n\t\tthis._stage = stage;\n\n\t\tfor (var i in RenderablePool._classPool)\n\t\t\tthis._objectPools[i] = new RenderPool(RenderablePool._classPool[i], this._stage, renderClass);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderableOwner:IRenderableOwner):RenderableBase\n\t{\n\t\treturn this._pool[renderableOwner.id] || (this._pool[renderableOwner.id] = renderableOwner._iAddRenderable(new (RenderablePool.getClass(renderableOwner))(this, renderableOwner, this._stage)));\n\t}\n\n\t/**\n\t *\n\t * @param image\n\t */\n\tpublic disposeItem(renderableOwner:IRenderableOwner)\n\t{\n\t\trenderableOwner._iRemoveRenderable(this._pool[renderableOwner.id]);\n\n\t\tthis._pool[renderableOwner.id] = null;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderPool\n\t */\n\tpublic getRenderPool(renderableOwner:IRenderableOwner):RenderPool\n\t{\n\t\treturn this._objectPools[renderableOwner.assetType];\n\t}\n\n\t/**\n\t *\n\t * @param imageObjectClass\n\t */\n\tpublic static registerClass(renderableClass:IRenderableClass)\n\t{\n\t\tRenderablePool._classPool[renderableClass.assetClass.assetType] = renderableClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(renderableOwner:IRenderableOwner):IRenderableClass\n\t{\n\t\treturn RenderablePool._classPool[renderableOwner.assetType];\n\t}\n\n\t/**\n\t * Disposes the resources used by the RenderablePool.\n\t */\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\tthis._pool[id].dispose();\n\n\t\tthis._pool = null;\n\t}\n\n\n\tprivate static main = RenderablePool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tRenderablePool.registerClass(BillboardRenderable);\n\t\tRenderablePool.registerClass(LineSegmentRenderable);\n\t\tRenderablePool.registerClass(LineSubMeshRenderable);\n\t\tRenderablePool.registerClass(TriangleSubMeshRenderable);\n\t\tRenderablePool.registerClass(CurveSubMeshRenderable);\n\t\tRenderablePool.registerClass(SkyboxRenderable);\n\t}\n}\n\nexport = RenderablePool;",
    "import AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.SkyboxRenderable\n */\nclass SkyboxRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = Skybox;\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate static _geometry:TriangleSubGeometry;\n\n\tprivate _vertexArray:Array<number>;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param skybox\n\t */\n\tconstructor(pool:RenderablePool, skybox:Skybox, stage:Stage)\n\t{\n\t\tsuper(pool, skybox, skybox, skybox, stage);\n\n\t\tthis._vertexArray = new Array<number>(0, 0, 0, 0, 1, 1, 1, 1);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t * @private\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar geometry:TriangleSubGeometry = SkyboxRenderable._geometry;\n\n\t\tif (!geometry) {\n\t\t\tgeometry = SkyboxRenderable._geometry = new TriangleSubGeometry(new AttributesBuffer(11, 4));\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.setIndices(Array<number>(0, 1, 2, 2, 3, 0, 6, 5, 4, 4, 7, 6, 2, 6, 7, 7, 3, 2, 4, 5, 1, 1, 0, 4, 4, 0, 3, 3, 7, 4, 2, 1, 5, 5, 6, 2));\n\t\t\tgeometry.setPositions(Array<number>(-1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1));\n\t\t}\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"mul vt0, va0, vc5\\n\" +\n\t\t\t\"add vt0, vt0, vc4\\n\" +\n\t\t\t\"m44 op, vt0, vc0\\n\";\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar pos:Vector3D = camera.scenePosition;\n\t\tthis._vertexArray[0] = pos.x;\n\t\tthis._vertexArray[1] = pos.y;\n\t\tthis._vertexArray[2] = pos.z;\n\t\tthis._vertexArray[4] = this._vertexArray[5] = this._vertexArray[6] = camera.projection.far/Math.sqrt(3);\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, viewProjection, true);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._vertexArray, 2);\n\t}\n}\n\nexport = SkyboxRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass TriangleSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = TriangleSubMesh;\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:TriangleSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:TriangleSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\treturn (this.subMesh.animator)? <TriangleSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry) : this.subMesh.subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = TriangleSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport LightSources\t\t\t\t\t= require(\"awayjs-display/lib/materials/LightSources\");\n\nimport ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport ILightingPass\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/ILightingPass\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport LightingCompiler\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/LightingCompiler\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ShaderBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass LightingShader extends ShaderBase\n{\n\tpublic _lightingPass:ILightingPass;\n\n\tprivate _includeCasters:boolean = true;\n\n\t/**\n\t * The first index for the fragment constants containing the light data.\n\t */\n\tpublic lightFragmentConstantIndex:number;\n\n\t/**\n\t * The starting index if the vertex constant to which light data needs to be uploaded.\n\t */\n\tpublic lightVertexConstantIndex:number;\n\n\t/**\n\t * Indices for the light probe diffuse textures.\n\t */\n\tpublic lightProbeDiffuseIndices:Array<number> /*uint*/;\n\n\t/**\n\t * Indices for the light probe specular textures.\n\t */\n\tpublic lightProbeSpecularIndices:Array<number> /*uint*/;\n\n\t/**\n\t * The index of the fragment constant containing the weights for the light probes.\n\t */\n\tpublic probeWeightsIndex:number;\n\n\tpublic numLights:number;\n\tpublic numDirectionalLights:number;\n\tpublic numPointLights:number;\n\tpublic numLightProbes:number;\n\n\tpublic usesLightFallOff:boolean;\n\n\tpublic usesShadows:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any lights.\n\t */\n\tpublic usesLights:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any light probes.\n\t */\n\tpublic usesProbes:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any specular components.\n\t */\n\tpublic usesLightsForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any specular components.\n\t */\n\tpublic usesProbesForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any diffuse components.\n\t */\n\tpublic usesLightsForDiffuse:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any diffuse components.\n\t */\n\tpublic usesProbesForDiffuse:boolean;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, lightingPass:ILightingPass, stage:Stage)\n\t{\n\t\tsuper(renderableClass, lightingPass, stage);\n\n\t\tthis._lightingPass = lightingPass;\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis.numPointLights = this._lightingPass.numPointLights;\n\t\tthis.numDirectionalLights = this._lightingPass.numDirectionalLights;\n\t\tthis.numLightProbes = this._lightingPass.numLightProbes;\n\n\t\tvar numAllLights:number = this._lightingPass.numPointLights + this._lightingPass.numDirectionalLights;\n\t\tvar numLightProbes:number = this._lightingPass.numLightProbes;\n\t\tvar diffuseLightSources:number = this._lightingPass._iUsesDiffuse(this)? this._lightingPass.diffuseLightSources : 0x00;\n\t\tvar specularLightSources:number = this._lightingPass._iUsesSpecular(this)? this._lightingPass.specularLightSources : 0x00;\n\t\tvar combinedLightSources:number = diffuseLightSources | specularLightSources;\n\n\t\tthis.usesLightFallOff = this._lightingPass.enableLightFallOff && this.profile != ContextGLProfile.BASELINE_CONSTRAINED;\n\t\tthis.numLights = numAllLights + numLightProbes;\n\t\tthis.usesLights = numAllLights > 0 && (combinedLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbes = numLightProbes > 0 && (combinedLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForSpecular = numAllLights > 0 && (specularLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForSpecular = numLightProbes > 0 && (specularLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForDiffuse = numAllLights > 0 && (diffuseLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForDiffuse = numLightProbes > 0 && (diffuseLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesShadows = this._lightingPass._iUsesShadows(this);\n\n\t\t//IMPORTANT this must occur after shader lighting initialisation above\n\t\tsuper._iIncludeDependencies();\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param materialPassVO\n\t * @returns {away.materials.LightingCompiler}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, pass:ILightingPass):CompilerBase\n\t{\n\t\treturn new LightingCompiler(renderableClass, pass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.numLights = 0;\n\t\tthis.usesLightFallOff = true;\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(renderable, camera, viewProjection);\n\n\t\tif (this._lightingPass.lightPicker)\n\t\t\tthis._lightingPass.lightPicker.collectLights(renderable);\n\n\t\tif (this.usesLights)\n\t\t\tthis.updateLights();\n\n\t\tif (this.usesProbes)\n\t\t\tthis.updateProbes();\n\t}\n\n\t/**\n\t * Updates constant data render state used by the lights. This method is optional for subclasses to implement.\n\t */\n\tprivate updateLights()\n\t{\n\t\tvar dirLight:DirectionalLight;\n\t\tvar pointLight:PointLight;\n\t\tvar i:number = 0;\n\t\tvar k:number = 0;\n\t\tvar len:number;\n\t\tvar dirPos:Vector3D;\n\t\tvar total:number = 0;\n\t\tvar numLightTypes:number = this.usesShadows? 2 : 1;\n\t\tvar l:number;\n\t\tvar offset:number;\n\n\t\tthis.ambientR = this.ambientG = this.ambientB = 0;\n\n\t\tl = this.lightVertexConstantIndex;\n\t\tk = this.lightFragmentConstantIndex;\n\n\t\tvar cast:number = 0;\n\t\tvar dirLights:Array<DirectionalLight> = this._lightingPass.lightPicker.directionalLights;\n\t\toffset = this._lightingPass.directionalLightsOffset;\n\t\tlen = this._lightingPass.lightPicker.directionalLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tdirLights = this._lightingPass.lightPicker.castingDirectionalLights;\n\n\t\t\tlen = dirLights.length;\n\n\t\t\tif (len > this.numDirectionalLights)\n\t\t\t\tlen = this.numDirectionalLights;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tdirLight = dirLights[offset + i];\n\t\t\t\tdirPos = dirLight.sceneDirection;\n\n\t\t\t\tthis.ambientR += dirLight._iAmbientR;\n\t\t\t\tthis.ambientG += dirLight._iAmbientG;\n\t\t\t\tthis.ambientB += dirLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tvar x:number = -dirPos.x;\n\t\t\t\t\tvar y:number = -dirPos.y;\n\t\t\t\t\tvar z:number = -dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tif (++total == this.numDirectionalLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numDirectionalLights > total) {\n\t\t\ti = k + (this.numDirectionalLights - total)*12;\n\n\t\t\twhile (k < i)\n\t\t\t\tthis.fragmentConstantData[k++] = 0;\n\t\t}\n\n\t\ttotal = 0;\n\n\t\tvar pointLights:Array<PointLight> = this._lightingPass.lightPicker.pointLights;\n\t\toffset = this._lightingPass.pointLightsOffset;\n\t\tlen = this._lightingPass.lightPicker.pointLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t} else {\n\t\t\tcast = 0;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tpointLights = this._lightingPass.lightPicker.castingPointLights;\n\n\t\t\tlen = pointLights.length;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tpointLight = pointLights[offset + i];\n\t\t\t\tdirPos = pointLight.scenePosition;\n\n\t\t\t\tthis.ambientR += pointLight._iAmbientR;\n\t\t\t\tthis.ambientG += pointLight._iAmbientG;\n\t\t\t\tthis.ambientB += pointLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tx = dirPos.x;\n\t\t\t\t\ty = dirPos.y;\n\t\t\t\t\tz = dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else if (!this.usesGlobalPosFragment) {\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.x;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.y;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseB;\n\n\t\t\t\tvar radius:number = pointLight._pRadius;\n\t\t\t\tthis.fragmentConstantData[k++] = radius*radius;\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._pFallOffFactor;\n\n\t\t\t\tif (++total == this.numPointLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numPointLights > total) {\n\t\t\ti = k + (total - this.numPointLights)*12;\n\n\t\t\tfor (; k < i; ++k)\n\t\t\t\tthis.fragmentConstantData[k] = 0;\n\t\t}\n\t}\n\n\t/**\n\t * Updates constant data render state used by the light probes. This method is optional for subclasses to implement.\n\t */\n\tprivate updateProbes()\n\t{\n\t\tvar probe:LightProbe;\n\t\tvar lightProbes:Array<LightProbe> = this._lightingPass.lightPicker.lightProbes;\n\t\tvar weights:Array<number> = this._lightingPass.lightPicker.lightProbeWeights;\n\t\tvar len:number = lightProbes.length - this._lightingPass.lightProbesOffset;\n\t\tvar addDiff:boolean = this.usesProbesForDiffuse;\n\t\tvar addSpec:boolean = this.usesProbesForSpecular;\n\n\t\tif (!(addDiff || addSpec))\n\t\t\treturn;\n\n\t\tif (len > this.numLightProbes)\n\t\t\tlen = this.numLightProbes;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tprobe = lightProbes[ this._lightingPass.lightProbesOffset + i];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._stage.getImageObject(probe.diffuseMap).activate(this.lightProbeDiffuseIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._stage.getImageObject(probe.specularMap).activate(this.lightProbeSpecularIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis.fragmentConstantData[this.probeWeightsIndex + i] = weights[this._lightingPass.lightProbesOffset + i];\n\t}\n}\n\nexport = LightingShader;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * RegisterPool is used by the shader compilers process to keep track of which registers of a certain type are\n * currently used and should not be allowed to be written to. Either entire registers can be requested and locked,\n * or single components (x, y, z, w) of a single register.\n * It is used by ShaderRegisterCache to track usages of individual register types.\n *\n * @see away.materials.ShaderRegisterCache\n */\nclass RegisterPool\n{\n\tprivate static _regPool:Object = new Object();\n\tprivate static _regCompsPool:Object = new Object();\n\n\tprivate _vectorRegisters:Array<ShaderRegisterElement>;\n\tprivate _registerComponents;\n\n\tprivate _regName:string;\n\tprivate _usedSingleCount:Array<Array<number>>;\n\tprivate _usedVectorCount:Array<number> /*uint*/;\n\tprivate _regCount:number;\n\n\tprivate _persistent:boolean;\n\n\t/**\n\t * Creates a new RegisterPool object.\n\t * @param regName The base name of the register type (\"ft\" for fragment temporaries, \"vc\" for vertex constants, etc)\n\t * @param regCount The amount of available registers of this type.\n\t * @param persistent Whether or not registers, once reserved, can be freed again. For example, temporaries are not persistent, but constants are.\n\t */\n\tconstructor(regName:string, regCount:number, persistent:boolean = true)\n\t{\n\t\tthis._regName = regName;\n\t\tthis._regCount = regCount;\n\t\tthis._persistent = persistent;\n\t\tthis.initRegisters(regName, regCount);\n\t}\n\n\t/**\n\t * Retrieve an entire vector register that's still available.\n\t */\n\tpublic requestFreeVectorReg():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (!this.isRegisterUsed(i)) {\n\t\t\t\tif (this._persistent)\n\t\t\t\t\tthis._usedVectorCount[i]++;\n\n\t\t\t\treturn this._vectorRegisters[i];\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Retrieve a single vector component that's still available.\n\t */\n\tpublic requestFreeRegComponent():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (this._usedVectorCount[i] > 0)\n\t\t\t\tcontinue;\n\n\t\t\tfor (var j:number = 0; j < 4; ++j) {\n\t\t\t\tif (this._usedSingleCount[j][i] == 0) {\n\t\t\t\t\tif (this._persistent)\n\t\t\t\t\t\tthis._usedSingleCount[j][i]++;\n\n\t\t\t\t\treturn this._registerComponents[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Marks a register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addUsage(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tif (register._component > -1)\n\t\t\tthis._usedSingleCount[register._component][register.index] += usageCount;\n\t\telse\n\t\t\tthis._usedVectorCount[register.index] += usageCount;\n\t}\n\n\t/**\n\t * Removes a usage from a register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeUsage(register:ShaderRegisterElement)\n\t{\n\t\tif (register._component > -1) {\n\t\t\tif (--this._usedSingleCount[register._component][register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t} else {\n\t\t\tif (--this._usedVectorCount[register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t}\n\t}\n\n\t/**\n\t * Disposes any resources used by the current RegisterPool object.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._vectorRegisters = null;\n\t\tthis._registerComponents = null;\n\t\tthis._usedSingleCount = null;\n\t\tthis._usedVectorCount = null;\n\t}\n\n\t/**\n\t * Indicates whether or not any registers are in use.\n\t */\n\tpublic hasRegisteredRegs():boolean\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i)\n\t\t\tif (this.isRegisterUsed(i))\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initializes all registers.\n\t */\n\tprivate initRegisters(regName:string, regCount:number)\n\t{\n\t\tvar hash:string = RegisterPool._initPool(regName, regCount);\n\n\t\tthis._vectorRegisters = RegisterPool._regPool[hash];\n\t\tthis._registerComponents = RegisterPool._regCompsPool[hash];\n\n\t\tthis._usedVectorCount = this._initArray(Array<number>(regCount), 0);\n\n\t\tthis._usedSingleCount = new Array<Array<number>>(4);\n\t\tthis._usedSingleCount[0] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[1] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[2] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[3] = this._initArray(new Array<number>(regCount), 0);\n\t}\n\n\tprivate static _initPool(regName:string, regCount:number):string\n\t{\n\t\tvar hash:string = regName + regCount;\n\n\t\tif (RegisterPool._regPool[hash] != undefined)\n\t\t\treturn hash;\n\n\t\tvar vectorRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>(regCount);\n\t\tRegisterPool._regPool[hash] = vectorRegisters;\n\n\t\tvar registerComponents = [\n\t\t\t[],\n\t\t\t[],\n\t\t\t[],\n\t\t\t[]\n\t\t];\n\t\tRegisterPool._regCompsPool[hash] = registerComponents;\n\n\t\tfor (var i:number = 0; i < regCount; ++i) {\n\n\t\t\tvectorRegisters[i] = new ShaderRegisterElement(regName, i);\n\n\t\t\tfor (var j:number = 0; j < 4; ++j)\n\t\t\t\tregisterComponents[j][i] = new ShaderRegisterElement(regName, i, j);\n\t\t}\n\n\t\treturn hash;\n\t}\n\n\n\t/**\n\t * Check if the temp register is either used for single or vector use\n\t */\n\tprivate isRegisterUsed(index:number):boolean\n\t{\n\t\tif (this._usedVectorCount[index] > 0)\n\t\t\treturn true;\n\n\t\tfor (var i:number = 0; i < 4; ++i)\n\t\t\tif (this._usedSingleCount[i][index] > 0)\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\n\tprivate _initArray(a:Array<any>, val:any):Array<any>\n\t{\n\t\tvar l:number = a.length;\n\n\t\tfor (var c:number = 0; c < l; c++)\n\t\t\ta[c] = val;\n\n\t\treturn a;\n\t}\n}\n\nexport = RegisterPool;\n",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ColorTransform\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLTriangleFace\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\n\n/**\n * ShaderBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderBase\n{\n\tprivate _textureVOPool:TextureVOPool;\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _pass:IPass;\n\tpublic _stage:Stage;\n\tprivate _programData:ProgramData;\n\n\tprivate _blendFactorSource:string = ContextGLBlendFactor.ONE;\n\tprivate _blendFactorDest:string = ContextGLBlendFactor.ZERO;\n\n\tprivate _invalidShader:boolean = true;\n\tprivate _invalidProgram:boolean = true;\n\tprivate _animationVertexCode:string = \"\";\n\tprivate _animationFragmentCode:string = \"\";\n\n\tpublic get programData():ProgramData\n\t{\n\t\tif (this._invalidProgram)\n\t\t\tthis._updateProgram();\n\n\t\treturn this._programData;\n\t}\n\n\tpublic usesBlending:boolean = false;\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\tpublic depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\n\t/**\n\t * Indicate whether the shader should write to the depth buffer or not. Ignored when blending is enabled.\n\t */\n\tpublic writeDepth:boolean = true;\n\n\tpublic profile:string;\n\n\tpublic usesAnimation:boolean;\n\n\tprivate _defaultCulling:string = ContextGLTriangleFace.BACK;\n\n\tpublic _pInverseSceneMatrix:Array<number> = new Array<number>();\n\n\tpublic animationRegisterCache:AnimationRegisterCache;\n\n\t/**\n\t * The amount of used vertex constants in the vertex code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedVertexConstants:number;\n\n\t/**\n\t * The amount of used fragment constants in the fragment code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedFragmentConstants:number;\n\n\t/**\n\t * The amount of used vertex streams in the vertex code. Used by the animation code generation to know from which index on streams are available.\n\t */\n\tpublic numUsedStreams:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedTextures:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedVaryings:number;\n\n\tpublic animatableAttributes:Array<string>;\n\tpublic animationTargetRegisters:Array<string>;\n\tpublic uvSource:string;\n\tpublic uvTarget:string;\n\n\tpublic useAlphaPremultiplied:boolean;\n\tpublic useBothSides:boolean;\n\tpublic useMipmapping:boolean;\n\tpublic useSmoothTextures:boolean;\n\tpublic repeatTextures:boolean;\n\tpublic usesUVTransform:boolean;\n\tpublic usesColorTransform:boolean;\n\tpublic alphaThreshold:number;\n\tpublic texture:TextureVOBase;\n\tpublic color:number;\n\n\n\t//set ambient values to default\n\tpublic ambientR:number = 0xFF;\n\tpublic ambientG:number = 0xFF;\n\tpublic ambientB:number = 0xFF;\n\n\t/**\n\t * Indicates whether the pass requires any fragment animation code.\n\t */\n\tpublic usesFragmentAnimation:boolean;\n\n\t/**\n\t * The amount of dependencies on the projected position.\n\t */\n\tpublic projectionDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the normal vector.\n\t */\n\tpublic normalDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the vertex color.\n\t */\n\tpublic colorDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the view direction.\n\t */\n\tpublic viewDirDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the primary UV coordinates.\n\t */\n\tpublic uvDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the secondary UV coordinates.\n\t */\n\tpublic secondaryUVDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the global position. This can be 0 while hasGlobalPosDependencies is true when\n\t * the global position is used as a temporary value (fe to calculate the view direction)\n\t */\n\tpublic globalPosDependencies:number;\n\n\t/**\n\t * The amount of tangent vector dependencies (fragment shader).\n\t */\n\tpublic tangentDependencies:number;\n\n\t/**\n\t *\n\t */\n\tpublic outputsColors:boolean;\n\n\t/**\n\t * Indicates whether or not normals are output.\n\t */\n\tpublic outputsNormals:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are output in tangent space.\n\t */\n\tpublic outputsTangentNormals:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are expected in tangent space. This is only the case if no world-space\n\t * dependencies exist and normals are being output.\n\t */\n\tpublic usesTangentSpace:boolean;\n\n\t/**\n\t * Indicates whether there are any dependencies on the world-space position vector.\n\t */\n\tpublic usesGlobalPosFragment:boolean = false;\n\n\t/**\n\t * Indicates whether there are any dependencies on the local position vector.\n\t */\n\tpublic usesLocalPosFragment:boolean = false;\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\t/**\n\t * The index for the common data register.\n\t */\n\tpublic commonsDataIndex:number;\n\n\t/**\n\t * The index for the UV vertex attribute stream.\n\t */\n\tpublic uvBufferIndex:number;\n\n\t/**\n\t * The index for the secondary UV vertex attribute stream.\n\t */\n\tpublic secondaryUVBufferIndex:number;\n\n\t/**\n\t * The index for the vertex normal attribute stream.\n\t */\n\tpublic normalBufferIndex:number;\n\n\t/**\n\t * The index for the color attribute stream.\n\t */\n\tpublic colorBufferIndex:number;\n\n\t/**\n\t * The index for the vertex tangent attribute stream.\n\t */\n\tpublic tangentBufferIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the view matrix.\n\t */\n\tpublic viewMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the scene matrix.\n\t */\n\tpublic sceneMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the uniform scene matrix (the inverse transpose).\n\t */\n\tpublic sceneNormalMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the camera position.\n\t */\n\tpublic cameraPositionIndex:number;\n\n\t/**\n\t * The index for the UV transformation matrix vertex constant.\n\t */\n\tpublic uvTransformIndex:number;\n\n\t/**\n\t * The index for the color transform fragment constant.\n\t */\n\tpublic colorTransformIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic jointIndexIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic jointWeightIndex:number;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, pass:IPass, stage:Stage)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._pass = pass;\n\t\tthis._stage = stage;\n\t\tthis.profile = this._stage.profile;\n\n\t\tthis._textureVOPool = new TextureVOPool(this._stage);\n\t}\n\n\tpublic getTextureVO(texture:TextureBase):TextureVOBase\n\t{\n\t\treturn this._textureVOPool.getItem(texture);\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis._pass._iIncludeDependencies(this);\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param renderableClass\n\t * @param pass\n\t * @param stage\n\t * @returns {CompilerBase}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, pass:IPass):CompilerBase\n\t{\n\t\treturn new CompilerBase(renderableClass, pass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tthis.projectionDependencies = 0;\n\t\tthis.normalDependencies = 0;\n\t\tthis.colorDependencies = 0;\n\t\tthis.viewDirDependencies = 0;\n\t\tthis.uvDependencies = 0;\n\t\tthis.secondaryUVDependencies = 0;\n\t\tthis.globalPosDependencies = 0;\n\t\tthis.tangentDependencies = 0;\n\t\tthis.usesGlobalPosFragment = false;\n\t\tthis.usesLocalPosFragment = false;\n\t\tthis.usesFragmentAnimation = false;\n\t\tthis.usesTangentSpace = false;\n\t\tthis.outputsNormals = false;\n\t\tthis.outputsTangentNormals = false;\n\t}\n\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis.commonsDataIndex = -1;\n\t\tthis.cameraPositionIndex = -1;\n\t\tthis.uvBufferIndex = -1;\n\t\tthis.uvTransformIndex = -1;\n\t\tthis.colorTransformIndex = -1;\n\t\tthis.secondaryUVBufferIndex = -1;\n\t\tthis.normalBufferIndex = -1;\n\t\tthis.colorBufferIndex = -1;\n\t\tthis.tangentBufferIndex = -1;\n\t\tthis.sceneMatrixIndex = -1;\n\t\tthis.sceneNormalMatrixIndex = -1;\n\t\tthis.jointIndexIndex = -1;\n\t\tthis.jointWeightIndex = -1;\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this shader object.\n\t */\n\tpublic initConstantData(registerCache:ShaderRegisterCache, animatableAttributes:Array<string>, animationTargetRegisters:Array<string>, uvSource:string, uvTarget:string)\n\t{\n\t\t//Updates the amount of used register indices.\n\t\tthis.numUsedVertexConstants = registerCache.numUsedVertexConstants;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\t\tthis.numUsedStreams = registerCache.numUsedStreams;\n\t\tthis.numUsedTextures = registerCache.numUsedTextures;\n\t\tthis.numUsedVaryings = registerCache.numUsedVaryings;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\n\t\tthis.animatableAttributes = animatableAttributes;\n\t\tthis.animationTargetRegisters = animationTargetRegisters;\n\t\tthis.uvSource = uvSource;\n\t\tthis.uvTarget = uvTarget;\n\n\t\tthis.vertexConstantData.length = this.numUsedVertexConstants*4;\n\t\tthis.fragmentConstantData.length = this.numUsedFragmentConstants*4;\n\n\t\t//Initializes commonly required constant values.\n\t\tthis.fragmentConstantData[this.commonsDataIndex] = .5;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 1] = 0;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 2] = 1/255;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 3] = 1;\n\n\t\t//Initializes the default UV transformation matrix.\n\t\tif (this.uvTransformIndex >= 0) {\n\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 2] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 6] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t}\n\n\t\t//Initializes the default colorTransform.\n\t\tif (this.colorTransformIndex >= 0) {\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = 0;\n\t\t}\n\t\tif (this.cameraPositionIndex >= 0)\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 3] = 1;\n\t}\n\n\t/**\n\t * The blend mode to use when drawing this renderable. The following blend modes are supported:\n\t * <ul>\n\t * <li>BlendMode.NORMAL: No blending, unless the material inherently needs it</li>\n\t * <li>BlendMode.LAYER: Force blending. This will draw the object the same as NORMAL, but without writing depth writes.</li>\n\t * <li>BlendMode.MULTIPLY</li>\n\t * <li>BlendMode.ADD</li>\n\t * <li>BlendMode.ALPHA</li>\n\t * </ul>\n\t */\n\tpublic setBlendMode(value:string)\n\t{\n\t\tswitch (value) {\n\t\t\tcase BlendMode.NORMAL:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis.usesBlending = false;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.LAYER:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.MULTIPLY:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_COLOR;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ADD:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ALPHA:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"Unsupported blend mode!\");\n\t\t}\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._pass.animationSet).activate(this, this._stage);\n\n\t\tthis._stage.context.setCulling(this.useBothSides? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);\n\n\t\tif (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = pos.x;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;\n\t\t}\n\n\t\tthis._stage.context.setDepthTest(( this.writeDepth && !this.usesBlending ), this.depthCompareMode);\n\n\t\tif (this.usesBlending)\n\t\t\tthis._stage.context.setBlendFactors(this._blendFactorSource, this._blendFactorDest);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._pass.animationSet).deactivate(this, this._stage);\n\n\t\t//For the love of god don't remove this if you want your multi-material shadows to not flicker like shit\n\t\tthis._stage.context.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tif (renderable.renderableOwner.animator)\n\t\t\t(<AnimatorBase> renderable.renderableOwner.animator).setRenderState(this, renderable, this._stage, camera, this.numUsedVertexConstants, this.numUsedStreams);\n\n\t\tif (this.usesUVTransform) {\n\t\t\tvar uvTransform:Matrix = renderable.renderableOwner.uvTransform.matrix;\n\n\t\t\tif (uvTransform) {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = uvTransform.a;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;\n\t\t\t} else {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\t\tif (this.usesColorTransform) {\n\n\t\t\tvar colorTransform:ColorTransform = renderable.renderableOwner.colorTransform;\n\n\t\t\tif (colorTransform) {\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = colorTransform.redMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = colorTransform.greenMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = colorTransform.blueMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = colorTransform.alphaMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = colorTransform.redOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = colorTransform.greenOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = colorTransform.blueOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = colorTransform.alphaOffset/255;\n\t\t\t} else {\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\t\tif (this.sceneNormalMatrixIndex >= 0)\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);\n\n\t\tif (this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\t\t\tvar x:number = pos.x;\n\t\t\tvar y:number = pos.y;\n\t\t\tvar z:number = pos.z;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t}\n\t}\n\t\n\tpublic invalidateProgram()\n\t{\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic invalidateShader()\n\t{\n\t\tthis._invalidShader = true;\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._programData.dispose();\n\t\tthis._programData = null;\n\t}\n\n\tprivate _updateProgram()\n\t{\n\t\tthis._invalidProgram = false;\n\n\t\tvar compiler:CompilerBase;\n\n\t\tif (this._invalidShader) {\n\t\t\tthis._invalidShader = false;\n\n\t\t\tcompiler = this.createCompiler(this._renderableClass, this._pass);\n\t\t\tcompiler.compile();\n\t\t}\n\n\t\tthis._calcAnimationCode(compiler.shadedTarget);\n\n\t\tvar programData:ProgramData = this._stage.getProgramData(this._animationVertexCode + compiler.vertexCode, compiler.fragmentCode + this._animationFragmentCode + compiler.postAnimationFragmentCode);\n\n\t\t//check program data hasn't changed, keep count of program usages\n\t\tif (this._programData != programData) {\n\t\t\tif (this._programData)\n\t\t\t\tthis._programData.dispose();\n\n\t\t\tthis._programData = programData;\n\n\t\t\tprogramData.usages++;\n\t\t}\n\t}\n\n\tprivate _calcAnimationCode(shadedTarget:string)\n\t{\n\t\t//reset code\n\t\tthis._animationVertexCode = \"\";\n\t\tthis._animationFragmentCode = \"\";\n\n\t\t//check to see if GPU animation is used\n\t\tif (this.usesAnimation) {\n\n\t\t\tvar animationSet:AnimationSetBase = <AnimationSetBase> this._pass.animationSet;\n\n\t\t\tthis._animationVertexCode += animationSet.getAGALVertexCode(this);\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += animationSet.getAGALUVCode(this);\n\n\t\t\tif (this.usesFragmentAnimation)\n\t\t\t\tthis._animationFragmentCode += animationSet.getAGALFragmentCode(this, shadedTarget);\n\n\t\t\tanimationSet.doneAGALCode(this);\n\n\t\t} else {\n\t\t\t// simply write attributes to targets, do not animate them\n\t\t\t// projection will pick up on targets[0] to do the projection\n\t\t\tvar len:number = this.animatableAttributes.length;\n\t\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.animationTargetRegisters[i] + \", \" + this.animatableAttributes[i] + \"\\n\";\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.uvTarget + \",\" + this.uvSource + \"\\n\";\n\t\t}\n\t}\n}\n\nexport = ShaderBase;",
    "import RegisterPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/RegisterPool\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * ShaderRegister Cache provides the usage management system for all registers during shading compilers.\n */\nclass ShaderRegisterCache\n{\n\tprivate _fragmentTempCache:RegisterPool;\n\tprivate _vertexTempCache:RegisterPool;\n\tprivate _varyingCache:RegisterPool;\n\tprivate _fragmentConstantsCache:RegisterPool;\n\tprivate _vertexConstantsCache:RegisterPool;\n\tprivate _textureCache:RegisterPool;\n\tprivate _vertexAttributesCache:RegisterPool;\n\tprivate _vertexConstantOffset:number; //TODO: check if this should be initialised to 0\n\tprivate _vertexAttributesOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _varyingsOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _fragmentConstantOffset:number;//TODO: check if this should be initialised to 0\n\n\tprivate _fragmentOutputRegister:ShaderRegisterElement;\n\tprivate _vertexOutputRegister:ShaderRegisterElement;\n\tprivate _numUsedVertexConstants:number = 0;\n\tprivate _numUsedFragmentConstants:number = 0;\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\tprivate _numUsedVaryings:number = 0;\n\tprivate _profile:string;\n\n\t/**\n\t * Create a new ShaderRegisterCache object.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tconstructor(profile:string)\n\t{\n\t\tthis._profile = profile;\n\t}\n\n\t/**\n\t * Resets all registers.\n\t */\n\tpublic reset()\n\t{\n\t\tthis._fragmentTempCache = new RegisterPool(\"ft\", 8, false);\n\t\tthis._vertexTempCache = new RegisterPool(\"vt\", 8, false);\n\t\tthis._varyingCache = new RegisterPool(\"v\", 8);\n\t\tthis._textureCache = new RegisterPool(\"fs\", 8);\n\t\tthis._vertexAttributesCache = new RegisterPool(\"va\", 8);\n\t\tthis._fragmentConstantsCache = new RegisterPool(\"fc\", 28);\n\t\tthis._vertexConstantsCache = new RegisterPool(\"vc\", 128);\n\t\tthis._fragmentOutputRegister = new ShaderRegisterElement(\"oc\", -1);\n\t\tthis._vertexOutputRegister = new ShaderRegisterElement(\"op\", -1);\n\t\tthis._numUsedVertexConstants = 0;\n\t\tthis._numUsedStreams = 0;\n\t\tthis._numUsedTextures = 0;\n\t\tthis._numUsedVaryings = 0;\n\t\tthis._numUsedFragmentConstants = 0;\n\n\t\tvar i:number;\n\n\t\tfor (i = 0; i < this._vertexAttributesOffset; ++i)\n\t\t\tthis.getFreeVertexAttribute();\n\n\t\tfor (i = 0; i < this._vertexConstantOffset; ++i)\n\t\t\tthis.getFreeVertexConstant();\n\n\t\tfor (i = 0; i < this._varyingsOffset; ++i)\n\t\t\tthis.getFreeVarying();\n\n\t\tfor (i = 0; i < this._fragmentConstantOffset; ++i)\n\t\t\tthis.getFreeFragmentConstant();\n\t}\n\n\t/**\n\t * Disposes all resources used.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._fragmentTempCache.dispose();\n\t\tthis._vertexTempCache.dispose();\n\t\tthis._varyingCache.dispose();\n\t\tthis._fragmentConstantsCache.dispose();\n\t\tthis._vertexAttributesCache.dispose();\n\n\t\tthis._fragmentTempCache = null;\n\t\tthis._vertexTempCache = null;\n\t\tthis._varyingCache = null;\n\t\tthis._fragmentConstantsCache = null;\n\t\tthis._vertexAttributesCache = null;\n\t\tthis._fragmentOutputRegister = null;\n\t\tthis._vertexOutputRegister = null;\n\t}\n\n\t/**\n\t * Marks a fragment temporary register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addFragmentTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._fragmentTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a fragment temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeFragmentTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._fragmentTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Marks a vertex temporary register as used, so it cannot be retrieved. The register won't be able to be used\n\t * until removeUsage has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addVertexTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._vertexTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a vertex temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeVertexTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._vertexTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Retrieve an entire fragment temporary register that's still available. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t */\n\tpublic getFreeFragmentVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a fragment temporary register that's still available.\n\t */\n\tpublic getFreeFragmentSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available varying register\n\t */\n\tpublic getFreeVarying():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVaryings;\n\t\treturn this._varyingCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available fragment constant register\n\t */\n\tpublic getFreeFragmentConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedFragmentConstants;\n\t\treturn this._fragmentConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available vertex constant register\n\t */\n\tpublic getFreeVertexConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVertexConstants;\n\t\treturn this._vertexConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an entire vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available vertex attribute register\n\t */\n\tpublic getFreeVertexAttribute():ShaderRegisterElement\n\t{\n\t\t++this._numUsedStreams;\n\t\treturn this._vertexAttributesCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available texture register\n\t */\n\tpublic getFreeTextureReg():ShaderRegisterElement\n\t{\n\t\t++this._numUsedTextures;\n\t\treturn this._textureCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex constants.\n\t */\n\tpublic get vertexConstantOffset():number\n\t{\n\t\treturn this._vertexConstantOffset;\n\t}\n\n\tpublic set vertexConstantOffset(vertexConstantOffset:number)\n\t{\n\t\tthis._vertexConstantOffset = vertexConstantOffset;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex attributes.\n\t */\n\tpublic get vertexAttributesOffset():number\n\t{\n\t\treturn this._vertexAttributesOffset;\n\t}\n\n\tpublic set vertexAttributesOffset(value:number)\n\t{\n\t\tthis._vertexAttributesOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve varying registers.\n\t */\n\tpublic get varyingsOffset():number\n\t{\n\t\treturn this._varyingsOffset;\n\t}\n\n\tpublic set varyingsOffset(value:number)\n\t{\n\t\tthis._varyingsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve fragment constants.\n\t */\n\tpublic get fragmentConstantOffset():number\n\t{\n\t\treturn this._fragmentConstantOffset;\n\t}\n\n\tpublic set fragmentConstantOffset(value:number)\n\t{\n\t\tthis._fragmentConstantOffset = value;\n\t}\n\n\t/**\n\t * The fragment output register.\n\t */\n\tpublic get fragmentOutputRegister():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentOutputRegister;\n\t}\n\n\t/**\n\t * The amount of used vertex constant registers.\n\t */\n\tpublic get numUsedVertexConstants():number\n\t{\n\t\treturn this._numUsedVertexConstants;\n\t}\n\n\t/**\n\t * The amount of used fragment constant registers.\n\t */\n\tpublic get numUsedFragmentConstants():number\n\t{\n\t\treturn this._numUsedFragmentConstants;\n\t}\n\n\t/**\n\t * The amount of used vertex streams.\n\t */\n\tpublic get numUsedStreams():number\n\t{\n\t\treturn this._numUsedStreams;\n\t}\n\n\t/**\n\t * The amount of used texture slots.\n\t */\n\tpublic get numUsedTextures():number\n\t{\n\t\treturn this._numUsedTextures;\n\t}\n\n\t/**\n\t * The amount of used varying registers.\n\t */\n\tpublic get numUsedVaryings():number\n\t{\n\t\treturn this._numUsedVaryings;\n\t}\n}\n\nexport = ShaderRegisterCache;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * ShaderRegisterData contains the \"named\" registers, generated by the compiler and to be passed on to the methods.\n */\nclass ShaderRegisterData\n{\n\tpublic normalVarying:ShaderRegisterElement;\n\tpublic colorVarying:ShaderRegisterElement\n\tpublic tangentVarying:ShaderRegisterElement;\n\tpublic bitangentVarying:ShaderRegisterElement;\n\tpublic uvVarying:ShaderRegisterElement;\n\tpublic secondaryUVVarying:ShaderRegisterElement;\n\tpublic viewDirVarying:ShaderRegisterElement;\n\tpublic shadowTarget:ShaderRegisterElement;\n\tpublic shadedTarget:ShaderRegisterElement;\n\tpublic globalPositionVertex:ShaderRegisterElement;\n\tpublic globalPositionVarying:ShaderRegisterElement;\n    public localPositionVarying:ShaderRegisterElement;\n\tpublic localPosition:ShaderRegisterElement;\n\tpublic normalInput:ShaderRegisterElement;\n\tpublic colorInput:ShaderRegisterElement;\n\tpublic tangentInput:ShaderRegisterElement;\n\tpublic animatedNormal:ShaderRegisterElement;\n\tpublic animatedTangent:ShaderRegisterElement;\n\tpublic commons:ShaderRegisterElement;\n\tpublic projectionFragment:ShaderRegisterElement;\n\tpublic normalFragment:ShaderRegisterElement;\n\tpublic viewDirFragment:ShaderRegisterElement;\n\tpublic bitangent:ShaderRegisterElement;\n\n\tconstructor()\n\t{\n\n\t}\n}\n\nexport = ShaderRegisterData;",
    "/**\n * A single register element (an entire register or a single register's component) used by the RegisterPool.\n */\nclass ShaderRegisterElement\n{\n\tprivate _regName:string;\n\tprivate _index:number;\n\tprivate _toStr:string;\n\n\tprivate static COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\n\n\tpublic _component:number;\n\n\t/**\n\t * Creates a new ShaderRegisterElement object.\n\t *\n\t * @param regName The name of the register.\n\t * @param index The index of the register.\n\t * @param component The register's component, if not the entire register is represented.\n\t */\n\tconstructor(regName:string, index:number, component:number = -1)\n\t{\n\t\tthis._component = component;\n\t\tthis._regName = regName;\n\t\tthis._index = index;\n\n\t\tthis._toStr = this._regName;\n\n\t\tif (this._index >= 0)\n\t\t\tthis._toStr += this._index;\n\n\t\tif (component > -1)\n\t\t\tthis._toStr += \".\" + ShaderRegisterElement.COMPONENTS[component];\n\t}\n\n\t/**\n\t * Converts the register or the components AGAL string representation.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn this._toStr;\n\t}\n\n\t/**\n\t * The register's name.\n\t */\n\tpublic get regName():string\n\t{\n\t\treturn this._regName;\n\t}\n\n\t/**\n\t * The register's index.\n\t */\n\tpublic get index():number\n\t{\n\t\treturn this._index;\n\t}\n}\n\nexport = ShaderRegisterElement;",
    "import RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\n\n/**\n * CompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass CompilerBase\n{\n\tpublic _pShader:ShaderBase;\n\tpublic _pSharedRegisters:ShaderRegisterData;\n\tpublic _pRegisterCache:ShaderRegisterCache;\n\tpublic _pRenderableClass:IRenderableClass;\n\tpublic _pRenderPass:IPass;\n\n\tpublic _pVertexCode:string = ''; // Changed to emtpy string- AwayTS\n\tpublic _pFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\tpublic _pPostAnimationFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\n\t//The attributes that need to be animated by animators.\n\tpublic _pAnimatableAttributes:Array<string>;\n\n\t//The target registers for animated properties, written to by the animators.\n\tpublic _pAnimationTargetRegisters:Array<string>;\n\n\t//The target register to place the animated UV coordinate.\n\tprivate _uvTarget:string;\n\n\t//The souce register providing the UV coordinate to animate.\n\tprivate _uvSource:string;\n\n\t/**\n\t * Creates a new CompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, pass:IPass, shader:ShaderBase)\n\t{\n\t\tthis._pRenderableClass = renderableClass;\n\t\tthis._pRenderPass = pass;\n\t\tthis._pShader = shader;\n\n\t\tthis._pSharedRegisters = new ShaderRegisterData();\n\n\t\tthis._pRegisterCache = new ShaderRegisterCache(shader.profile);\n\t\tthis._pRegisterCache.vertexAttributesOffset = renderableClass.vertexAttributesOffset;\n\t\tthis._pRegisterCache.reset();\n\t}\n\n\t/**\n\t * Compiles the code after all setup on the compiler has finished.\n\t */\n\tpublic compile()\n\t{\n\t\tthis._pShader.reset();\n\n\t\tthis._pShader._iIncludeDependencies();\n\n\t\tthis.pInitRegisterIndices();\n\n\t\tthis.pCompileDependencies();\n\n\t\t//compile custom vertex & fragment codes\n\t\tthis._pVertexCode += this._pRenderPass._iGetVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pPostAnimationFragmentCode += this._pRenderPass._iGetFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\tconsole.log(\"uses ct:\",this._pShader.usesColorTransform);\n\t\tif (this._pShader.usesColorTransform)\n\t\t{\n\t\t\tthis.compileColorTransformCode();\n\t\t}else{\n\t\t\tthis._pShader.colorTransformIndex = -1;\n\t\t}\n\n\t\t//assign the final output color to the output register\n\t\tthis._pPostAnimationFragmentCode += \"mov \" + this._pRegisterCache.fragmentOutputRegister + \", \" + this._pSharedRegisters.shadedTarget + \"\\n\";\n\t\tthis._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);\n\n\t\t//initialise the required shader constants\n\t\tthis._pShader.initConstantData(this._pRegisterCache, this._pAnimatableAttributes, this._pAnimationTargetRegisters, this._uvSource, this._uvTarget);\n\t\tthis._pRenderPass._iInitConstantData(this._pShader);\n\t}\n\t/**\n\t * Calculate the transformed colours\n\t */\n\tprivate compileColorTransformCode()\n\t{\n\t\t// rm, gm, bm, am - multiplier\n\t\t// ro, go, bo, ao - offset\n\t\tvar ct1:ShaderRegisterElement = this._pRegisterCache.getFreeFragmentConstant();\n\t\tvar ct2:ShaderRegisterElement = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShader.colorTransformIndex = ct1.index*4;\n\t\tthis._pPostAnimationFragmentCode += \"mul \" + this._pSharedRegisters.shadedTarget + \", \" + this._pSharedRegisters.shadedTarget + \", \" + ct1 + \"\\n\";\n\t\tthis._pPostAnimationFragmentCode += \"add \" + this._pSharedRegisters.shadedTarget + \", \" + this._pSharedRegisters.shadedTarget + \", \" + ct2 + \"\\n\";\n\t}\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tthis._pSharedRegisters.shadedTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget, 1);\n\n\t\t//compile the world-space position if required\n\t\tif (this._pShader.globalPosDependencies > 0)\n\t\t\tthis.compileGlobalPositionCode();\n\n        //compile the local-space position if required\n        if (this._pShader.usesLocalPosFragment)\n            this.compileLocalPositionCode();\n\n\t\t//Calculate the (possibly animated) UV coordinates.\n\t\tif (this._pShader.uvDependencies > 0)\n\t\t\tthis.compileUVCode();\n\n\t\tif (this._pShader.secondaryUVDependencies > 0)\n\t\t\tthis.compileSecondaryUVCode();\n\n\t\tif (this._pShader.normalDependencies > 0)\n\t\t\tthis.compileNormalCode();\n\n\t\tif (this._pShader.viewDirDependencies > 0)\n\t\t\tthis.compileViewDirCode();\n\n\t\t//collect code from material\n\t\tthis._pVertexCode += this._pRenderableClass._iGetVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderableClass._iGetFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//collect code from pass\n\t\tthis._pVertexCode += this._pRenderPass._iGetPreLightingVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderPass._iGetPreLightingFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\tprivate compileGlobalPositionCode()\n\t{\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex = this._pRegisterCache.getFreeVertexVectorTemp(), this._pShader.globalPosDependencies);\n\n\t\tvar sceneMatrixReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\tthis._pShader.sceneMatrixIndex = sceneMatrixReg.index*4;\n\n\t\tthis._pVertexCode += \"m44 \" + this._pSharedRegisters.globalPositionVertex + \", \" + this._pSharedRegisters.localPosition + \", \" + sceneMatrixReg + \"\\n\";\n\n\t\tif (this._pShader.usesGlobalPosFragment) {\n\t\t\tthis._pSharedRegisters.globalPositionVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.globalPositionVarying + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t}\n\t}\n    private compileLocalPositionCode()\n    {\n        this._pSharedRegisters.localPositionVarying = this._pRegisterCache.getFreeVarying();\n        this._pVertexCode += \"mov \" + this._pSharedRegisters.localPositionVarying + \", \" + this._pSharedRegisters.localPosition + \"\\n\";\n    }\n\t/**\n\t * Calculate the (possibly animated) UV coordinates.\n\t */\n\tprivate compileUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShader.uvBufferIndex = uvAttributeReg.index;\n\n\t\tvar varying:ShaderRegisterElement = this._pSharedRegisters.uvVarying = this._pRegisterCache.getFreeVarying();\n\n\t\tif (this._pShader.usesUVTransform) {\n\t\t\t// a, b, 0, tx\n\t\t\t// c, d, 0, ty\n\t\t\tvar uvTransform1:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tvar uvTransform2:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tthis._pShader.uvTransformIndex = uvTransform1.index*4;\n\n\t\t\tthis._pVertexCode += \"dp4 \" + varying + \".x, \" + uvAttributeReg + \", \" + uvTransform1 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"dp4 \" + varying + \".y, \" + uvAttributeReg + \", \" + uvTransform2 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"mov \" + varying + \".zw, \" + uvAttributeReg + \".zw \\n\";\n\t\t} else {\n\t\t\tthis._pShader.uvTransformIndex = -1;\n\t\t\tthis._uvTarget = varying.toString();\n\t\t\tthis._uvSource = uvAttributeReg.toString();\n\t\t}\n\t}\n\n\t/**\n\t * Provide the secondary UV coordinates.\n\t */\n\tprivate compileSecondaryUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShader.secondaryUVBufferIndex = uvAttributeReg.index;\n\t\tthis._pSharedRegisters.secondaryUVVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.secondaryUVVarying + \", \" + uvAttributeReg + \"\\n\";\n\t}\n\n\t/**\n\t * Calculate the view direction.\n\t */\n\tpublic compileViewDirCode()\n\t{\n\t\tvar cameraPositionReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pSharedRegisters.viewDirVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pSharedRegisters.viewDirFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment, this._pShader.viewDirDependencies);\n\n\t\tthis._pShader.cameraPositionIndex = cameraPositionReg.index*4;\n\n\t\tif (this._pShader.usesTangentSpace) {\n\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\"m33 \" + this._pSharedRegisters.viewDirVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.viewDirVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t} else {\n\t\t\tthis._pVertexCode += \"sub \" + this._pSharedRegisters.viewDirVarying + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex);\n\t\t}\n\n\t\t//TODO is this required in all cases? (re: distancemappass)\n\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.viewDirFragment + \".xyz, \" + this._pSharedRegisters.viewDirVarying + \"\\n\" +\n\t\t\t\"mov \" + this._pSharedRegisters.viewDirFragment + \".w,   \" + this._pSharedRegisters.viewDirVarying + \".w\\n\";\n\t}\n\n\t/**\n\t * Calculate the normal.\n\t */\n\tpublic compileNormalCode()\n\t{\n\t\tthis._pSharedRegisters.normalFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment, this._pShader.normalDependencies);\n\n\t\t//simple normal aquisition if no tangent space is being used\n\t\tif (this._pShader.outputsNormals && !this._pShader.outputsTangentNormals) {\n\t\t\tthis._pVertexCode += this._pRenderPass._iGetNormalVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar normalMatrix:Array<ShaderRegisterElement>;\n\n\t\tif (!this._pShader.outputsNormals || !this._pShader.usesTangentSpace) {\n\t\t\tnormalMatrix = new Array<ShaderRegisterElement>(3);\n\t\t\tnormalMatrix[0] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[1] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[2] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pShader.sceneNormalMatrixIndex = normalMatrix[0].index*4;\n\n\t\t\tthis._pSharedRegisters.normalVarying = this._pRegisterCache.getFreeVarying();\n\t\t}\n\n\t\tif (this._pShader.outputsNormals) {\n\t\t\tif (this._pShader.usesTangentSpace) {\n\t\t\t\t// normalize normal + tangent vector and generate (approximated) bitangent used in m33 operation for view\n\t\t\t\tthis._pVertexCode += \"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + this._pSharedRegisters.animatedNormal + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"crs \" + this._pSharedRegisters.bitangent + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\";\n\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t} else {\n\t\t\t\t//Compiles the vertex shader code for tangent-space normal maps.\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pSharedRegisters.bitangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"crs \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".y, \" + temp + \".x    \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".y, \" + temp + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".y, \" + temp + \".z    \\n\";\n\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);\n\n\t\t\t\t//Compiles the fragment shader code for tangent-space normal maps.\n\t\t\t\tvar t:ShaderRegisterElement;\n\t\t\t\tvar b:ShaderRegisterElement;\n\t\t\t\tvar n:ShaderRegisterElement;\n\n\t\t\t\tt = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(t, 1);\n\t\t\t\tb = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(b, 1);\n\t\t\t\tn = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(n, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + t + \".xyz, \" + this._pSharedRegisters.tangentVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + t + \".w, \" + this._pSharedRegisters.tangentVarying + \".w\t\\n\" +\n\t\t\t\t\t\"nrm \" + b + \".xyz, \" + this._pSharedRegisters.bitangentVarying + \"\\n\" +\n\t\t\t\t\t\"nrm \" + n + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\";\n\n\t\t\t\t//compile custom fragment code for normal calcs\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters) +\n\t\t\t\t\t\"m33 \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalFragment + \", \" + t + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(b);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(t);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(n);\n\t\t\t}\n\t\t} else {\n\t\t\t// no output, world space is enough\n\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.normalVarying + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.animatedNormal + \".w\\n\";\n\n\t\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\tif (this._pShader.tangentDependencies > 0) {\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.tangentVarying + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.animatedTangent + \".w\\n\";\n\t\t\t}\n\t\t}\n\n\t\tif (!this._pShader.usesTangentSpace)\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal);\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis._pShader.pInitRegisterIndices();\n\n\t\tthis._pAnimatableAttributes = new Array<string>(\"va0\");\n\t\tthis._pAnimationTargetRegisters = new Array<string>(\"vt0\");\n\t\tthis._pVertexCode = \"\";\n\t\tthis._pFragmentCode = \"\";\n\t\tthis._pPostAnimationFragmentCode = \"\";\n\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition = this._pRegisterCache.getFreeVertexVectorTemp(), 1);\n\n\t\t//create commonly shared constant registers\n\t\tthis._pSharedRegisters.commons = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShader.commonsDataIndex = this._pSharedRegisters.commons.index*4;\n\n\t\t//Creates the registers to contain the tangent data.\n\t\t// need to be created FIRST and in this order (for when using tangent space)\n\t\tif (this._pShader.tangentDependencies > 0 || this._pShader.outputsNormals) {\n\t\t\tthis._pSharedRegisters.tangentInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.tangentBufferIndex = this._pSharedRegisters.tangentInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedTangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent, 1);\n\n\t\t\tif (this._pShader.usesTangentSpace) {\n\t\t\t\tthis._pSharedRegisters.bitangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent, 1);\n\t\t\t}\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString());\n\t\t}\n\n\t\tif (this._pShader.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.normalInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.normalBufferIndex = this._pSharedRegisters.normalInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedNormal = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal, 1);\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString());\n\t\t}\n\n\t\tif (this._pShader.colorDependencies > 0) {\n\t\t\tthis._pSharedRegisters.colorInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.colorBufferIndex = this._pSharedRegisters.colorInput.index;\n\n\t\t\tthis._pSharedRegisters.colorVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.colorVarying + \", \" + this._pSharedRegisters.colorInput + \"\\n\";\n\t\t}\n\t}\n\n\t/**\n\t * Disposes all resources used by the compiler.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRegisterCache.dispose();\n\t\tthis._pRegisterCache = null;\n\t\tthis._pSharedRegisters = null;\n\t}\n\n\t/**\n\t * The generated vertex code.\n\t */\n\tpublic get vertexCode():string\n\t{\n\t\treturn this._pVertexCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get fragmentCode():string\n\t{\n\t\treturn this._pFragmentCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get postAnimationFragmentCode():string\n\t{\n\t\treturn this._pPostAnimationFragmentCode;\n\t}\n\n\t/**\n\t * The register name containing the final shaded colour.\n\t */\n\tpublic get shadedTarget():string\n\t{\n\t\treturn this._pSharedRegisters.shadedTarget.toString();\n\t}\n}\n\nexport = CompilerBase;",
    "import ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\n\nimport LightingShader\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/LightingShader\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport ILightingPass\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/ILightingPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\n\n/**\n * CompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass LightingCompiler extends CompilerBase\n{\n\tprivate _shaderLightingObject:LightingShader;\n\tprivate _lightingPass:ILightingPass;\n\tpublic _pointLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _pointLightVertexConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightVertexConstants:Array<ShaderRegisterElement>;\n\n\tpublic _pNumProbeRegisters:number;\n\n\t/**\n\t * Creates a new CompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, lightingPass:ILightingPass, shaderLightingObject:LightingShader)\n\t{\n\t\tsuper(renderableClass, lightingPass, shaderLightingObject);\n\n\t\tthis._shaderLightingObject = shaderLightingObject;\n\t\tthis._lightingPass = lightingPass;\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tsuper.pCompileDependencies();\n\n\t\t//compile the lighting code\n\t\tif (this._shaderLightingObject.usesShadows)\n\t\t\tthis.pCompileShadowCode();\n\n\t\tif (this._shaderLightingObject.usesLights) {\n\t\t\tthis.initLightRegisters();\n\t\t\tthis.compileLightCode();\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesProbes)\n\t\t\tthis.compileLightProbeCode();\n\n\t\tthis._pVertexCode += this._lightingPass._iGetPostLightingVertexCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._lightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\t/**\n\t * Provides the code to provide shadow mapping.\n\t */\n\tpublic pCompileShadowCode()\n\t{\n\t\tif (this._shaderLightingObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pSharedRegisters.normalFragment;\n\t\t} else {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget, 1);\n\t\t}\n\t}\n\n\t/**\n\t * Initializes constant registers to contain light data.\n\t */\n\tprivate initLightRegisters()\n\t{\n\t\t// init these first so we're sure they're in sequence\n\t\tvar i:number, len:number;\n\n\t\tif (this._dirLightVertexConstants) {\n\t\t\tlen = this._dirLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._dirLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._dirLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pointLightVertexConstants) {\n\t\t\tlen = this._pointLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._pointLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._pointLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tlen = this._dirLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._dirLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._dirLightFragmentConstants[i].index*4;\n\t\t}\n\n\t\tlen = this._pointLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._pointLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._pointLightFragmentConstants[i].index*4;\n\t\t}\n\t}\n\n\t/**\n\t * Compiles the shading code for directional and point lights.\n\t */\n\tprivate compileLightCode()\n\t{\n\t\tvar diffuseColorReg:ShaderRegisterElement;\n\t\tvar specularColorReg:ShaderRegisterElement;\n\t\tvar lightPosReg:ShaderRegisterElement;\n\t\tvar lightDirReg:ShaderRegisterElement;\n\t\tvar vertexRegIndex:number = 0;\n\t\tvar fragmentRegIndex:number = 0;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesLightsForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesLightsForDiffuse;\n\n\t\t//compile the shading code for directional lights.\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numDirectionalLights; ++i) {\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightDirReg = this._dirLightVertexConstants[vertexRegIndex++];\n\n\t\t\t\tvar lightVarying:ShaderRegisterElement = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + lightVarying + \".xyz, \" + lightDirReg + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(lightDirReg, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\n\t\t\t} else {\n\t\t\t\tlightDirReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\t}\n\n\t\t\tdiffuseColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace)\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(lightDirReg);\n\t\t}\n\n\t\tvertexRegIndex = 0;\n\t\tfragmentRegIndex = 0;\n\n\t\t//compile the shading code for point lights\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numPointLights; ++i) {\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment)\n\t\t\t\tlightPosReg = this._pointLightVertexConstants[vertexRegIndex++];\n\t\t\telse\n\t\t\t\tlightPosReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tdiffuseColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(lightDirReg, 1);\n\n\t\t\tvar lightVarying:ShaderRegisterElement;\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + lightPosReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\t\"m33 \" + lightVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t\t} else if (!this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pVertexCode += \"sub \" + lightVarying + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\t} else {\n\t\t\t\tlightVarying = lightDirReg;\n\t\t\t\tthis._pFragmentCode += \"sub \" + lightDirReg + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVarying + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.usesLightFallOff) {\n\t\t\t\t// calculate attenuation\n\t\t\t\tthis._pFragmentCode += // attenuate\n\t\t\t\t\t\"dp3 \" + lightDirReg + \".w, \" + lightVarying + \", \" + lightVarying + \"\\n\" + // w = d - radius\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + diffuseColorReg + \".w\\n\" + // w = (d - radius)/(max-min)\n\t\t\t\t\t\"mul \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + specularColorReg + \".w\\n\" + // w = clamp(w, 0, 1)\n\t\t\t\t\t\"sat \" + lightDirReg + \".w, \" + lightDirReg + \".w\\n\" + // w = 1-w\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + this._pSharedRegisters.commons + \".w, \" + lightDirReg + \".w\\n\" + // normalize\n\t\t\t\t\t\"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\";\n\t\t\t} else {\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = lightPosReg.index*4;\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tthis._pRegisterCache.removeFragmentTempUsage(lightDirReg);\n\t\t}\n\t}\n\n\t/**\n\t * Compiles shading code for light probes.\n\t */\n\tprivate compileLightProbeCode()\n\t{\n\t\tvar weightReg:string;\n\t\tvar weightComponents = [ \".x\", \".y\", \".z\", \".w\" ];\n\t\tvar weightRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>();\n\t\tvar i:number;\n\t\tvar texReg:ShaderRegisterElement;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesProbesForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesProbesForDiffuse;\n\n\t\tif (addDiff)\n\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices = new Array<number>();\n\n\t\tif (addSpec)\n\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices = new Array<number>();\n\n\t\tfor (i = 0; i < this._pNumProbeRegisters; ++i) {\n\t\t\tweightRegisters[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (i == 0)\n\t\t\t\tthis._shaderLightingObject.probeWeightsIndex = weightRegisters[i].index*4;\n\t\t}\n\n\t\tfor (i = 0; i < this._shaderLightingObject.numLightProbes; ++i) {\n\t\t\tweightReg = weightRegisters[Math.floor(i/4)].toString() + weightComponents[i%4];\n\n\t\t\tif (addDiff) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\n\t\t\tif (addSpec) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tsuper.pInitRegisterIndices();\n\n\t\tthis._shaderLightingObject.lightVertexConstantIndex = -1;\n\t\tthis._shaderLightingObject.lightFragmentConstantIndex = -1;\n\t\tthis._shaderLightingObject.probeWeightsIndex = -1;\n\n\t\tthis._pNumProbeRegisters = Math.ceil(this._shaderLightingObject.numLightProbes/4);\n\n\t\t//init light data\n\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\tthis._pointLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights);\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*2);\n\t\t} else {\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*3);\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\tthis._dirLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights);\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*2);\n\t\t} else {\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*3);\n\t\t}\n\t}\n}\n\nexport = LightingCompiler;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n *  Class Merge merges two or more static meshes into one.<code>Merge</code>\n */\nclass Merge\n{\n\n\t//private const LIMIT:uint = 196605;\n\tprivate _objectSpace:boolean;\n\tprivate _keepMaterial:boolean;\n\tprivate _disposeSources:boolean;\n\tprivate _geomVOs:Array<GeometryVO>;\n\tprivate _toDispose:Array<Mesh>;\n\n\t/**\n\t * @param    keepMaterial    [optional]    Determines if the merged object uses the recevier mesh material information or keeps its source material(s). Defaults to false.\n\t * If false and receiver object has multiple materials, the last material found in receiver submeshes is applied to the merged submesh(es).\n\t * @param    disposeSources  [optional]    Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t * If true, only receiver geometry and resulting mesh are kept in  memory.\n\t * @param    objectSpace     [optional]    Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tconstructor(keepMaterial:boolean = false, disposeSources:boolean = false, objectSpace:boolean = false)\n\t{\n\t\tthis._keepMaterial = keepMaterial;\n\t\tthis._disposeSources = disposeSources;\n\t\tthis._objectSpace = objectSpace;\n\t}\n\n\t/**\n\t * Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set disposeSources(b:boolean)\n\t{\n\t\tthis._disposeSources = b;\n\t}\n\n\tpublic get disposeSources():boolean\n\t{\n\t\treturn this._disposeSources;\n\t}\n\n\t/**\n\t * Determines if the material source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set keepMaterial(b:boolean)\n\t{\n\t\tthis._keepMaterial = b;\n\t}\n\n\tpublic get keepMaterial():boolean\n\t{\n\t\treturn this._keepMaterial;\n\t}\n\n\t/**\n\t * Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tpublic set objectSpace(b:boolean)\n\t{\n\t\tthis._objectSpace = b;\n\t}\n\n\tpublic get objectSpace():boolean\n\t{\n\t\treturn this._objectSpace;\n\t}\n\n\t/**\n\t * Merges all the children of a container into a single Mesh. If no Mesh object is found, method returns the receiver without modification.\n\t *\n\t * @param    receiver           The Mesh to receive the merged contents of the container.\n\t * @param    objectContainer    The DisplayObjectContainer holding the meshes to be mergd.\n\t *\n\t * @return The merged Mesh instance.\n\t */\n\tpublic applyToContainer(receiver:Mesh, objectContainer:DisplayObjectContainer)\n\t{\n\t\tthis.reset();\n\n\t\t//collect container meshes\n\t\tthis.parseContainer(receiver, objectContainer);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t * Merges all the meshes found in the Array&lt;Mesh&gt; into a single Mesh.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of the meshes.\n\t * @param    meshes      A series of Meshes to be merged with the reciever mesh.\n\t */\n\tpublic applyToMeshes(receiver:Mesh, meshes:Array<Mesh>)\n\t{\n\t\tthis.reset();\n\n\t\tif (!meshes.length)\n\t\t\treturn;\n\n\t\t//collect meshes in vector\n\t\tfor (var i:number /*uint*/ = 0; i < meshes.length; i++)\n\t\t\tif (meshes[i] != receiver)\n\t\t\t\tthis.collect(meshes[i], this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t *  Merges 2 meshes into one. It is recommand to use apply when 2 meshes are to be merged. If more need to be merged, use either applyToMeshes or applyToContainer methods.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of both meshes.\n\t * @param    mesh        The Mesh to be merged with the receiver mesh\n\t */\n\tpublic apply(receiver:Mesh, mesh:Mesh)\n\t{\n\t\tthis.reset();\n\n\t\t//collect mesh\n\t\tthis.collect(mesh, this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\tprivate reset()\n\t{\n\t\tthis._toDispose  = new Array<Mesh>();\n\t\tthis._geomVOs = new Array<GeometryVO>();\n\t}\n\n\tprivate merge(destMesh:Mesh, dispose:boolean)\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar subIdx:number /*uint*/;\n\t\tvar oldGeom:Geometry;\n\t\tvar destGeom:Geometry;\n\t\tvar useSubMaterials:boolean;\n\n\t\toldGeom = destMesh.geometry;\n\t\tdestGeom = destMesh.geometry = new Geometry();\n\t\tsubIdx = destMesh.subMeshes.length;\n\n\t\t// Only apply materials directly to sub-meshes if necessary,\n\t\t// i.e. if there is more than one material available.\n\t\tuseSubMaterials = (this._geomVOs.length > 1);\n\n\t\tfor (i = 0; i < this._geomVOs.length; i++) {\n\t\t\tvar s:number /*uint*/;\n\t\t\tvar data:GeometryVO;\n\t\t\tvar sub:TriangleSubGeometry = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\tsub.autoDeriveNormals = false;\n\t\t\tsub.autoDeriveTangents = false;\n\n\t\t\tdata = this._geomVOs[i];\n\t\t\tsub.setIndices(data.indices);\n\t\t\tsub.setPositions(data.vertices);\n\t\t\tsub.setNormals(data.normals);\n\t\t\tsub.setTangents(data.tangents);\n\t\t\tsub.setUVs(data.uvs);\n\n\t\t\tdestGeom.addSubGeometry(sub);\n\n\t\t\tif (this._keepMaterial && useSubMaterials)\n\t\t\t\tdestMesh.subMeshes[subIdx].material = data.material;\n\t\t}\n\n\t\tif (this._keepMaterial && !useSubMaterials && this._geomVOs.length)\n\t\t\tdestMesh.material = this._geomVOs[0].material;\n\n\t\tif (dispose) {\n\t\t\tvar m:Mesh;\n\t\t\tvar len:number = this._toDispose.length;\n\t\t\tfor (var i:number; i < len; i++) {\n\t\t\t\tm = this._toDispose[i];\n\t\t\t\tm.geometry.dispose();\n\t\t\t\tm.dispose();\n\t\t\t}\n\n\t\t\t//dispose of the original receiver geometry\n\t\t\toldGeom.dispose();\n\t\t}\n\n\t\tthis._toDispose = null;\n\t}\n\n\tprivate collect(mesh:Mesh, dispose:boolean)\n\t{\n\t\tif (mesh.geometry) {\n\t\t\tvar subIdx:number /*uint*/;\n\t\t\tvar subGeometries:Array<TriangleSubGeometry> = <Array<TriangleSubGeometry>> mesh.geometry.subGeometries;\n\t\t\tvar calc:number /*uint*/;\n\t\t\tfor (subIdx = 0; subIdx < subGeometries.length; subIdx++) {\n\t\t\t\tvar i:number /*uint*/;\n\t\t\t\tvar len:number /*uint*/;\n\t\t\t\tvar iIdx:number /*uint*/, vIdx:number /*uint*/, nIdx:number /*uint*/, tIdx:number /*uint*/, uIdx:number /*uint*/;\n\t\t\t\tvar indexOffset:number /*uint*/;\n\t\t\t\tvar subGeom:TriangleSubGeometry;\n\t\t\t\tvar vo:GeometryVO;\n\t\t\t\tvar vertices:Array<number>;\n\t\t\t\tvar normals:Array<number>;\n\t\t\t\tvar tangents:Array<number>;\n\t\t\t\tvar ind:Uint16Array, pd:Float32Array, nd:Float32Array, td:Float32Array, ud:Float32Array;\n\n\t\t\t\tsubGeom = subGeometries[subIdx];\n\t\t\t\tpd = subGeom.positions.get(subGeom.numVertices);\n\t\t\t\tnd = subGeom.normals.get(subGeom.numVertices);\n\t\t\t\ttd = subGeom.tangents.get(subGeom.numVertices);\n\t\t\t\tud = subGeom.uvs.get(subGeom.numVertices);\n\n\t\t\t\t// Get (or create) a VO for this material\n\t\t\t\tvo = this.getSubGeomData(mesh.subMeshes[subIdx].material || mesh.material);\n\n\t\t\t\t// Vertices and normals are copied to temporary vectors, to be transformed\n\t\t\t\t// before concatenated onto those of the data. This is unnecessary if no\n\t\t\t\t// transformation will be performed, i.e. for object space merging.\n\t\t\t\tvertices = (this._objectSpace)? vo.vertices : new Array<number>();\n\t\t\t\tnormals = (this._objectSpace)? vo.normals : new Array<number>();\n\t\t\t\ttangents = (this._objectSpace)? vo.tangents : new Array<number>();\n\n\t\t\t\t// Copy over vertex attributes\n\t\t\t\tvIdx = vertices.length;\n\t\t\t\tnIdx = normals.length;\n\t\t\t\ttIdx = tangents.length;\n\t\t\t\tuIdx = vo.uvs.length;\n\t\t\t\tlen = subGeom.numVertices;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\n\t\t\t\t\t// Position\n\t\t\t\t\tvertices[vIdx++] = pd[calc];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 1];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 2];\n\n\t\t\t\t\t// Normal\n\t\t\t\t\tnormals[nIdx++] = nd[calc];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 1];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 2];\n\n\t\t\t\t\t// Tangent\n\t\t\t\t\ttangents[tIdx++] = td[calc];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 1];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 2];\n\n\t\t\t\t\t// UV\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2];\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2 + 1];\n\t\t\t\t}\n\n\t\t\t\t// Copy over triangle indices\n\t\t\t\tindexOffset = (!this._objectSpace)? vo.vertices.length/3 :0;\n\t\t\t\tiIdx = vo.indices.length;\n\t\t\t\tlen = subGeom.numElements;\n\t\t\t\tind = subGeom.indices.get(len);\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc + 1] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc + 2] + indexOffset;\n\t\t\t\t}\n\n\t\t\t\tif (!this._objectSpace) {\n\t\t\t\t\tmesh.sceneTransform.transformVectors(vertices, vertices);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, normals, normals);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, tangents, tangents);\n\n\t\t\t\t\t// Copy vertex data from temporary (transformed) vectors\n\t\t\t\t\tvIdx = vo.vertices.length;\n\t\t\t\t\tnIdx = vo.normals.length;\n\t\t\t\t\ttIdx = vo.tangents.length;\n\t\t\t\t\tlen = vertices.length;\n\t\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\t\tvo.vertices[vIdx++] = vertices[i];\n\t\t\t\t\t\tvo.normals[nIdx++] = normals[i];\n\t\t\t\t\t\tvo.tangents[tIdx++] = tangents[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dispose)\n\t\t\t\tthis._toDispose.push(mesh);\n\t\t}\n\t}\n\n\tprivate getSubGeomData(material:MaterialBase):GeometryVO\n\t{\n\t\tvar data:GeometryVO;\n\n\t\tif (this._keepMaterial) {\n\t\t\tvar i:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\n\t\t\tlen = this._geomVOs.length;\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tif (this._geomVOs[i].material == material) {\n\t\t\t\t\tdata = this._geomVOs[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this._geomVOs.length) {\n\t\t\t// If materials are not to be kept, all data can be\n\t\t\t// put into a single VO, so return that one.\n\t\t\tdata = this._geomVOs[0];\n\t\t}\n\n\t\t// No data (for this material) found, create new.\n\t\tif (!data) {\n\t\t\tdata = new GeometryVO();\n\t\t\tdata.vertices = new Array<number>();\n\t\t\tdata.normals = new Array<number>();\n\t\t\tdata.tangents = new Array<number>();\n\t\t\tdata.uvs = new Array<number>();\n\t\t\tdata.indices = new Array<number /*uint*/>();\n\t\t\tdata.material = material;\n\n\t\t\tthis._geomVOs.push(data);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tprivate parseContainer(receiver:Mesh, object:DisplayObjectContainer)\n\t{\n\t\tvar child:DisplayObjectContainer;\n\t\tvar i:number /*uint*/;\n\n\t\tif (object instanceof Mesh && object != (<DisplayObjectContainer> receiver))\n\t\t\tthis.collect(<Mesh> object, this._disposeSources);\n\n\t\tfor (i = 0; i < object.numChildren; ++i) {\n\t\t\tchild = <DisplayObjectContainer> object.getChildAt(i);\n\t\t\tthis.parseContainer(receiver, child);\n\t\t}\n\t}\n}\n\nexport = Merge;\n\nclass GeometryVO\n{\n\tpublic uvs:Array<number>;\n\tpublic vertices:Array<number>;\n\tpublic normals:Array<number>;\n\tpublic tangents:Array<number>;\n\tpublic indices:Array<number /*uint*/>;\n\tpublic material:MaterialBase;\n}\n",
    "import Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n * ...\n */\nclass ParticleGeometryTransform\n{\n\tprivate _defaultVertexTransform:Matrix3D;\n\tprivate _defaultInvVertexTransform:Matrix3D;\n\tprivate _defaultUVTransform:Matrix;\n\n\tpublic set vertexTransform(value:Matrix3D)\n\t{\n\t\tthis._defaultVertexTransform = value;\n\t\tthis._defaultInvVertexTransform = value.clone();\n\t\tthis._defaultInvVertexTransform.invert();\n\t\tthis._defaultInvVertexTransform.transpose();\n\t}\n\n\tpublic set UVTransform(value:Matrix)\n\t{\n\t\tthis._defaultUVTransform = value;\n\t}\n\n\tpublic get UVTransform():Matrix\n\t{\n\t\treturn this._defaultUVTransform;\n\t}\n\n\tpublic get vertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultVertexTransform;\n\t}\n\n\tpublic get invVertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultInvVertexTransform;\n\t}\n}\n\nexport = ParticleGeometryTransform;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ParticleGeometryTransform\t\t= require(\"awayjs-renderergl/lib/tools/data/ParticleGeometryTransform\");\n\n/**\n * ...\n */\nclass ParticleGeometryHelper\n{\n\tpublic static MAX_VERTEX:number /*int*/ = 65535;\n\n\tpublic static generateGeometry(geometries:Array<Geometry>, transforms:Array<ParticleGeometryTransform> = null):ParticleGeometry\n\t{\n\t\tvar indicesVector:Array<Array<number>> /*uint*/ = new Array<Array<number>>() /*uint*/;\n\t\tvar positionsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar normalsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar tangentsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar uvsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar vertexCounters:Array<number> /*uint*/ = new Array<number>() /*uint*/;\n\t\tvar particles:Array<ParticleData> = new Array<ParticleData>();\n\t\tvar subGeometries:Array<TriangleSubGeometry> = new Array<TriangleSubGeometry>();\n\t\tvar numParticles:number /*uint*/ = geometries.length;\n\n\t\tvar sourceSubGeometries:Array<TriangleSubGeometry>;\n\t\tvar sourceSubGeometry:TriangleSubGeometry;\n\t\tvar numSubGeometries:number /*uint*/;\n\t\tvar indices:Array<number> /*uint*/;\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\t\tvar uvs:Array<number>;\n\t\tvar vertexCounter:number /*uint*/;\n\t\tvar subGeometry:TriangleSubGeometry;\n\t\tvar i:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar sub2SubMap:Array<number> /*int*/ = new Array<number>() /*int*/;\n\n\t\tvar tempVertex:Vector3D = new Vector3D;\n\t\tvar tempNormal:Vector3D = new Vector3D;\n\t\tvar tempTangents:Vector3D = new Vector3D;\n\t\tvar tempUV:Point = new Point;\n\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsourceSubGeometries = <Array<TriangleSubGeometry>> geometries[i].subGeometries;\n\t\t\tnumSubGeometries = sourceSubGeometries.length;\n\t\t\tfor (var srcIndex:number /*int*/ = 0; srcIndex < numSubGeometries; srcIndex++) {\n\t\t\t\t//create a different particle subgeometry group for each source subgeometry in a particle.\n\t\t\t\tif (sub2SubMap.length <= srcIndex) {\n\t\t\t\t\tsub2SubMap.push(subGeometries.length);\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(new AttributesBuffer()));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tsourceSubGeometry = sourceSubGeometries[srcIndex];\n\n\t\t\t\t//add a new particle subgeometry if this source subgeometry will take us over the maxvertex limit\n\t\t\t\tif (sourceSubGeometry.numVertices + vertexCounters[sub2SubMap[srcIndex]] > ParticleGeometryHelper.MAX_VERTEX) {\n\t\t\t\t\t//update submap and add new subgeom vectors\n\t\t\t\t\tsub2SubMap[srcIndex] = subGeometries.length;\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(new AttributesBuffer()));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tj = sub2SubMap[srcIndex];\n\n\t\t\t\t//select the correct vector\n\t\t\t\tindices = indicesVector[j];\n\t\t\t\tpositions = positionsVector[j];\n\t\t\t\tnormals = normalsVector[j];\n\t\t\t\ttangents = tangentsVector[j];\n\t\t\t\tuvs = uvsVector[j];\n\t\t\t\tvertexCounter = vertexCounters[j];\n\t\t\t\tsubGeometry = subGeometries[j];\n\n\t\t\t\tvar particleData:ParticleData = new ParticleData();\n\t\t\t\tparticleData.numVertices = sourceSubGeometry.numVertices;\n\t\t\t\tparticleData.startVertexIndex = vertexCounter;\n\t\t\t\tparticleData.particleIndex = i;\n\t\t\t\tparticleData.subGeometry = subGeometry;\n\t\t\t\tparticles.push(particleData);\n\n\t\t\t\tvertexCounters[j] += sourceSubGeometry.numVertices;\n\n\t\t\t\tvar k:number /*int*/;\n\t\t\t\tvar tempLen:number /*int*/;\n\t\t\t\tvar compact:TriangleSubGeometry = sourceSubGeometry;\n\t\t\t\tvar product:number /*uint*/;\n\t\t\t\tvar sourcePositions:Float32Array;\n\t\t\t\tvar sourceNormals:Float32Array;\n\t\t\t\tvar sourceTangents:Float32Array;\n\t\t\t\tvar sourceUVs:Float32Array;\n\n\t\t\t\tif (compact) {\n\t\t\t\t\ttempLen = compact.numVertices;\n\t\t\t\t\tsourcePositions = compact.positions.get(tempLen);\n\t\t\t\t\tsourceNormals = compact.normals.get(tempLen);\n\t\t\t\t\tsourceTangents = compact.tangents.get(tempLen);\n\t\t\t\t\tsourceUVs = compact.uvs.get(tempLen);\n\n\t\t\t\t\tif (transforms) {\n\t\t\t\t\t\tvar particleGeometryTransform:ParticleGeometryTransform = transforms[i];\n\t\t\t\t\t\tvar vertexTransform:Matrix3D = particleGeometryTransform.vertexTransform;\n\t\t\t\t\t\tvar invVertexTransform:Matrix3D = particleGeometryTransform.invVertexTransform;\n\t\t\t\t\t\tvar UVTransform:Matrix = particleGeometryTransform.UVTransform;\n\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t * 0 - 2: vertex position X, Y, Z\n\t\t\t\t\t\t\t * 3 - 5: normal X, Y, Z\n\t\t\t\t\t\t\t * 6 - 8: tangent X, Y, Z\n\t\t\t\t\t\t\t * 9 - 10: U V\n\t\t\t\t\t\t\t * 11 - 12: Secondary U V*/\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\ttempVertex.x = sourcePositions[product];\n\t\t\t\t\t\t\ttempVertex.y = sourcePositions[product + 1];\n\t\t\t\t\t\t\ttempVertex.z = sourcePositions[product + 2];\n\t\t\t\t\t\t\ttempNormal.x = sourceNormals[product];\n\t\t\t\t\t\t\ttempNormal.y = sourceNormals[product + 1];\n\t\t\t\t\t\t\ttempNormal.z = sourceNormals[product + 2];\n\t\t\t\t\t\t\ttempTangents.x = sourceTangents[product];\n\t\t\t\t\t\t\ttempTangents.y = sourceTangents[product + 1];\n\t\t\t\t\t\t\ttempTangents.z = sourceTangents[product + 2];\n\t\t\t\t\t\t\ttempUV.x = sourceUVs[k*2];\n\t\t\t\t\t\t\ttempUV.y = sourceUVs[k*2 + 1];\n\t\t\t\t\t\t\tif (vertexTransform) {\n\t\t\t\t\t\t\t\ttempVertex = vertexTransform.transformVector(tempVertex);\n\t\t\t\t\t\t\t\ttempNormal = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t\ttempTangents = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (UVTransform)\n\t\t\t\t\t\t\t\ttempUV = UVTransform.transformPoint(tempUV);\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tpositions.push(tempVertex.x, tempVertex.y, tempVertex.z);\n\t\t\t\t\t\t\tnormals.push(tempNormal.x, tempNormal.y, tempNormal.z);\n\t\t\t\t\t\t\ttangents.push(tempTangents.x, tempTangents.y, tempTangents.z);\n\t\t\t\t\t\t\tuvs.push(tempUV.x, tempUV.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tpositions.push(sourcePositions[product], sourcePositions[product + 1], sourcePositions[product + 2]);\n\t\t\t\t\t\t\tnormals.push(sourceNormals[product], sourceNormals[product + 1], sourceNormals[product + 2]);\n\t\t\t\t\t\t\ttangents.push(sourceTangents[product], sourceTangents[product + 1], sourceTangents[product + 2]);\n\t\t\t\t\t\t\tuvs.push(sourceUVs[k*2], sourceUVs[k*2 + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Todo\n\t\t\t\t}\n\n\t\t\t\ttempLen = sourceSubGeometry.numElements;\n\t\t\t\tvar sourceIndices:Uint16Array = sourceSubGeometry.indices.get(tempLen);\n\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\tproduct = k*3;\n\t\t\t\t\tindices.push(sourceIndices[product] + vertexCounter, sourceIndices[product + 1] + vertexCounter, sourceIndices[product + 2] + vertexCounter);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar particleGeometry:ParticleGeometry = new ParticleGeometry();\n\t\tparticleGeometry.particles = particles;\n\t\tparticleGeometry.numParticles = numParticles;\n\n\t\tnumParticles = subGeometries.length;\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsubGeometry = subGeometries[i];\n\t\t\tsubGeometry.autoDeriveNormals = false;\n\t\t\tsubGeometry.autoDeriveTangents = false;\n\t\t\tsubGeometry.setIndices(indicesVector[i]);\n\t\t\tsubGeometry.setPositions(positionsVector[i]);\n\t\t\tsubGeometry.setNormals(normalsVector[i]);\n\t\t\tsubGeometry.setTangents(tangentsVector[i]);\n\t\t\tsubGeometry.setUVs(uvsVector[i]);\n\t\t\tparticleGeometry.addSubGeometry(subGeometry);\n\t\t}\n\n\t\treturn particleGeometry;\n\t}\n}\n\nexport = ParticleGeometryHelper;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n *\n */\nclass PerspectiveMatrix3D extends Matrix3D\n{\n\tconstructor(v:Array<number> = null)\n\t{\n\t\tsuper(v);\n\t}\n\n\tpublic perspectiveFieldOfViewLH(fieldOfViewY:number, aspectRatio:number, zNear:number, zFar:number)\n\t{\n\t\tvar yScale:number = 1/Math.tan(fieldOfViewY/2);\n\t\tvar xScale:number = yScale/aspectRatio;\n\n\t\tthis.copyRawDataFrom([xScale, 0.0, 0.0, 0.0, 0.0, yScale, 0.0, 0.0, 0.0, 0.0, zFar/(zFar - zNear), 1.0, 0.0, 0.0, (zNear*zFar)/(zNear - zFar), 0.0]);\n\t}\n}\n\nexport = PerspectiveMatrix3D;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport CurveSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.CurveSubGeometryVO\n */\nclass CurveSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = CurveSubGeometry;\n\n\tprivate _curveSubGeometry:CurveSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, curveSubGeometry:CurveSubGeometry)\n\t{\n\t\tsuper(pool, curveSubGeometry);\n\n\t\tthis._curveSubGeometry = curveSubGeometry;\n\n\t\tthis.invalidateVertices(this._curveSubGeometry.positions);\n\t\tthis.invalidateVertices(this._curveSubGeometry.curves);\n\t\tthis.invalidateVertices(this._curveSubGeometry.uvs);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.uvBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.uvBufferIndex, this._curveSubGeometry.uvs, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._curveSubGeometry.positions, stage);\n\t\tthis.activateVertexBufferVO(1, this._curveSubGeometry.curves, stage);\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.CurveSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new CurveSubGeometryVO(this._pool, this._curveSubGeometry);\n\t}\n}\n\nexport = CurveSubGeometryVO;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.LineSubGeometryVO\n */\nclass LineSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = LineSubGeometry;\n\n\tprivate _lineSubGeometry:LineSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, lineSubGeometry:LineSubGeometry)\n\t{\n\t\tsuper(pool, lineSubGeometry);\n\n\t\tthis._lineSubGeometry = lineSubGeometry;\n\n\t\tthis.invalidateVertices(this._lineSubGeometry.positions);\n\t\tthis.invalidateVertices(this._lineSubGeometry.thickness);\n\t\tthis.invalidateVertices(this._lineSubGeometry.colors);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.colorBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.colorBufferIndex, this._lineSubGeometry.colors, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._lineSubGeometry.positions, stage, 3);\n\t\tthis.activateVertexBufferVO(1, this._lineSubGeometry.positions, stage, 3, 12);\n\t\tthis.activateVertexBufferVO(2, this._lineSubGeometry.thickness, stage);\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new LineSubGeometryVO(this._pool, this._lineSubGeometry);\n\t}\n}\n\nexport = LineSubGeometryVO;",
    "import Sampler2D\t\t\t\t\t= require(\"awayjs-core/lib/data/Sampler2D\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SamplerVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerVOBase\");\n\n/**\n *\n * @class away.pool.Sampler2DVO\n */\nclass Sampler2DVO extends SamplerVOBase\n{\n\tpublic sampler2D:Sampler2D;\n\n\tpublic fragmentReg:ShaderRegisterElement;\n\n\tpublic fragmentIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\n\tpublic initProperties(sampler2D:Sampler2D, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.sampler2D = sampler2D;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\t\tthis.samplerIndex = this.samplerReg.index;\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tthis.fragmentReg = regCache.getFreeFragmentConstant();\n\t\t\tthis.fragmentIndex = this.fragmentReg.index*4;\n\t\t}\n\t}\n\n\tpublic getFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar wrap:string = (shader.repeatTextures? \"wrap\":\"clamp\");\n\t\tvar format:string = this.getFormatString(this.sampler2D);\n\t\tvar filter:string = (shader.useSmoothTextures)? (shader.useMipmapping? \"linear,miplinear\" : \"linear\") : (shader.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\tvar temp:ShaderRegisterElement;\n\n\t\t//handles texture atlasing\n\t\tif (this.sampler2D.imageRect) {\n\t\t\ttemp = regCache.getFreeFragmentVectorTemp();\n\n\t\t\tcode += \"mul \" + temp + \", \" + inputReg + \", \" + this.fragmentReg + \".xy\\n\";\n\t\t\tcode += \"add \" + temp + \", \" + temp + \", \" + this.fragmentReg + \".zw\\n\";\n\t\t} else {\n\t\t\ttemp = inputReg;\n\t\t}\n\n\t\tcode += \"tex \" + targetReg + \", \" + temp + \", \" + this.samplerReg + \" <2d,\" + filter + \",\" + format + wrap + \">\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._stage.getImageObject(this.sampler2D.image2D).activate(this.samplerIndex, this.sampler2D.repeat || shader.repeatTextures, this.sampler2D.smooth || shader.useSmoothTextures, this.sampler2D.mipmap || shader.useMipmapping);\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tvar index:number = this.fragmentIndex;\n\t\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\t\tdata[index] = this.sampler2D.scaleX;\n\t\t\tdata[index + 1] = this.sampler2D.scaleY;\n\t\t\tdata[index + 2] = this.sampler2D.offsetX;\n\t\t\tdata[index + 3] = this.sampler2D.offsetY;\n\t\t}\n\t}\n}\n\nexport = Sampler2DVO;",
    "import SamplerCube\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerCube\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SamplerVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerVOBase\");\n\n/**\n *\n * @class away.pool.BitmapObject\n */\nclass SamplerCubeVO extends SamplerVOBase\n{\n\tpublic samplerCube:SamplerCube;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\tpublic initProperties(samplerCube:SamplerCube, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.samplerCube = samplerCube;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\n\t\tthis.samplerIndex = this.samplerReg.index;\n\t}\n\n\tpublic getFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar filter:string;\n\t\tvar format:string = this.getFormatString(this.samplerCube);\n\t\tvar filter:string = (shader.useSmoothTextures)? (shader.useMipmapping? \"linear,miplinear\" : \"linear\") : (shader.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\treturn \"tex \" + targetReg + \", \" + inputReg + \", \" + this.samplerReg + \" <cube,\" + format + filter + \">\\n\";\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._stage.getImageObject(this.samplerCube.imageCube).activate(this.samplerIndex, false, this.samplerCube.smooth || shader.useSmoothTextures, this.samplerCube.mipmap || shader.useMipmapping);\n\t}\n}\n\nexport = SamplerCubeVO;",
    "import SamplerBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerBase\");\n\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n\n/**\n *\n * @class away.pool.SamplerVOBase\n */\nclass SamplerVOBase\n{\n\tpublic _stage:Stage;\n\n\tpublic samplerReg:ShaderRegisterElement;\n\n\tpublic samplerIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * Generates a texture format string for the sample instruction.\n\t * @param texture The texture for which to get the format string.\n\t * @return\n\t *\n\t * @protected\n\t */\n\tpublic getFormatString(bitmap:SamplerBase):string\n\t{\n\t\tswitch (bitmap.format) {\n\t\t\tcase ContextGLTextureFormat.COMPRESSED:\n\t\t\t\treturn \"dxt1,\";\n\t\t\t\tbreak;\n\t\t\tcase ContextGLTextureFormat.COMPRESSED_ALPHA:\n\t\t\t\treturn \"dxt5,\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn \"\";\n\t\t}\n\t}\n}\n\nexport = SamplerVOBase;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport Single2DTexture\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport Sampler2DVO\t\t\t\t= require(\"awayjs-renderergl/lib/vos/Sampler2DVO\");\n\n/**\n *\n * @class away.pool.Single2DTextureVO\n */\nclass Single2DTextureVO extends TextureVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = Single2DTexture;\n\n\tprivate _single2DTexture:Single2DTexture;\n\n\tprivate _sampler2DVO:Sampler2DVO;\n\n\tconstructor(pool:TextureVOPool, single2DTexture:Single2DTexture, stage:Stage)\n\t{\n\t\tsuper(pool, single2DTexture, stage);\n\n\t\tthis._single2DTexture = single2DTexture;\n\n\t\tthis._sampler2DVO = new Sampler2DVO(stage);\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._sampler2DVO.initProperties(this._single2DTexture.sampler2D, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shader\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The uv coordinate vector with which to sample the texture map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._sampler2DVO.getFragmentCode(shader, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._sampler2DVO.activate(shader);\n\t}\n}\n\nexport = Single2DTextureVO;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport SingleCubeTexture\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport SamplerCubeVO\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerCubeVO\");\n\n/**\n *\n * @class away.pool.TextureDataBase\n */\nclass SingleCubeTextureVO extends TextureVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = SingleCubeTexture;\n\n\n\tprivate _singleCubeTexture:SingleCubeTexture;\n\n\tprivate _samplerCubeVO:SamplerCubeVO;\n\n\tconstructor(pool:TextureVOPool, singleCubeTexture:SingleCubeTexture, stage:Stage)\n\t{\n\t\tsuper(pool, singleCubeTexture, stage);\n\n\t\tthis._singleCubeTexture = singleCubeTexture;\n\n\t\tthis._samplerCubeVO = new SamplerCubeVO(stage);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase, includeInput:boolean = true)\n\t{\n\t\tif (includeInput)\n\t\t\tshader.usesLocalPosFragment = true;\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._samplerCubeVO.initProperties(this._singleCubeTexture.samplerCube, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shader\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The direction vector with which to sample the cube map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._samplerCubeVO.getFragmentCode(shader, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._samplerCubeVO.activate(shader);\n\t}\n}\n\nexport = SingleCubeTextureVO;",
    "import AttributesView\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesView\");\nimport AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport SubGeometryUtils\t\t\t\t= require(\"awayjs-display/lib/utils/SubGeometryUtils\");\nimport AttributesBufferVO\t\t\t= require(\"awayjs-stagegl/lib/vos/AttributesBufferVO\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport ISubGeometryVO\t\t\t\t= require(\"awayjs-display/lib/vos/ISubGeometryVO\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n *\n * @class away.pool.SubGeometryVOBaseBase\n */\nclass SubGeometryVOBase implements ISubGeometryVO\n{\n\tpublic _pool:SubGeometryVOPool;\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _onIndicesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onIndicesDisposedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesDisposedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _overflow:SubGeometryVOBase;\n\tprivate _indices:AttributesBuffer;\n\tprivate _indicesDirty:boolean;\n\tprivate _vertices:Object = new Object();\n\tprivate _verticesDirty:Object = new Object();\n\n\tpublic _indexMappings:Array<number> = Array<number>();\n\t\n\tprivate _numElements:number;\n\n\tpublic invalid:boolean;\n\n\tpublic get subGeometry()\n\t{\n\t\treturn this._subGeometry;\n\t}\n\t/**\n\t *\n\t */\n\tpublic get numElements():number\n\t{\n\t\treturn this._numElements;\n\t}\n\n\tconstructor(pool:SubGeometryVOPool, subGeometry:SubGeometryBase)\n\t{\n\t\tthis._pool = pool;\n\t\tthis._subGeometry = subGeometry;\n\n\t\tthis._onIndicesUpdatedDelegate = (event:SubGeometryEvent) => this._onIndicesUpdated(event);\n\t\tthis._onIndicesDisposedDelegate = (event:SubGeometryEvent) => this._onIndicesDisposed(event);\n\t\tthis._onVerticesUpdatedDelegate = (event:SubGeometryEvent) => this._onVerticesUpdated(event);\n\t\tthis._onVerticesDisposedDelegate = (event:SubGeometryEvent) => this._onVerticesDisposed(event);\n\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_DISPOSED, this._onIndicesDisposedDelegate);\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_DISPOSED, this._onVerticesDisposedDelegate);\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\n\t\tthis.invalidateIndices();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get indexMappings():Array<number>\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\treturn this._indexMappings;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getIndexBufferVO(stage:Stage):AttributesBufferVO\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\treturn stage.getAttributesBufferVO(this._indices);\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic getVertexBufferVO(attributesView:AttributesView, stage:Stage):AttributesBufferVO\n\t{\n\t\tvar bufferId:number = attributesView.buffer.id;\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\tif (this._verticesDirty[bufferId])\n\t\t\tthis._updateVertices(attributesView);\n\n\t\treturn stage.getAttributesBufferVO(this._vertices[bufferId]);\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic activateVertexBufferVO(index:number, attributesView:AttributesView, stage:Stage, dimensions:number = 0, offset:number = 0)\n\t{\n\t\tthis.getVertexBufferVO(attributesView, stage).activate(index, attributesView.size, dimensions || attributesView.dimensions, attributesView.offset + offset);\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic invalidateIndices()\n\t{\n\t\tif (!this._subGeometry.indices)\n\t\t\treturn;\n\n\t\tthis._indicesDirty = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic disposeIndices()\n\t{\n\t\tthis._indices.dispose();\n\t\tthis._indices = null;\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param attributesView\n\t */\n\tpublic invalidateVertices(attributesView:AttributesView)\n\t{\n\t\tif (!attributesView)\n\t\t\treturn;\n\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._verticesDirty[bufferId] = true;\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic disposeVertices(attributesView:AttributesView)\n\t{\n\t\tif (!attributesView)\n\t\t\treturn;\n\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._vertices[bufferId].dispose();\n\t\tthis._vertices[bufferId] = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this._subGeometry);\n\n\t\tthis.disposeIndices();\n\n\t\tif (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement = null):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _iRender(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\tthis._render(shader, stage);\n\n\t\tif (this._overflow)\n\t\t\tthis._overflow._iRender(shader, stage);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (this._indices)\n\t\t\tthis.getIndexBufferVO(stage).draw(0, this._numElements);\n\t\t//else\n\t\t//\tthis._stage.context.drawVertices(mode, 0, this._numElements);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tpublic _updateIndices(indexOffset:number = 0)\n\t{\n\t\tthis._indices = SubGeometryUtils.getSubIndices(this._subGeometry.indices, this._subGeometry.numVertices, this._indexMappings, indexOffset);\n\n\t\tthis._numElements = this._indices.count;\n\n\t\tindexOffset = this._indices.count;\n\n\t\t//check if there is more to split\n\t\tif (indexOffset < this._subGeometry.indices.count) {\n\t\t\tif (!this._overflow)\n\t\t\t\tthis._overflow = this._pGetOverflowSubGeometry();\n\n\t\t\tthis._overflow._updateIndices(indexOffset);\n\t\t} else if (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\n\t\tthis._indicesDirty = false;\n\t\t\n\t\t//invalidate vertices if index mappings exist\n\t\tif (this._indexMappings.length)\n\t\t\tfor (var key in this._verticesDirty)\n\t\t\t\tthis._verticesDirty[key] = true;\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param attributesView\n\t * @private\n\t */\n\tprivate _updateVertices(attributesView:AttributesView)\n\t{\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._vertices[bufferId] = SubGeometryUtils.getSubVertices(attributesView.buffer, this._indexMappings);\n\n\t\tthis._verticesDirty[bufferId] = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateIndices();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesDisposed(event:SubGeometryEvent)\n\t{\n\t\tthis.disposeIndices();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateVertices(event.attributesView);\n\t}\n\t\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesDisposed(event:SubGeometryEvent)\n\t{\n\t\tthis.disposeVertices(event.attributesView);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = SubGeometryVOBase;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\nimport ISubGeometryVOClass\t\t\t= require(\"awayjs-renderergl/lib/vos/ISubGeometryVOClass\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport TriangleSubGeometryVO\t\t= require(\"awayjs-renderergl/lib/vos/TriangleSubGeometryVO\");\nimport LineSubGeometryVO\t\t\t= require(\"awayjs-renderergl/lib/vos/LineSubGeometryVO\");\nimport CurveSubGeometryVO\t\t\t= require(\"awayjs-renderergl/lib/vos/CurveSubGeometryVO\");\n\n/**\n * @class away.pool.SubGeometryVOPool\n */\nclass SubGeometryVOPool\n{\n\tprivate static classPool:Object = new Object();\n\n\tpublic static _pool:SubGeometryVOPool;\n\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param subGeometryDataClass\n\t */\n\tconstructor()\n\t{\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ISubGeometry\n\t */\n\tpublic getItem(subGeometry:SubGeometryBase):SubGeometryVOBase\n\t{\n\t\treturn (this._pool[subGeometry.id] || (this._pool[subGeometry.id] = subGeometry._iAddSubGeometryVO(new (SubGeometryVOPool.getClass(subGeometry))(this, subGeometry))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(subGeometry:SubGeometryBase)\n\t{\n\t\tsubGeometry._iRemoveSubGeometryVO(this._pool[subGeometry.id]);\n\n\t\tthis._pool[subGeometry.id] = null;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderPool\n\t */\n\tpublic static getPool():SubGeometryVOPool\n\t{\n\t\treturn (SubGeometryVOPool._pool || (SubGeometryVOPool._pool = new SubGeometryVOPool()));\n\t}\n\n\t/**\n\t *\n\t * @param subMeshClass\n\t */\n\tpublic static registerClass(subGeometryVOClass:ISubGeometryVOClass)\n\t{\n\t\tSubGeometryVOPool.classPool[subGeometryVOClass.assetClass.assetType] = subGeometryVOClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(subGeometry:SubGeometryBase):ISubGeometryVOClass\n\t{\n\t\treturn SubGeometryVOPool.classPool[subGeometry.assetType];\n\t}\n\n\tprivate static main = SubGeometryVOPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tSubGeometryVOPool.registerClass(CurveSubGeometryVO);\n\t\tSubGeometryVOPool.registerClass(LineSubGeometryVO);\n\t\tSubGeometryVOPool.registerClass(TriangleSubGeometryVO);\n\t}\n}\n\nexport = SubGeometryVOPool;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ITextureVO\t\t\t\t\t= require(\"awayjs-display/lib/pool/ITextureVO\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\n\n/**\n *\n * @class away.pool.TextureVOBaseBase\n */\nclass TextureVOBase implements ITextureVO\n{\n\tprivate _pool:TextureVOPool;\n\tprivate _texture:TextureBase;\n\n\tpublic _stage:Stage;\n\n\tpublic invalid:boolean;\n\n\tconstructor(pool:TextureVOPool, texture:TextureBase, stage:Stage)\n\t{\n\t\tthis._pool = pool;\n\t\tthis._texture = texture;\n\t\tthis._stage = stage;\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this._texture);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement = null):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = TextureVOBase;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ITextureVOClass\t\t\t= require(\"awayjs-renderergl/lib/vos/ITextureVOClass\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport Single2DTextureVO\t\t= require(\"awayjs-renderergl/lib/vos/Single2DTextureVO\");\nimport SingleCubeTextureVO\t\t= require(\"awayjs-renderergl/lib/vos/SingleCubeTextureVO\");\n\n/**\n * @class away.pool.TextureVOPool\n */\nclass TextureVOPool\n{\n\tprivate static classPool:Object = new Object();\n\n\tpublic _stage:Stage;\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(texture:TextureBase):TextureVOBase\n\t{\n\t\treturn (this._pool[texture.id] || (this._pool[texture.id] = texture._iAddTextureVO(new (TextureVOPool.getClass(texture))(this, texture, this._stage))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(texture:TextureBase)\n\t{\n\t\ttexture._iRemoveTextureVO(this._pool[texture.id]);\n\n\t\tthis._pool[texture.id] = null;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\tthis._pool[id].dispose();\n\t}\n\n\t/**\n\t *\n\t * @param subMeshClass\n\t */\n\tpublic static registerClass(textureVOClass:ITextureVOClass)\n\t{\n\t\tTextureVOPool.classPool[textureVOClass.assetClass.assetType] = textureVOClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(texture:TextureBase):ITextureVOClass\n\t{\n\t\treturn TextureVOPool.classPool[texture.assetType];\n\t}\n\n\tprivate static main = TextureVOPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tTextureVOPool.registerClass(Single2DTextureVO);\n\t\tTextureVOPool.registerClass(SingleCubeTextureVO);\n\t}\n}\n\nexport = TextureVOPool;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.TriangleSubGeometryVO\n */\nclass TriangleSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = TriangleSubGeometry;\n\n\tprivate _triangleSubGeometry:TriangleSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, triangleSubGeometry:TriangleSubGeometry)\n\t{\n\t\tsuper(pool, triangleSubGeometry);\n\n\t\tthis._triangleSubGeometry = triangleSubGeometry;\n\n\t\tthis.invalidateVertices(this._triangleSubGeometry.positions);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.normals);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.tangents);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.uvs);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.secondaryUVs);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.jointIndices);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.jointWeights);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.uvBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.uvBufferIndex, this._triangleSubGeometry.uvs, stage);\n\n\t\tif (shader.secondaryUVBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.secondaryUVBufferIndex, this._triangleSubGeometry.secondaryUVs, stage);\n\n\t\tif (shader.normalBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.normalBufferIndex, this._triangleSubGeometry.normals, stage);\n\n\t\tif (shader.tangentBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.tangentBufferIndex, this._triangleSubGeometry.tangents, stage);\n\n\t\tif (shader.jointIndexIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.jointIndexIndex, this._triangleSubGeometry.jointIndices, stage);\n\n\t\tif (shader.jointWeightIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.jointIndexIndex, this._triangleSubGeometry.jointWeights, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._triangleSubGeometry.positions, stage);\n\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new TriangleSubGeometryVO(this._pool, this._triangleSubGeometry);\n\t}\n}\n\nexport = TriangleSubGeometryVO;"
  ],
  "sourceRoot": ""
}