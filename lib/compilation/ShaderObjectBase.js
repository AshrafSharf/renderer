var TriangleSubGeometry = require("awayjs-display/lib/base/TriangleSubGeometry");
var ContextGLTriangleFace = require("awayjs-stagegl/lib/base/ContextGLTriangleFace");
var ShaderCompilerBase = require("awayjs-renderergl/lib/compilation/ShaderCompilerBase");
/**
 * ShaderObjectBase keeps track of the number of dependencies for "named registers" used across a pass.
 * Named registers are that are not necessarily limited to a single method. They are created by the compiler and
 * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed
 * each time a method has been compiled into the shader.
 *
 * @see RegisterPool.addUsage
 */
var ShaderObjectBase = (function () {
    /**
     * Creates a new MethodCompilerVO object.
     */
    function ShaderObjectBase(profile) {
        this._defaultCulling = ContextGLTriangleFace.BACK;
        this._pInverseSceneMatrix = new Array();
        //set ambient values to default
        this.ambientR = 0xFF;
        this.ambientG = 0xFF;
        this.ambientB = 0xFF;
        /**
         * Indicates whether there are any dependencies on the world-space position vector.
         */
        this.usesGlobalPosFragment = false;
        this.vertexConstantData = new Array();
        this.fragmentConstantData = new Array();
        this.profile = profile;
    }
    /**
     * Factory method to create a concrete compiler object for this object
     *
     * @param materialPassVO
     * @returns {away.materials.ShaderCompilerBase}
     */
    ShaderObjectBase.prototype.createCompiler = function (material, materialPass) {
        return new ShaderCompilerBase(material, materialPass, this);
    };
    /**
     * Clears dependency counts for all registers. Called when recompiling a pass.
     */
    ShaderObjectBase.prototype.reset = function () {
        this.projectionDependencies = 0;
        this.normalDependencies = 0;
        this.viewDirDependencies = 0;
        this.uvDependencies = 0;
        this.secondaryUVDependencies = 0;
        this.globalPosDependencies = 0;
        this.tangentDependencies = 0;
        this.usesGlobalPosFragment = false;
        this.usesFragmentAnimation = false;
        this.usesTangentSpace = false;
        this.outputsNormals = false;
        this.outputsTangentNormals = false;
    };
    ShaderObjectBase.prototype.pInitRegisterIndices = function () {
        this.commonsDataIndex = -1;
        this.cameraPositionIndex = -1;
        this.uvBufferIndex = -1;
        this.uvTransformIndex = -1;
        this.secondaryUVBufferIndex = -1;
        this.normalBufferIndex = -1;
        this.tangentBufferIndex = -1;
        this.sceneMatrixIndex = -1;
        this.sceneNormalMatrixIndex = -1;
    };
    /**
     * Initializes the unchanging constant data for this shader object.
     */
    ShaderObjectBase.prototype.initConstantData = function (registerCache, animatableAttributes, animationTargetRegisters, uvSource, uvTarget) {
        //Updates the amount of used register indices.
        this.numUsedVertexConstants = registerCache.numUsedVertexConstants;
        this.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;
        this.numUsedStreams = registerCache.numUsedStreams;
        this.numUsedTextures = registerCache.numUsedTextures;
        this.numUsedVaryings = registerCache.numUsedVaryings;
        this.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;
        this.animatableAttributes = animatableAttributes;
        this.animationTargetRegisters = animationTargetRegisters;
        this.uvSource = uvSource;
        this.uvTarget = uvTarget;
        this.vertexConstantData.length = this.numUsedVertexConstants * 4;
        this.fragmentConstantData.length = this.numUsedFragmentConstants * 4;
        //Initializes commonly required constant values.
        this.fragmentConstantData[this.commonsDataIndex] = .5;
        this.fragmentConstantData[this.commonsDataIndex + 1] = 0;
        this.fragmentConstantData[this.commonsDataIndex + 2] = 1 / 255;
        this.fragmentConstantData[this.commonsDataIndex + 3] = 1;
        //Initializes the default UV transformation matrix.
        if (this.uvTransformIndex >= 0) {
            this.vertexConstantData[this.uvTransformIndex] = 1;
            this.vertexConstantData[this.uvTransformIndex + 1] = 0;
            this.vertexConstantData[this.uvTransformIndex + 2] = 0;
            this.vertexConstantData[this.uvTransformIndex + 3] = 0;
            this.vertexConstantData[this.uvTransformIndex + 4] = 0;
            this.vertexConstantData[this.uvTransformIndex + 5] = 1;
            this.vertexConstantData[this.uvTransformIndex + 6] = 0;
            this.vertexConstantData[this.uvTransformIndex + 7] = 0;
        }
        if (this.cameraPositionIndex >= 0)
            this.vertexConstantData[this.cameraPositionIndex + 3] = 1;
    };
    /**
     * @inheritDoc
     */
    ShaderObjectBase.prototype.iActivate = function (stage, camera) {
        stage.context.setCulling(this.useBothSides ? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);
        if (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {
            var pos = camera.scenePosition;
            this.vertexConstantData[this.cameraPositionIndex] = pos.x;
            this.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;
            this.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;
        }
    };
    /**
     * @inheritDoc
     */
    ShaderObjectBase.prototype.iDeactivate = function (stage) {
    };
    /**
     *
     *
     * @param renderable
     * @param stage
     * @param camera
     */
    ShaderObjectBase.prototype.setRenderState = function (renderable, stage, camera, viewProjection) {
        var context = stage.context;
        if (renderable.materialOwner.animator)
            renderable.materialOwner.animator.setRenderState(this, renderable, stage, camera, this.numUsedVertexConstants, this.numUsedStreams);
        if (this.uvBufferIndex >= 0)
            stage.activateBuffer(this.uvBufferIndex, renderable.getVertexData(TriangleSubGeometry.UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.UV_DATA), TriangleSubGeometry.UV_FORMAT);
        if (this.secondaryUVBufferIndex >= 0)
            stage.activateBuffer(this.secondaryUVBufferIndex, renderable.getVertexData(TriangleSubGeometry.SECONDARY_UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.SECONDARY_UV_DATA), TriangleSubGeometry.SECONDARY_UV_FORMAT);
        if (this.normalBufferIndex >= 0)
            stage.activateBuffer(this.normalBufferIndex, renderable.getVertexData(TriangleSubGeometry.NORMAL_DATA), renderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);
        if (this.tangentBufferIndex >= 0)
            stage.activateBuffer(this.tangentBufferIndex, renderable.getVertexData(TriangleSubGeometry.TANGENT_DATA), renderable.getVertexOffset(TriangleSubGeometry.TANGENT_DATA), TriangleSubGeometry.TANGENT_FORMAT);
        if (this.usesUVTransform) {
            var uvTransform = renderable.materialOwner.uvTransform.matrix;
            if (uvTransform) {
                this.vertexConstantData[this.uvTransformIndex] = uvTransform.a;
                this.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;
                this.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;
                this.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;
                this.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;
                this.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;
            }
            else {
                this.vertexConstantData[this.uvTransformIndex] = 1;
                this.vertexConstantData[this.uvTransformIndex + 1] = 0;
                this.vertexConstantData[this.uvTransformIndex + 3] = 0;
                this.vertexConstantData[this.uvTransformIndex + 4] = 0;
                this.vertexConstantData[this.uvTransformIndex + 5] = 1;
                this.vertexConstantData[this.uvTransformIndex + 7] = 0;
            }
        }
        if (this.sceneNormalMatrixIndex >= 0)
            renderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);
        if (this.usesTangentSpace && this.cameraPositionIndex >= 0) {
            renderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);
            var pos = camera.scenePosition;
            var x = pos.x;
            var y = pos.y;
            var z = pos.z;
            this.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0] * x + this._pInverseSceneMatrix[4] * y + this._pInverseSceneMatrix[8] * z + this._pInverseSceneMatrix[12];
            this.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1] * x + this._pInverseSceneMatrix[5] * y + this._pInverseSceneMatrix[9] * z + this._pInverseSceneMatrix[13];
            this.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2] * x + this._pInverseSceneMatrix[6] * y + this._pInverseSceneMatrix[10] * z + this._pInverseSceneMatrix[14];
        }
    };
    ShaderObjectBase.prototype.dispose = function () {
        //TODO uncount associated program data
    };
    return ShaderObjectBase;
})();
module.exports = ShaderObjectBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9zaGFkZXJvYmplY3RiYXNlLnRzIl0sIm5hbWVzIjpbIlNoYWRlck9iamVjdEJhc2UiLCJTaGFkZXJPYmplY3RCYXNlLmNvbnN0cnVjdG9yIiwiU2hhZGVyT2JqZWN0QmFzZS5jcmVhdGVDb21waWxlciIsIlNoYWRlck9iamVjdEJhc2UucmVzZXQiLCJTaGFkZXJPYmplY3RCYXNlLnBJbml0UmVnaXN0ZXJJbmRpY2VzIiwiU2hhZGVyT2JqZWN0QmFzZS5pbml0Q29uc3RhbnREYXRhIiwiU2hhZGVyT2JqZWN0QmFzZS5pQWN0aXZhdGUiLCJTaGFkZXJPYmplY3RCYXNlLmlEZWFjdGl2YXRlIiwiU2hhZGVyT2JqZWN0QmFzZS5zZXRSZW5kZXJTdGF0ZSIsIlNoYWRlck9iamVjdEJhc2UuZGlzcG9zZSJdLCJtYXBwaW5ncyI6IkFBT0EsSUFBTyxtQkFBbUIsV0FBYSw2Q0FBNkMsQ0FBQyxDQUFDO0FBSXRGLElBQU8scUJBQXFCLFdBQVksK0NBQStDLENBQUMsQ0FBQztBQVF6RixJQUFPLGtCQUFrQixXQUFhLHNEQUFzRCxDQUFDLENBQUM7QUFJOUYsQUFRQTs7Ozs7OztHQURHO0lBQ0csZ0JBQWdCO0lBa0xyQkE7O09BRUdBO0lBQ0hBLFNBckxLQSxnQkFBZ0JBLENBcUxUQSxPQUFPQTtRQWxMWEMsb0JBQWVBLEdBQVVBLHFCQUFxQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7UUFFckRBLHlCQUFvQkEsR0FBaUJBLElBQUlBLEtBQUtBLEVBQVVBLENBQUNBO1FBK0NoRUEsK0JBQStCQTtRQUN4QkEsYUFBUUEsR0FBVUEsSUFBSUEsQ0FBQ0E7UUFDdkJBLGFBQVFBLEdBQVVBLElBQUlBLENBQUNBO1FBQ3ZCQSxhQUFRQSxHQUFVQSxJQUFJQSxDQUFDQTtRQWlFOUJBOztXQUVHQTtRQUNJQSwwQkFBcUJBLEdBQVdBLEtBQUtBLENBQUNBO1FBRXRDQSx1QkFBa0JBLEdBQWlCQSxJQUFJQSxLQUFLQSxFQUFVQSxD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QUNBLENBQUNBLEdBQUdBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBO2dCQUNuRUEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLFdBQVdBLENBQUNBLEVBQUVBLENBQUNBO1lBQ3JFQSxDQUFDQTtZQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtnQkFDUEEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUNuREEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO2dCQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3hEQSxDQUFDQTtRQUNGQSxDQUFDQTtRQUVEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxzQkFBc0JBLElBQUlBLENBQUNBLENBQUNBO1lBQ3BDQSxVQUFVQSxDQUFDQSxZQUFZQSxDQUFDQSxxQkFBcUJBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLENBQUNBLGtCQUFrQkEsRUFBRUEsSUFBSUEsQ0FBQ0Esc0JBQXNCQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUUxSEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxJQUFJQSxJQUFJQSxDQUFDQSxtQkFBbUJBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRTVEQSxVQUFVQSxDQUFDQSxZQUFZQSxDQUFDQSxxQkFBcUJBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0E7WUFDdkZBLElBQUlBLEdBQUdBLEdBQVlBLE1BQU1BLENBQUNBLGFBQWFBLENBQUNBO1lBQ3hDQSxJQUFJQSxDQUFDQSxHQUFVQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyQkEsSUFBSUEsQ0FBQ0EsR0FBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDckJBLElBQUlBLENBQUNBLEdBQVVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1lBRXJCQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLG1CQUFtQkEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtZQUNyTEEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxtQkFBbUJBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0E7WUFDekxBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsbUJBQW1CQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBO1FBQzNMQSxDQUFDQTtJQUNGQSxDQUFDQTtJQUVNUixrQ0FBT0EsR0FBZEE7UUFFQ1Msc0NBQXNDQTtJQUN2Q0EsQ0FBQ0E7SUFDRlQsdUJBQUNBO0FBQURBLENBOVdBLEFBOFdDQSxJQUFBO0FBRUQsQUFBMEIsaUJBQWpCLGdCQUFnQixDQUFDIiwiZmlsZSI6ImNvbXBpbGF0aW9uL1NoYWRlck9iamVjdEJhc2UuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1hdHJpeFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeFwiKTtcbmltcG9ydCBNYXRyaXgzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEXCIpO1xuaW1wb3J0IE1hdHJpeDNEVXRpbHNcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEVXRpbHNcIik7XG5pbXBvcnQgUmVjdGFuZ2xlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1JlY3RhbmdsZVwiKTtcbmltcG9ydCBWZWN0b3IzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xuaW1wb3J0IFRleHR1cmUyREJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9UZXh0dXJlMkRCYXNlXCIpO1xuXG5pbXBvcnQgVHJpYW5nbGVTdWJHZW9tZXRyeVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL1RyaWFuZ2xlU3ViR2VvbWV0cnlcIik7XG5pbXBvcnQgQ2FtZXJhXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0NhbWVyYVwiKTtcblxuaW1wb3J0IElDb250ZXh0R0xcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvSUNvbnRleHRHTFwiKTtcbmltcG9ydCBDb250ZXh0R0xUcmlhbmdsZUZhY2VcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvQ29udGV4dEdMVHJpYW5nbGVGYWNlXCIpO1xuaW1wb3J0IFN0YWdlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvU3RhZ2VcIik7XG5cbmltcG9ydCBBbmltYXRpb25TZXRCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL0FuaW1hdGlvblNldEJhc2VcIik7XG5pbXBvcnQgQW5pbWF0b3JCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvQW5pbWF0b3JCYXNlXCIpO1xuaW1wb3J0IEFuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9kYXRhL0FuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wb29sL1JlbmRlcmFibGVCYXNlXCIpO1xuaW1wb3J0IE1hdGVyaWFsR0xCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvbWF0ZXJpYWxzL01hdGVyaWFsR0xCYXNlXCIpO1xuaW1wb3J0IFNoYWRlckNvbXBpbGVyQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9TaGFkZXJDb21waWxlckJhc2VcIik7XG5pbXBvcnQgU2hhZGVyUmVnaXN0ZXJDYWNoZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9TaGFkZXJSZWdpc3RlckNhY2hlXCIpO1xuaW1wb3J0IE1hdGVyaWFsUGFzc0dMQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wYXNzZXMvTWF0ZXJpYWxQYXNzR0xCYXNlXCIpO1xuXG4vKipcbiAqIFNoYWRlck9iamVjdEJhc2Uga2VlcHMgdHJhY2sgb2YgdGhlIG51bWJlciBvZiBkZXBlbmRlbmNpZXMgZm9yIFwibmFtZWQgcmVnaXN0ZXJzXCIgdXNlZCBhY3Jvc3MgYSBwYXNzLlxuICogTmFtZWQgcmVnaXN0ZXJzIGFyZSB0aGF0IGFyZSBub3QgbmVjZXNzYXJpbHkgbGltaXRlZCB0byBhIHNpbmdsZSBtZXRob2QuIFRoZXkgYXJlIGNyZWF0ZWQgYnkgdGhlIGNvbXBpbGVyIGFuZFxuICogcGFzc2VkIG9uIHRvIG1ldGhvZHMuIFRoZSBjb21waWxlciB1c2VzIHRoZSByZXN1bHRzIHRvIHJlc2VydmUgdXNhZ2VzIHRocm91Z2ggUmVnaXN0ZXJQb29sLCB3aGljaCBjYW4gYmUgcmVtb3ZlZFxuICogZWFjaCB0aW1lIGEgbWV0aG9kIGhhcyBiZWVuIGNvbXBpbGVkIGludG8gdGhlIHNoYWRlci5cbiAqXG4gKiBAc2VlIFJlZ2lzdGVyUG9vbC5hZGRVc2FnZVxuICovXG5jbGFzcyBTaGFkZXJPYmplY3RCYXNlXG57XG5cblx0cHJpdmF0ZSBfZGVmYXVsdEN1bGxpbmc6c3RyaW5nID0gQ29udGV4dEdMVHJpYW5nbGVGYWNlLkJBQ0s7XG5cblx0cHVibGljIF9wSW52ZXJzZVNjZW5lTWF0cml4OkFycmF5PG51bWJlcj4gPSBuZXcgQXJyYXk8bnVtYmVyPigpO1xuXG5cdHB1YmxpYyBhbmltYXRpb25SZWdpc3RlckNhY2hlOkFuaW1hdGlvblJlZ2lzdGVyQ2FjaGU7XG5cblx0cHVibGljIHByb2ZpbGU6c3RyaW5nO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIHVzZWQgdmVydGV4IGNvbnN0YW50cyBpbiB0aGUgdmVydGV4IGNvZGUuIFVzZWQgYnkgdGhlIGFuaW1hdGlvbiBjb2RlIGdlbmVyYXRpb24gdG8ga25vdyBmcm9tIHdoaWNoIGluZGV4IG9uIHJlZ2lzdGVycyBhcmUgYXZhaWxhYmxlLlxuXHQgKi9cblx0cHVibGljIG51bVVzZWRWZXJ0ZXhDb25zdGFudHM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIHVzZWQgZnJhZ21lbnQgY29uc3RhbnRzIGluIHRoZSBmcmFnbWVudCBjb2RlLiBVc2VkIGJ5IHRoZSBhbmltYXRpb24gY29kZSBnZW5lcmF0aW9uIHRvIGtub3cgZnJvbSB3aGljaCBpbmRleCBvbiByZWdpc3RlcnMgYXJlIGF2YWlsYWJsZS5cblx0ICovXG5cdHB1YmxpYyBudW1Vc2VkRnJhZ21lbnRDb25zdGFudHM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIHVzZWQgdmVydGV4IHN0cmVhbXMgaW4gdGhlIHZlcnRleCBjb2RlLiBVc2VkIGJ5IHRoZSBhbmltYXRpb24gY29kZSBnZW5lcmF0aW9uIHRvIGtub3cgZnJvbSB3aGljaCBpbmRleCBvbiBzdHJlYW1zIGFyZSBhdmFpbGFibGUuXG5cdCAqL1xuXHRwdWJsaWMgbnVtVXNlZFN0cmVhbXM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKlxuXHQgKi9cblx0cHVibGljIG51bVVzZWRUZXh0dXJlczpudW1iZXI7XG5cblx0LyoqXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgbnVtVXNlZFZhcnlpbmdzOm51bWJlcjtcblxuXHRwdWJsaWMgYW5pbWF0YWJsZUF0dHJpYnV0ZXM6QXJyYXk8c3RyaW5nPjtcblx0cHVibGljIGFuaW1hdGlvblRhcmdldFJlZ2lzdGVyczpBcnJheTxzdHJpbmc+O1xuXHRwdWJsaWMgdXZTb3VyY2U6c3RyaW5nO1xuXHRwdWJsaWMgdXZUYXJnZXQ6c3RyaW5nO1xuXG5cdHB1YmxpYyB1c2VBbHBoYVByZW11bHRpcGxpZWQ6Ym9vbGVhbjtcblx0cHVibGljIHVzZUJvdGhTaWRlczpib29sZWFuO1xuXHRwdWJsaWMgdXNlTWlwbWFwcGluZzpib29sZWFuO1xuXHRwdWJsaWMgdXNlU21vb3RoVGV4dHVyZXM6Ym9vbGVhbjtcblx0cHVibGljIHJlcGVhdFRleHR1cmVzOmJvb2xlYW47XG5cdHB1YmxpYyB1c2VzVVZUcmFuc2Zvcm06Ym9vbGVhbjtcblx0cHVibGljIGFscGhhVGhyZXNob2xkOm51bWJlcjtcblx0cHVibGljIHRleHR1cmU6VGV4dHVyZTJEQmFzZTtcblx0cHVibGljIGNvbG9yOm51bWJlcjtcblxuXG5cdC8vc2V0IGFtYmllbnQgdmFsdWVzIHRvIGRlZmF1bHRcblx0cHVibGljIGFtYmllbnRSOm51bWJlciA9IDB4RkY7XG5cdHB1YmxpYyBhbWJpZW50RzpudW1iZXIgPSAweEZGO1xuXHRwdWJsaWMgYW1iaWVudEI6bnVtYmVyID0gMHhGRjtcblxuXHQvKipcblx0ICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHBhc3MgcmVxdWlyZXMgYW55IGZyYWdtZW50IGFuaW1hdGlvbiBjb2RlLlxuXHQgKi9cblx0cHVibGljIHVzZXNGcmFnbWVudEFuaW1hdGlvbjpib29sZWFuO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIGRlcGVuZGVuY2llcyBvbiB0aGUgcHJvamVjdGVkIHBvc2l0aW9uLlxuXHQgKi9cblx0cHVibGljIHByb2plY3Rpb25EZXBlbmRlbmNpZXM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIGRlcGVuZGVuY2llcyBvbiB0aGUgbm9ybWFsIHZlY3Rvci5cblx0ICovXG5cdHB1YmxpYyBub3JtYWxEZXBlbmRlbmNpZXM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIGRlcGVuZGVuY2llcyBvbiB0aGUgdmlldyBkaXJlY3Rpb24uXG5cdCAqL1xuXHRwdWJsaWMgdmlld0RpckRlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSBwcmltYXJ5IFVWIGNvb3JkaW5hdGVzLlxuXHQgKi9cblx0cHVibGljIHV2RGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiBkZXBlbmRlbmNpZXMgb24gdGhlIHNlY29uZGFyeSBVViBjb29yZGluYXRlcy5cblx0ICovXG5cdHB1YmxpYyBzZWNvbmRhcnlVVkRlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSBsb2NhbCBwb3NpdGlvbi4gVGhpcyBjYW4gYmUgMCB3aGlsZSBoYXNHbG9iYWxQb3NEZXBlbmRlbmNpZXMgaXMgdHJ1ZSB3aGVuXG5cdCAqIHRoZSBnbG9iYWwgcG9zaXRpb24gaXMgdXNlZCBhcyBhIHRlbXBvcmFyeSB2YWx1ZSAoZmUgdG8gY2FsY3VsYXRlIHRoZSB2aWV3IGRpcmVjdGlvbilcblx0ICovXG5cdHB1YmxpYyBsb2NhbFBvc0RlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSBnbG9iYWwgcG9zaXRpb24uIFRoaXMgY2FuIGJlIDAgd2hpbGUgaGFzR2xvYmFsUG9zRGVwZW5kZW5jaWVzIGlzIHRydWUgd2hlblxuXHQgKiB0aGUgZ2xvYmFsIHBvc2l0aW9uIGlzIHVzZWQgYXMgYSB0ZW1wb3JhcnkgdmFsdWUgKGZlIHRvIGNhbGN1bGF0ZSB0aGUgdmlldyBkaXJlY3Rpb24pXG5cdCAqL1xuXHRwdWJsaWMgZ2xvYmFsUG9zRGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiB0YW5nZW50IHZlY3RvciBkZXBlbmRlbmNpZXMgKGZyYWdtZW50IHNoYWRlcikuXG5cdCAqL1xuXHRwdWJsaWMgdGFuZ2VudERlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgb3V0cHV0c05vcm1hbHM6Ym9vbGVhbjtcblxuXHQvKipcblx0ICogSW5kaWNhdGVzIHdoZXRoZXIgb3Igbm90IG5vcm1hbCBjYWxjdWxhdGlvbnMgYXJlIGV4cGVjdGVkIGluIHRhbmdlbnQgc3BhY2UuIFRoaXMgaXMgb25seSB0aGUgY2FzZSBpZiBubyB3b3JsZC1zcGFjZVxuXHQgKiBkZXBlbmRlbmNpZXMgZXhpc3QuXG5cdCAqL1xuXHRwdWJsaWMgdXNlc1RhbmdlbnRTcGFjZTpib29sZWFuO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2F0ZXMgd2hldGhlciBvciBub3Qgbm9ybWFsIGNhbGN1bGF0aW9ucyBhcmUgb3V0cHV0IGluIHRhbmdlbnQgc3BhY2UuXG5cdCAqL1xuXHRwdWJsaWMgb3V0cHV0c1RhbmdlbnROb3JtYWxzOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIHRoZXJlIGFyZSBhbnkgZGVwZW5kZW5jaWVzIG9uIHRoZSB3b3JsZC1zcGFjZSBwb3NpdGlvbiB2ZWN0b3IuXG5cdCAqL1xuXHRwdWJsaWMgdXNlc0dsb2JhbFBvc0ZyYWdtZW50OmJvb2xlYW4gPSBmYWxzZTtcblxuXHRwdWJsaWMgdmVydGV4Q29uc3RhbnREYXRhOkFycmF5PG51bWJlcj4gPSBuZXcgQXJyYXk8bnVtYmVyPigpO1xuXHRwdWJsaWMgZnJhZ21lbnRDb25zdGFudERhdGE6QXJyYXk8bnVtYmVyPiA9IG5ldyBBcnJheTxudW1iZXI+KCk7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBmb3IgdGhlIGNvbW1vbiBkYXRhIHJlZ2lzdGVyLlxuXHQgKi9cblx0cHVibGljIGNvbW1vbnNEYXRhSW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggZm9yIHRoZSBVViB2ZXJ0ZXggYXR0cmlidXRlIHN0cmVhbS5cblx0ICovXG5cdHB1YmxpYyB1dkJ1ZmZlckluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IGZvciB0aGUgc2Vjb25kYXJ5IFVWIHZlcnRleCBhdHRyaWJ1dGUgc3RyZWFtLlxuXHQgKi9cblx0cHVibGljIHNlY29uZGFyeVVWQnVmZmVySW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggZm9yIHRoZSB2ZXJ0ZXggbm9ybWFsIGF0dHJpYnV0ZSBzdHJlYW0uXG5cdCAqL1xuXHRwdWJsaWMgbm9ybWFsQnVmZmVySW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggZm9yIHRoZSB2ZXJ0ZXggdGFuZ2VudCBhdHRyaWJ1dGUgc3RyZWFtLlxuXHQgKi9cblx0cHVibGljIHRhbmdlbnRCdWZmZXJJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBvZiB0aGUgdmVydGV4IGNvbnN0YW50IGNvbnRhaW5pbmcgdGhlIHZpZXcgbWF0cml4LlxuXHQgKi9cblx0cHVibGljIHZpZXdNYXRyaXhJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBvZiB0aGUgdmVydGV4IGNvbnN0YW50IGNvbnRhaW5pbmcgdGhlIHNjZW5lIG1hdHJpeC5cblx0ICovXG5cdHB1YmxpYyBzY2VuZU1hdHJpeEluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IG9mIHRoZSB2ZXJ0ZXggY29uc3RhbnQgY29udGFpbmluZyB0aGUgdW5pZm9ybSBzY2VuZSBtYXRyaXggKHRoZSBpbnZlcnNlIHRyYW5zcG9zZSkuXG5cdCAqL1xuXHRwdWJsaWMgc2NlbmVOb3JtYWxNYXRyaXhJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBvZiB0aGUgdmVydGV4IGNvbnN0YW50IGNvbnRhaW5pbmcgdGhlIGNhbWVyYSBwb3NpdGlvbi5cblx0ICovXG5cdHB1YmxpYyBjYW1lcmFQb3NpdGlvbkluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IGZvciB0aGUgVVYgdHJhbnNmb3JtYXRpb24gbWF0cml4IHZlcnRleCBjb25zdGFudC5cblx0ICovXG5cdHB1YmxpYyB1dlRyYW5zZm9ybUluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIG5ldyBNZXRob2RDb21waWxlclZPIG9iamVjdC5cblx0ICovXG5cdGNvbnN0cnVjdG9yKHByb2ZpbGUpXG5cdHtcblx0XHR0aGlzLnByb2ZpbGUgPSBwcm9maWxlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEZhY3RvcnkgbWV0aG9kIHRvIGNyZWF0ZSBhIGNvbmNyZXRlIGNvbXBpbGVyIG9iamVjdCBmb3IgdGhpcyBvYmplY3Rcblx0ICpcblx0ICogQHBhcmFtIG1hdGVyaWFsUGFzc1ZPXG5cdCAqIEByZXR1cm5zIHthd2F5Lm1hdGVyaWFscy5TaGFkZXJDb21waWxlckJhc2V9XG5cdCAqL1xuXHRwdWJsaWMgY3JlYXRlQ29tcGlsZXIobWF0ZXJpYWw6TWF0ZXJpYWxHTEJhc2UsIG1hdGVyaWFsUGFzczpNYXRlcmlhbFBhc3NHTEJhc2UpOlNoYWRlckNvbXBpbGVyQmFzZVxuXHR7XG5cdFx0cmV0dXJuIG5ldyBTaGFkZXJDb21waWxlckJhc2UobWF0ZXJpYWwsIG1hdGVyaWFsUGFzcywgdGhpcyk7XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXJzIGRlcGVuZGVuY3kgY291bnRzIGZvciBhbGwgcmVnaXN0ZXJzLiBDYWxsZWQgd2hlbiByZWNvbXBpbGluZyBhIHBhc3MuXG5cdCAqL1xuXHRwdWJsaWMgcmVzZXQoKVxuXHR7XG5cdFx0dGhpcy5wcm9qZWN0aW9uRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLm5vcm1hbERlcGVuZGVuY2llcyA9IDA7XG5cdFx0dGhpcy52aWV3RGlyRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnV2RGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnNlY29uZGFyeVVWRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLmdsb2JhbFBvc0RlcGVuZGVuY2llcyA9IDA7XG5cdFx0dGhpcy50YW5nZW50RGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnVzZXNHbG9iYWxQb3NGcmFnbWVudCA9IGZhbHNlO1xuXHRcdHRoaXMudXNlc0ZyYWdtZW50QW5pbWF0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy51c2VzVGFuZ2VudFNwYWNlID0gZmFsc2U7XG5cdFx0dGhpcy5vdXRwdXRzTm9ybWFscyA9IGZhbHNlO1xuXHRcdHRoaXMub3V0cHV0c1RhbmdlbnROb3JtYWxzID0gZmFsc2U7XG5cdH1cblxuXHRwdWJsaWMgcEluaXRSZWdpc3RlckluZGljZXMoKVxuXHR7XG5cdFx0dGhpcy5jb21tb25zRGF0YUluZGV4ID0gLTE7XG5cdFx0dGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ID0gLTE7XG5cdFx0dGhpcy51dkJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy51dlRyYW5zZm9ybUluZGV4ID0gLTE7XG5cdFx0dGhpcy5zZWNvbmRhcnlVVkJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy5ub3JtYWxCdWZmZXJJbmRleCA9IC0xO1xuXHRcdHRoaXMudGFuZ2VudEJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy5zY2VuZU1hdHJpeEluZGV4ID0gLTE7XG5cdFx0dGhpcy5zY2VuZU5vcm1hbE1hdHJpeEluZGV4ID0gLTE7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZXMgdGhlIHVuY2hhbmdpbmcgY29uc3RhbnQgZGF0YSBmb3IgdGhpcyBzaGFkZXIgb2JqZWN0LlxuXHQgKi9cblx0cHVibGljIGluaXRDb25zdGFudERhdGEocmVnaXN0ZXJDYWNoZTpTaGFkZXJSZWdpc3RlckNhY2hlLCBhbmltYXRhYmxlQXR0cmlidXRlczpBcnJheTxzdHJpbmc+LCBhbmltYXRpb25UYXJnZXRSZWdpc3RlcnM6QXJyYXk8c3RyaW5nPiwgdXZTb3VyY2U6c3RyaW5nLCB1dlRhcmdldDpzdHJpbmcpXG5cdHtcblx0XHQvL1VwZGF0ZXMgdGhlIGFtb3VudCBvZiB1c2VkIHJlZ2lzdGVyIGluZGljZXMuXG5cdFx0dGhpcy5udW1Vc2VkVmVydGV4Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkVmVydGV4Q29uc3RhbnRzO1xuXHRcdHRoaXMubnVtVXNlZEZyYWdtZW50Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHM7XG5cdFx0dGhpcy5udW1Vc2VkU3RyZWFtcyA9IHJlZ2lzdGVyQ2FjaGUubnVtVXNlZFN0cmVhbXM7XG5cdFx0dGhpcy5udW1Vc2VkVGV4dHVyZXMgPSByZWdpc3RlckNhY2hlLm51bVVzZWRUZXh0dXJlcztcblx0XHR0aGlzLm51bVVzZWRWYXJ5aW5ncyA9IHJlZ2lzdGVyQ2FjaGUubnVtVXNlZFZhcnlpbmdzO1xuXHRcdHRoaXMubnVtVXNlZEZyYWdtZW50Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHM7XG5cblx0XHR0aGlzLmFuaW1hdGFibGVBdHRyaWJ1dGVzID0gYW5pbWF0YWJsZUF0dHJpYnV0ZXM7XG5cdFx0dGhpcy5hbmltYXRpb25UYXJnZXRSZWdpc3RlcnMgPSBhbmltYXRpb25UYXJnZXRSZWdpc3RlcnM7XG5cdFx0dGhpcy51dlNvdXJjZSA9IHV2U291cmNlO1xuXHRcdHRoaXMudXZUYXJnZXQgPSB1dlRhcmdldDtcblxuXHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhLmxlbmd0aCA9IHRoaXMubnVtVXNlZFZlcnRleENvbnN0YW50cyo0O1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGEubGVuZ3RoID0gdGhpcy5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHMqNDtcblxuXHRcdC8vSW5pdGlhbGl6ZXMgY29tbW9ubHkgcmVxdWlyZWQgY29uc3RhbnQgdmFsdWVzLlxuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4XSA9IC41O1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4ICsgMV0gPSAwO1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4ICsgMl0gPSAxLzI1NTtcblx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW3RoaXMuY29tbW9uc0RhdGFJbmRleCArIDNdID0gMTtcblxuXHRcdC8vSW5pdGlhbGl6ZXMgdGhlIGRlZmF1bHQgVVYgdHJhbnNmb3JtYXRpb24gbWF0cml4LlxuXHRcdGlmICh0aGlzLnV2VHJhbnNmb3JtSW5kZXggPj0gMCkge1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4XSA9IDE7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAxXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAyXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAzXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA0XSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA1XSA9IDE7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA2XSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA3XSA9IDA7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuY2FtZXJhUG9zaXRpb25JbmRleCA+PSAwKVxuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgM10gPSAxO1xuXHR9XG5cblxuXHQvKipcblx0ICogQGluaGVyaXREb2Ncblx0ICovXG5cdHB1YmxpYyBpQWN0aXZhdGUoc3RhZ2U6U3RhZ2UsIGNhbWVyYTpDYW1lcmEpXG5cdHtcblx0XHRzdGFnZS5jb250ZXh0LnNldEN1bGxpbmcodGhpcy51c2VCb3RoU2lkZXM/IENvbnRleHRHTFRyaWFuZ2xlRmFjZS5OT05FIDogdGhpcy5fZGVmYXVsdEN1bGxpbmcsIGNhbWVyYS5wcm9qZWN0aW9uLmNvb3JkaW5hdGVTeXN0ZW0pO1xuXG5cdFx0aWYgKCF0aGlzLnVzZXNUYW5nZW50U3BhY2UgJiYgdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ID49IDApIHtcblx0XHRcdHZhciBwb3M6VmVjdG9yM0QgPSBjYW1lcmEuc2NlbmVQb3NpdGlvbjtcblxuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4XSA9IHBvcy54O1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgMV0gPSBwb3MueTtcblx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMuY2FtZXJhUG9zaXRpb25JbmRleCArIDJdID0gcG9zLno7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEBpbmhlcml0RG9jXG5cdCAqL1xuXHRwdWJsaWMgaURlYWN0aXZhdGUoc3RhZ2U6U3RhZ2UpXG5cdHtcblxuXHR9XG5cblxuXHQvKipcblx0ICpcblx0ICpcblx0ICogQHBhcmFtIHJlbmRlcmFibGVcblx0ICogQHBhcmFtIHN0YWdlXG5cdCAqIEBwYXJhbSBjYW1lcmFcblx0ICovXG5cdHB1YmxpYyBzZXRSZW5kZXJTdGF0ZShyZW5kZXJhYmxlOlJlbmRlcmFibGVCYXNlLCBzdGFnZTpTdGFnZSwgY2FtZXJhOkNhbWVyYSwgdmlld1Byb2plY3Rpb246TWF0cml4M0QpXG5cdHtcblx0XHR2YXIgY29udGV4dDpJQ29udGV4dEdMID0gc3RhZ2UuY29udGV4dDtcblxuXHRcdGlmIChyZW5kZXJhYmxlLm1hdGVyaWFsT3duZXIuYW5pbWF0b3IpXG5cdFx0XHQoPEFuaW1hdG9yQmFzZT4gcmVuZGVyYWJsZS5tYXRlcmlhbE93bmVyLmFuaW1hdG9yKS5zZXRSZW5kZXJTdGF0ZSh0aGlzLCByZW5kZXJhYmxlLCBzdGFnZSwgY2FtZXJhLCB0aGlzLm51bVVzZWRWZXJ0ZXhDb25zdGFudHMsIHRoaXMubnVtVXNlZFN0cmVhbXMpO1xuXG5cdFx0aWYgKHRoaXMudXZCdWZmZXJJbmRleCA+PSAwKVxuXHRcdFx0c3RhZ2UuYWN0aXZhdGVCdWZmZXIodGhpcy51dkJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9EQVRBKSwgcmVuZGVyYWJsZS5nZXRWZXJ0ZXhPZmZzZXQoVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9EQVRBKSwgVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9GT1JNQVQpO1xuXG5cdFx0aWYgKHRoaXMuc2Vjb25kYXJ5VVZCdWZmZXJJbmRleCA+PSAwKVxuXHRcdFx0c3RhZ2UuYWN0aXZhdGVCdWZmZXIodGhpcy5zZWNvbmRhcnlVVkJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5TRUNPTkRBUllfVVZfREFUQSksIHJlbmRlcmFibGUuZ2V0VmVydGV4T2Zmc2V0KFRyaWFuZ2xlU3ViR2VvbWV0cnkuU0VDT05EQVJZX1VWX0RBVEEpLCBUcmlhbmdsZVN1Ykdlb21ldHJ5LlNFQ09OREFSWV9VVl9GT1JNQVQpO1xuXG5cdFx0aWYgKHRoaXMubm9ybWFsQnVmZmVySW5kZXggPj0gMClcblx0XHRcdHN0YWdlLmFjdGl2YXRlQnVmZmVyKHRoaXMubm9ybWFsQnVmZmVySW5kZXgsIHJlbmRlcmFibGUuZ2V0VmVydGV4RGF0YShUcmlhbmdsZVN1Ykdlb21ldHJ5Lk5PUk1BTF9EQVRBKSwgcmVuZGVyYWJsZS5nZXRWZXJ0ZXhPZmZzZXQoVHJpYW5nbGVTdWJHZW9tZXRyeS5OT1JNQUxfREFUQSksIFRyaWFuZ2xlU3ViR2VvbWV0cnkuTk9STUFMX0ZPUk1BVCk7XG5cblx0XHRpZiAodGhpcy50YW5nZW50QnVmZmVySW5kZXggPj0gMClcblx0XHRcdHN0YWdlLmFjdGl2YXRlQnVmZmVyKHRoaXMudGFuZ2VudEJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5UQU5HRU5UX0RBVEEpLCByZW5kZXJhYmxlLmdldFZlcnRleE9mZnNldChUcmlhbmdsZVN1Ykdlb21ldHJ5LlRBTkdFTlRfREFUQSksIFRyaWFuZ2xlU3ViR2VvbWV0cnkuVEFOR0VOVF9GT1JNQVQpO1xuXG5cblx0XHRpZiAodGhpcy51c2VzVVZUcmFuc2Zvcm0pIHtcblx0XHRcdHZhciB1dlRyYW5zZm9ybTpNYXRyaXggPSByZW5kZXJhYmxlLm1hdGVyaWFsT3duZXIudXZUcmFuc2Zvcm0ubWF0cml4O1xuXG5cdFx0XHRpZiAodXZUcmFuc2Zvcm0pIHtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4XSA9IHV2VHJhbnNmb3JtLmE7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDFdID0gdXZUcmFuc2Zvcm0uYjtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgM10gPSB1dlRyYW5zZm9ybS50eDtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgNF0gPSB1dlRyYW5zZm9ybS5jO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA1XSA9IHV2VHJhbnNmb3JtLmQ7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDddID0gdXZUcmFuc2Zvcm0udHk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXhdID0gMTtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgMV0gPSAwO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAzXSA9IDA7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDRdID0gMDtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgNV0gPSAxO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA3XSA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuc2NlbmVOb3JtYWxNYXRyaXhJbmRleCA+PSAwKVxuXHRcdFx0cmVuZGVyYWJsZS5zb3VyY2VFbnRpdHkuaW52ZXJzZVNjZW5lVHJhbnNmb3JtLmNvcHlSYXdEYXRhVG8odGhpcy52ZXJ0ZXhDb25zdGFudERhdGEsIHRoaXMuc2NlbmVOb3JtYWxNYXRyaXhJbmRleCwgZmFsc2UpO1xuXG5cdFx0aWYgKHRoaXMudXNlc1RhbmdlbnRTcGFjZSAmJiB0aGlzLmNhbWVyYVBvc2l0aW9uSW5kZXggPj0gMCkge1xuXG5cdFx0XHRyZW5kZXJhYmxlLnNvdXJjZUVudGl0eS5pbnZlcnNlU2NlbmVUcmFuc2Zvcm0uY29weVJhd0RhdGFUbyh0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4KTtcblx0XHRcdHZhciBwb3M6VmVjdG9yM0QgPSBjYW1lcmEuc2NlbmVQb3NpdGlvbjtcblx0XHRcdHZhciB4Om51bWJlciA9IHBvcy54O1xuXHRcdFx0dmFyIHk6bnVtYmVyID0gcG9zLnk7XG5cdFx0XHR2YXIgejpudW1iZXIgPSBwb3MuejtcblxuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4XSA9IHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMF0qeCArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbNF0qeSArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbOF0qeiArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMTJdO1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgMV0gPSB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzFdKnggKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzVdKnkgKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzldKnogKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzEzXTtcblx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMuY2FtZXJhUG9zaXRpb25JbmRleCArIDJdID0gdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsyXSp4ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs2XSp5ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsxMF0qeiArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMTRdO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdC8vVE9ETyB1bmNvdW50IGFzc29jaWF0ZWQgcHJvZ3JhbSBkYXRhXG5cdH1cbn1cblxuZXhwb3J0ID0gU2hhZGVyT2JqZWN0QmFzZTsiXX0=