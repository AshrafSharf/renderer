var RenderObjectPool = require("awayjs-renderergl/lib/compilation/RenderObjectPool");
var RenderBasicMaterialObject = require("awayjs-renderergl/lib/compilation/RenderBasicMaterialObject");
var SkyboxRenderObject = require("awayjs-renderergl/lib/compilation/SkyboxRenderObject");
var DepthRenderObject = require("awayjs-renderergl/lib/compilation/DepthRenderObject");
var DistanceRenderObject = require("awayjs-renderergl/lib/compilation/DistanceRenderObject");
/**
 * @class away.pool.RenderablePoolBase
 */
var RenderablePoolBase = (function () {
    /**
     * //TODO
     *
     * @param renderableClass
     */
    function RenderablePoolBase(renderableClass, stage) {
        this._renderablePool = new Object();
        this._renderableClass = renderableClass;
        this._stage = stage;
        this._materialRenderObjectPool = new RenderObjectPool(RenderBasicMaterialObject, this._renderableClass, this._stage);
        this._skyboxRenderObjectPool = new RenderObjectPool(SkyboxRenderObject, this._renderableClass, this._stage);
        this._depthRenderObjectPool = new RenderObjectPool(DepthRenderObject, this._renderableClass, this._stage);
        this._distanceRenderObjectPool = new RenderObjectPool(DistanceRenderObject, this._renderableClass, this._stage);
    }
    /**
     * //TODO
     *
     * @param renderableOwner
     * @returns IRenderable
     */
    RenderablePoolBase.prototype.getItem = function (renderableOwner) {
        return (this._renderablePool[renderableOwner.id] || (this._renderablePool[renderableOwner.id] = renderableOwner._iAddRenderable(new this._renderableClass(this, renderableOwner, this._stage))));
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getMaterialRenderObject = function (renderObjectOwner) {
        return this._materialRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getSkyboxRenderObject = function (renderObjectOwner) {
        return this._skyboxRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getDepthRenderObject = function (renderObjectOwner) {
        return this._depthRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getDistanceRenderObject = function (renderObjectOwner) {
        return this._distanceRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     * //TODO
     *
     * @param renderableOwner
     */
    RenderablePoolBase.prototype.disposeItem = function (renderableOwner) {
        renderableOwner._iRemoveRenderable(this._renderablePool[renderableOwner.id]);
        this._renderablePool[renderableOwner.id] = null;
    };
    RenderablePoolBase.prototype.dispose = function () {
        for (var id in this._renderablePool)
            this._renderablePool[id].dispose();
        RenderablePoolBase.disposePool(this._renderableClass, this._stage);
    };
    /**
     * //TODO
     *
     * @param renderableClass
     * @returns RenderablePoolBase
     */
    RenderablePoolBase.getPool = function (renderableClass, stage) {
        var pools = (RenderablePoolBase._pools[stage.stageIndex] || (RenderablePoolBase._pools[stage.stageIndex] = new Object()));
        return (pools[renderableClass.id] || (pools[renderableClass.id] = new RenderablePoolBase(renderableClass, stage)));
    };
    /**
     * //TODO
     *
     * @param renderableClass
     */
    RenderablePoolBase.disposePool = function (renderableClass, stage) {
        var pools = RenderablePoolBase._pools[stage.stageIndex];
        if (pools == undefined)
            return;
        if (pools[renderableClass.id])
            pools[renderableClass.id] = undefined;
    };
    RenderablePoolBase._pools = new Object();
    return RenderablePoolBase;
})();
module.exports = RenderablePoolBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wb29sL1JlbmRlcmFibGVQb29sQmFzZS50cyJdLCJuYW1lcyI6WyJSZW5kZXJhYmxlUG9vbEJhc2UiLCJSZW5kZXJhYmxlUG9vbEJhc2UuY29uc3RydWN0b3IiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0SXRlbSIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRNYXRlcmlhbFJlbmRlck9iamVjdCIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRTa3lib3hSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0RGVwdGhSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0RGlzdGFuY2VSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZGlzcG9zZUl0ZW0iLCJSZW5kZXJhYmxlUG9vbEJhc2UuZGlzcG9zZSIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRQb29sIiwiUmVuZGVyYWJsZVBvb2xCYXNlLmRpc3Bvc2VQb29sIl0sIm1hcHBpbmdzIjoiQUFXQSxJQUFPLGdCQUFnQixXQUFjLG9EQUFvRCxDQUFDLENBQUM7QUFDM0YsSUFBTyx5QkFBeUIsV0FBVyw2REFBNkQsQ0FBQyxDQUFDO0FBQzFHLElBQU8sa0JBQWtCLFdBQWEsc0RBQXNELENBQUMsQ0FBQztBQUM5RixJQUFPLGlCQUFpQixXQUFhLHFEQUFxRCxDQUFDLENBQUM7QUFDNUYsSUFBTyxvQkFBb0IsV0FBYSx3REFBd0QsQ0FBQyxDQUFDO0FBR2xHLEFBR0E7O0dBREc7SUFDRyxrQkFBa0I7SUFhdkJBOzs7O09BSUdBO0lBQ0hBLFNBbEJLQSxrQkFBa0JBLENBa0JYQSxlQUFnQ0EsRUFBRUEsS0FBV0E7UUFibERDLG9CQUFlQSxHQUFVQSxJQUFJQSxNQUFNQSxFQUFFQSxDQUFDQTtRQWU1Q0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxlQUFlQSxDQUFDQTtRQUN4Q0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsS0FBS0EsQ0FB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LE1BQU1BLEVBQUVBLENBQUNBO0lBOEg1Q0EseUJBQUNBO0FBQURBLENBaElBLEFBZ0lDQSxJQUFBO0FBRUQsQUFBNEIsaUJBQW5CLGtCQUFrQixDQUFDIiwiZmlsZSI6InBvb2wvUmVuZGVyYWJsZVBvb2xCYXNlLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJUmVuZGVyT2JqZWN0T3duZXJcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JUmVuZGVyT2JqZWN0T3duZXJcIik7XG5pbXBvcnQgSVJlbmRlcmFibGVPd25lclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2Jhc2UvSVJlbmRlcmFibGVPd25lclwiKTtcbmltcG9ydCBNYXRlcmlhbEJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9NYXRlcmlhbEJhc2VcIik7XG5pbXBvcnQgSVJlbmRlcmFibGVQb29sXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcG9vbC9JUmVuZGVyYWJsZVBvb2xcIik7XG5pbXBvcnQgSVJlbmRlck9iamVjdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3Bvb2wvSVJlbmRlck9iamVjdFwiKTtcblxuaW1wb3J0IFN0YWdlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvU3RhZ2VcIik7XG5cbmltcG9ydCBSZW5kZXJlckJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2Jhc2UvUmVuZGVyZXJCYXNlXCIpO1xuaW1wb3J0IFJlbmRlcmFibGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9SZW5kZXJhYmxlQmFzZVwiKTtcbmltcG9ydCBJUmVuZGVyYWJsZUNsYXNzXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9JUmVuZGVyYWJsZUNsYXNzXCIpO1xuaW1wb3J0IFJlbmRlck9iamVjdFBvb2xcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9SZW5kZXJPYmplY3RQb29sXCIpO1xuaW1wb3J0IFJlbmRlckJhc2ljTWF0ZXJpYWxPYmplY3RcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9SZW5kZXJCYXNpY01hdGVyaWFsT2JqZWN0XCIpO1xuaW1wb3J0IFNreWJveFJlbmRlck9iamVjdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9Ta3lib3hSZW5kZXJPYmplY3RcIik7XG5pbXBvcnQgRGVwdGhSZW5kZXJPYmplY3RcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vRGVwdGhSZW5kZXJPYmplY3RcIik7XG5pbXBvcnQgRGlzdGFuY2VSZW5kZXJPYmplY3RcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vRGlzdGFuY2VSZW5kZXJPYmplY3RcIik7XG5pbXBvcnQgUmVuZGVyT2JqZWN0QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1JlbmRlck9iamVjdEJhc2VcIik7XG5cbi8qKlxuICogQGNsYXNzIGF3YXkucG9vbC5SZW5kZXJhYmxlUG9vbEJhc2VcbiAqL1xuY2xhc3MgUmVuZGVyYWJsZVBvb2xCYXNlIGltcGxlbWVudHMgSVJlbmRlcmFibGVQb29sXG57XG5cdHB1YmxpYyBzdGF0aWMgX3Bvb2xzOk9iamVjdCA9IG5ldyBPYmplY3QoKTtcblxuXHRwdWJsaWMgX3N0YWdlOlN0YWdlO1xuXHRwdWJsaWMgX3JlbmRlcmFibGVQb29sOk9iamVjdCA9IG5ldyBPYmplY3QoKTtcblx0cHVibGljIF9yZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcztcblxuXHRwcml2YXRlIF9tYXRlcmlhbFJlbmRlck9iamVjdFBvb2w6UmVuZGVyT2JqZWN0UG9vbDtcblx0cHJpdmF0ZSBfc2t5Ym94UmVuZGVyT2JqZWN0UG9vbDpSZW5kZXJPYmplY3RQb29sO1xuXHRwcml2YXRlIF9kZXB0aFJlbmRlck9iamVjdFBvb2w6UmVuZGVyT2JqZWN0UG9vbDtcblx0cHJpdmF0ZSBfZGlzdGFuY2VSZW5kZXJPYmplY3RQb29sOlJlbmRlck9iamVjdFBvb2w7XG5cblx0LyoqXG5cdCAqIC8vVE9ET1xuXHQgKlxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZUNsYXNzXG5cdCAqL1xuXHRjb25zdHJ1Y3RvcihyZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcywgc3RhZ2U6U3RhZ2UpXG5cdHtcblx0XHR0aGlzLl9yZW5kZXJhYmxlQ2xhc3MgPSByZW5kZXJhYmxlQ2xhc3M7XG5cdFx0dGhpcy5fc3RhZ2UgPSBzdGFnZTtcblxuXHRcdHRoaXMuX21hdGVyaWFsUmVuZGVyT2JqZWN0UG9vbCA9IG5ldyBSZW5kZXJPYmplY3RQb29sKFJlbmRlckJhc2ljTWF0ZXJpYWxPYmplY3QsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xuXHRcdHRoaXMuX3NreWJveFJlbmRlck9iamVjdFBvb2wgPSBuZXcgUmVuZGVyT2JqZWN0UG9vbChTa3lib3hSZW5kZXJPYmplY3QsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xuXHRcdHRoaXMuX2RlcHRoUmVuZGVyT2JqZWN0UG9vbCA9IG5ldyBSZW5kZXJPYmplY3RQb29sKERlcHRoUmVuZGVyT2JqZWN0LCB0aGlzLl9yZW5kZXJhYmxlQ2xhc3MsIHRoaXMuX3N0YWdlKTtcblx0XHR0aGlzLl9kaXN0YW5jZVJlbmRlck9iamVjdFBvb2wgPSBuZXcgUmVuZGVyT2JqZWN0UG9vbChEaXN0YW5jZVJlbmRlck9iamVjdCwgdGhpcy5fcmVuZGVyYWJsZUNsYXNzLCB0aGlzLl9zdGFnZSk7XG5cdH1cblxuXHQvKipcblx0ICogLy9UT0RPXG5cdCAqXG5cdCAqIEBwYXJhbSByZW5kZXJhYmxlT3duZXJcblx0ICogQHJldHVybnMgSVJlbmRlcmFibGVcblx0ICovXG5cdHB1YmxpYyBnZXRJdGVtKHJlbmRlcmFibGVPd25lcjpJUmVuZGVyYWJsZU93bmVyKTpSZW5kZXJhYmxlQmFzZVxuXHR7XG5cdFx0cmV0dXJuICh0aGlzLl9yZW5kZXJhYmxlUG9vbFtyZW5kZXJhYmxlT3duZXIuaWRdIHx8ICh0aGlzLl9yZW5kZXJhYmxlUG9vbFtyZW5kZXJhYmxlT3duZXIuaWRdID0gcmVuZGVyYWJsZU93bmVyLl9pQWRkUmVuZGVyYWJsZShuZXcgdGhpcy5fcmVuZGVyYWJsZUNsYXNzKHRoaXMsIHJlbmRlcmFibGVPd25lciwgdGhpcy5fc3RhZ2UpKSkpXG5cdH1cblxuXHQvKipcblx0ICpcblx0ICogQHBhcmFtIG1hdGVyaWFsXG5cdCAqIEBwYXJhbSByZW5kZXJhYmxlXG5cdCAqL1xuXHRwdWJsaWMgZ2V0TWF0ZXJpYWxSZW5kZXJPYmplY3QocmVuZGVyT2JqZWN0T3duZXI6SVJlbmRlck9iamVjdE93bmVyKTpSZW5kZXJPYmplY3RCYXNlXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fbWF0ZXJpYWxSZW5kZXJPYmplY3RQb29sLmdldEl0ZW0ocmVuZGVyT2JqZWN0T3duZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSBtYXRlcmlhbFxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxuXHQgKi9cblx0cHVibGljIGdldFNreWJveFJlbmRlck9iamVjdChyZW5kZXJPYmplY3RPd25lcjpJUmVuZGVyT2JqZWN0T3duZXIpOlJlbmRlck9iamVjdEJhc2Vcblx0e1xuXHRcdHJldHVybiB0aGlzLl9za3lib3hSZW5kZXJPYmplY3RQb29sLmdldEl0ZW0ocmVuZGVyT2JqZWN0T3duZXIpO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSBtYXRlcmlhbFxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxuXHQgKi9cblx0cHVibGljIGdldERlcHRoUmVuZGVyT2JqZWN0KHJlbmRlck9iamVjdE93bmVyOklSZW5kZXJPYmplY3RPd25lcik6UmVuZGVyT2JqZWN0QmFzZVxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2RlcHRoUmVuZGVyT2JqZWN0UG9vbC5nZXRJdGVtKHJlbmRlck9iamVjdE93bmVyKTtcblx0fVxuXG5cdC8qKlxuXHQgKlxuXHQgKiBAcGFyYW0gbWF0ZXJpYWxcblx0ICogQHBhcmFtIHJlbmRlcmFibGVcblx0ICovXG5cdHB1YmxpYyBnZXREaXN0YW5jZVJlbmRlck9iamVjdChyZW5kZXJPYmplY3RPd25lcjpJUmVuZGVyT2JqZWN0T3duZXIpOlJlbmRlck9iamVjdEJhc2Vcblx0e1xuXHRcdHJldHVybiB0aGlzLl9kaXN0YW5jZVJlbmRlck9iamVjdFBvb2wuZ2V0SXRlbShyZW5kZXJPYmplY3RPd25lcik7XG5cdH1cblxuXHQvKipcblx0ICogLy9UT0RPXG5cdCAqXG5cdCAqIEBwYXJhbSByZW5kZXJhYmxlT3duZXJcblx0ICovXG5cdHB1YmxpYyBkaXNwb3NlSXRlbShyZW5kZXJhYmxlT3duZXI6SVJlbmRlcmFibGVPd25lcilcblx0e1xuXHRcdHJlbmRlcmFibGVPd25lci5faVJlbW92ZVJlbmRlcmFibGUodGhpcy5fcmVuZGVyYWJsZVBvb2xbcmVuZGVyYWJsZU93bmVyLmlkXSk7XG5cblx0XHR0aGlzLl9yZW5kZXJhYmxlUG9vbFtyZW5kZXJhYmxlT3duZXIuaWRdID0gbnVsbDtcblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdGZvciAodmFyIGlkIGluIHRoaXMuX3JlbmRlcmFibGVQb29sKVxuXHRcdFx0dGhpcy5fcmVuZGVyYWJsZVBvb2xbaWRdLmRpc3Bvc2UoKTtcblxuXHRcdFJlbmRlcmFibGVQb29sQmFzZS5kaXNwb3NlUG9vbCh0aGlzLl9yZW5kZXJhYmxlQ2xhc3MsIHRoaXMuX3N0YWdlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiAvL1RPRE9cblx0ICpcblx0ICogQHBhcmFtIHJlbmRlcmFibGVDbGFzc1xuXHQgKiBAcmV0dXJucyBSZW5kZXJhYmxlUG9vbEJhc2Vcblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgZ2V0UG9vbChyZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcywgc3RhZ2U6U3RhZ2UpOlJlbmRlcmFibGVQb29sQmFzZVxuXHR7XG5cdFx0dmFyIHBvb2xzOk9iamVjdCA9IChSZW5kZXJhYmxlUG9vbEJhc2UuX3Bvb2xzW3N0YWdlLnN0YWdlSW5kZXhdIHx8IChSZW5kZXJhYmxlUG9vbEJhc2UuX3Bvb2xzW3N0YWdlLnN0YWdlSW5kZXhdID0gbmV3IE9iamVjdCgpKSk7XG5cblx0XHRyZXR1cm4gKHBvb2xzW3JlbmRlcmFibGVDbGFzcy5pZF0gfHwgKHBvb2xzW3JlbmRlcmFibGVDbGFzcy5pZF0gPSBuZXcgUmVuZGVyYWJsZVBvb2xCYXNlKHJlbmRlcmFibGVDbGFzcywgc3RhZ2UpKSk7XG5cdH1cblxuXHQvKipcblx0ICogLy9UT0RPXG5cdCAqXG5cdCAqIEBwYXJhbSByZW5kZXJhYmxlQ2xhc3Ncblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgZGlzcG9zZVBvb2wocmVuZGVyYWJsZUNsYXNzOklSZW5kZXJhYmxlQ2xhc3MsIHN0YWdlOlN0YWdlKVxuXHR7XG5cdFx0dmFyIHBvb2xzOk9iamVjdCA9IFJlbmRlcmFibGVQb29sQmFzZS5fcG9vbHNbc3RhZ2Uuc3RhZ2VJbmRleF07XG5cblx0XHRpZiAocG9vbHMgPT0gdW5kZWZpbmVkKVxuXHRcdFx0cmV0dXJuO1xuXG5cdFx0aWYgKHBvb2xzW3JlbmRlcmFibGVDbGFzcy5pZF0pXG5cdFx0XHRwb29sc1tyZW5kZXJhYmxlQ2xhc3MuaWRdID0gdW5kZWZpbmVkO1xuXHR9XG59XG5cbmV4cG9ydCA9IFJlbmRlcmFibGVQb29sQmFzZTsiXX0=