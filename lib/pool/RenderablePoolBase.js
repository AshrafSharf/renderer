var RenderObjectPool = require("awayjs-renderergl/lib/compilation/RenderObjectPool");
var RenderBasicMaterialObject = require("awayjs-renderergl/lib/compilation/RenderBasicMaterialObject");
var SkyboxRenderObject = require("awayjs-renderergl/lib/compilation/SkyboxRenderObject");
var DepthRenderObject = require("awayjs-renderergl/lib/compilation/DepthRenderObject");
var DistanceRenderObject = require("awayjs-renderergl/lib/compilation/DistanceRenderObject");
/**
 * @class away.pool.RenderablePoolBase
 */
var RenderablePoolBase = (function () {
    /**
     * //TODO
     *
     * @param renderableClass
     */
    function RenderablePoolBase(renderableClass, stage) {
        this._renderablePool = new Object();
        this._renderableClass = renderableClass;
        this._stage = stage;
        this._materialRenderObjectPool = new RenderObjectPool(RenderBasicMaterialObject, this._renderableClass, this._stage);
        this._skyboxRenderObjectPool = new RenderObjectPool(SkyboxRenderObject, this._renderableClass, this._stage);
        this._depthRenderObjectPool = new RenderObjectPool(DepthRenderObject, this._renderableClass, this._stage);
        this._distanceRenderObjectPool = new RenderObjectPool(DistanceRenderObject, this._renderableClass, this._stage);
    }
    /**
     * //TODO
     *
     * @param renderableOwner
     * @returns IRenderable
     */
    RenderablePoolBase.prototype.getItem = function (renderableOwner) {
        return (this._renderablePool[renderableOwner.id] || (this._renderablePool[renderableOwner.id] = renderableOwner._iAddRenderable(new this._renderableClass(this, renderableOwner, this._stage))));
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getMaterialRenderObject = function (renderObjectOwner) {
        return this._materialRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getSkyboxRenderObject = function (renderObjectOwner) {
        return this._skyboxRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getDepthRenderObject = function (renderObjectOwner) {
        return this._depthRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     *
     * @param material
     * @param renderable
     */
    RenderablePoolBase.prototype.getDistanceRenderObject = function (renderObjectOwner) {
        return this._distanceRenderObjectPool.getItem(renderObjectOwner);
    };
    /**
     * //TODO
     *
     * @param renderableOwner
     */
    RenderablePoolBase.prototype.disposeItem = function (renderableOwner) {
        renderableOwner._iRemoveRenderable(this._renderablePool[renderableOwner.id]);
        this._renderablePool[renderableOwner.id] = null;
    };
    RenderablePoolBase.prototype.dispose = function () {
        for (var id in this._renderablePool)
            this._renderablePool[id].dispose();
        RenderablePoolBase.disposePool(this._renderableClass, this._stage);
    };
    /**
     * //TODO
     *
     * @param renderableClass
     * @returns RenderablePoolBase
     */
    RenderablePoolBase.getPool = function (renderableClass, stage) {
        var pools = (RenderablePoolBase._pools[stage.stageIndex] || (RenderablePoolBase._pools[stage.stageIndex] = new Object()));
        return (pools[renderableClass.id] || (pools[renderableClass.id] = new RenderablePoolBase(renderableClass, stage)));
    };
    /**
     * //TODO
     *
     * @param renderableClass
     */
    RenderablePoolBase.disposePool = function (renderableClass, stage) {
        var pools = RenderablePoolBase._pools[stage.stageIndex];
        if (pools == undefined)
            return;
        if (pools[renderableClass.id])
            pools[renderableClass.id] = undefined;
    };
    RenderablePoolBase._pools = new Object();
    return RenderablePoolBase;
})();
module.exports = RenderablePoolBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wb29sL1JlbmRlcmFibGVQb29sQmFzZS50cyJdLCJuYW1lcyI6WyJSZW5kZXJhYmxlUG9vbEJhc2UiLCJSZW5kZXJhYmxlUG9vbEJhc2UuY29uc3RydWN0b3IiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0SXRlbSIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRNYXRlcmlhbFJlbmRlck9iamVjdCIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRTa3lib3hSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0RGVwdGhSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZ2V0RGlzdGFuY2VSZW5kZXJPYmplY3QiLCJSZW5kZXJhYmxlUG9vbEJhc2UuZGlzcG9zZUl0ZW0iLCJSZW5kZXJhYmxlUG9vbEJhc2UuZGlzcG9zZSIsIlJlbmRlcmFibGVQb29sQmFzZS5nZXRQb29sIiwiUmVuZGVyYWJsZVBvb2xCYXNlLmRpc3Bvc2VQb29sIl0sIm1hcHBpbmdzIjoiQUFXQSxJQUFPLGdCQUFnQixXQUFjLG9EQUFvRCxDQUFDLENBQUM7QUFDM0YsSUFBTyx5QkFBeUIsV0FBVyw2REFBNkQsQ0FBQyxDQUFDO0FBQzFHLElBQU8sa0JBQWtCLFdBQWEsc0RBQXNELENBQUMsQ0FBQztBQUM5RixJQUFPLGlCQUFpQixXQUFhLHFEQUFxRCxDQUFDLENBQUM7QUFDNUYsSUFBTyxvQkFBb0IsV0FBYSx3REFBd0QsQ0FBQyxDQUFDO0FBR2xHLEFBR0E7O0dBREc7SUFDRyxrQkFBa0I7SUFhdkJBOzs7O09BSUdBO0lBQ0hBLFNBbEJLQSxrQkFBa0JBLENBa0JYQSxlQUFnQ0EsRUFBRUEsS0FBV0E7UUFibERDLG9CQUFlQSxHQUFVQSxJQUFJQSxNQUFNQSxFQUFFQSxDQUFDQTtRQWU1Q0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxlQUFlQSxDQUFDQTtRQUN4Q0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsS0FBS0EsQ0FB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LE1BQU1BLEVBQUVBLENBQUNBO0lBOEg1Q0EseUJBQUNBO0FBQURBLENBaElBLEFBZ0lDQSxJQUFBO0FBRUQsQUFBNEIsaUJBQW5CLGtCQUFrQixDQUFDIiwiZmlsZSI6InBvb2wvUmVuZGVyYWJsZVBvb2xCYXNlLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJUmVuZGVyT2JqZWN0T3duZXJcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JUmVuZGVyT2JqZWN0T3duZXJcIik7XHJcbmltcG9ydCBJUmVuZGVyYWJsZU93bmVyXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JUmVuZGVyYWJsZU93bmVyXCIpO1xyXG5pbXBvcnQgTWF0ZXJpYWxCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYXRlcmlhbHMvTWF0ZXJpYWxCYXNlXCIpO1xyXG5pbXBvcnQgSVJlbmRlcmFibGVQb29sXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcG9vbC9JUmVuZGVyYWJsZVBvb2xcIik7XHJcbmltcG9ydCBJUmVuZGVyT2JqZWN0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcG9vbC9JUmVuZGVyT2JqZWN0XCIpO1xyXG5cclxuaW1wb3J0IFN0YWdlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvU3RhZ2VcIik7XHJcblxyXG5pbXBvcnQgUmVuZGVyZXJCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9iYXNlL1JlbmRlcmVyQmFzZVwiKTtcclxuaW1wb3J0IFJlbmRlcmFibGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9SZW5kZXJhYmxlQmFzZVwiKTtcclxuaW1wb3J0IElSZW5kZXJhYmxlQ2xhc3NcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wb29sL0lSZW5kZXJhYmxlQ2xhc3NcIik7XHJcbmltcG9ydCBSZW5kZXJPYmplY3RQb29sXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vUmVuZGVyT2JqZWN0UG9vbFwiKTtcclxuaW1wb3J0IFJlbmRlckJhc2ljTWF0ZXJpYWxPYmplY3RcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9SZW5kZXJCYXNpY01hdGVyaWFsT2JqZWN0XCIpO1xyXG5pbXBvcnQgU2t5Ym94UmVuZGVyT2JqZWN0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1NreWJveFJlbmRlck9iamVjdFwiKTtcclxuaW1wb3J0IERlcHRoUmVuZGVyT2JqZWN0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL0RlcHRoUmVuZGVyT2JqZWN0XCIpO1xyXG5pbXBvcnQgRGlzdGFuY2VSZW5kZXJPYmplY3RcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vRGlzdGFuY2VSZW5kZXJPYmplY3RcIik7XHJcbmltcG9ydCBSZW5kZXJPYmplY3RCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vUmVuZGVyT2JqZWN0QmFzZVwiKTtcclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgYXdheS5wb29sLlJlbmRlcmFibGVQb29sQmFzZVxyXG4gKi9cclxuY2xhc3MgUmVuZGVyYWJsZVBvb2xCYXNlIGltcGxlbWVudHMgSVJlbmRlcmFibGVQb29sXHJcbntcclxuXHRwdWJsaWMgc3RhdGljIF9wb29sczpPYmplY3QgPSBuZXcgT2JqZWN0KCk7XHJcblxyXG5cdHB1YmxpYyBfc3RhZ2U6U3RhZ2U7XHJcblx0cHVibGljIF9yZW5kZXJhYmxlUG9vbDpPYmplY3QgPSBuZXcgT2JqZWN0KCk7XHJcblx0cHVibGljIF9yZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcztcclxuXHJcblx0cHJpdmF0ZSBfbWF0ZXJpYWxSZW5kZXJPYmplY3RQb29sOlJlbmRlck9iamVjdFBvb2w7XHJcblx0cHJpdmF0ZSBfc2t5Ym94UmVuZGVyT2JqZWN0UG9vbDpSZW5kZXJPYmplY3RQb29sO1xyXG5cdHByaXZhdGUgX2RlcHRoUmVuZGVyT2JqZWN0UG9vbDpSZW5kZXJPYmplY3RQb29sO1xyXG5cdHByaXZhdGUgX2Rpc3RhbmNlUmVuZGVyT2JqZWN0UG9vbDpSZW5kZXJPYmplY3RQb29sO1xyXG5cclxuXHQvKipcclxuXHQgKiAvL1RPRE9cclxuXHQgKlxyXG5cdCAqIEBwYXJhbSByZW5kZXJhYmxlQ2xhc3NcclxuXHQgKi9cclxuXHRjb25zdHJ1Y3RvcihyZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcywgc3RhZ2U6U3RhZ2UpXHJcblx0e1xyXG5cdFx0dGhpcy5fcmVuZGVyYWJsZUNsYXNzID0gcmVuZGVyYWJsZUNsYXNzO1xyXG5cdFx0dGhpcy5fc3RhZ2UgPSBzdGFnZTtcclxuXHJcblx0XHR0aGlzLl9tYXRlcmlhbFJlbmRlck9iamVjdFBvb2wgPSBuZXcgUmVuZGVyT2JqZWN0UG9vbChSZW5kZXJCYXNpY01hdGVyaWFsT2JqZWN0LCB0aGlzLl9yZW5kZXJhYmxlQ2xhc3MsIHRoaXMuX3N0YWdlKTtcclxuXHRcdHRoaXMuX3NreWJveFJlbmRlck9iamVjdFBvb2wgPSBuZXcgUmVuZGVyT2JqZWN0UG9vbChTa3lib3hSZW5kZXJPYmplY3QsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cdFx0dGhpcy5fZGVwdGhSZW5kZXJPYmplY3RQb29sID0gbmV3IFJlbmRlck9iamVjdFBvb2woRGVwdGhSZW5kZXJPYmplY3QsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cdFx0dGhpcy5fZGlzdGFuY2VSZW5kZXJPYmplY3RQb29sID0gbmV3IFJlbmRlck9iamVjdFBvb2woRGlzdGFuY2VSZW5kZXJPYmplY3QsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogLy9UT0RPXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZU93bmVyXHJcblx0ICogQHJldHVybnMgSVJlbmRlcmFibGVcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0SXRlbShyZW5kZXJhYmxlT3duZXI6SVJlbmRlcmFibGVPd25lcik6UmVuZGVyYWJsZUJhc2VcclxuXHR7XHJcblx0XHRyZXR1cm4gKHRoaXMuX3JlbmRlcmFibGVQb29sW3JlbmRlcmFibGVPd25lci5pZF0gfHwgKHRoaXMuX3JlbmRlcmFibGVQb29sW3JlbmRlcmFibGVPd25lci5pZF0gPSByZW5kZXJhYmxlT3duZXIuX2lBZGRSZW5kZXJhYmxlKG5ldyB0aGlzLl9yZW5kZXJhYmxlQ2xhc3ModGhpcywgcmVuZGVyYWJsZU93bmVyLCB0aGlzLl9zdGFnZSkpKSlcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIG1hdGVyaWFsXHJcblx0ICogQHBhcmFtIHJlbmRlcmFibGVcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0TWF0ZXJpYWxSZW5kZXJPYmplY3QocmVuZGVyT2JqZWN0T3duZXI6SVJlbmRlck9iamVjdE93bmVyKTpSZW5kZXJPYmplY3RCYXNlXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX21hdGVyaWFsUmVuZGVyT2JqZWN0UG9vbC5nZXRJdGVtKHJlbmRlck9iamVjdE93bmVyKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIG1hdGVyaWFsXHJcblx0ICogQHBhcmFtIHJlbmRlcmFibGVcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0U2t5Ym94UmVuZGVyT2JqZWN0KHJlbmRlck9iamVjdE93bmVyOklSZW5kZXJPYmplY3RPd25lcik6UmVuZGVyT2JqZWN0QmFzZVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9za3lib3hSZW5kZXJPYmplY3RQb29sLmdldEl0ZW0ocmVuZGVyT2JqZWN0T3duZXIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gbWF0ZXJpYWxcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXREZXB0aFJlbmRlck9iamVjdChyZW5kZXJPYmplY3RPd25lcjpJUmVuZGVyT2JqZWN0T3duZXIpOlJlbmRlck9iamVjdEJhc2VcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fZGVwdGhSZW5kZXJPYmplY3RQb29sLmdldEl0ZW0ocmVuZGVyT2JqZWN0T3duZXIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gbWF0ZXJpYWxcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXREaXN0YW5jZVJlbmRlck9iamVjdChyZW5kZXJPYmplY3RPd25lcjpJUmVuZGVyT2JqZWN0T3duZXIpOlJlbmRlck9iamVjdEJhc2VcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fZGlzdGFuY2VSZW5kZXJPYmplY3RQb29sLmdldEl0ZW0ocmVuZGVyT2JqZWN0T3duZXIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogLy9UT0RPXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZU93bmVyXHJcblx0ICovXHJcblx0cHVibGljIGRpc3Bvc2VJdGVtKHJlbmRlcmFibGVPd25lcjpJUmVuZGVyYWJsZU93bmVyKVxyXG5cdHtcclxuXHRcdHJlbmRlcmFibGVPd25lci5faVJlbW92ZVJlbmRlcmFibGUodGhpcy5fcmVuZGVyYWJsZVBvb2xbcmVuZGVyYWJsZU93bmVyLmlkXSk7XHJcblxyXG5cdFx0dGhpcy5fcmVuZGVyYWJsZVBvb2xbcmVuZGVyYWJsZU93bmVyLmlkXSA9IG51bGw7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZGlzcG9zZSgpXHJcblx0e1xyXG5cdFx0Zm9yICh2YXIgaWQgaW4gdGhpcy5fcmVuZGVyYWJsZVBvb2wpXHJcblx0XHRcdHRoaXMuX3JlbmRlcmFibGVQb29sW2lkXS5kaXNwb3NlKCk7XHJcblxyXG5cdFx0UmVuZGVyYWJsZVBvb2xCYXNlLmRpc3Bvc2VQb29sKHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogLy9UT0RPXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZUNsYXNzXHJcblx0ICogQHJldHVybnMgUmVuZGVyYWJsZVBvb2xCYXNlXHJcblx0ICovXHJcblx0cHVibGljIHN0YXRpYyBnZXRQb29sKHJlbmRlcmFibGVDbGFzczpJUmVuZGVyYWJsZUNsYXNzLCBzdGFnZTpTdGFnZSk6UmVuZGVyYWJsZVBvb2xCYXNlXHJcblx0e1xyXG5cdFx0dmFyIHBvb2xzOk9iamVjdCA9IChSZW5kZXJhYmxlUG9vbEJhc2UuX3Bvb2xzW3N0YWdlLnN0YWdlSW5kZXhdIHx8IChSZW5kZXJhYmxlUG9vbEJhc2UuX3Bvb2xzW3N0YWdlLnN0YWdlSW5kZXhdID0gbmV3IE9iamVjdCgpKSk7XHJcblxyXG5cdFx0cmV0dXJuIChwb29sc1tyZW5kZXJhYmxlQ2xhc3MuaWRdIHx8IChwb29sc1tyZW5kZXJhYmxlQ2xhc3MuaWRdID0gbmV3IFJlbmRlcmFibGVQb29sQmFzZShyZW5kZXJhYmxlQ2xhc3MsIHN0YWdlKSkpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogLy9UT0RPXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZUNsYXNzXHJcblx0ICovXHJcblx0cHVibGljIHN0YXRpYyBkaXNwb3NlUG9vbChyZW5kZXJhYmxlQ2xhc3M6SVJlbmRlcmFibGVDbGFzcywgc3RhZ2U6U3RhZ2UpXHJcblx0e1xyXG5cdFx0dmFyIHBvb2xzOk9iamVjdCA9IFJlbmRlcmFibGVQb29sQmFzZS5fcG9vbHNbc3RhZ2Uuc3RhZ2VJbmRleF07XHJcblxyXG5cdFx0aWYgKHBvb2xzID09IHVuZGVmaW5lZClcclxuXHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdGlmIChwb29sc1tyZW5kZXJhYmxlQ2xhc3MuaWRdKVxyXG5cdFx0XHRwb29sc1tyZW5kZXJhYmxlQ2xhc3MuaWRdID0gdW5kZWZpbmVkO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0ID0gUmVuZGVyYWJsZVBvb2xCYXNlOyJdfQ==