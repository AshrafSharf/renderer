/**
 * ...
 */
var AnimationSubGeometry = (function () {
    function AnimationSubGeometry() {
        this._pVertexBuffer = new Array(8);
        this._pBufferContext = new Array(8);
        this._pBufferDirty = new Array(8);
        this.numProcessedVertices = 0;
        this.previousTime = Number.NEGATIVE_INFINITY;
        this.animationParticles = new Array();
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
        this._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;
    }
    AnimationSubGeometry.prototype.createVertexData = function (numVertices /*uint*/, totalLenOfOneVertex /*uint*/) {
        this._numVertices = numVertices;
        this._totalLenOfOneVertex = totalLenOfOneVertex;
        this._pVertexData = new Array(numVertices * totalLenOfOneVertex);
    };
    AnimationSubGeometry.prototype.activateVertexBuffer = function (index /*int*/, bufferOffset /*int*/, stage, format) {
        var contextIndex = stage.stageIndex;
        var context = stage.context;
        var buffer = this._pVertexBuffer[contextIndex];
        if (!buffer || this._pBufferContext[contextIndex] != context) {
            buffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex);
            this._pBufferContext[contextIndex] = context;
            this._pBufferDirty[contextIndex] = true;
        }
        if (this._pBufferDirty[contextIndex]) {
            buffer.uploadFromArray(this._pVertexData, 0, this._numVertices);
            this._pBufferDirty[contextIndex] = false;
        }
        context.setVertexBufferAt(index, buffer, bufferOffset, format);
    };
    AnimationSubGeometry.prototype.dispose = function () {
        while (this._pVertexBuffer.length) {
            var vertexBuffer = this._pVertexBuffer.pop();
            if (vertexBuffer)
                vertexBuffer.dispose();
        }
    };
    AnimationSubGeometry.prototype.invalidateBuffer = function () {
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
    };
    Object.defineProperty(AnimationSubGeometry.prototype, "vertexData", {
        get: function () {
            return this._pVertexData;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "numVertices", {
        get: function () {
            return this._numVertices;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "totalLenOfOneVertex", {
        get: function () {
            return this._totalLenOfOneVertex;
        },
        enumerable: true,
        configurable: true
    });
    AnimationSubGeometry.SUBGEOM_ID_COUNT = 0;
    return AnimationSubGeometry;
})();
module.exports = AnimationSubGeometry;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9hbmltYXRpb25zdWJnZW9tZXRyeS50cyJdLCJuYW1lcyI6WyJBbmltYXRpb25TdWJHZW9tZXRyeSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmNvbnN0cnVjdG9yIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuY3JlYXRlVmVydGV4RGF0YSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuZGlzcG9zZSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmludmFsaWRhdGVCdWZmZXIiLCJBbmltYXRpb25TdWJHZW9tZXRyeS52ZXJ0ZXhEYXRhIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkubnVtVmVydGljZXMiLCJBbmltYXRpb25TdWJHZW9tZXRyeS50b3RhbExlbk9mT25lVmVydGV4Il0sIm1hcHBpbmdzIjoiQUFNQSxBQUdBOztHQURHO0lBQ0csb0JBQW9CO0lBMkJ6QkEsU0EzQktBLG9CQUFvQkE7UUFNbEJDLG1CQUFjQSxHQUF3QkEsSUFBSUEsS0FBS0EsQ0FBZ0JBLENBQUNBLENBQUNBLENBQUNBO1FBQ2xFQSxvQkFBZUEsR0FBMEJBLElBQUlBLEtBQUtBLENBQWtCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUN2RUEsa0JBQWFBLEdBQWtCQSxJQUFJQSxLQUFLQSxDQUFVQSxDQUFDQSxDQUFDQSxDQUFDQTtRQU1yREEseUJBQW9CQSxHQUFrQkEsQ0FBQ0EsQ0FBQ0E7UUFFeENBLGlCQUFZQSxHQUFVQSxNQUFNQSxDQUFDQSxpQkFBaUJBLENBQUNBO1FBRS9DQSx1QkFBa0JBLEdBQWdDQSxJQUFJQSxLQUFLQSxFQUF5QkEsQ0FBQ0E7UUFXM0ZBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQWtCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQTtZQUN4Q0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFFOUJBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLG9CQUFvQkEsQ0FBQ0EsZ0JBQWdCQSxFQUFFQSxDQUFDQTtJQUMzREEsQ0FBQ0E7SUFFTUQsK0NBQWdCQSxHQUF2QkEsVUFBd0JBLFdBQVdBLENBQVFBLFFBQURBLEFBQVNBLEVBQUVBLG1CQUFtQkEsQ0FBUUEsUUFBREEsQUFBU0E7UUFFdkZFLElBQUlBLENBQUNBLFlBQVlBLEdBQUdBLFdBQVdBLENBQUNBO1FBQ2hDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLEdBQUdBLG1CQUFtQkEsQ0FBQ0E7UUFDaERBLElBQUlBLENBQUNBLFlBQVlBLEdBQUdBLElBQUlBLEtBQUtBLENBQVNBLFdBQVdBLEdBQUNBLG1CQUFtQkEsQ0FBQ0EsQ0FBQ0E7SUFDeEVBLENBQUNBO0lBRU1GLG1EQUFvQkEsR0FBM0JBLFVBQTRCQSxLQUFLQSxDQUFRQSxPQUFEQSxBQUFRQSxFQUFFQSxZQUFZQSxDQUFRQSxPQUFEQSxBQUFRQSxFQUFFQSxLQUFXQSxFQUFFQSxNQUFhQTtRQUV4R0csSUFBSUEsWUFBWUEsR0FBa0JBLEtBQUtBLENBQUNBLFVBQVVBLENBQUNBO1FBQ25EQSxJQUFJQSxPQUFPQSxHQUFxQ0EsS0FBS0EsQ0FBQ0EsT0FBT0EsQ0FBQ0E7UUFFOURBLElBQUlBLE1BQU1BLEdBQWlCQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQTtRQUM3REEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsSUFBSUEsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDOURBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLFlBQVlBLENBQUNBLEdBQUdBLE9BQU9BLENBQUNBLGtCQUFrQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsRUFBRUEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQTtZQUN0SEEsSUFBSUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsT0FBT0EsQ0FBQ0E7WUFDN0NBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFlBQVlBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBO1FBQ3pDQSxDQUFDQTtRQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0Q0EsTUFBTUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0EsRUFBRUEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7WUFDaEVBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFlBQVlBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBO1FBQzFDQSxDQUFDQTtRQUNEQSxPQUFPQSxDQUFDQSxpQkFBaUJBLENBQUNBLEtBQUtBLEVBQUVBLE1BQU1BLEVBQUVBLFlBQVlBLEVBQUVBLE1BQU1BLENBQUNBLENBQUNBO0lBQ2hFQSxDQUFDQTtJQUVNSCxzQ0FBT0EsR0FBZEE7UUFFQ0ksT0FBT0EsSUFBSUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0E7WUFDbkNBLElBQUlBLFlBQVlBLEdBQWlCQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFBQTtZQUUxREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsWUFBWUEsQ0FBQ0E7Z0JBQ2hCQSxZQUFZQSxDQUFDQSxPQUFPQSxFQUFFQSxDQUFDQTtRQUN6QkEsQ0FBQ0E7SUFDRkEsQ0FBQ0E7SUFFTUosK0NBQWdCQSxHQUF2QkE7UUFFQ0ssR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBa0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBO1lBQ3hDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQTtJQUMvQkEsQ0FBQ0E7SUFFREwsc0JBQVdBLDRDQUFVQTthQUFyQkE7WUFFQ00sTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFDMUJBLENBQUNBOzs7T0FBQU47SUFFREEsc0JBQVdBLDZDQUFXQTthQUF0QkE7WUFFQ08sTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFDMUJBLENBQUNBOzs7T0FBQVA7SUFFREEsc0JBQVdBLHFEQUFtQkE7YUFBOUJBO1lBRUNRLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0E7UUFDbENBLENBQUNBOzs7T0FBQVI7SUF2RmFBLHFDQUFnQkEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7SUF3RjNDQSwyQkFBQ0E7QUFBREEsQ0ExRkEsQUEwRkNBLElBQUE7QUFFRCxBQUE4QixpQkFBckIsb0JBQW9CLENBQUMiLCJmaWxlIjoiYW5pbWF0b3JzL2RhdGEvQW5pbWF0aW9uU3ViR2VvbWV0cnkuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN0YWdlXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9TdGFnZVwiKTtcbmltcG9ydCBJQ29udGV4dFN0YWdlR0xcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvSUNvbnRleHRTdGFnZUdMXCIpO1xuaW1wb3J0IElWZXJ0ZXhCdWZmZXJcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvSVZlcnRleEJ1ZmZlclwiKTtcblxuaW1wb3J0IFBhcnRpY2xlQW5pbWF0aW9uRGF0YVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9QYXJ0aWNsZUFuaW1hdGlvbkRhdGFcIik7XG5cbi8qKlxuICogLi4uXG4gKi9cbmNsYXNzIEFuaW1hdGlvblN1Ykdlb21ldHJ5XG57XG5cdHB1YmxpYyBzdGF0aWMgU1VCR0VPTV9JRF9DT1VOVDpudW1iZXIgPSAwO1xuXG5cdHB1YmxpYyBfcFZlcnRleERhdGE6QXJyYXk8bnVtYmVyPjtcblxuXHRwdWJsaWMgX3BWZXJ0ZXhCdWZmZXI6QXJyYXk8SVZlcnRleEJ1ZmZlcj4gPSBuZXcgQXJyYXk8SVZlcnRleEJ1ZmZlcj4oOCk7XG5cdHB1YmxpYyBfcEJ1ZmZlckNvbnRleHQ6QXJyYXk8SUNvbnRleHRTdGFnZUdMPiA9IG5ldyBBcnJheTxJQ29udGV4dFN0YWdlR0w+KDgpO1xuXHRwdWJsaWMgX3BCdWZmZXJEaXJ0eTpBcnJheTxib29sZWFuPiA9IG5ldyBBcnJheTxib29sZWFuPig4KTtcblxuXHRwcml2YXRlIF9udW1WZXJ0aWNlczpudW1iZXIgLyp1aW50Ki87XG5cblx0cHJpdmF0ZSBfdG90YWxMZW5PZk9uZVZlcnRleDpudW1iZXIgLyp1aW50Ki87XG5cblx0cHVibGljIG51bVByb2Nlc3NlZFZlcnRpY2VzOm51bWJlciAvKmludCovID0gMDtcblxuXHRwdWJsaWMgcHJldmlvdXNUaW1lOm51bWJlciA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWTtcblxuXHRwdWJsaWMgYW5pbWF0aW9uUGFydGljbGVzOkFycmF5PFBhcnRpY2xlQW5pbWF0aW9uRGF0YT4gPSBuZXcgQXJyYXk8UGFydGljbGVBbmltYXRpb25EYXRhPigpO1xuXG5cdC8qKlxuXHQgKiBBbiBpZCBmb3IgdGhpcyBhbmltYXRpb24gc3ViZ2VvbWV0cnksIHVzZWQgdG8gaWRlbnRpZnkgYW5pbWF0aW9uIHN1Ymdlb21ldHJpZXMgd2hlbiB1c2luZyBhbmltYXRpb24gc2V0cy5cblx0ICpcblx0ICogQHByaXZhdGVcblx0ICovXG5cdHB1YmxpYyBfaVVuaXF1ZUlkOm51bWJlcjsvL0FyY2FuZVxuXG5cdGNvbnN0cnVjdG9yKClcblx0e1xuXHRcdGZvciAodmFyIGk6bnVtYmVyIC8qaW50Ki8gPSAwOyBpIDwgODsgaSsrKVxuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2ldID0gdHJ1ZTtcblxuXHRcdHRoaXMuX2lVbmlxdWVJZCA9IEFuaW1hdGlvblN1Ykdlb21ldHJ5LlNVQkdFT01fSURfQ09VTlQrKztcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGVWZXJ0ZXhEYXRhKG51bVZlcnRpY2VzOm51bWJlciAvKnVpbnQqLywgdG90YWxMZW5PZk9uZVZlcnRleDpudW1iZXIgLyp1aW50Ki8pXG5cdHtcblx0XHR0aGlzLl9udW1WZXJ0aWNlcyA9IG51bVZlcnRpY2VzO1xuXHRcdHRoaXMuX3RvdGFsTGVuT2ZPbmVWZXJ0ZXggPSB0b3RhbExlbk9mT25lVmVydGV4O1xuXHRcdHRoaXMuX3BWZXJ0ZXhEYXRhID0gbmV3IEFycmF5PG51bWJlcj4obnVtVmVydGljZXMqdG90YWxMZW5PZk9uZVZlcnRleCk7XG5cdH1cblxuXHRwdWJsaWMgYWN0aXZhdGVWZXJ0ZXhCdWZmZXIoaW5kZXg6bnVtYmVyIC8qaW50Ki8sIGJ1ZmZlck9mZnNldDpudW1iZXIgLyppbnQqLywgc3RhZ2U6U3RhZ2UsIGZvcm1hdDpzdHJpbmcpXG5cdHtcblx0XHR2YXIgY29udGV4dEluZGV4Om51bWJlciAvKmludCovID0gc3RhZ2Uuc3RhZ2VJbmRleDtcblx0XHR2YXIgY29udGV4dDpJQ29udGV4dFN0YWdlR0wgPSA8SUNvbnRleHRTdGFnZUdMPiBzdGFnZS5jb250ZXh0O1xuXG5cdFx0dmFyIGJ1ZmZlcjpJVmVydGV4QnVmZmVyID0gdGhpcy5fcFZlcnRleEJ1ZmZlcltjb250ZXh0SW5kZXhdO1xuXHRcdGlmICghYnVmZmVyIHx8IHRoaXMuX3BCdWZmZXJDb250ZXh0W2NvbnRleHRJbmRleF0gIT0gY29udGV4dCkge1xuXHRcdFx0YnVmZmVyID0gdGhpcy5fcFZlcnRleEJ1ZmZlcltjb250ZXh0SW5kZXhdID0gY29udGV4dC5jcmVhdGVWZXJ0ZXhCdWZmZXIodGhpcy5fbnVtVmVydGljZXMsIHRoaXMuX3RvdGFsTGVuT2ZPbmVWZXJ0ZXgpO1xuXHRcdFx0dGhpcy5fcEJ1ZmZlckNvbnRleHRbY29udGV4dEluZGV4XSA9IGNvbnRleHQ7XG5cdFx0XHR0aGlzLl9wQnVmZmVyRGlydHlbY29udGV4dEluZGV4XSA9IHRydWU7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9wQnVmZmVyRGlydHlbY29udGV4dEluZGV4XSkge1xuXHRcdFx0YnVmZmVyLnVwbG9hZEZyb21BcnJheSh0aGlzLl9wVmVydGV4RGF0YSwgMCwgdGhpcy5fbnVtVmVydGljZXMpO1xuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0gPSBmYWxzZTtcblx0XHR9XG5cdFx0Y29udGV4dC5zZXRWZXJ0ZXhCdWZmZXJBdChpbmRleCwgYnVmZmVyLCBidWZmZXJPZmZzZXQsIGZvcm1hdCk7XG5cdH1cblxuXHRwdWJsaWMgZGlzcG9zZSgpXG5cdHtcblx0XHR3aGlsZSAodGhpcy5fcFZlcnRleEJ1ZmZlci5sZW5ndGgpIHtcblx0XHRcdHZhciB2ZXJ0ZXhCdWZmZXI6SVZlcnRleEJ1ZmZlciA9IHRoaXMuX3BWZXJ0ZXhCdWZmZXIucG9wKClcblxuXHRcdFx0aWYgKHZlcnRleEJ1ZmZlcilcblx0XHRcdFx0dmVydGV4QnVmZmVyLmRpc3Bvc2UoKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgaW52YWxpZGF0ZUJ1ZmZlcigpXG5cdHtcblx0XHRmb3IgKHZhciBpOm51bWJlciAvKmludCovID0gMDsgaSA8IDg7IGkrKylcblx0XHRcdHRoaXMuX3BCdWZmZXJEaXJ0eVtpXSA9IHRydWU7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IHZlcnRleERhdGEoKTpBcnJheTxudW1iZXI+XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcFZlcnRleERhdGE7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IG51bVZlcnRpY2VzKCk6bnVtYmVyIC8qdWludCovXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fbnVtVmVydGljZXM7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IHRvdGFsTGVuT2ZPbmVWZXJ0ZXgoKTpudW1iZXIgLyp1aW50Ki9cblx0e1xuXHRcdHJldHVybiB0aGlzLl90b3RhbExlbk9mT25lVmVydGV4O1xuXHR9XG59XG5cbmV4cG9ydCA9IEFuaW1hdGlvblN1Ykdlb21ldHJ5OyJdfQ==