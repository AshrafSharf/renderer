/**
 * ...
 */
var AnimationSubGeometry = (function () {
    function AnimationSubGeometry() {
        this._pVertexBuffer = new Array(8);
        this._pBufferContext = new Array(8);
        this._pBufferDirty = new Array(8);
        this.numProcessedVertices = 0;
        this.previousTime = Number.NEGATIVE_INFINITY;
        this.animationParticles = new Array();
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
        this._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;
    }
    AnimationSubGeometry.prototype.createVertexData = function (numVertices /*uint*/, totalLenOfOneVertex /*uint*/) {
        this._numVertices = numVertices;
        this._totalLenOfOneVertex = totalLenOfOneVertex;
        this._pVertexData = new Array(numVertices * totalLenOfOneVertex);
    };
    AnimationSubGeometry.prototype.activateVertexBuffer = function (index /*int*/, bufferOffset /*int*/, stage, format) {
        var contextIndex = stage.stageIndex;
        var context = stage.context;
        var buffer = this._pVertexBuffer[contextIndex];
        if (!buffer || this._pBufferContext[contextIndex] != context) {
            buffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex);
            this._pBufferContext[contextIndex] = context;
            this._pBufferDirty[contextIndex] = true;
        }
        if (this._pBufferDirty[contextIndex]) {
            buffer.uploadFromArray(this._pVertexData, 0, this._numVertices);
            this._pBufferDirty[contextIndex] = false;
        }
        context.setVertexBufferAt(index, buffer, bufferOffset, format);
    };
    AnimationSubGeometry.prototype.dispose = function () {
        while (this._pVertexBuffer.length) {
            var vertexBuffer = this._pVertexBuffer.pop();
            if (vertexBuffer)
                vertexBuffer.dispose();
        }
    };
    AnimationSubGeometry.prototype.invalidateBuffer = function () {
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
    };
    Object.defineProperty(AnimationSubGeometry.prototype, "vertexData", {
        get: function () {
            return this._pVertexData;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "numVertices", {
        get: function () {
            return this._numVertices;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "totalLenOfOneVertex", {
        get: function () {
            return this._totalLenOfOneVertex;
        },
        enumerable: true,
        configurable: true
    });
    AnimationSubGeometry.SUBGEOM_ID_COUNT = 0;
    return AnimationSubGeometry;
})();
module.exports = AnimationSubGeometry;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9BbmltYXRpb25TdWJHZW9tZXRyeS50cyJdLCJuYW1lcyI6WyJBbmltYXRpb25TdWJHZW9tZXRyeSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmNvbnN0cnVjdG9yIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuY3JlYXRlVmVydGV4RGF0YSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuZGlzcG9zZSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmludmFsaWRhdGVCdWZmZXIiLCJBbmltYXRpb25TdWJHZW9tZXRyeS52ZXJ0ZXhEYXRhIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkubnVtVmVydGljZXMiLCJBbmltYXRpb25TdWJHZW9tZXRyeS50b3RhbExlbk9mT25lVmVydGV4Il0sIm1hcHBpbmdzIjoiQUFNQSxBQUdBOztHQURHO0lBQ0csb0JBQW9CO0lBMkJ6QkEsU0EzQktBLG9CQUFvQkE7UUFNbEJDLG1CQUFjQSxHQUF3QkEsSUFBSUEsS0FBS0EsQ0FBZ0JBLENBQUNBLENBQUNBLENBQUNBO1FBQ2xFQSxvQkFBZUEsR0FBcUJBLElBQUlBLEtBQUtBLENBQWFBLENBQUNBLENBQUNBLENBQUNBO1FBQzdEQSxrQkFBYUEsR0FBa0JBLElBQUlBLEtBQUtBLENBQVVBLENBQUNBLENBQUNBLENBQUNBO1FBTXJEQSx5QkFBb0JBLEdBQWtCQSxDQUFDQSxDQUFDQTtRQUV4Q0EsaUJBQVlBLEdBQVVBLE1BQU1BLENBQUNBLGlCQUFpQkEsQ0FBQ0E7UUFFL0NBLHVCQUFrQkEsR0FBZ0NBLElBQUlBLEtBQUtBLEVBQXlCQSxDQUFDQTtRQVczRkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBa0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBO1lBQ3hDQSxJQUFJQSxDQUFD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LEdBQUdBLElBQUlBLENBQUNBO0lBQy9CQSxDQUFDQTtJQUVETCxzQkFBV0EsNENBQVVBO2FBQXJCQTtZQUVDTSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBTjtJQUVEQSxzQkFBV0EsNkNBQVdBO2FBQXRCQTtZQUVDTyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBUDtJQUVEQSxzQkFBV0EscURBQW1CQTthQUE5QkE7WUFFQ1EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQTtRQUNsQ0EsQ0FBQ0E7OztPQUFBUjtJQXZGYUEscUNBQWdCQSxHQUFVQSxDQUFDQSxDQUFDQTtJQXdGM0NBLDJCQUFDQTtBQUFEQSxDQTFGQSxBQTBGQ0EsSUFBQTtBQUVELEFBQThCLGlCQUFyQixvQkFBb0IsQ0FBQyIsImZpbGUiOiJhbmltYXRvcnMvZGF0YS9BbmltYXRpb25TdWJHZW9tZXRyeS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL1N0YWdlXCIpO1xyXG5pbXBvcnQgSUNvbnRleHRHTFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lDb250ZXh0R0xcIik7XHJcbmltcG9ydCBJVmVydGV4QnVmZmVyXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lWZXJ0ZXhCdWZmZXJcIik7XHJcblxyXG5pbXBvcnQgUGFydGljbGVBbmltYXRpb25EYXRhXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9kYXRhL1BhcnRpY2xlQW5pbWF0aW9uRGF0YVwiKTtcclxuXHJcbi8qKlxyXG4gKiAuLi5cclxuICovXHJcbmNsYXNzIEFuaW1hdGlvblN1Ykdlb21ldHJ5XHJcbntcclxuXHRwdWJsaWMgc3RhdGljIFNVQkdFT01fSURfQ09VTlQ6bnVtYmVyID0gMDtcclxuXHJcblx0cHVibGljIF9wVmVydGV4RGF0YTpBcnJheTxudW1iZXI+O1xyXG5cclxuXHRwdWJsaWMgX3BWZXJ0ZXhCdWZmZXI6QXJyYXk8SVZlcnRleEJ1ZmZlcj4gPSBuZXcgQXJyYXk8SVZlcnRleEJ1ZmZlcj4oOCk7XHJcblx0cHVibGljIF9wQnVmZmVyQ29udGV4dDpBcnJheTxJQ29udGV4dEdMPiA9IG5ldyBBcnJheTxJQ29udGV4dEdMPig4KTtcclxuXHRwdWJsaWMgX3BCdWZmZXJEaXJ0eTpBcnJheTxib29sZWFuPiA9IG5ldyBBcnJheTxib29sZWFuPig4KTtcclxuXHJcblx0cHJpdmF0ZSBfbnVtVmVydGljZXM6bnVtYmVyIC8qdWludCovO1xyXG5cclxuXHRwcml2YXRlIF90b3RhbExlbk9mT25lVmVydGV4Om51bWJlciAvKnVpbnQqLztcclxuXHJcblx0cHVibGljIG51bVByb2Nlc3NlZFZlcnRpY2VzOm51bWJlciAvKmludCovID0gMDtcclxuXHJcblx0cHVibGljIHByZXZpb3VzVGltZTpudW1iZXIgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XHJcblxyXG5cdHB1YmxpYyBhbmltYXRpb25QYXJ0aWNsZXM6QXJyYXk8UGFydGljbGVBbmltYXRpb25EYXRhPiA9IG5ldyBBcnJheTxQYXJ0aWNsZUFuaW1hdGlvbkRhdGE+KCk7XHJcblxyXG5cdC8qKlxyXG5cdCAqIEFuIGlkIGZvciB0aGlzIGFuaW1hdGlvbiBzdWJnZW9tZXRyeSwgdXNlZCB0byBpZGVudGlmeSBhbmltYXRpb24gc3ViZ2VvbWV0cmllcyB3aGVuIHVzaW5nIGFuaW1hdGlvbiBzZXRzLlxyXG5cdCAqXHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHRwdWJsaWMgX2lVbmlxdWVJZDpudW1iZXI7Ly9BcmNhbmVcclxuXHJcblx0Y29uc3RydWN0b3IoKVxyXG5cdHtcclxuXHRcdGZvciAodmFyIGk6bnVtYmVyIC8qaW50Ki8gPSAwOyBpIDwgODsgaSsrKVxyXG5cdFx0XHR0aGlzLl9wQnVmZmVyRGlydHlbaV0gPSB0cnVlO1xyXG5cclxuXHRcdHRoaXMuX2lVbmlxdWVJZCA9IEFuaW1hdGlvblN1Ykdlb21ldHJ5LlNVQkdFT01fSURfQ09VTlQrKztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBjcmVhdGVWZXJ0ZXhEYXRhKG51bVZlcnRpY2VzOm51bWJlciAvKnVpbnQqLywgdG90YWxMZW5PZk9uZVZlcnRleDpudW1iZXIgLyp1aW50Ki8pXHJcblx0e1xyXG5cdFx0dGhpcy5fbnVtVmVydGljZXMgPSBudW1WZXJ0aWNlcztcclxuXHRcdHRoaXMuX3RvdGFsTGVuT2ZPbmVWZXJ0ZXggPSB0b3RhbExlbk9mT25lVmVydGV4O1xyXG5cdFx0dGhpcy5fcFZlcnRleERhdGEgPSBuZXcgQXJyYXk8bnVtYmVyPihudW1WZXJ0aWNlcyp0b3RhbExlbk9mT25lVmVydGV4KTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBhY3RpdmF0ZVZlcnRleEJ1ZmZlcihpbmRleDpudW1iZXIgLyppbnQqLywgYnVmZmVyT2Zmc2V0Om51bWJlciAvKmludCovLCBzdGFnZTpTdGFnZSwgZm9ybWF0OnN0cmluZylcclxuXHR7XHJcblx0XHR2YXIgY29udGV4dEluZGV4Om51bWJlciAvKmludCovID0gc3RhZ2Uuc3RhZ2VJbmRleDtcclxuXHRcdHZhciBjb250ZXh0OklDb250ZXh0R0wgPSA8SUNvbnRleHRHTD4gc3RhZ2UuY29udGV4dDtcclxuXHJcblx0XHR2YXIgYnVmZmVyOklWZXJ0ZXhCdWZmZXIgPSB0aGlzLl9wVmVydGV4QnVmZmVyW2NvbnRleHRJbmRleF07XHJcblx0XHRpZiAoIWJ1ZmZlciB8fCB0aGlzLl9wQnVmZmVyQ29udGV4dFtjb250ZXh0SW5kZXhdICE9IGNvbnRleHQpIHtcclxuXHRcdFx0YnVmZmVyID0gdGhpcy5fcFZlcnRleEJ1ZmZlcltjb250ZXh0SW5kZXhdID0gY29udGV4dC5jcmVhdGVWZXJ0ZXhCdWZmZXIodGhpcy5fbnVtVmVydGljZXMsIHRoaXMuX3RvdGFsTGVuT2ZPbmVWZXJ0ZXgpO1xyXG5cdFx0XHR0aGlzLl9wQnVmZmVyQ29udGV4dFtjb250ZXh0SW5kZXhdID0gY29udGV4dDtcclxuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0gPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuX3BCdWZmZXJEaXJ0eVtjb250ZXh0SW5kZXhdKSB7XHJcblx0XHRcdGJ1ZmZlci51cGxvYWRGcm9tQXJyYXkodGhpcy5fcFZlcnRleERhdGEsIDAsIHRoaXMuX251bVZlcnRpY2VzKTtcclxuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0gPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdGNvbnRleHQuc2V0VmVydGV4QnVmZmVyQXQoaW5kZXgsIGJ1ZmZlciwgYnVmZmVyT2Zmc2V0LCBmb3JtYXQpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGRpc3Bvc2UoKVxyXG5cdHtcclxuXHRcdHdoaWxlICh0aGlzLl9wVmVydGV4QnVmZmVyLmxlbmd0aCkge1xyXG5cdFx0XHR2YXIgdmVydGV4QnVmZmVyOklWZXJ0ZXhCdWZmZXIgPSB0aGlzLl9wVmVydGV4QnVmZmVyLnBvcCgpXHJcblxyXG5cdFx0XHRpZiAodmVydGV4QnVmZmVyKVxyXG5cdFx0XHRcdHZlcnRleEJ1ZmZlci5kaXNwb3NlKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgaW52YWxpZGF0ZUJ1ZmZlcigpXHJcblx0e1xyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyppbnQqLyA9IDA7IGkgPCA4OyBpKyspXHJcblx0XHRcdHRoaXMuX3BCdWZmZXJEaXJ0eVtpXSA9IHRydWU7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IHZlcnRleERhdGEoKTpBcnJheTxudW1iZXI+XHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX3BWZXJ0ZXhEYXRhO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldCBudW1WZXJ0aWNlcygpOm51bWJlciAvKnVpbnQqL1xyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9udW1WZXJ0aWNlcztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgdG90YWxMZW5PZk9uZVZlcnRleCgpOm51bWJlciAvKnVpbnQqL1xyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl90b3RhbExlbk9mT25lVmVydGV4O1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0ID0gQW5pbWF0aW9uU3ViR2VvbWV0cnk7Il19