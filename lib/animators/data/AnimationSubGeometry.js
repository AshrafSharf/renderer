/**
 * ...
 */
var AnimationSubGeometry = (function () {
    function AnimationSubGeometry() {
        this._pVertexBuffer = new Array(8);
        this._pBufferContext = new Array(8);
        this._pBufferDirty = new Array(8);
        this.numProcessedVertices = 0;
        this.previousTime = Number.NEGATIVE_INFINITY;
        this.animationParticles = new Array();
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
        this._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;
    }
    AnimationSubGeometry.prototype.createVertexData = function (numVertices /*uint*/, totalLenOfOneVertex /*uint*/) {
        this._numVertices = numVertices;
        this._totalLenOfOneVertex = totalLenOfOneVertex;
        this._pVertexData = new Array(numVertices * totalLenOfOneVertex);
    };
    AnimationSubGeometry.prototype.activateVertexBuffer = function (index /*int*/, bufferOffset /*int*/, stage, format) {
        var contextIndex = stage.stageIndex;
        var context = stage.context;
        var buffer = this._pVertexBuffer[contextIndex];
        if (!buffer || this._pBufferContext[contextIndex] != context) {
            buffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex);
            this._pBufferContext[contextIndex] = context;
            this._pBufferDirty[contextIndex] = true;
        }
        if (this._pBufferDirty[contextIndex]) {
            buffer.uploadFromArray(this._pVertexData, 0, this._numVertices);
            this._pBufferDirty[contextIndex] = false;
        }
        context.setVertexBufferAt(index, buffer, bufferOffset, format);
    };
    AnimationSubGeometry.prototype.dispose = function () {
        while (this._pVertexBuffer.length) {
            var vertexBuffer = this._pVertexBuffer.pop();
            if (vertexBuffer)
                vertexBuffer.dispose();
        }
    };
    AnimationSubGeometry.prototype.invalidateBuffer = function () {
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
    };
    Object.defineProperty(AnimationSubGeometry.prototype, "vertexData", {
        get: function () {
            return this._pVertexData;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "numVertices", {
        get: function () {
            return this._numVertices;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "totalLenOfOneVertex", {
        get: function () {
            return this._totalLenOfOneVertex;
        },
        enumerable: true,
        configurable: true
    });
    AnimationSubGeometry.SUBGEOM_ID_COUNT = 0;
    return AnimationSubGeometry;
})();
module.exports = AnimationSubGeometry;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdG9ycy9kYXRhL2FuaW1hdGlvbnN1Ymdlb21ldHJ5LnRzIl0sIm5hbWVzIjpbIkFuaW1hdGlvblN1Ykdlb21ldHJ5IiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuY29uc3RydWN0b3IiLCJBbmltYXRpb25TdWJHZW9tZXRyeS5jcmVhdGVWZXJ0ZXhEYXRhIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuYWN0aXZhdGVWZXJ0ZXhCdWZmZXIiLCJBbmltYXRpb25TdWJHZW9tZXRyeS5kaXNwb3NlIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuaW52YWxpZGF0ZUJ1ZmZlciIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LnZlcnRleERhdGEiLCJBbmltYXRpb25TdWJHZW9tZXRyeS5udW1WZXJ0aWNlcyIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LnRvdGFsTGVuT2ZPbmVWZXJ0ZXgiXSwibWFwcGluZ3MiOiJBQU1BLEFBR0E7O0dBREc7SUFDRyxvQkFBb0I7SUEyQnpCQSxTQTNCS0Esb0JBQW9CQTtRQU1sQkMsbUJBQWNBLEdBQXdCQSxJQUFJQSxLQUFLQSxDQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDbEVBLG9CQUFlQSxHQUEwQkEsSUFBSUEsS0FBS0EsQ0FBa0JBLENBQUNBLENBQUNBLENBQUNBO1FBQ3ZFQSxrQkFBYUEsR0FBa0JBLElBQUlBLEtBQUtBLENBQVVBLENBQUNBLENBQUNBLENBQUNBO1FBTXJEQSx5QkFBb0JBLEdBQWtCQSxDQUFDQSxDQUFDQTtRQUV4Q0EsaUJBQVlBLEdBQVVBLE1BQU1BLENBQUNBLGlCQUFpQkEsQ0FBQ0E7UUFFL0NBLHVCQUFrQkEsR0FBZ0NBLElBQUlBLEtBQUtBLEVBQXlCQSxDQUFDQTtRQVczRkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBa0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBO1lBQ3hDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUU5QkEsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0Esb0JBQW9CQSxDQUFDQSxnQkFBZ0JBLEVBQUVBLENBQUNBO0lBQzNEQSxDQUFDQTtJQUVNRCwrQ0FBZ0JBLEdBQXZCQSxVQUF3QkEsV0FBV0EsQ0FBUUEsUUFBREEsQUFBU0EsRUFBRUEsbUJBQW1CQSxDQUFRQSxRQUFEQSxBQUFTQTtRQUV2RkUsSUFBSUEsQ0FBQ0EsWUFBWUEsR0FBR0EsV0FBV0EsQ0FBQ0E7UUFDaENBLElBQUlBLENBQUNBLG9CQUFvQkEsR0FBR0EsbUJBQW1CQSxDQUFDQTtRQUNoREEsSUFBSUEsQ0FBQ0EsWUFBWUEsR0FBR0EsSUFBSUEsS0FBS0EsQ0FBU0EsV0FBV0EsR0FBQ0EsbUJBQW1CQSxDQUFDQSxDQUFDQTtJQUN4RUEsQ0FBQ0E7SUFFTUYsbURBQW9CQSxHQUEzQkEsVUFBNEJBLEtBQUtBLENBQVFBLE9BQURBLEFBQVFBLEVBQUVBLFlBQVlBLENBQVFBLE9BQURBLEFBQVFBLEVBQUVBLEtBQVdBLEVBQUVBLE1BQWFBO1FBRXhHRyxJQUFJQSxZQUFZQSxHQUFrQkEsS0FBS0EsQ0FBQ0EsVUFBVUEsQ0FBQ0E7UUFDbkRBLElBQUlBLE9BQU9BLEdBQXFDQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQTtRQUU5REEsSUFBSUEsTUFBTUEsR0FBaUJBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBO1FBQzdEQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxNQUFNQSxJQUFJQSxJQUFJQSxDQUFDQSxlQUFlQSxDQUFDQSxZQUFZQSxDQUFDQSxJQUFJQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUM5REEsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsT0FBT0EsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxFQUFFQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBO1lBQ3RIQSxJQUFJQSxDQUFDQSxlQUFlQSxDQUFDQSxZQUFZQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQTtZQUM3Q0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDekNBLENBQUNBO1FBQ0RBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ3RDQSxNQUFNQSxDQUFDQSxlQUFlQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQTtZQUNoRUEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7UUFDMUNBLENBQUNBO1FBQ0RBLE9BQU9BLENBQUNBLGlCQUFpQkEsQ0FBQ0EsS0FBS0EsRUFBRUEsTUFBTUEsRUFBRUEsWUFBWUEsRUFBRUEsTUFBTUEsQ0FBQ0EsQ0FBQ0E7SUFDaEVBLENBQUNBO0lBRU1ILHNDQUFPQSxHQUFkQTtRQUVDSSxPQUFPQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQTtZQUNuQ0EsSUFBSUEsWUFBWUEsR0FBaUJBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLEdBQUdBLEVBQUVBLENBQUFBO1lBRTFEQSxFQUFFQSxDQUFDQSxDQUFDQSxZQUFZQSxDQUFDQTtnQkFDaEJBLFlBQVlBLENBQUNBLE9BQU9BLEVBQUVBLENBQUNBO1FBQ3pCQSxDQUFDQTtJQUNGQSxDQUFDQTtJQUVNSiwrQ0FBZ0JBLEdBQXZCQTtRQUVDSyxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFrQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUE7WUFDeENBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBO0lBQy9CQSxDQUFDQTtJQUVETCxzQkFBV0EsNENBQVVBO2FBQXJCQTtZQUVDTSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBTjtJQUVEQSxzQkFBV0EsNkNBQVdBO2FBQXRCQTtZQUVDTyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBUDtJQUVEQSxzQkFBV0EscURBQW1CQTthQUE5QkE7WUFFQ1EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQTtRQUNsQ0EsQ0FBQ0E7OztPQUFBUjtJQXZGYUEscUNBQWdCQSxHQUFVQSxDQUFDQSxDQUFDQTtJQXdGM0NBLDJCQUFDQTtBQUFEQSxDQTFGQSxBQTBGQ0EsSUFBQTtBQUVELEFBQThCLGlCQUFyQixvQkFBb0IsQ0FBQyIsImZpbGUiOiJhbmltYXRvcnMvZGF0YS9BbmltYXRpb25TdWJHZW9tZXRyeS5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvcm9iYmF0ZW1hbi9XZWJzdG9ybVByb2plY3RzL2F3YXlqcy1yZW5kZXJlcmdsLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTdGFnZVx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvYmFzZS9TdGFnZVwiKTtcbmltcG9ydCBJQ29udGV4dFN0YWdlR0xcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9JQ29udGV4dFN0YWdlR0xcIik7XG5pbXBvcnQgSVZlcnRleEJ1ZmZlclx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9zdGFnZWdsL0lWZXJ0ZXhCdWZmZXJcIik7XG5cbmltcG9ydCBQYXJ0aWNsZUFuaW1hdGlvbkRhdGFcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvUGFydGljbGVBbmltYXRpb25EYXRhXCIpO1xuXG4vKipcbiAqIC4uLlxuICovXG5jbGFzcyBBbmltYXRpb25TdWJHZW9tZXRyeVxue1xuXHRwdWJsaWMgc3RhdGljIFNVQkdFT01fSURfQ09VTlQ6bnVtYmVyID0gMDtcblxuXHRwdWJsaWMgX3BWZXJ0ZXhEYXRhOkFycmF5PG51bWJlcj47XG5cblx0cHVibGljIF9wVmVydGV4QnVmZmVyOkFycmF5PElWZXJ0ZXhCdWZmZXI+ID0gbmV3IEFycmF5PElWZXJ0ZXhCdWZmZXI+KDgpO1xuXHRwdWJsaWMgX3BCdWZmZXJDb250ZXh0OkFycmF5PElDb250ZXh0U3RhZ2VHTD4gPSBuZXcgQXJyYXk8SUNvbnRleHRTdGFnZUdMPig4KTtcblx0cHVibGljIF9wQnVmZmVyRGlydHk6QXJyYXk8Ym9vbGVhbj4gPSBuZXcgQXJyYXk8Ym9vbGVhbj4oOCk7XG5cblx0cHJpdmF0ZSBfbnVtVmVydGljZXM6bnVtYmVyIC8qdWludCovO1xuXG5cdHByaXZhdGUgX3RvdGFsTGVuT2ZPbmVWZXJ0ZXg6bnVtYmVyIC8qdWludCovO1xuXG5cdHB1YmxpYyBudW1Qcm9jZXNzZWRWZXJ0aWNlczpudW1iZXIgLyppbnQqLyA9IDA7XG5cblx0cHVibGljIHByZXZpb3VzVGltZTpudW1iZXIgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFk7XG5cblx0cHVibGljIGFuaW1hdGlvblBhcnRpY2xlczpBcnJheTxQYXJ0aWNsZUFuaW1hdGlvbkRhdGE+ID0gbmV3IEFycmF5PFBhcnRpY2xlQW5pbWF0aW9uRGF0YT4oKTtcblxuXHQvKipcblx0ICogQW4gaWQgZm9yIHRoaXMgYW5pbWF0aW9uIHN1Ymdlb21ldHJ5LCB1c2VkIHRvIGlkZW50aWZ5IGFuaW1hdGlvbiBzdWJnZW9tZXRyaWVzIHdoZW4gdXNpbmcgYW5pbWF0aW9uIHNldHMuXG5cdCAqXG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRwdWJsaWMgX2lVbmlxdWVJZDpudW1iZXI7Ly9BcmNhbmVcblxuXHRjb25zdHJ1Y3RvcigpXG5cdHtcblx0XHRmb3IgKHZhciBpOm51bWJlciAvKmludCovID0gMDsgaSA8IDg7IGkrKylcblx0XHRcdHRoaXMuX3BCdWZmZXJEaXJ0eVtpXSA9IHRydWU7XG5cblx0XHR0aGlzLl9pVW5pcXVlSWQgPSBBbmltYXRpb25TdWJHZW9tZXRyeS5TVUJHRU9NX0lEX0NPVU5UKys7XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlVmVydGV4RGF0YShudW1WZXJ0aWNlczpudW1iZXIgLyp1aW50Ki8sIHRvdGFsTGVuT2ZPbmVWZXJ0ZXg6bnVtYmVyIC8qdWludCovKVxuXHR7XG5cdFx0dGhpcy5fbnVtVmVydGljZXMgPSBudW1WZXJ0aWNlcztcblx0XHR0aGlzLl90b3RhbExlbk9mT25lVmVydGV4ID0gdG90YWxMZW5PZk9uZVZlcnRleDtcblx0XHR0aGlzLl9wVmVydGV4RGF0YSA9IG5ldyBBcnJheTxudW1iZXI+KG51bVZlcnRpY2VzKnRvdGFsTGVuT2ZPbmVWZXJ0ZXgpO1xuXHR9XG5cblx0cHVibGljIGFjdGl2YXRlVmVydGV4QnVmZmVyKGluZGV4Om51bWJlciAvKmludCovLCBidWZmZXJPZmZzZXQ6bnVtYmVyIC8qaW50Ki8sIHN0YWdlOlN0YWdlLCBmb3JtYXQ6c3RyaW5nKVxuXHR7XG5cdFx0dmFyIGNvbnRleHRJbmRleDpudW1iZXIgLyppbnQqLyA9IHN0YWdlLnN0YWdlSW5kZXg7XG5cdFx0dmFyIGNvbnRleHQ6SUNvbnRleHRTdGFnZUdMID0gPElDb250ZXh0U3RhZ2VHTD4gc3RhZ2UuY29udGV4dDtcblxuXHRcdHZhciBidWZmZXI6SVZlcnRleEJ1ZmZlciA9IHRoaXMuX3BWZXJ0ZXhCdWZmZXJbY29udGV4dEluZGV4XTtcblx0XHRpZiAoIWJ1ZmZlciB8fCB0aGlzLl9wQnVmZmVyQ29udGV4dFtjb250ZXh0SW5kZXhdICE9IGNvbnRleHQpIHtcblx0XHRcdGJ1ZmZlciA9IHRoaXMuX3BWZXJ0ZXhCdWZmZXJbY29udGV4dEluZGV4XSA9IGNvbnRleHQuY3JlYXRlVmVydGV4QnVmZmVyKHRoaXMuX251bVZlcnRpY2VzLCB0aGlzLl90b3RhbExlbk9mT25lVmVydGV4KTtcblx0XHRcdHRoaXMuX3BCdWZmZXJDb250ZXh0W2NvbnRleHRJbmRleF0gPSBjb250ZXh0O1xuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0gPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0pIHtcblx0XHRcdGJ1ZmZlci51cGxvYWRGcm9tQXJyYXkodGhpcy5fcFZlcnRleERhdGEsIDAsIHRoaXMuX251bVZlcnRpY2VzKTtcblx0XHRcdHRoaXMuX3BCdWZmZXJEaXJ0eVtjb250ZXh0SW5kZXhdID0gZmFsc2U7XG5cdFx0fVxuXHRcdGNvbnRleHQuc2V0VmVydGV4QnVmZmVyQXQoaW5kZXgsIGJ1ZmZlciwgYnVmZmVyT2Zmc2V0LCBmb3JtYXQpO1xuXHR9XG5cblx0cHVibGljIGRpc3Bvc2UoKVxuXHR7XG5cdFx0d2hpbGUgKHRoaXMuX3BWZXJ0ZXhCdWZmZXIubGVuZ3RoKSB7XG5cdFx0XHR2YXIgdmVydGV4QnVmZmVyOklWZXJ0ZXhCdWZmZXIgPSB0aGlzLl9wVmVydGV4QnVmZmVyLnBvcCgpXG5cblx0XHRcdGlmICh2ZXJ0ZXhCdWZmZXIpXG5cdFx0XHRcdHZlcnRleEJ1ZmZlci5kaXNwb3NlKCk7XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIGludmFsaWRhdGVCdWZmZXIoKVxuXHR7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyppbnQqLyA9IDA7IGkgPCA4OyBpKyspXG5cdFx0XHR0aGlzLl9wQnVmZmVyRGlydHlbaV0gPSB0cnVlO1xuXHR9XG5cblx0cHVibGljIGdldCB2ZXJ0ZXhEYXRhKCk6QXJyYXk8bnVtYmVyPlxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3BWZXJ0ZXhEYXRhO1xuXHR9XG5cblx0cHVibGljIGdldCBudW1WZXJ0aWNlcygpOm51bWJlciAvKnVpbnQqL1xuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX251bVZlcnRpY2VzO1xuXHR9XG5cblx0cHVibGljIGdldCB0b3RhbExlbk9mT25lVmVydGV4KCk6bnVtYmVyIC8qdWludCovXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fdG90YWxMZW5PZk9uZVZlcnRleDtcblx0fVxufVxuXG5leHBvcnQgPSBBbmltYXRpb25TdWJHZW9tZXRyeTsiXX0=