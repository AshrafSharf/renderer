/**
 * ...
 */
var AnimationSubGeometry = (function () {
    function AnimationSubGeometry() {
        this._pVertexBuffer = new Array(8);
        this._pBufferContext = new Array(8);
        this._pBufferDirty = new Array(8);
        this.numProcessedVertices = 0;
        this.previousTime = Number.NEGATIVE_INFINITY;
        this.animationParticles = new Array();
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
        this._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;
    }
    AnimationSubGeometry.prototype.createVertexData = function (numVertices /*uint*/, totalLenOfOneVertex /*uint*/) {
        this._numVertices = numVertices;
        this._totalLenOfOneVertex = totalLenOfOneVertex;
        this._pVertexData = new Array(numVertices * totalLenOfOneVertex);
    };
    AnimationSubGeometry.prototype.activateVertexBuffer = function (index /*int*/, bufferOffset /*int*/, stage, format) {
        var contextIndex = stage.stageIndex;
        var context = stage.context;
        var buffer = this._pVertexBuffer[contextIndex];
        if (!buffer || this._pBufferContext[contextIndex] != context) {
            buffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex);
            this._pBufferContext[contextIndex] = context;
            this._pBufferDirty[contextIndex] = true;
        }
        if (this._pBufferDirty[contextIndex]) {
            buffer.uploadFromArray(this._pVertexData, 0, this._numVertices);
            this._pBufferDirty[contextIndex] = false;
        }
        context.setVertexBufferAt(index, buffer, bufferOffset, format);
    };
    AnimationSubGeometry.prototype.dispose = function () {
        while (this._pVertexBuffer.length) {
            var vertexBuffer = this._pVertexBuffer.pop();
            if (vertexBuffer)
                vertexBuffer.dispose();
        }
    };
    AnimationSubGeometry.prototype.invalidateBuffer = function () {
        for (var i = 0; i < 8; i++)
            this._pBufferDirty[i] = true;
    };
    Object.defineProperty(AnimationSubGeometry.prototype, "vertexData", {
        get: function () {
            return this._pVertexData;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "numVertices", {
        get: function () {
            return this._numVertices;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AnimationSubGeometry.prototype, "totalLenOfOneVertex", {
        get: function () {
            return this._totalLenOfOneVertex;
        },
        enumerable: true,
        configurable: true
    });
    AnimationSubGeometry.SUBGEOM_ID_COUNT = 0;
    return AnimationSubGeometry;
})();
module.exports = AnimationSubGeometry;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9BbmltYXRpb25TdWJHZW9tZXRyeS50cyJdLCJuYW1lcyI6WyJBbmltYXRpb25TdWJHZW9tZXRyeSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmNvbnN0cnVjdG9yIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuY3JlYXRlVmVydGV4RGF0YSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkuZGlzcG9zZSIsIkFuaW1hdGlvblN1Ykdlb21ldHJ5LmludmFsaWRhdGVCdWZmZXIiLCJBbmltYXRpb25TdWJHZW9tZXRyeS52ZXJ0ZXhEYXRhIiwiQW5pbWF0aW9uU3ViR2VvbWV0cnkubnVtVmVydGljZXMiLCJBbmltYXRpb25TdWJHZW9tZXRyeS50b3RhbExlbk9mT25lVmVydGV4Il0sIm1hcHBpbmdzIjoiQUFNQSxBQUdBOztHQURHO0lBQ0csb0JBQW9CO0lBMkJ6QkEsU0EzQktBLG9CQUFvQkE7UUFNbEJDLG1CQUFjQSxHQUF3QkEsSUFBSUEsS0FBS0EsQ0FBZ0JBLENBQUNBLENBQUNBLENBQUNBO1FBQ2xFQSxvQkFBZUEsR0FBcUJBLElBQUlBLEtBQUtBLENBQWFBLENBQUNBLENBQUNBLENBQUNBO1FBQzdEQSxrQkFBYUEsR0FBa0JBLElBQUlBLEtBQUtBLENBQVVBLENBQUNBLENBQUNBLENBQUNBO1FBTXJEQSx5QkFBb0JBLEdBQWtCQSxDQUFDQSxDQUFDQTtRQUV4Q0EsaUJBQVlBLEdBQVVBLE1BQU1BLENBQUNBLGlCQUFpQkEsQ0FBQ0E7UUFFL0NBLHVCQUFrQkEsR0FBZ0NBLElBQUlBLEtBQUtBLEVBQXlCQSxDQUFDQTtRQVczRkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBa0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBO1lBQ3hDQSxJQUFJQSxDQUFD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LEdBQUdBLElBQUlBLENBQUNBO0lBQy9CQSxDQUFDQTtJQUVETCxzQkFBV0EsNENBQVVBO2FBQXJCQTtZQUVDTSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBTjtJQUVEQSxzQkFBV0EsNkNBQVdBO2FBQXRCQTtZQUVDTyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQUFBUDtJQUVEQSxzQkFBV0EscURBQW1CQTthQUE5QkE7WUFFQ1EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQTtRQUNsQ0EsQ0FBQ0E7OztPQUFBUjtJQXZGYUEscUNBQWdCQSxHQUFVQSxDQUFDQSxDQUFDQTtJQXdGM0NBLDJCQUFDQTtBQUFEQSxDQTFGQSxBQTBGQ0EsSUFBQTtBQUVELEFBQThCLGlCQUFyQixvQkFBb0IsQ0FBQyIsImZpbGUiOiJhbmltYXRvcnMvZGF0YS9BbmltYXRpb25TdWJHZW9tZXRyeS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL1N0YWdlXCIpO1xuaW1wb3J0IElDb250ZXh0R0xcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9JQ29udGV4dEdMXCIpO1xuaW1wb3J0IElWZXJ0ZXhCdWZmZXJcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvSVZlcnRleEJ1ZmZlclwiKTtcblxuaW1wb3J0IFBhcnRpY2xlQW5pbWF0aW9uRGF0YVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9QYXJ0aWNsZUFuaW1hdGlvbkRhdGFcIik7XG5cbi8qKlxuICogLi4uXG4gKi9cbmNsYXNzIEFuaW1hdGlvblN1Ykdlb21ldHJ5XG57XG5cdHB1YmxpYyBzdGF0aWMgU1VCR0VPTV9JRF9DT1VOVDpudW1iZXIgPSAwO1xuXG5cdHB1YmxpYyBfcFZlcnRleERhdGE6QXJyYXk8bnVtYmVyPjtcblxuXHRwdWJsaWMgX3BWZXJ0ZXhCdWZmZXI6QXJyYXk8SVZlcnRleEJ1ZmZlcj4gPSBuZXcgQXJyYXk8SVZlcnRleEJ1ZmZlcj4oOCk7XG5cdHB1YmxpYyBfcEJ1ZmZlckNvbnRleHQ6QXJyYXk8SUNvbnRleHRHTD4gPSBuZXcgQXJyYXk8SUNvbnRleHRHTD4oOCk7XG5cdHB1YmxpYyBfcEJ1ZmZlckRpcnR5OkFycmF5PGJvb2xlYW4+ID0gbmV3IEFycmF5PGJvb2xlYW4+KDgpO1xuXG5cdHByaXZhdGUgX251bVZlcnRpY2VzOm51bWJlciAvKnVpbnQqLztcblxuXHRwcml2YXRlIF90b3RhbExlbk9mT25lVmVydGV4Om51bWJlciAvKnVpbnQqLztcblxuXHRwdWJsaWMgbnVtUHJvY2Vzc2VkVmVydGljZXM6bnVtYmVyIC8qaW50Ki8gPSAwO1xuXG5cdHB1YmxpYyBwcmV2aW91c1RpbWU6bnVtYmVyID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO1xuXG5cdHB1YmxpYyBhbmltYXRpb25QYXJ0aWNsZXM6QXJyYXk8UGFydGljbGVBbmltYXRpb25EYXRhPiA9IG5ldyBBcnJheTxQYXJ0aWNsZUFuaW1hdGlvbkRhdGE+KCk7XG5cblx0LyoqXG5cdCAqIEFuIGlkIGZvciB0aGlzIGFuaW1hdGlvbiBzdWJnZW9tZXRyeSwgdXNlZCB0byBpZGVudGlmeSBhbmltYXRpb24gc3ViZ2VvbWV0cmllcyB3aGVuIHVzaW5nIGFuaW1hdGlvbiBzZXRzLlxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0cHVibGljIF9pVW5pcXVlSWQ6bnVtYmVyOy8vQXJjYW5lXG5cblx0Y29uc3RydWN0b3IoKVxuXHR7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyppbnQqLyA9IDA7IGkgPCA4OyBpKyspXG5cdFx0XHR0aGlzLl9wQnVmZmVyRGlydHlbaV0gPSB0cnVlO1xuXG5cdFx0dGhpcy5faVVuaXF1ZUlkID0gQW5pbWF0aW9uU3ViR2VvbWV0cnkuU1VCR0VPTV9JRF9DT1VOVCsrO1xuXHR9XG5cblx0cHVibGljIGNyZWF0ZVZlcnRleERhdGEobnVtVmVydGljZXM6bnVtYmVyIC8qdWludCovLCB0b3RhbExlbk9mT25lVmVydGV4Om51bWJlciAvKnVpbnQqLylcblx0e1xuXHRcdHRoaXMuX251bVZlcnRpY2VzID0gbnVtVmVydGljZXM7XG5cdFx0dGhpcy5fdG90YWxMZW5PZk9uZVZlcnRleCA9IHRvdGFsTGVuT2ZPbmVWZXJ0ZXg7XG5cdFx0dGhpcy5fcFZlcnRleERhdGEgPSBuZXcgQXJyYXk8bnVtYmVyPihudW1WZXJ0aWNlcyp0b3RhbExlbk9mT25lVmVydGV4KTtcblx0fVxuXG5cdHB1YmxpYyBhY3RpdmF0ZVZlcnRleEJ1ZmZlcihpbmRleDpudW1iZXIgLyppbnQqLywgYnVmZmVyT2Zmc2V0Om51bWJlciAvKmludCovLCBzdGFnZTpTdGFnZSwgZm9ybWF0OnN0cmluZylcblx0e1xuXHRcdHZhciBjb250ZXh0SW5kZXg6bnVtYmVyIC8qaW50Ki8gPSBzdGFnZS5zdGFnZUluZGV4O1xuXHRcdHZhciBjb250ZXh0OklDb250ZXh0R0wgPSA8SUNvbnRleHRHTD4gc3RhZ2UuY29udGV4dDtcblxuXHRcdHZhciBidWZmZXI6SVZlcnRleEJ1ZmZlciA9IHRoaXMuX3BWZXJ0ZXhCdWZmZXJbY29udGV4dEluZGV4XTtcblx0XHRpZiAoIWJ1ZmZlciB8fCB0aGlzLl9wQnVmZmVyQ29udGV4dFtjb250ZXh0SW5kZXhdICE9IGNvbnRleHQpIHtcblx0XHRcdGJ1ZmZlciA9IHRoaXMuX3BWZXJ0ZXhCdWZmZXJbY29udGV4dEluZGV4XSA9IGNvbnRleHQuY3JlYXRlVmVydGV4QnVmZmVyKHRoaXMuX251bVZlcnRpY2VzLCB0aGlzLl90b3RhbExlbk9mT25lVmVydGV4KTtcblx0XHRcdHRoaXMuX3BCdWZmZXJDb250ZXh0W2NvbnRleHRJbmRleF0gPSBjb250ZXh0O1xuXHRcdFx0dGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0gPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fcEJ1ZmZlckRpcnR5W2NvbnRleHRJbmRleF0pIHtcblx0XHRcdGJ1ZmZlci51cGxvYWRGcm9tQXJyYXkodGhpcy5fcFZlcnRleERhdGEsIDAsIHRoaXMuX251bVZlcnRpY2VzKTtcblx0XHRcdHRoaXMuX3BCdWZmZXJEaXJ0eVtjb250ZXh0SW5kZXhdID0gZmFsc2U7XG5cdFx0fVxuXHRcdGNvbnRleHQuc2V0VmVydGV4QnVmZmVyQXQoaW5kZXgsIGJ1ZmZlciwgYnVmZmVyT2Zmc2V0LCBmb3JtYXQpO1xuXHR9XG5cblx0cHVibGljIGRpc3Bvc2UoKVxuXHR7XG5cdFx0d2hpbGUgKHRoaXMuX3BWZXJ0ZXhCdWZmZXIubGVuZ3RoKSB7XG5cdFx0XHR2YXIgdmVydGV4QnVmZmVyOklWZXJ0ZXhCdWZmZXIgPSB0aGlzLl9wVmVydGV4QnVmZmVyLnBvcCgpXG5cblx0XHRcdGlmICh2ZXJ0ZXhCdWZmZXIpXG5cdFx0XHRcdHZlcnRleEJ1ZmZlci5kaXNwb3NlKCk7XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIGludmFsaWRhdGVCdWZmZXIoKVxuXHR7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyppbnQqLyA9IDA7IGkgPCA4OyBpKyspXG5cdFx0XHR0aGlzLl9wQnVmZmVyRGlydHlbaV0gPSB0cnVlO1xuXHR9XG5cblx0cHVibGljIGdldCB2ZXJ0ZXhEYXRhKCk6QXJyYXk8bnVtYmVyPlxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3BWZXJ0ZXhEYXRhO1xuXHR9XG5cblx0cHVibGljIGdldCBudW1WZXJ0aWNlcygpOm51bWJlciAvKnVpbnQqL1xuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX251bVZlcnRpY2VzO1xuXHR9XG5cblx0cHVibGljIGdldCB0b3RhbExlbk9mT25lVmVydGV4KCk6bnVtYmVyIC8qdWludCovXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fdG90YWxMZW5PZk9uZVZlcnRleDtcblx0fVxufVxuXG5leHBvcnQgPSBBbmltYXRpb25TdWJHZW9tZXRyeTsiXX0=