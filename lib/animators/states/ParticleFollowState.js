var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var MathConsts = require("awayjs-core/lib/geom/MathConsts");
var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var ContextGLVertexBufferFormat = require("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");
var ParticleStateBase = require("awayjs-renderergl/lib/animators/states/ParticleStateBase");
/**
 * ...
 */
var ParticleFollowState = (function (_super) {
    __extends(ParticleFollowState, _super);
    function ParticleFollowState(animator, particleFollowNode) {
        _super.call(this, animator, particleFollowNode, true);
        this._targetPos = new Vector3D();
        this._targetEuler = new Vector3D();
        //temporary vector3D for calculation
        this._temp = new Vector3D();
        this._particleFollowNode = particleFollowNode;
        this._smooth = particleFollowNode._iSmooth;
    }
    Object.defineProperty(ParticleFollowState.prototype, "followTarget", {
        get: function () {
            return this._followTarget;
        },
        set: function (value) {
            this._followTarget = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParticleFollowState.prototype, "smooth", {
        get: function () {
            return this._smooth;
        },
        set: function (value) {
            this._smooth = value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @inheritDoc
     */
    ParticleFollowState.prototype.setRenderState = function (stage, renderable, animationSubGeometry, animationRegisterCache, camera) {
        if (this._followTarget) {
            if (this._particleFollowNode._iUsesPosition) {
                this._targetPos.x = this._followTarget.transform.position.x / renderable.sourceEntity.scaleX;
                this._targetPos.y = this._followTarget.transform.position.y / renderable.sourceEntity.scaleY;
                this._targetPos.z = this._followTarget.transform.position.z / renderable.sourceEntity.scaleZ;
            }
            if (this._particleFollowNode._iUsesRotation) {
                this._targetEuler.x = this._followTarget.rotationX;
                this._targetEuler.y = this._followTarget.rotationY;
                this._targetEuler.z = this._followTarget.rotationZ;
                this._targetEuler.scaleBy(MathConsts.DEGREES_TO_RADIANS);
            }
        }
        //initialization
        if (!this._prePos)
            this._prePos = this._targetPos.clone();
        if (!this._preEuler)
            this._preEuler = this._targetEuler.clone();
        var currentTime = this._pTime / 1000;
        var previousTime = animationSubGeometry.previousTime;
        var deltaTime = currentTime - previousTime;
        var needProcess = previousTime != currentTime;
        if (this._particleFollowNode._iUsesPosition && this._particleFollowNode._iUsesRotation) {
            if (needProcess)
                this.processPositionAndRotation(currentTime, deltaTime, animationSubGeometry);
            animationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);
            animationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);
        }
        else if (this._particleFollowNode._iUsesPosition) {
            if (needProcess)
                this.processPosition(currentTime, deltaTime, animationSubGeometry);
            animationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);
        }
        else if (this._particleFollowNode._iUsesRotation) {
            if (needProcess)
                this.precessRotation(currentTime, deltaTime, animationSubGeometry);
            animationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);
        }
        this._prePos.copyFrom(this._targetPos);
        this._targetEuler.copyFrom(this._targetEuler);
        animationSubGeometry.previousTime = currentTime;
    };
    ParticleFollowState.prototype.processPosition = function (currentTime, deltaTime, animationSubGeometry) {
        var data = animationSubGeometry.animationParticles;
        var vertexData = animationSubGeometry.vertexData;
        var changed = false;
        var len = data.length;
        var interpolatedPos;
        var posVelocity;
        if (this._smooth) {
            posVelocity = this._prePos.subtract(this._targetPos);
            posVelocity.scaleBy(1 / deltaTime);
        }
        else
            interpolatedPos = this._targetPos;
        for (var i = 0; i < len; i++) {
            var k = (currentTime - data[i].startTime) / data[i].totalTime;
            var t = (k - Math.floor(k)) * data[i].totalTime;
            if (t - deltaTime <= 0) {
                var inc = data[i].startVertexIndex * animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;
                if (this._smooth) {
                    this._temp.copyFrom(posVelocity);
                    this._temp.scaleBy(t);
                    interpolatedPos = this._targetPos.add(this._temp);
                }
                if (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z) {
                    changed = true;
                    for (var j = 0; j < data[i].numVertices; j++) {
                        vertexData[inc++] = interpolatedPos.x;
                        vertexData[inc++] = interpolatedPos.y;
                        vertexData[inc++] = interpolatedPos.z;
                    }
                }
            }
        }
        if (changed)
            animationSubGeometry.invalidateBuffer();
    };
    ParticleFollowState.prototype.precessRotation = function (currentTime, deltaTime, animationSubGeometry) {
        var data = animationSubGeometry.animationParticles;
        var vertexData = animationSubGeometry.vertexData;
        var changed = false;
        var len = data.length;
        var interpolatedRotation;
        var rotationVelocity;
        if (this._smooth) {
            rotationVelocity = this._preEuler.subtract(this._targetEuler);
            rotationVelocity.scaleBy(1 / deltaTime);
        }
        else
            interpolatedRotation = this._targetEuler;
        for (var i = 0; i < len; i++) {
            var k = (currentTime - data[i].startTime) / data[i].totalTime;
            var t = (k - Math.floor(k)) * data[i].totalTime;
            if (t - deltaTime <= 0) {
                var inc = data[i].startVertexIndex * animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;
                if (this._smooth) {
                    this._temp.copyFrom(rotationVelocity);
                    this._temp.scaleBy(t);
                    interpolatedRotation = this._targetEuler.add(this._temp);
                }
                if (vertexData[inc] != interpolatedRotation.x || vertexData[inc + 1] != interpolatedRotation.y || vertexData[inc + 2] != interpolatedRotation.z) {
                    changed = true;
                    for (var j = 0; j < data[i].numVertices; j++) {
                        vertexData[inc++] = interpolatedRotation.x;
                        vertexData[inc++] = interpolatedRotation.y;
                        vertexData[inc++] = interpolatedRotation.z;
                    }
                }
            }
        }
        if (changed)
            animationSubGeometry.invalidateBuffer();
    };
    ParticleFollowState.prototype.processPositionAndRotation = function (currentTime, deltaTime, animationSubGeometry) {
        var data = animationSubGeometry.animationParticles;
        var vertexData = animationSubGeometry.vertexData;
        var changed = false;
        var len = data.length;
        var interpolatedPos;
        var interpolatedRotation;
        var posVelocity;
        var rotationVelocity;
        if (this._smooth) {
            posVelocity = this._prePos.subtract(this._targetPos);
            posVelocity.scaleBy(1 / deltaTime);
            rotationVelocity = this._preEuler.subtract(this._targetEuler);
            rotationVelocity.scaleBy(1 / deltaTime);
        }
        else {
            interpolatedPos = this._targetPos;
            interpolatedRotation = this._targetEuler;
        }
        for (var i = 0; i < len; i++) {
            var k = (currentTime - data[i].startTime) / data[i].totalTime;
            var t = (k - Math.floor(k)) * data[i].totalTime;
            if (t - deltaTime <= 0) {
                var inc = data[i].startVertexIndex * animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;
                if (this._smooth) {
                    this._temp.copyFrom(posVelocity);
                    this._temp.scaleBy(t);
                    interpolatedPos = this._targetPos.add(this._temp);
                    this._temp.copyFrom(rotationVelocity);
                    this._temp.scaleBy(t);
                    interpolatedRotation = this._targetEuler.add(this._temp);
                }
                if (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z || vertexData[inc + 3] != interpolatedRotation.x || vertexData[inc + 4] != interpolatedRotation.y || vertexData[inc + 5] != interpolatedRotation.z) {
                    changed = true;
                    for (var j = 0; j < data[i].numVertices; j++) {
                        vertexData[inc++] = interpolatedPos.x;
                        vertexData[inc++] = interpolatedPos.y;
                        vertexData[inc++] = interpolatedPos.z;
                        vertexData[inc++] = interpolatedRotation.x;
                        vertexData[inc++] = interpolatedRotation.y;
                        vertexData[inc++] = interpolatedRotation.z;
                    }
                }
            }
        }
        if (changed)
            animationSubGeometry.invalidateBuffer();
    };
    /** @private */
    ParticleFollowState.FOLLOW_POSITION_INDEX = 0;
    /** @private */
    ParticleFollowState.FOLLOW_ROTATION_INDEX = 1;
    return ParticleFollowState;
})(ParticleStateBase);
module.exports = ParticleFollowState;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvc3RhdGVzL1BhcnRpY2xlRm9sbG93U3RhdGUudHMiXSwibmFtZXMiOlsiUGFydGljbGVGb2xsb3dTdGF0ZSIsIlBhcnRpY2xlRm9sbG93U3RhdGUuY29uc3RydWN0b3IiLCJQYXJ0aWNsZUZvbGxvd1N0YXRlLmZvbGxvd1RhcmdldCIsIlBhcnRpY2xlRm9sbG93U3RhdGUuc21vb3RoIiwiUGFydGljbGVGb2xsb3dTdGF0ZS5zZXRSZW5kZXJTdGF0ZSIsIlBhcnRpY2xlRm9sbG93U3RhdGUucHJvY2Vzc1Bvc2l0aW9uIiwiUGFydGljbGVGb2xsb3dTdGF0ZS5wcmVjZXNzUm90YXRpb24iLCJQYXJ0aWNsZUZvbGxvd1N0YXRlLnByb2Nlc3NQb3NpdGlvbkFuZFJvdGF0aW9uIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLFVBQVUsV0FBZ0IsaUNBQWlDLENBQUMsQ0FBQztBQUNwRSxJQUFPLFFBQVEsV0FBaUIsK0JBQStCLENBQUMsQ0FBQztBQU1qRSxJQUFPLDJCQUEyQixXQUFZLHFEQUFxRCxDQUFDLENBQUM7QUFPckcsSUFBTyxpQkFBaUIsV0FBYywwREFBMEQsQ0FBQyxDQUFDO0FBR2xHLEFBR0E7O0dBREc7SUFDRyxtQkFBbUI7SUFBU0EsVUFBNUJBLG1CQUFtQkEsVUFBMEJBO0lBb0JsREEsU0FwQktBLG1CQUFtQkEsQ0FvQlpBLFFBQXlCQSxFQUFFQSxrQkFBcUNBO1FBRTNFQyxrQkFBTUEsUUFBUUEsRUFBRUEsa0JBQWtCQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtRQVhuQ0EsZUFBVUEsR0FBWUEsSUFBSUEsUUFBUUEsRUFBRUEsQ0FBQ0E7UUFDckNBLGlCQUFZQSxHQUFZQSxJQUFJQSxRQUFRQSxFQUFFQSxDQUFDQTtRQUsvQ0Esb0NBQW9DQTtRQUM1QkEsVUFBS0EsR0FBWUEsSUFBSUEsUUFBUUEsRUFBRUEsQ0FBQ0E7UUFNdkNBLElBQUlBLENBQUNBLG1CQUFtQkEsR0FBR0Es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QUFDQSxDQUFDQSxDQUFDQTtvQkFDdEJBLG9CQUFvQkEsR0FBR0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzFEQSxDQUFDQTtnQkFFREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsVUFBVUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsZUFBZUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsVUFBVUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsZUFBZUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsVUFBVUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsZUFBZUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsVUFBVUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsb0JBQW9CQSxDQUFDQSxDQUFDQSxJQUFJQSxVQUFVQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxvQkFBb0JBLENBQUNBLENBQUNBLElBQUlBLFVBQVVBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3JSQSxPQUFPQSxHQUFHQSxJQUFJQSxDQUFDQTtvQkFDZkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBbUJBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLFdBQVdBLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO3dCQUM5REEsVUFBVUEsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsR0FBR0EsZUFBZUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3RDQSxVQUFVQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxHQUFHQSxlQUFlQSxDQUFDQSxDQUFDQSxDQUFDQTt3QkFDdENBLFVBQVVBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLEdBQUdBLGVBQWVBLENBQUNBLENBQUNBLENBQUNBO3dCQUN0Q0EsVUFBVUEsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsR0FBR0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQTt3QkFDM0NBLFVBQVVBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLEdBQUdBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQzNDQSxVQUFVQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxHQUFHQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBO29CQUM1Q0EsQ0FBQ0E7Z0JBQ0ZBLENBQUNBO1lBQ0ZBLENBQUNBO1FBQ0ZBLENBQUNBO1FBQ0RBLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBO1lBQ1hBLG9CQUFvQkEsQ0FBQ0EsZ0JBQWdCQSxFQUFFQSxDQUFDQTtJQUMxQ0EsQ0FBQ0E7SUE3T0RQLGVBQWVBO0lBQ0RBLHlDQUFxQkEsR0FBbUJBLENBQUNBLENBQUNBO0lBRXhEQSxlQUFlQTtJQUNEQSx5Q0FBcUJBLEdBQW1CQSxDQUFDQSxDQUFDQTtJQTJPekRBLDBCQUFDQTtBQUFEQSxDQWpQQSxBQWlQQ0EsRUFqUGlDLGlCQUFpQixFQWlQbEQ7QUFFRCxBQUE2QixpQkFBcEIsbUJBQW1CLENBQUMiLCJmaWxlIjoiYW5pbWF0b3JzL3N0YXRlcy9QYXJ0aWNsZUZvbGxvd1N0YXRlLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBNYXRoQ29uc3RzXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vTWF0aENvbnN0c1wiKTtcclxuaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcclxuXHJcbmltcG9ydCBEaXNwbGF5T2JqZWN0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0Rpc3BsYXlPYmplY3RcIik7XHJcbmltcG9ydCBDYW1lcmFcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9DYW1lcmFcIik7XHJcblxyXG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL1N0YWdlXCIpO1xyXG5pbXBvcnQgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0NvbnRleHRHTFZlcnRleEJ1ZmZlckZvcm1hdFwiKTtcclxuXHJcbmltcG9ydCBQYXJ0aWNsZUFuaW1hdG9yXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvUGFydGljbGVBbmltYXRvclwiKTtcclxuaW1wb3J0IEFuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvQW5pbWF0aW9uUmVnaXN0ZXJDYWNoZVwiKTtcclxuaW1wb3J0IEFuaW1hdGlvblN1Ykdlb21ldHJ5XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvQW5pbWF0aW9uU3ViR2VvbWV0cnlcIik7XHJcbmltcG9ydCBQYXJ0aWNsZUFuaW1hdGlvbkRhdGFcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvUGFydGljbGVBbmltYXRpb25EYXRhXCIpO1xyXG5pbXBvcnQgUGFydGljbGVGb2xsb3dOb2RlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL25vZGVzL1BhcnRpY2xlRm9sbG93Tm9kZVwiKTtcclxuaW1wb3J0IFBhcnRpY2xlU3RhdGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL3N0YXRlcy9QYXJ0aWNsZVN0YXRlQmFzZVwiKTtcclxuaW1wb3J0IFJlbmRlcmFibGVCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9wb29sL1JlbmRlcmFibGVCYXNlXCIpO1xyXG5cclxuLyoqXHJcbiAqIC4uLlxyXG4gKi9cclxuY2xhc3MgUGFydGljbGVGb2xsb3dTdGF0ZSBleHRlbmRzIFBhcnRpY2xlU3RhdGVCYXNlXHJcbntcclxuXHQvKiogQHByaXZhdGUgKi9cclxuXHRwdWJsaWMgc3RhdGljIEZPTExPV19QT1NJVElPTl9JTkRFWDpudW1iZXIgLyp1aW50Ki8gPSAwO1xyXG5cclxuXHQvKiogQHByaXZhdGUgKi9cclxuXHRwdWJsaWMgc3RhdGljIEZPTExPV19ST1RBVElPTl9JTkRFWDpudW1iZXIgLyp1aW50Ki8gPSAxO1xyXG5cclxuXHRwcml2YXRlIF9wYXJ0aWNsZUZvbGxvd05vZGU6UGFydGljbGVGb2xsb3dOb2RlO1xyXG5cdHByaXZhdGUgX2ZvbGxvd1RhcmdldDpEaXNwbGF5T2JqZWN0O1xyXG5cclxuXHRwcml2YXRlIF90YXJnZXRQb3M6VmVjdG9yM0QgPSBuZXcgVmVjdG9yM0QoKTtcclxuXHRwcml2YXRlIF90YXJnZXRFdWxlcjpWZWN0b3IzRCA9IG5ldyBWZWN0b3IzRCgpO1xyXG5cdHByaXZhdGUgX3ByZVBvczpWZWN0b3IzRDtcclxuXHRwcml2YXRlIF9wcmVFdWxlcjpWZWN0b3IzRDtcclxuXHRwcml2YXRlIF9zbW9vdGg6Ym9vbGVhbjtcclxuXHJcblx0Ly90ZW1wb3JhcnkgdmVjdG9yM0QgZm9yIGNhbGN1bGF0aW9uXHJcblx0cHJpdmF0ZSBfdGVtcDpWZWN0b3IzRCA9IG5ldyBWZWN0b3IzRCgpO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhbmltYXRvcjpQYXJ0aWNsZUFuaW1hdG9yLCBwYXJ0aWNsZUZvbGxvd05vZGU6UGFydGljbGVGb2xsb3dOb2RlKVxyXG5cdHtcclxuXHRcdHN1cGVyKGFuaW1hdG9yLCBwYXJ0aWNsZUZvbGxvd05vZGUsIHRydWUpO1xyXG5cclxuXHRcdHRoaXMuX3BhcnRpY2xlRm9sbG93Tm9kZSA9IHBhcnRpY2xlRm9sbG93Tm9kZTtcclxuXHRcdHRoaXMuX3Ntb290aCA9IHBhcnRpY2xlRm9sbG93Tm9kZS5faVNtb290aDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgZm9sbG93VGFyZ2V0KCk6RGlzcGxheU9iamVjdFxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9mb2xsb3dUYXJnZXQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IGZvbGxvd1RhcmdldCh2YWx1ZTpEaXNwbGF5T2JqZWN0KVxyXG5cdHtcclxuXHRcdHRoaXMuX2ZvbGxvd1RhcmdldCA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldCBzbW9vdGgoKTpib29sZWFuXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX3Ntb290aDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgc21vb3RoKHZhbHVlOmJvb2xlYW4pXHJcblx0e1xyXG5cdFx0dGhpcy5fc21vb3RoID0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAaW5oZXJpdERvY1xyXG5cdCAqL1xyXG5cdHB1YmxpYyBzZXRSZW5kZXJTdGF0ZShzdGFnZTpTdGFnZSwgcmVuZGVyYWJsZTpSZW5kZXJhYmxlQmFzZSwgYW5pbWF0aW9uU3ViR2VvbWV0cnk6QW5pbWF0aW9uU3ViR2VvbWV0cnksIGFuaW1hdGlvblJlZ2lzdGVyQ2FjaGU6QW5pbWF0aW9uUmVnaXN0ZXJDYWNoZSwgY2FtZXJhOkNhbWVyYSlcclxuXHR7XHJcblx0XHRpZiAodGhpcy5fZm9sbG93VGFyZ2V0KSB7XHJcblx0XHRcdGlmICh0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lVc2VzUG9zaXRpb24pIHtcclxuXHRcdFx0XHR0aGlzLl90YXJnZXRQb3MueCA9IHRoaXMuX2ZvbGxvd1RhcmdldC50cmFuc2Zvcm0ucG9zaXRpb24ueC9yZW5kZXJhYmxlLnNvdXJjZUVudGl0eS5zY2FsZVg7XHJcblx0XHRcdFx0dGhpcy5fdGFyZ2V0UG9zLnkgPSB0aGlzLl9mb2xsb3dUYXJnZXQudHJhbnNmb3JtLnBvc2l0aW9uLnkvcmVuZGVyYWJsZS5zb3VyY2VFbnRpdHkuc2NhbGVZO1xyXG5cdFx0XHRcdHRoaXMuX3RhcmdldFBvcy56ID0gdGhpcy5fZm9sbG93VGFyZ2V0LnRyYW5zZm9ybS5wb3NpdGlvbi56L3JlbmRlcmFibGUuc291cmNlRW50aXR5LnNjYWxlWjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodGhpcy5fcGFydGljbGVGb2xsb3dOb2RlLl9pVXNlc1JvdGF0aW9uKSB7XHJcblx0XHRcdFx0dGhpcy5fdGFyZ2V0RXVsZXIueCA9IHRoaXMuX2ZvbGxvd1RhcmdldC5yb3RhdGlvblg7XHJcblx0XHRcdFx0dGhpcy5fdGFyZ2V0RXVsZXIueSA9IHRoaXMuX2ZvbGxvd1RhcmdldC5yb3RhdGlvblk7XHJcblx0XHRcdFx0dGhpcy5fdGFyZ2V0RXVsZXIueiA9IHRoaXMuX2ZvbGxvd1RhcmdldC5yb3RhdGlvblo7XHJcblx0XHRcdFx0dGhpcy5fdGFyZ2V0RXVsZXIuc2NhbGVCeShNYXRoQ29uc3RzLkRFR1JFRVNfVE9fUkFESUFOUyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8vaW5pdGlhbGl6YXRpb25cclxuXHRcdGlmICghdGhpcy5fcHJlUG9zKVxyXG5cdFx0XHR0aGlzLl9wcmVQb3MgPSB0aGlzLl90YXJnZXRQb3MuY2xvbmUoKTtcclxuXHRcdGlmICghdGhpcy5fcHJlRXVsZXIpXHJcblx0XHRcdHRoaXMuX3ByZUV1bGVyID0gdGhpcy5fdGFyZ2V0RXVsZXIuY2xvbmUoKTtcclxuXHJcblx0XHR2YXIgY3VycmVudFRpbWU6bnVtYmVyID0gdGhpcy5fcFRpbWUvMTAwMDtcclxuXHRcdHZhciBwcmV2aW91c1RpbWU6bnVtYmVyID0gYW5pbWF0aW9uU3ViR2VvbWV0cnkucHJldmlvdXNUaW1lO1xyXG5cdFx0dmFyIGRlbHRhVGltZTpudW1iZXIgPSBjdXJyZW50VGltZSAtIHByZXZpb3VzVGltZTtcclxuXHJcblx0XHR2YXIgbmVlZFByb2Nlc3M6Ym9vbGVhbiA9IHByZXZpb3VzVGltZSAhPSBjdXJyZW50VGltZTtcclxuXHJcblx0XHRpZiAodGhpcy5fcGFydGljbGVGb2xsb3dOb2RlLl9pVXNlc1Bvc2l0aW9uICYmIHRoaXMuX3BhcnRpY2xlRm9sbG93Tm9kZS5faVVzZXNSb3RhdGlvbikge1xyXG5cdFx0XHRpZiAobmVlZFByb2Nlc3MpXHJcblx0XHRcdFx0dGhpcy5wcm9jZXNzUG9zaXRpb25BbmRSb3RhdGlvbihjdXJyZW50VGltZSwgZGVsdGFUaW1lLCBhbmltYXRpb25TdWJHZW9tZXRyeSk7XHJcblxyXG5cdFx0XHRhbmltYXRpb25TdWJHZW9tZXRyeS5hY3RpdmF0ZVZlcnRleEJ1ZmZlcihhbmltYXRpb25SZWdpc3RlckNhY2hlLmdldFJlZ2lzdGVySW5kZXgodGhpcy5fcEFuaW1hdGlvbk5vZGUsIFBhcnRpY2xlRm9sbG93U3RhdGUuRk9MTE9XX1BPU0lUSU9OX0lOREVYKSwgdGhpcy5fcGFydGljbGVGb2xsb3dOb2RlLl9pRGF0YU9mZnNldCwgc3RhZ2UsIENvbnRleHRHTFZlcnRleEJ1ZmZlckZvcm1hdC5GTE9BVF8zKTtcclxuXHRcdFx0YW5pbWF0aW9uU3ViR2VvbWV0cnkuYWN0aXZhdGVWZXJ0ZXhCdWZmZXIoYW5pbWF0aW9uUmVnaXN0ZXJDYWNoZS5nZXRSZWdpc3RlckluZGV4KHRoaXMuX3BBbmltYXRpb25Ob2RlLCBQYXJ0aWNsZUZvbGxvd1N0YXRlLkZPTExPV19ST1RBVElPTl9JTkRFWCksIHRoaXMuX3BhcnRpY2xlRm9sbG93Tm9kZS5faURhdGFPZmZzZXQgKyAzLCBzdGFnZSwgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0LkZMT0FUXzMpO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lVc2VzUG9zaXRpb24pIHtcclxuXHRcdFx0aWYgKG5lZWRQcm9jZXNzKVxyXG5cdFx0XHRcdHRoaXMucHJvY2Vzc1Bvc2l0aW9uKGN1cnJlbnRUaW1lLCBkZWx0YVRpbWUsIGFuaW1hdGlvblN1Ykdlb21ldHJ5KTtcclxuXHJcblx0XHRcdGFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyKGFuaW1hdGlvblJlZ2lzdGVyQ2FjaGUuZ2V0UmVnaXN0ZXJJbmRleCh0aGlzLl9wQW5pbWF0aW9uTm9kZSwgUGFydGljbGVGb2xsb3dTdGF0ZS5GT0xMT1dfUE9TSVRJT05fSU5ERVgpLCB0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lEYXRhT2Zmc2V0LCBzdGFnZSwgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0LkZMT0FUXzMpO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lVc2VzUm90YXRpb24pIHtcclxuXHRcdFx0aWYgKG5lZWRQcm9jZXNzKVxyXG5cdFx0XHRcdHRoaXMucHJlY2Vzc1JvdGF0aW9uKGN1cnJlbnRUaW1lLCBkZWx0YVRpbWUsIGFuaW1hdGlvblN1Ykdlb21ldHJ5KTtcclxuXHJcblx0XHRcdGFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyKGFuaW1hdGlvblJlZ2lzdGVyQ2FjaGUuZ2V0UmVnaXN0ZXJJbmRleCh0aGlzLl9wQW5pbWF0aW9uTm9kZSwgUGFydGljbGVGb2xsb3dTdGF0ZS5GT0xMT1dfUk9UQVRJT05fSU5ERVgpLCB0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lEYXRhT2Zmc2V0LCBzdGFnZSwgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0LkZMT0FUXzMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3ByZVBvcy5jb3B5RnJvbSh0aGlzLl90YXJnZXRQb3MpO1xyXG5cdFx0dGhpcy5fdGFyZ2V0RXVsZXIuY29weUZyb20odGhpcy5fdGFyZ2V0RXVsZXIpO1xyXG5cdFx0YW5pbWF0aW9uU3ViR2VvbWV0cnkucHJldmlvdXNUaW1lID0gY3VycmVudFRpbWU7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHByb2Nlc3NQb3NpdGlvbihjdXJyZW50VGltZTpudW1iZXIsIGRlbHRhVGltZTpudW1iZXIsIGFuaW1hdGlvblN1Ykdlb21ldHJ5OkFuaW1hdGlvblN1Ykdlb21ldHJ5KVxyXG5cdHtcclxuXHRcdHZhciBkYXRhOkFycmF5PFBhcnRpY2xlQW5pbWF0aW9uRGF0YT4gPSBhbmltYXRpb25TdWJHZW9tZXRyeS5hbmltYXRpb25QYXJ0aWNsZXM7XHJcblx0XHR2YXIgdmVydGV4RGF0YTpBcnJheTxudW1iZXI+ID0gYW5pbWF0aW9uU3ViR2VvbWV0cnkudmVydGV4RGF0YTtcclxuXHJcblx0XHR2YXIgY2hhbmdlZDpib29sZWFuID0gZmFsc2U7XHJcblx0XHR2YXIgbGVuOm51bWJlciAvKnVpbnQqLyA9IGRhdGEubGVuZ3RoO1xyXG5cdFx0dmFyIGludGVycG9sYXRlZFBvczpWZWN0b3IzRDtcclxuXHRcdHZhciBwb3NWZWxvY2l0eTpWZWN0b3IzRDtcclxuXHRcdGlmICh0aGlzLl9zbW9vdGgpIHtcclxuXHRcdFx0cG9zVmVsb2NpdHkgPSB0aGlzLl9wcmVQb3Muc3VidHJhY3QodGhpcy5fdGFyZ2V0UG9zKTtcclxuXHRcdFx0cG9zVmVsb2NpdHkuc2NhbGVCeSgxL2RlbHRhVGltZSk7XHJcblx0XHR9IGVsc2VcclxuXHRcdFx0aW50ZXJwb2xhdGVkUG9zID0gdGhpcy5fdGFyZ2V0UG9zO1xyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyp1aW50Ki8gPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0dmFyIGs6bnVtYmVyID0gKGN1cnJlbnRUaW1lIC0gZGF0YVtpXS5zdGFydFRpbWUpL2RhdGFbaV0udG90YWxUaW1lO1xyXG5cdFx0XHR2YXIgdDpudW1iZXIgPSAoayAtIE1hdGguZmxvb3IoaykpKmRhdGFbaV0udG90YWxUaW1lO1xyXG5cdFx0XHRpZiAodCAtIGRlbHRhVGltZSA8PSAwKSB7XHJcblx0XHRcdFx0dmFyIGluYzpudW1iZXIgLyppbnQqLyA9IGRhdGFbaV0uc3RhcnRWZXJ0ZXhJbmRleCphbmltYXRpb25TdWJHZW9tZXRyeS50b3RhbExlbk9mT25lVmVydGV4ICsgdGhpcy5fcGFydGljbGVGb2xsb3dOb2RlLl9pRGF0YU9mZnNldDtcclxuXHJcblx0XHRcdFx0aWYgKHRoaXMuX3Ntb290aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5fdGVtcC5jb3B5RnJvbShwb3NWZWxvY2l0eSk7XHJcblx0XHRcdFx0XHR0aGlzLl90ZW1wLnNjYWxlQnkodCk7XHJcblx0XHRcdFx0XHRpbnRlcnBvbGF0ZWRQb3MgPSB0aGlzLl90YXJnZXRQb3MuYWRkKHRoaXMuX3RlbXApO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKHZlcnRleERhdGFbaW5jXSAhPSBpbnRlcnBvbGF0ZWRQb3MueCB8fCB2ZXJ0ZXhEYXRhW2luYyArIDFdICE9IGludGVycG9sYXRlZFBvcy55IHx8IHZlcnRleERhdGFbaW5jICsgMl0gIT0gaW50ZXJwb2xhdGVkUG9zLnopIHtcclxuXHRcdFx0XHRcdGNoYW5nZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0Zm9yICh2YXIgajpudW1iZXIgLyp1aW50Ki8gPSAwOyBqIDwgZGF0YVtpXS5udW1WZXJ0aWNlczsgaisrKSB7XHJcblx0XHRcdFx0XHRcdHZlcnRleERhdGFbaW5jKytdID0gaW50ZXJwb2xhdGVkUG9zLng7XHJcblx0XHRcdFx0XHRcdHZlcnRleERhdGFbaW5jKytdID0gaW50ZXJwb2xhdGVkUG9zLnk7XHJcblx0XHRcdFx0XHRcdHZlcnRleERhdGFbaW5jKytdID0gaW50ZXJwb2xhdGVkUG9zLno7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoY2hhbmdlZClcclxuXHRcdFx0YW5pbWF0aW9uU3ViR2VvbWV0cnkuaW52YWxpZGF0ZUJ1ZmZlcigpO1xyXG5cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcHJlY2Vzc1JvdGF0aW9uKGN1cnJlbnRUaW1lOm51bWJlciwgZGVsdGFUaW1lOm51bWJlciwgYW5pbWF0aW9uU3ViR2VvbWV0cnk6QW5pbWF0aW9uU3ViR2VvbWV0cnkpXHJcblx0e1xyXG5cdFx0dmFyIGRhdGE6QXJyYXk8UGFydGljbGVBbmltYXRpb25EYXRhPiA9IGFuaW1hdGlvblN1Ykdlb21ldHJ5LmFuaW1hdGlvblBhcnRpY2xlcztcclxuXHRcdHZhciB2ZXJ0ZXhEYXRhOkFycmF5PG51bWJlcj4gPSBhbmltYXRpb25TdWJHZW9tZXRyeS52ZXJ0ZXhEYXRhO1xyXG5cclxuXHRcdHZhciBjaGFuZ2VkOmJvb2xlYW4gPSBmYWxzZTtcclxuXHRcdHZhciBsZW46bnVtYmVyIC8qdWludCovID0gZGF0YS5sZW5ndGg7XHJcblxyXG5cdFx0dmFyIGludGVycG9sYXRlZFJvdGF0aW9uOlZlY3RvcjNEO1xyXG5cdFx0dmFyIHJvdGF0aW9uVmVsb2NpdHk6VmVjdG9yM0Q7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Ntb290aCkge1xyXG5cdFx0XHRyb3RhdGlvblZlbG9jaXR5ID0gdGhpcy5fcHJlRXVsZXIuc3VidHJhY3QodGhpcy5fdGFyZ2V0RXVsZXIpO1xyXG5cdFx0XHRyb3RhdGlvblZlbG9jaXR5LnNjYWxlQnkoMS9kZWx0YVRpbWUpO1xyXG5cdFx0fSBlbHNlXHJcblx0XHRcdGludGVycG9sYXRlZFJvdGF0aW9uID0gdGhpcy5fdGFyZ2V0RXVsZXI7XHJcblxyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgLyp1aW50Ki8gPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0dmFyIGs6bnVtYmVyID0gKGN1cnJlbnRUaW1lIC0gZGF0YVtpXS5zdGFydFRpbWUpL2RhdGFbaV0udG90YWxUaW1lO1xyXG5cdFx0XHR2YXIgdDpudW1iZXIgPSAoayAtIE1hdGguZmxvb3IoaykpKmRhdGFbaV0udG90YWxUaW1lO1xyXG5cdFx0XHRpZiAodCAtIGRlbHRhVGltZSA8PSAwKSB7XHJcblx0XHRcdFx0dmFyIGluYzpudW1iZXIgLyppbnQqLyA9IGRhdGFbaV0uc3RhcnRWZXJ0ZXhJbmRleCphbmltYXRpb25TdWJHZW9tZXRyeS50b3RhbExlbk9mT25lVmVydGV4ICsgdGhpcy5fcGFydGljbGVGb2xsb3dOb2RlLl9pRGF0YU9mZnNldDtcclxuXHJcblx0XHRcdFx0aWYgKHRoaXMuX3Ntb290aCkge1xyXG5cdFx0XHRcdFx0dGhpcy5fdGVtcC5jb3B5RnJvbShyb3RhdGlvblZlbG9jaXR5KTtcclxuXHRcdFx0XHRcdHRoaXMuX3RlbXAuc2NhbGVCeSh0KTtcclxuXHRcdFx0XHRcdGludGVycG9sYXRlZFJvdGF0aW9uID0gdGhpcy5fdGFyZ2V0RXVsZXIuYWRkKHRoaXMuX3RlbXApO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKHZlcnRleERhdGFbaW5jXSAhPSBpbnRlcnBvbGF0ZWRSb3RhdGlvbi54IHx8IHZlcnRleERhdGFbaW5jICsgMV0gIT0gaW50ZXJwb2xhdGVkUm90YXRpb24ueSB8fCB2ZXJ0ZXhEYXRhW2luYyArIDJdICE9IGludGVycG9sYXRlZFJvdGF0aW9uLnopIHtcclxuXHRcdFx0XHRcdGNoYW5nZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0Zm9yICh2YXIgajpudW1iZXIgLyp1aW50Ki8gPSAwOyBqIDwgZGF0YVtpXS5udW1WZXJ0aWNlczsgaisrKSB7XHJcblx0XHRcdFx0XHRcdHZlcnRleERhdGFbaW5jKytdID0gaW50ZXJwb2xhdGVkUm90YXRpb24ueDtcclxuXHRcdFx0XHRcdFx0dmVydGV4RGF0YVtpbmMrK10gPSBpbnRlcnBvbGF0ZWRSb3RhdGlvbi55O1xyXG5cdFx0XHRcdFx0XHR2ZXJ0ZXhEYXRhW2luYysrXSA9IGludGVycG9sYXRlZFJvdGF0aW9uLno7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoY2hhbmdlZClcclxuXHRcdFx0YW5pbWF0aW9uU3ViR2VvbWV0cnkuaW52YWxpZGF0ZUJ1ZmZlcigpO1xyXG5cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcHJvY2Vzc1Bvc2l0aW9uQW5kUm90YXRpb24oY3VycmVudFRpbWU6bnVtYmVyLCBkZWx0YVRpbWU6bnVtYmVyLCBhbmltYXRpb25TdWJHZW9tZXRyeTpBbmltYXRpb25TdWJHZW9tZXRyeSlcclxuXHR7XHJcblx0XHR2YXIgZGF0YTpBcnJheTxQYXJ0aWNsZUFuaW1hdGlvbkRhdGE+ID0gYW5pbWF0aW9uU3ViR2VvbWV0cnkuYW5pbWF0aW9uUGFydGljbGVzO1xyXG5cdFx0dmFyIHZlcnRleERhdGE6QXJyYXk8bnVtYmVyPiA9IGFuaW1hdGlvblN1Ykdlb21ldHJ5LnZlcnRleERhdGE7XHJcblxyXG5cdFx0dmFyIGNoYW5nZWQ6Ym9vbGVhbiA9IGZhbHNlO1xyXG5cdFx0dmFyIGxlbjpudW1iZXIgLyp1aW50Ki8gPSBkYXRhLmxlbmd0aDtcclxuXHJcblx0XHR2YXIgaW50ZXJwb2xhdGVkUG9zOlZlY3RvcjNEO1xyXG5cdFx0dmFyIGludGVycG9sYXRlZFJvdGF0aW9uOlZlY3RvcjNEO1xyXG5cclxuXHRcdHZhciBwb3NWZWxvY2l0eTpWZWN0b3IzRDtcclxuXHRcdHZhciByb3RhdGlvblZlbG9jaXR5OlZlY3RvcjNEO1xyXG5cdFx0aWYgKHRoaXMuX3Ntb290aCkge1xyXG5cdFx0XHRwb3NWZWxvY2l0eSA9IHRoaXMuX3ByZVBvcy5zdWJ0cmFjdCh0aGlzLl90YXJnZXRQb3MpO1xyXG5cdFx0XHRwb3NWZWxvY2l0eS5zY2FsZUJ5KDEvZGVsdGFUaW1lKTtcclxuXHRcdFx0cm90YXRpb25WZWxvY2l0eSA9IHRoaXMuX3ByZUV1bGVyLnN1YnRyYWN0KHRoaXMuX3RhcmdldEV1bGVyKTtcclxuXHRcdFx0cm90YXRpb25WZWxvY2l0eS5zY2FsZUJ5KDEvZGVsdGFUaW1lKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGludGVycG9sYXRlZFBvcyA9IHRoaXMuX3RhcmdldFBvcztcclxuXHRcdFx0aW50ZXJwb2xhdGVkUm90YXRpb24gPSB0aGlzLl90YXJnZXRFdWxlcjtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKHZhciBpOm51bWJlciAvKnVpbnQqLyA9IDA7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHR2YXIgazpudW1iZXIgPSAoY3VycmVudFRpbWUgLSBkYXRhW2ldLnN0YXJ0VGltZSkvZGF0YVtpXS50b3RhbFRpbWU7XHJcblx0XHRcdHZhciB0Om51bWJlciA9IChrIC0gTWF0aC5mbG9vcihrKSkqZGF0YVtpXS50b3RhbFRpbWU7XHJcblx0XHRcdGlmICh0IC0gZGVsdGFUaW1lIDw9IDApIHtcclxuXHRcdFx0XHR2YXIgaW5jOm51bWJlciAvKmludCovID0gZGF0YVtpXS5zdGFydFZlcnRleEluZGV4KmFuaW1hdGlvblN1Ykdlb21ldHJ5LnRvdGFsTGVuT2ZPbmVWZXJ0ZXggKyB0aGlzLl9wYXJ0aWNsZUZvbGxvd05vZGUuX2lEYXRhT2Zmc2V0O1xyXG5cdFx0XHRcdGlmICh0aGlzLl9zbW9vdGgpIHtcclxuXHRcdFx0XHRcdHRoaXMuX3RlbXAuY29weUZyb20ocG9zVmVsb2NpdHkpO1xyXG5cdFx0XHRcdFx0dGhpcy5fdGVtcC5zY2FsZUJ5KHQpO1xyXG5cdFx0XHRcdFx0aW50ZXJwb2xhdGVkUG9zID0gdGhpcy5fdGFyZ2V0UG9zLmFkZCh0aGlzLl90ZW1wKTtcclxuXHJcblx0XHRcdFx0XHR0aGlzLl90ZW1wLmNvcHlGcm9tKHJvdGF0aW9uVmVsb2NpdHkpO1xyXG5cdFx0XHRcdFx0dGhpcy5fdGVtcC5zY2FsZUJ5KHQpO1xyXG5cdFx0XHRcdFx0aW50ZXJwb2xhdGVkUm90YXRpb24gPSB0aGlzLl90YXJnZXRFdWxlci5hZGQodGhpcy5fdGVtcCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAodmVydGV4RGF0YVtpbmNdICE9IGludGVycG9sYXRlZFBvcy54IHx8IHZlcnRleERhdGFbaW5jICsgMV0gIT0gaW50ZXJwb2xhdGVkUG9zLnkgfHwgdmVydGV4RGF0YVtpbmMgKyAyXSAhPSBpbnRlcnBvbGF0ZWRQb3MueiB8fCB2ZXJ0ZXhEYXRhW2luYyArIDNdICE9IGludGVycG9sYXRlZFJvdGF0aW9uLnggfHwgdmVydGV4RGF0YVtpbmMgKyA0XSAhPSBpbnRlcnBvbGF0ZWRSb3RhdGlvbi55IHx8IHZlcnRleERhdGFbaW5jICsgNV0gIT0gaW50ZXJwb2xhdGVkUm90YXRpb24ueikge1xyXG5cdFx0XHRcdFx0Y2hhbmdlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRmb3IgKHZhciBqOm51bWJlciAvKnVpbnQqLyA9IDA7IGogPCBkYXRhW2ldLm51bVZlcnRpY2VzOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0dmVydGV4RGF0YVtpbmMrK10gPSBpbnRlcnBvbGF0ZWRQb3MueDtcclxuXHRcdFx0XHRcdFx0dmVydGV4RGF0YVtpbmMrK10gPSBpbnRlcnBvbGF0ZWRQb3MueTtcclxuXHRcdFx0XHRcdFx0dmVydGV4RGF0YVtpbmMrK10gPSBpbnRlcnBvbGF0ZWRQb3MuejtcclxuXHRcdFx0XHRcdFx0dmVydGV4RGF0YVtpbmMrK10gPSBpbnRlcnBvbGF0ZWRSb3RhdGlvbi54O1xyXG5cdFx0XHRcdFx0XHR2ZXJ0ZXhEYXRhW2luYysrXSA9IGludGVycG9sYXRlZFJvdGF0aW9uLnk7XHJcblx0XHRcdFx0XHRcdHZlcnRleERhdGFbaW5jKytdID0gaW50ZXJwb2xhdGVkUm90YXRpb24uejtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmIChjaGFuZ2VkKVxyXG5cdFx0XHRhbmltYXRpb25TdWJHZW9tZXRyeS5pbnZhbGlkYXRlQnVmZmVyKCk7XHJcblx0fVxyXG5cclxufVxyXG5cclxuZXhwb3J0ID0gUGFydGljbGVGb2xsb3dTdGF0ZTsiXX0=