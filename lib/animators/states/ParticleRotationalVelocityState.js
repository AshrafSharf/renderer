var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Vector3D = require("awayjs-core/lib/core/geom/Vector3D");
var ContextGLVertexBufferFormat = require("awayjs-stagegl/lib/core/stagegl/ContextGLVertexBufferFormat");
var ParticlePropertiesMode = require("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");
var ParticleStateBase = require("awayjs-renderergl/lib/animators/states/ParticleStateBase");
/**
 * ...
 */
var ParticleRotationalVelocityState = (function (_super) {
    __extends(ParticleRotationalVelocityState, _super);
    function ParticleRotationalVelocityState(animator, particleRotationNode) {
        _super.call(this, animator, particleRotationNode);
        this._particleRotationalVelocityNode = particleRotationNode;
        this._rotationalVelocity = this._particleRotationalVelocityNode._iRotationalVelocity;
        this.updateRotationalVelocityData();
    }
    Object.defineProperty(ParticleRotationalVelocityState.prototype, "rotationalVelocity", {
        /**
         * Defines the default rotationalVelocity of the state, used when in global mode.
         */
        get: function () {
            return this._rotationalVelocity;
        },
        set: function (value) {
            this._rotationalVelocity = value;
            this.updateRotationalVelocityData();
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    ParticleRotationalVelocityState.prototype.getRotationalVelocities = function () {
        return this._pDynamicProperties;
    };
    ParticleRotationalVelocityState.prototype.setRotationalVelocities = function (value) {
        this._pDynamicProperties = value;
        this._pDynamicPropertiesDirty = new Object();
    };
    /**
     * @inheritDoc
     */
    ParticleRotationalVelocityState.prototype.setRenderState = function (stage, renderable, animationSubGeometry, animationRegisterCache, camera) {
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])
            this._pUpdateDynamicProperties(animationSubGeometry);
        var index = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX);
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL)
            animationRegisterCache.setVertexConst(index, this._rotationalVelocityData.x, this._rotationalVelocityData.y, this._rotationalVelocityData.z, this._rotationalVelocityData.w);
        else
            animationSubGeometry.activateVertexBuffer(index, this._particleRotationalVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);
    };
    ParticleRotationalVelocityState.prototype.updateRotationalVelocityData = function () {
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL) {
            if (this._rotationalVelocity.w <= 0)
                throw (new Error("the cycle duration must greater than zero"));
            var rotation = this._rotationalVelocity.clone();
            if (rotation.length <= 0)
                rotation.z = 1; //set the default direction
            else
                rotation.normalize();
            // w is used as angle/2 in agal
            this._rotationalVelocityData = new Vector3D(rotation.x, rotation.y, rotation.z, Math.PI / rotation.w);
        }
    };
    /** @private */
    ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX = 0;
    return ParticleRotationalVelocityState;
})(ParticleStateBase);
module.exports = ParticleRotationalVelocityState;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdG9ycy9zdGF0ZXMvcGFydGljbGVyb3RhdGlvbmFsdmVsb2NpdHlzdGF0ZS50cyJdLCJuYW1lcyI6WyJQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlIiwiUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZS5jb25zdHJ1Y3RvciIsIlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUucm90YXRpb25hbFZlbG9jaXR5IiwiUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZS5nZXRSb3RhdGlvbmFsVmVsb2NpdGllcyIsIlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUuc2V0Um90YXRpb25hbFZlbG9jaXRpZXMiLCJQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlLnNldFJlbmRlclN0YXRlIiwiUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZS51cGRhdGVSb3RhdGlvbmFsVmVsb2NpdHlEYXRhIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLFFBQVEsV0FBaUIsb0NBQW9DLENBQUMsQ0FBQztBQU10RSxJQUFPLDJCQUEyQixXQUFZLDZEQUE2RCxDQUFDLENBQUM7QUFJN0csSUFBTyxzQkFBc0IsV0FBYSw2REFBNkQsQ0FBQyxDQUFDO0FBRXpHLElBQU8saUJBQWlCLFdBQWMsMERBQTBELENBQUMsQ0FBQztBQUVsRyxBQUdBOztHQURHO0lBQ0csK0JBQStCO0lBQVNBLFVBQXhDQSwrQkFBK0JBLFVBQTBCQTtJQXVDOURBLFNBdkNLQSwrQkFBK0JBLENBdUN4QkEsUUFBeUJBLEVBQUVBLG9CQUFtREE7UUFFekZDLGtCQUFNQSxRQUFRQSxFQUFFQSxvQkFBb0JBLENBQUNBLENBQUNBO1FBRXRDQSxJQUFJQSxDQUFDQSwrQkFBK0JBLEdBQUdBLG9CQUFvQkEsQ0FBQ0E7UUFDNURBLElBQUlBLENBQUNBLG1CQUFtQkEsR0FBR0EsSUFBSUEsQ0FBQ0EsK0JBQStCQSxDQUFDQSxvQkFBb0JBLENBQUNB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QSxDQUFDQSxFQUFFQSwyQkFBMkJBO1lBQzVDQSxJQURnQkEsQUFDWkE7Z0JBQ0hBLFFBQVFBLENBQUNBLFNBQVNBLEVBQUVBLENBQUNBO1lBQ3RCQSxBQUNBQSwrQkFEK0JBO1lBQy9CQSxJQUFJQSxDQUFDQSx1QkFBdUJBLEdBQUdBLElBQUlBLFFBQVFBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLEVBQUVBLFFBQVFBLENBQUNBLENBQUNBLEVBQUVBLFFBQVFBLENBQUNBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLEVBQUVBLEdBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1FBQ3JHQSxDQUFDQTtJQUNGQSxDQUFDQTtJQTdFRE4sZUFBZUE7SUFDREEsd0RBQXdCQSxHQUFtQkEsQ0FBQ0EsQ0FBQ0E7SUE2RTVEQSxzQ0FBQ0E7QUFBREEsQ0FoRkEsQUFnRkNBLEVBaEY2QyxpQkFBaUIsRUFnRjlEO0FBRUQsQUFBeUMsaUJBQWhDLCtCQUErQixDQUFDIiwiZmlsZSI6ImFuaW1hdG9ycy9zdGF0ZXMvUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvcm9iYmF0ZW1hbi9XZWJzdG9ybVByb2plY3RzL2F3YXlqcy1yZW5kZXJlcmdsLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWN0b3IzRFx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvZ2VvbS9WZWN0b3IzRFwiKTtcbmltcG9ydCBDYW1lcmFcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9lbnRpdGllcy9DYW1lcmFcIik7XG5cbmltcG9ydCBBbmltYXRpb25SZWdpc3RlckNhY2hlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FuaW1hdG9ycy9kYXRhL0FuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcIik7XG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL2Jhc2UvU3RhZ2VcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvcG9vbC9SZW5kZXJhYmxlQmFzZVwiKTtcbmltcG9ydCBDb250ZXh0R0xWZXJ0ZXhCdWZmZXJGb3JtYXRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9Db250ZXh0R0xWZXJ0ZXhCdWZmZXJGb3JtYXRcIik7XG5cbmltcG9ydCBQYXJ0aWNsZUFuaW1hdG9yXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvUGFydGljbGVBbmltYXRvclwiKTtcbmltcG9ydCBBbmltYXRpb25TdWJHZW9tZXRyeVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9kYXRhL0FuaW1hdGlvblN1Ykdlb21ldHJ5XCIpO1xuaW1wb3J0IFBhcnRpY2xlUHJvcGVydGllc01vZGVcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvUGFydGljbGVQcm9wZXJ0aWVzTW9kZVwiKTtcbmltcG9ydCBQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGVcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvbm9kZXMvUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlOb2RlXCIpO1xuaW1wb3J0IFBhcnRpY2xlU3RhdGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL3N0YXRlcy9QYXJ0aWNsZVN0YXRlQmFzZVwiKTtcblxuLyoqXG4gKiAuLi5cbiAqL1xuY2xhc3MgUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZSBleHRlbmRzIFBhcnRpY2xlU3RhdGVCYXNlXG57XG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRwdWJsaWMgc3RhdGljIFJPVEFUSU9OQUxWRUxPQ0lUWV9JTkRFWDpudW1iZXIgLyp1aW50Ki8gPSAwO1xuXG5cdHByaXZhdGUgX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZTpQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGU7XG5cdHByaXZhdGUgX3JvdGF0aW9uYWxWZWxvY2l0eURhdGE6VmVjdG9yM0Q7XG5cdHByaXZhdGUgX3JvdGF0aW9uYWxWZWxvY2l0eTpWZWN0b3IzRDtcblxuXHQvKipcblx0ICogRGVmaW5lcyB0aGUgZGVmYXVsdCByb3RhdGlvbmFsVmVsb2NpdHkgb2YgdGhlIHN0YXRlLCB1c2VkIHdoZW4gaW4gZ2xvYmFsIG1vZGUuXG5cdCAqL1xuXHRwdWJsaWMgZ2V0IHJvdGF0aW9uYWxWZWxvY2l0eSgpOlZlY3RvcjNEXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcm90YXRpb25hbFZlbG9jaXR5O1xuXHR9XG5cblx0cHVibGljIHNldCByb3RhdGlvbmFsVmVsb2NpdHkodmFsdWU6VmVjdG9yM0QpXG5cdHtcblx0XHR0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHkgPSB2YWx1ZTtcblxuXHRcdHRoaXMudXBkYXRlUm90YXRpb25hbFZlbG9jaXR5RGF0YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgZ2V0Um90YXRpb25hbFZlbG9jaXRpZXMoKTpBcnJheTxWZWN0b3IzRD5cblx0e1xuXHRcdHJldHVybiB0aGlzLl9wRHluYW1pY1Byb3BlcnRpZXM7XG5cdH1cblxuXHRwdWJsaWMgc2V0Um90YXRpb25hbFZlbG9jaXRpZXModmFsdWU6QXJyYXk8VmVjdG9yM0Q+KVxuXHR7XG5cdFx0dGhpcy5fcER5bmFtaWNQcm9wZXJ0aWVzID0gdmFsdWU7XG5cblx0XHR0aGlzLl9wRHluYW1pY1Byb3BlcnRpZXNEaXJ0eSA9IG5ldyBPYmplY3QoKTtcblx0fVxuXG5cdGNvbnN0cnVjdG9yKGFuaW1hdG9yOlBhcnRpY2xlQW5pbWF0b3IsIHBhcnRpY2xlUm90YXRpb25Ob2RlOlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZSlcblx0e1xuXHRcdHN1cGVyKGFuaW1hdG9yLCBwYXJ0aWNsZVJvdGF0aW9uTm9kZSk7XG5cblx0XHR0aGlzLl9wYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGUgPSBwYXJ0aWNsZVJvdGF0aW9uTm9kZTtcblx0XHR0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHkgPSB0aGlzLl9wYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGUuX2lSb3RhdGlvbmFsVmVsb2NpdHk7XG5cblx0XHR0aGlzLnVwZGF0ZVJvdGF0aW9uYWxWZWxvY2l0eURhdGEoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAaW5oZXJpdERvY1xuXHQgKi9cblx0cHVibGljIHNldFJlbmRlclN0YXRlKHN0YWdlOlN0YWdlLCByZW5kZXJhYmxlOlJlbmRlcmFibGVCYXNlLCBhbmltYXRpb25TdWJHZW9tZXRyeTpBbmltYXRpb25TdWJHZW9tZXRyeSwgYW5pbWF0aW9uUmVnaXN0ZXJDYWNoZTpBbmltYXRpb25SZWdpc3RlckNhY2hlLCBjYW1lcmE6Q2FtZXJhKVxuXHR7XG5cdFx0aWYgKHRoaXMuX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZS5tb2RlID09IFBhcnRpY2xlUHJvcGVydGllc01vZGUuTE9DQUxfRFlOQU1JQyAmJiAhdGhpcy5fcER5bmFtaWNQcm9wZXJ0aWVzRGlydHlbYW5pbWF0aW9uU3ViR2VvbWV0cnkuX2lVbmlxdWVJZF0pXG5cdFx0XHR0aGlzLl9wVXBkYXRlRHluYW1pY1Byb3BlcnRpZXMoYW5pbWF0aW9uU3ViR2VvbWV0cnkpO1xuXG5cdFx0dmFyIGluZGV4Om51bWJlciAvKmludCovID0gYW5pbWF0aW9uUmVnaXN0ZXJDYWNoZS5nZXRSZWdpc3RlckluZGV4KHRoaXMuX3BBbmltYXRpb25Ob2RlLCBQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlLlJPVEFUSU9OQUxWRUxPQ0lUWV9JTkRFWCk7XG5cblx0XHRpZiAodGhpcy5fcGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlOb2RlLm1vZGUgPT0gUGFydGljbGVQcm9wZXJ0aWVzTW9kZS5HTE9CQUwpXG5cdFx0XHRhbmltYXRpb25SZWdpc3RlckNhY2hlLnNldFZlcnRleENvbnN0KGluZGV4LCB0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHlEYXRhLngsIHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eURhdGEueSwgdGhpcy5fcm90YXRpb25hbFZlbG9jaXR5RGF0YS56LCB0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHlEYXRhLncpO1xuXHRcdGVsc2Vcblx0XHRcdGFuaW1hdGlvblN1Ykdlb21ldHJ5LmFjdGl2YXRlVmVydGV4QnVmZmVyKGluZGV4LCB0aGlzLl9wYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGUuX2lEYXRhT2Zmc2V0LCBzdGFnZSwgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0LkZMT0FUXzQpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVSb3RhdGlvbmFsVmVsb2NpdHlEYXRhKClcblx0e1xuXHRcdGlmICh0aGlzLl9wYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGUubW9kZSA9PSBQYXJ0aWNsZVByb3BlcnRpZXNNb2RlLkdMT0JBTCkge1xuXHRcdFx0aWYgKHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eS53IDw9IDApXG5cdFx0XHRcdHRocm93KG5ldyBFcnJvcihcInRoZSBjeWNsZSBkdXJhdGlvbiBtdXN0IGdyZWF0ZXIgdGhhbiB6ZXJvXCIpKTtcblx0XHRcdHZhciByb3RhdGlvbjpWZWN0b3IzRCA9IHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eS5jbG9uZSgpO1xuXG5cdFx0XHRpZiAocm90YXRpb24ubGVuZ3RoIDw9IDApXG5cdFx0XHRcdHJvdGF0aW9uLnogPSAxOyAvL3NldCB0aGUgZGVmYXVsdCBkaXJlY3Rpb25cblx0XHRcdGVsc2Vcblx0XHRcdFx0cm90YXRpb24ubm9ybWFsaXplKCk7XG5cdFx0XHQvLyB3IGlzIHVzZWQgYXMgYW5nbGUvMiBpbiBhZ2FsXG5cdFx0XHR0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHlEYXRhID0gbmV3IFZlY3RvcjNEKHJvdGF0aW9uLngsIHJvdGF0aW9uLnksIHJvdGF0aW9uLnosIE1hdGguUEkvcm90YXRpb24udyk7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCA9IFBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGU7Il19