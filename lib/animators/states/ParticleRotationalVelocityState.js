var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var ContextGLVertexBufferFormat = require("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");
var ParticlePropertiesMode = require("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");
var ParticleStateBase = require("awayjs-renderergl/lib/animators/states/ParticleStateBase");
/**
 * ...
 */
var ParticleRotationalVelocityState = (function (_super) {
    __extends(ParticleRotationalVelocityState, _super);
    function ParticleRotationalVelocityState(animator, particleRotationNode) {
        _super.call(this, animator, particleRotationNode);
        this._particleRotationalVelocityNode = particleRotationNode;
        this._rotationalVelocity = this._particleRotationalVelocityNode._iRotationalVelocity;
        this.updateRotationalVelocityData();
    }
    Object.defineProperty(ParticleRotationalVelocityState.prototype, "rotationalVelocity", {
        /**
         * Defines the default rotationalVelocity of the state, used when in global mode.
         */
        get: function () {
            return this._rotationalVelocity;
        },
        set: function (value) {
            this._rotationalVelocity = value;
            this.updateRotationalVelocityData();
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    ParticleRotationalVelocityState.prototype.getRotationalVelocities = function () {
        return this._pDynamicProperties;
    };
    ParticleRotationalVelocityState.prototype.setRotationalVelocities = function (value) {
        this._pDynamicProperties = value;
        this._pDynamicPropertiesDirty = new Object();
    };
    /**
     * @inheritDoc
     */
    ParticleRotationalVelocityState.prototype.setRenderState = function (stage, renderable, animationSubGeometry, animationRegisterCache, camera) {
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])
            this._pUpdateDynamicProperties(animationSubGeometry);
        var index = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX);
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL)
            animationRegisterCache.setVertexConst(index, this._rotationalVelocityData.x, this._rotationalVelocityData.y, this._rotationalVelocityData.z, this._rotationalVelocityData.w);
        else
            animationSubGeometry.activateVertexBuffer(index, this._particleRotationalVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);
    };
    ParticleRotationalVelocityState.prototype.updateRotationalVelocityData = function () {
        if (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL) {
            if (this._rotationalVelocity.w <= 0)
                throw (new Error("the cycle duration must greater than zero"));
            var rotation = this._rotationalVelocity.clone();
            if (rotation.length <= 0)
                rotation.z = 1; //set the default direction
            else
                rotation.normalize();
            // w is used as angle/2 in agal
            this._rotationalVelocityData = new Vector3D(rotation.x, rotation.y, rotation.z, Math.PI / rotation.w);
        }
    };
    /** @private */
    ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX = 0;
    return ParticleRotationalVelocityState;
})(ParticleStateBase);
module.exports = ParticleRotationalVelocityState;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvc3RhdGVzL3BhcnRpY2xlcm90YXRpb25hbHZlbG9jaXR5c3RhdGUudHMiXSwibmFtZXMiOlsiUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZSIsIlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUuY29uc3RydWN0b3IiLCJQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlLnJvdGF0aW9uYWxWZWxvY2l0eSIsIlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUuZ2V0Um90YXRpb25hbFZlbG9jaXRpZXMiLCJQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlLnNldFJvdGF0aW9uYWxWZWxvY2l0aWVzIiwiUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZS5zZXRSZW5kZXJTdGF0ZSIsIlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUudXBkYXRlUm90YXRpb25hbFZlbG9jaXR5RGF0YSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBTyxRQUFRLFdBQWlCLCtCQUErQixDQUFDLENBQUM7QUFPakUsSUFBTywyQkFBMkIsV0FBWSxxREFBcUQsQ0FBQyxDQUFDO0FBSXJHLElBQU8sc0JBQXNCLFdBQWEsNkRBQTZELENBQUMsQ0FBQztBQUV6RyxJQUFPLGlCQUFpQixXQUFjLDBEQUEwRCxDQUFDLENBQUM7QUFFbEcsQUFHQTs7R0FERztJQUNHLCtCQUErQjtJQUFTQSxVQUF4Q0EsK0JBQStCQSxVQUEwQkE7SUF1QzlEQSxTQXZDS0EsK0JBQStCQSxDQXVDeEJBLFFBQXlCQSxFQUFFQSxvQkFBbURBO1FBRXpGQyxrQkFBTUEsUUFBUUEsRUFBRUEsb0JBQW9CQSxDQUFDQSxDQUFDQTtRQUV0Q0EsSUFBSUEsQ0FBQ0EsK0JBQStCQSxHQUFHQSxvQkFBb0JBLENBQUNBO1FBQzVEQSxJQUFJQSxDQUFDQSxtQkFBbUJBLEdBQUdBLElBQUlBLENBQUNBLCtCQUEr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UUFBUUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsMkJBQTJCQTtZQUM1Q0EsSUFEZ0JBLEFBQ1pBO2dCQUNIQSxRQUFRQSxDQUFDQSxTQUFTQSxFQUFFQSxDQUFDQTtZQUN0QkEsQUFDQUEsK0JBRCtCQTtZQUMvQkEsSUFBSUEsQ0FBQ0EsdUJBQXVCQSxHQUFHQSxJQUFJQSxRQUFRQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNyR0EsQ0FBQ0E7SUFDRkEsQ0FBQ0E7SUE3RUROLGVBQWVBO0lBQ0RBLHdEQUF3QkEsR0FBbUJBLENBQUNBLENBQUNBO0lBNkU1REEsc0NBQUNBO0FBQURBLENBaEZBLEFBZ0ZDQSxFQWhGNkMsaUJBQWlCLEVBZ0Y5RDtBQUVELEFBQXlDLGlCQUFoQywrQkFBK0IsQ0FBQyIsImZpbGUiOiJhbmltYXRvcnMvc3RhdGVzL1BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcblxuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0NhbWVyYVwiKTtcblxuaW1wb3J0IEFuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYW5pbWF0b3JzL2RhdGEvQW5pbWF0aW9uUmVnaXN0ZXJDYWNoZVwiKTtcbmltcG9ydCBTdGFnZVx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvU3RhZ2VcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvUmVuZGVyYWJsZUJhc2VcIik7XG5pbXBvcnQgQ29udGV4dEdMVmVydGV4QnVmZmVyRm9ybWF0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0NvbnRleHRHTFZlcnRleEJ1ZmZlckZvcm1hdFwiKTtcblxuaW1wb3J0IFBhcnRpY2xlQW5pbWF0b3JcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9QYXJ0aWNsZUFuaW1hdG9yXCIpO1xuaW1wb3J0IEFuaW1hdGlvblN1Ykdlb21ldHJ5XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL2RhdGEvQW5pbWF0aW9uU3ViR2VvbWV0cnlcIik7XG5pbXBvcnQgUGFydGljbGVQcm9wZXJ0aWVzTW9kZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9QYXJ0aWNsZVByb3BlcnRpZXNNb2RlXCIpO1xuaW1wb3J0IFBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZVx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9ub2Rlcy9QYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGVcIik7XG5pbXBvcnQgUGFydGljbGVTdGF0ZUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvc3RhdGVzL1BhcnRpY2xlU3RhdGVCYXNlXCIpO1xuXG4vKipcbiAqIC4uLlxuICovXG5jbGFzcyBQYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eVN0YXRlIGV4dGVuZHMgUGFydGljbGVTdGF0ZUJhc2Vcbntcblx0LyoqIEBwcml2YXRlICovXG5cdHB1YmxpYyBzdGF0aWMgUk9UQVRJT05BTFZFTE9DSVRZX0lOREVYOm51bWJlciAvKnVpbnQqLyA9IDA7XG5cblx0cHJpdmF0ZSBfcGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlOb2RlOlBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZTtcblx0cHJpdmF0ZSBfcm90YXRpb25hbFZlbG9jaXR5RGF0YTpWZWN0b3IzRDtcblx0cHJpdmF0ZSBfcm90YXRpb25hbFZlbG9jaXR5OlZlY3RvcjNEO1xuXG5cdC8qKlxuXHQgKiBEZWZpbmVzIHRoZSBkZWZhdWx0IHJvdGF0aW9uYWxWZWxvY2l0eSBvZiB0aGUgc3RhdGUsIHVzZWQgd2hlbiBpbiBnbG9iYWwgbW9kZS5cblx0ICovXG5cdHB1YmxpYyBnZXQgcm90YXRpb25hbFZlbG9jaXR5KCk6VmVjdG9yM0Rcblx0e1xuXHRcdHJldHVybiB0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHk7XG5cdH1cblxuXHRwdWJsaWMgc2V0IHJvdGF0aW9uYWxWZWxvY2l0eSh2YWx1ZTpWZWN0b3IzRClcblx0e1xuXHRcdHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eSA9IHZhbHVlO1xuXG5cdFx0dGhpcy51cGRhdGVSb3RhdGlvbmFsVmVsb2NpdHlEYXRhKCk7XG5cdH1cblxuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBnZXRSb3RhdGlvbmFsVmVsb2NpdGllcygpOkFycmF5PFZlY3RvcjNEPlxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3BEeW5hbWljUHJvcGVydGllcztcblx0fVxuXG5cdHB1YmxpYyBzZXRSb3RhdGlvbmFsVmVsb2NpdGllcyh2YWx1ZTpBcnJheTxWZWN0b3IzRD4pXG5cdHtcblx0XHR0aGlzLl9wRHluYW1pY1Byb3BlcnRpZXMgPSB2YWx1ZTtcblxuXHRcdHRoaXMuX3BEeW5hbWljUHJvcGVydGllc0RpcnR5ID0gbmV3IE9iamVjdCgpO1xuXHR9XG5cblx0Y29uc3RydWN0b3IoYW5pbWF0b3I6UGFydGljbGVBbmltYXRvciwgcGFydGljbGVSb3RhdGlvbk5vZGU6UGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlOb2RlKVxuXHR7XG5cdFx0c3VwZXIoYW5pbWF0b3IsIHBhcnRpY2xlUm90YXRpb25Ob2RlKTtcblxuXHRcdHRoaXMuX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZSA9IHBhcnRpY2xlUm90YXRpb25Ob2RlO1xuXHRcdHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eSA9IHRoaXMuX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZS5faVJvdGF0aW9uYWxWZWxvY2l0eTtcblxuXHRcdHRoaXMudXBkYXRlUm90YXRpb25hbFZlbG9jaXR5RGF0YSgpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEBpbmhlcml0RG9jXG5cdCAqL1xuXHRwdWJsaWMgc2V0UmVuZGVyU3RhdGUoc3RhZ2U6U3RhZ2UsIHJlbmRlcmFibGU6UmVuZGVyYWJsZUJhc2UsIGFuaW1hdGlvblN1Ykdlb21ldHJ5OkFuaW1hdGlvblN1Ykdlb21ldHJ5LCBhbmltYXRpb25SZWdpc3RlckNhY2hlOkFuaW1hdGlvblJlZ2lzdGVyQ2FjaGUsIGNhbWVyYTpDYW1lcmEpXG5cdHtcblx0XHRpZiAodGhpcy5fcGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlOb2RlLm1vZGUgPT0gUGFydGljbGVQcm9wZXJ0aWVzTW9kZS5MT0NBTF9EWU5BTUlDICYmICF0aGlzLl9wRHluYW1pY1Byb3BlcnRpZXNEaXJ0eVthbmltYXRpb25TdWJHZW9tZXRyeS5faVVuaXF1ZUlkXSlcblx0XHRcdHRoaXMuX3BVcGRhdGVEeW5hbWljUHJvcGVydGllcyhhbmltYXRpb25TdWJHZW9tZXRyeSk7XG5cblx0XHR2YXIgaW5kZXg6bnVtYmVyIC8qaW50Ki8gPSBhbmltYXRpb25SZWdpc3RlckNhY2hlLmdldFJlZ2lzdGVySW5kZXgodGhpcy5fcEFuaW1hdGlvbk5vZGUsIFBhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5U3RhdGUuUk9UQVRJT05BTFZFTE9DSVRZX0lOREVYKTtcblxuXHRcdGlmICh0aGlzLl9wYXJ0aWNsZVJvdGF0aW9uYWxWZWxvY2l0eU5vZGUubW9kZSA9PSBQYXJ0aWNsZVByb3BlcnRpZXNNb2RlLkdMT0JBTClcblx0XHRcdGFuaW1hdGlvblJlZ2lzdGVyQ2FjaGUuc2V0VmVydGV4Q29uc3QoaW5kZXgsIHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eURhdGEueCwgdGhpcy5fcm90YXRpb25hbFZlbG9jaXR5RGF0YS55LCB0aGlzLl9yb3RhdGlvbmFsVmVsb2NpdHlEYXRhLnosIHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eURhdGEudyk7XG5cdFx0ZWxzZVxuXHRcdFx0YW5pbWF0aW9uU3ViR2VvbWV0cnkuYWN0aXZhdGVWZXJ0ZXhCdWZmZXIoaW5kZXgsIHRoaXMuX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZS5faURhdGFPZmZzZXQsIHN0YWdlLCBDb250ZXh0R0xWZXJ0ZXhCdWZmZXJGb3JtYXQuRkxPQVRfNCk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZVJvdGF0aW9uYWxWZWxvY2l0eURhdGEoKVxuXHR7XG5cdFx0aWYgKHRoaXMuX3BhcnRpY2xlUm90YXRpb25hbFZlbG9jaXR5Tm9kZS5tb2RlID09IFBhcnRpY2xlUHJvcGVydGllc01vZGUuR0xPQkFMKSB7XG5cdFx0XHRpZiAodGhpcy5fcm90YXRpb25hbFZlbG9jaXR5LncgPD0gMClcblx0XHRcdFx0dGhyb3cobmV3IEVycm9yKFwidGhlIGN5Y2xlIGR1cmF0aW9uIG11c3QgZ3JlYXRlciB0aGFuIHplcm9cIikpO1xuXHRcdFx0dmFyIHJvdGF0aW9uOlZlY3RvcjNEID0gdGhpcy5fcm90YXRpb25hbFZlbG9jaXR5LmNsb25lKCk7XG5cblx0XHRcdGlmIChyb3RhdGlvbi5sZW5ndGggPD0gMClcblx0XHRcdFx0cm90YXRpb24ueiA9IDE7IC8vc2V0IHRoZSBkZWZhdWx0IGRpcmVjdGlvblxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRyb3RhdGlvbi5ub3JtYWxpemUoKTtcblx0XHRcdC8vIHcgaXMgdXNlZCBhcyBhbmdsZS8yIGluIGFnYWxcblx0XHRcdHRoaXMuX3JvdGF0aW9uYWxWZWxvY2l0eURhdGEgPSBuZXcgVmVjdG9yM0Qocm90YXRpb24ueCwgcm90YXRpb24ueSwgcm90YXRpb24ueiwgTWF0aC5QSS9yb3RhdGlvbi53KTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0ID0gUGFydGljbGVSb3RhdGlvbmFsVmVsb2NpdHlTdGF0ZTsiXX0=