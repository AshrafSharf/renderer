var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var JointPose = require("awayjs-renderergl/lib/animators/data/JointPose");
var SkeletonPose = require("awayjs-renderergl/lib/animators/data/SkeletonPose");
var AnimationStateBase = require("awayjs-renderergl/lib/animators/states/AnimationStateBase");
/**
 *
 */
var SkeletonNaryLERPState = (function (_super) {
    __extends(SkeletonNaryLERPState, _super);
    function SkeletonNaryLERPState(animator, skeletonAnimationNode) {
        _super.call(this, animator, skeletonAnimationNode);
        this._skeletonPose = new SkeletonPose();
        this._skeletonPoseDirty = true;
        this._blendWeights = new Array();
        this._inputs = new Array();
        this._skeletonAnimationNode = skeletonAnimationNode;
        var i = this._skeletonAnimationNode.numInputs;
        while (i--)
            this._inputs[i] = animator.getAnimationState(this._skeletonAnimationNode._iInputs[i]);
    }
    /**
     * @inheritDoc
     */
    SkeletonNaryLERPState.prototype.phase = function (value) {
        this._skeletonPoseDirty = true;
        this._pPositionDeltaDirty = true;
        for (var j = 0; j < this._skeletonAnimationNode.numInputs; ++j) {
            if (this._blendWeights[j])
                this._inputs[j].update(value);
        }
    };
    /**
     * @inheritDoc
     */
    SkeletonNaryLERPState.prototype._pUdateTime = function (time /*int*/) {
        for (var j = 0; j < this._skeletonAnimationNode.numInputs; ++j) {
            if (this._blendWeights[j])
                this._inputs[j].update(time);
        }
        _super.prototype._pUpdateTime.call(this, time);
    };
    /**
     * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.
     */
    SkeletonNaryLERPState.prototype.getSkeletonPose = function (skeleton) {
        if (this._skeletonPoseDirty)
            this.updateSkeletonPose(skeleton);
        return this._skeletonPose;
    };
    /**
     * Returns the blend weight of the skeleton aniamtion node that resides at the given input index.
     *
     * @param index The input index for which the skeleton animation node blend weight is requested.
     */
    SkeletonNaryLERPState.prototype.getBlendWeightAt = function (index /*uint*/) {
        return this._blendWeights[index];
    };
    /**
     * Sets the blend weight of the skeleton aniamtion node that resides at the given input index.
     *
     * @param index The input index on which the skeleton animation node blend weight is to be set.
     * @param blendWeight The blend weight value to use for the given skeleton animation node index.
     */
    SkeletonNaryLERPState.prototype.setBlendWeightAt = function (index /*uint*/, blendWeight) {
        this._blendWeights[index] = blendWeight;
        this._pPositionDeltaDirty = true;
        this._skeletonPoseDirty = true;
    };
    /**
     * @inheritDoc
     */
    SkeletonNaryLERPState.prototype._pUpdatePositionDelta = function () {
        this._pPositionDeltaDirty = false;
        var delta;
        var weight;
        this.positionDelta.x = 0;
        this.positionDelta.y = 0;
        this.positionDelta.z = 0;
        for (var j = 0; j < this._skeletonAnimationNode.numInputs; ++j) {
            weight = this._blendWeights[j];
            if (weight) {
                delta = this._inputs[j].positionDelta;
                this.positionDelta.x += weight * delta.x;
                this.positionDelta.y += weight * delta.y;
                this.positionDelta.z += weight * delta.z;
            }
        }
    };
    /**
     * Updates the output skeleton pose of the node based on the blend weight values given to the input nodes.
     *
     * @param skeleton The skeleton used by the animator requesting the ouput pose.
     */
    SkeletonNaryLERPState.prototype.updateSkeletonPose = function (skeleton) {
        this._skeletonPoseDirty = false;
        var weight;
        var endPoses = this._skeletonPose.jointPoses;
        var poses;
        var endPose, pose;
        var endTr, tr;
        var endQuat, q;
        var firstPose;
        var i /*uint*/;
        var w0, x0, y0, z0;
        var w1, x1, y1, z1;
        var numJoints = skeleton.numJoints;
        // :s
        if (endPoses.length != numJoints)
            endPoses.length = numJoints;
        for (var j = 0; j < this._skeletonAnimationNode.numInputs; ++j) {
            weight = this._blendWeights[j];
            if (!weight)
                continue;
            poses = this._inputs[j].getSkeletonPose(skeleton).jointPoses;
            if (!firstPose) {
                firstPose = poses;
                for (i = 0; i < numJoints; ++i) {
                    endPose = endPoses[i];
                    if (endPose == null)
                        endPose = endPoses[i] = new JointPose();
                    pose = poses[i];
                    q = pose.orientation;
                    tr = pose.translation;
                    endQuat = endPose.orientation;
                    endQuat.x = weight * q.x;
                    endQuat.y = weight * q.y;
                    endQuat.z = weight * q.z;
                    endQuat.w = weight * q.w;
                    endTr = endPose.translation;
                    endTr.x = weight * tr.x;
                    endTr.y = weight * tr.y;
                    endTr.z = weight * tr.z;
                }
            }
            else {
                for (i = 0; i < skeleton.numJoints; ++i) {
                    endPose = endPoses[i];
                    pose = poses[i];
                    q = firstPose[i].orientation;
                    x0 = q.x;
                    y0 = q.y;
                    z0 = q.z;
                    w0 = q.w;
                    q = pose.orientation;
                    tr = pose.translation;
                    x1 = q.x;
                    y1 = q.y;
                    z1 = q.z;
                    w1 = q.w;
                    // find shortest direction
                    if (x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1 < 0) {
                        x1 = -x1;
                        y1 = -y1;
                        z1 = -z1;
                        w1 = -w1;
                    }
                    endQuat = endPose.orientation;
                    endQuat.x += weight * x1;
                    endQuat.y += weight * y1;
                    endQuat.z += weight * z1;
                    endQuat.w += weight * w1;
                    endTr = endPose.translation;
                    endTr.x += weight * tr.x;
                    endTr.y += weight * tr.y;
                    endTr.z += weight * tr.z;
                }
            }
        }
        for (i = 0; i < skeleton.numJoints; ++i)
            endPoses[i].orientation.normalize();
    };
    return SkeletonNaryLERPState;
})(AnimationStateBase);
module.exports = SkeletonNaryLERPState;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvc3RhdGVzL3NrZWxldG9ubmFyeWxlcnBzdGF0ZS50cyJdLCJuYW1lcyI6WyJTa2VsZXRvbk5hcnlMRVJQU3RhdGUiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUuY29uc3RydWN0b3IiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUucGhhc2UiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUuX3BVZGF0ZVRpbWUiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUuZ2V0U2tlbGV0b25Qb3NlIiwiU2tlbGV0b25OYXJ5TEVSUFN0YXRlLmdldEJsZW5kV2VpZ2h0QXQiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUuc2V0QmxlbmRXZWlnaHRBdCIsIlNrZWxldG9uTmFyeUxFUlBTdGF0ZS5fcFVwZGF0ZVBvc2l0aW9uRGVsdGEiLCJTa2VsZXRvbk5hcnlMRVJQU3RhdGUudXBkYXRlU2tlbGV0b25Qb3NlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFJQSxJQUFPLFNBQVMsV0FBZ0IsZ0RBQWdELENBQUMsQ0FBQztBQUVsRixJQUFPLFlBQVksV0FBZ0IsbURBQW1ELENBQUMsQ0FBQztBQUV4RixJQUFPLGtCQUFrQixXQUFjLDJEQUEyRCxDQUFDLENBQUM7QUFHcEcsQUFHQTs7R0FERztJQUNHLHFCQUFxQjtJQUFTQSxVQUE5QkEscUJBQXFCQSxVQUEyQkE7SUFRckRBLFNBUktBLHFCQUFxQkEsQ0FRZEEsUUFBcUJBLEVBQUVBLHFCQUEwQ0E7UUFFNUVDLGtCQUFNQSxRQUFRQSxFQUFFQSxxQkFBcUJBLENBQUNBLENBQUNBO1FBUGhDQSxrQkFBYUEsR0FBZ0JBLElBQUlBLFlBQVlBLEVBQUVBLENBQUNBO1FBQ2hEQSx1QkFBa0JBLEdBQVdBLElBQUlBLENBQUNBO1FBQ2xDQSxrQkFBYUEsR0FBaUJBLElBQUlBLEtBQUtBLEVBQVVBLENBQUNBO1FBQ2xEQSxZQUFPQSxHQUFrQ0EsSUFBSUEsS0FBS0EsRUFBMkJBLENBQUNBO1FBTXJGQSxJ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T0FBT0EsQ0FBQ0EsV0FBV0EsQ0FBQ0E7b0JBQzVCQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFHQSxNQUFNQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDdEJBLEtBQUtBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO29CQUN0QkEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsTUFBTUEsR0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZCQSxDQUFDQTtZQUNGQSxDQUFDQTtZQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtnQkFDUEEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsUUFBUUEsQ0FBQ0EsU0FBU0EsRUFBRUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7b0JBQ3pDQSxPQUFPQSxHQUFHQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDdEJBLElBQUlBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUVoQkEsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsV0FBV0EsQ0FBQ0E7b0JBQzdCQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDVEEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ1RBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUNUQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFFVEEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7b0JBQ3JCQSxFQUFFQSxHQUFHQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtvQkFFdEJBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUNUQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDVEEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ1RBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO29CQUNUQSxBQUNBQSwwQkFEMEJBO29CQUMxQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsR0FBQ0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBQ0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBQ0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBQ0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3ZDQSxFQUFFQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQTt3QkFDVEEsRUFBRUEsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7d0JBQ1RBLEVBQUVBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBO3dCQUNUQSxFQUFFQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQTtvQkFDVkEsQ0FBQ0E7b0JBQ0RBLE9BQU9BLEdBQUdBLE9BQU9BLENBQUNBLFdBQVdBLENBQUNBO29CQUM5QkEsT0FBT0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsTUFBTUEsR0FBQ0EsRUFBRUEsQ0FBQ0E7b0JBQ3ZCQSxPQUFPQSxDQUFDQSxDQUFDQSxJQUFJQSxNQUFNQSxHQUFDQSxFQUFFQSxDQUFDQTtvQkFDdkJBLE9BQU9BLENBQUNBLENBQUNBLElBQUlBLE1BQU1BLEdBQUNBLEVBQUVBLENBQUNBO29CQUN2QkEsT0FBT0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsTUFBTUEsR0FBQ0EsRUFBRUEsQ0FBQ0E7b0JBRXZCQSxLQUFLQSxHQUFHQSxPQUFPQSxDQUFDQSxXQUFXQSxDQUFDQTtvQkFDNUJBLEtBQUtBLENBQUNBLENBQUNBLElBQUlBLE1BQU1BLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO29CQUN2QkEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsTUFBTUEsR0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3ZCQSxLQUFLQSxDQUFDQSxDQUFDQSxJQUFJQSxNQUFNQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDeEJBLENBQUNBO1lBQ0ZBLENBQUNBO1FBQ0ZBLENBQUNBO1FBRURBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFFBQVFBLENBQUNBLFNBQVNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQ3RDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxXQUFXQSxDQUFDQSxTQUFTQSxFQUFFQSxDQUFDQTtJQUN0Q0EsQ0FBQ0E7SUFDRlIsNEJBQUNBO0FBQURBLENBaE5BLEFBZ05DQSxFQWhObUMsa0JBQWtCLEVBZ05yRDtBQUVELEFBQStCLGlCQUF0QixxQkFBcUIsQ0FBQyIsImZpbGUiOiJhbmltYXRvcnMvc3RhdGVzL1NrZWxldG9uTmFyeUxFUlBTdGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUXVhdGVybmlvblx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1F1YXRlcm5pb25cIik7XG5pbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xuXG5pbXBvcnQgQW5pbWF0b3JCYXNlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9BbmltYXRvckJhc2VcIik7XG5pbXBvcnQgSm9pbnRQb3NlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9kYXRhL0pvaW50UG9zZVwiKTtcbmltcG9ydCBTa2VsZXRvblx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2FuaW1hdG9ycy9kYXRhL1NrZWxldG9uXCIpO1xuaW1wb3J0IFNrZWxldG9uUG9zZVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvZGF0YS9Ta2VsZXRvblBvc2VcIik7XG5pbXBvcnQgU2tlbGV0b25OYXJ5TEVSUE5vZGVcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9hbmltYXRvcnMvbm9kZXMvU2tlbGV0b25OYXJ5TEVSUE5vZGVcIik7XG5pbXBvcnQgQW5pbWF0aW9uU3RhdGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL3N0YXRlcy9BbmltYXRpb25TdGF0ZUJhc2VcIik7XG5pbXBvcnQgSVNrZWxldG9uQW5pbWF0aW9uU3RhdGVcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvYW5pbWF0b3JzL3N0YXRlcy9JU2tlbGV0b25BbmltYXRpb25TdGF0ZVwiKTtcblxuLyoqXG4gKlxuICovXG5jbGFzcyBTa2VsZXRvbk5hcnlMRVJQU3RhdGUgZXh0ZW5kcyBBbmltYXRpb25TdGF0ZUJhc2UgaW1wbGVtZW50cyBJU2tlbGV0b25BbmltYXRpb25TdGF0ZVxue1xuXHRwcml2YXRlIF9za2VsZXRvbkFuaW1hdGlvbk5vZGU6U2tlbGV0b25OYXJ5TEVSUE5vZGU7XG5cdHByaXZhdGUgX3NrZWxldG9uUG9zZTpTa2VsZXRvblBvc2UgPSBuZXcgU2tlbGV0b25Qb3NlKCk7XG5cdHByaXZhdGUgX3NrZWxldG9uUG9zZURpcnR5OmJvb2xlYW4gPSB0cnVlO1xuXHRwcml2YXRlIF9ibGVuZFdlaWdodHM6QXJyYXk8bnVtYmVyPiA9IG5ldyBBcnJheTxudW1iZXI+KCk7XG5cdHByaXZhdGUgX2lucHV0czpBcnJheTxJU2tlbGV0b25BbmltYXRpb25TdGF0ZT4gPSBuZXcgQXJyYXk8SVNrZWxldG9uQW5pbWF0aW9uU3RhdGU+KCk7XG5cblx0Y29uc3RydWN0b3IoYW5pbWF0b3I6QW5pbWF0b3JCYXNlLCBza2VsZXRvbkFuaW1hdGlvbk5vZGU6U2tlbGV0b25OYXJ5TEVSUE5vZGUpXG5cdHtcblx0XHRzdXBlcihhbmltYXRvciwgc2tlbGV0b25BbmltYXRpb25Ob2RlKTtcblxuXHRcdHRoaXMuX3NrZWxldG9uQW5pbWF0aW9uTm9kZSA9IHNrZWxldG9uQW5pbWF0aW9uTm9kZTtcblxuXHRcdHZhciBpOm51bWJlciAvKnVpbnQqLyA9IHRoaXMuX3NrZWxldG9uQW5pbWF0aW9uTm9kZS5udW1JbnB1dHM7XG5cblx0XHR3aGlsZSAoaS0tKVxuXHRcdFx0dGhpcy5faW5wdXRzW2ldID0gPElTa2VsZXRvbkFuaW1hdGlvblN0YXRlPiBhbmltYXRvci5nZXRBbmltYXRpb25TdGF0ZSh0aGlzLl9za2VsZXRvbkFuaW1hdGlvbk5vZGUuX2lJbnB1dHNbaV0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEBpbmhlcml0RG9jXG5cdCAqL1xuXHRwdWJsaWMgcGhhc2UodmFsdWU6bnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fc2tlbGV0b25Qb3NlRGlydHkgPSB0cnVlO1xuXG5cdFx0dGhpcy5fcFBvc2l0aW9uRGVsdGFEaXJ0eSA9IHRydWU7XG5cblx0XHRmb3IgKHZhciBqOm51bWJlciAvKnVpbnQqLyA9IDA7IGogPCB0aGlzLl9za2VsZXRvbkFuaW1hdGlvbk5vZGUubnVtSW5wdXRzOyArK2opIHtcblx0XHRcdGlmICh0aGlzLl9ibGVuZFdlaWdodHNbal0pXG5cdFx0XHRcdHRoaXMuX2lucHV0c1tqXS51cGRhdGUodmFsdWUpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBAaW5oZXJpdERvY1xuXHQgKi9cblx0cHVibGljIF9wVWRhdGVUaW1lKHRpbWU6bnVtYmVyIC8qaW50Ki8pXG5cdHtcblx0XHRmb3IgKHZhciBqOm51bWJlciAvKnVpbnQqLyA9IDA7IGogPCB0aGlzLl9za2VsZXRvbkFuaW1hdGlvbk5vZGUubnVtSW5wdXRzOyArK2opIHtcblx0XHRcdGlmICh0aGlzLl9ibGVuZFdlaWdodHNbal0pXG5cdFx0XHRcdHRoaXMuX2lucHV0c1tqXS51cGRhdGUodGltZSk7XG5cdFx0fVxuXG5cdFx0c3VwZXIuX3BVcGRhdGVUaW1lKHRpbWUpO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJldHVybnMgdGhlIGN1cnJlbnQgc2tlbGV0b24gcG9zZSBvZiB0aGUgYW5pbWF0aW9uIGluIHRoZSBjbGlwIGJhc2VkIG9uIHRoZSBpbnRlcm5hbCBwbGF5aGVhZCBwb3NpdGlvbi5cblx0ICovXG5cdHB1YmxpYyBnZXRTa2VsZXRvblBvc2Uoc2tlbGV0b246U2tlbGV0b24pOlNrZWxldG9uUG9zZVxuXHR7XG5cdFx0aWYgKHRoaXMuX3NrZWxldG9uUG9zZURpcnR5KVxuXHRcdFx0dGhpcy51cGRhdGVTa2VsZXRvblBvc2Uoc2tlbGV0b24pO1xuXG5cdFx0cmV0dXJuIHRoaXMuX3NrZWxldG9uUG9zZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIHRoZSBibGVuZCB3ZWlnaHQgb2YgdGhlIHNrZWxldG9uIGFuaWFtdGlvbiBub2RlIHRoYXQgcmVzaWRlcyBhdCB0aGUgZ2l2ZW4gaW5wdXQgaW5kZXguXG5cdCAqXG5cdCAqIEBwYXJhbSBpbmRleCBUaGUgaW5wdXQgaW5kZXggZm9yIHdoaWNoIHRoZSBza2VsZXRvbiBhbmltYXRpb24gbm9kZSBibGVuZCB3ZWlnaHQgaXMgcmVxdWVzdGVkLlxuXHQgKi9cblx0cHVibGljIGdldEJsZW5kV2VpZ2h0QXQoaW5kZXg6bnVtYmVyIC8qdWludCovKTpudW1iZXJcblx0e1xuXHRcdHJldHVybiB0aGlzLl9ibGVuZFdlaWdodHNbaW5kZXhdO1xuXHR9XG5cblx0LyoqXG5cdCAqIFNldHMgdGhlIGJsZW5kIHdlaWdodCBvZiB0aGUgc2tlbGV0b24gYW5pYW10aW9uIG5vZGUgdGhhdCByZXNpZGVzIGF0IHRoZSBnaXZlbiBpbnB1dCBpbmRleC5cblx0ICpcblx0ICogQHBhcmFtIGluZGV4IFRoZSBpbnB1dCBpbmRleCBvbiB3aGljaCB0aGUgc2tlbGV0b24gYW5pbWF0aW9uIG5vZGUgYmxlbmQgd2VpZ2h0IGlzIHRvIGJlIHNldC5cblx0ICogQHBhcmFtIGJsZW5kV2VpZ2h0IFRoZSBibGVuZCB3ZWlnaHQgdmFsdWUgdG8gdXNlIGZvciB0aGUgZ2l2ZW4gc2tlbGV0b24gYW5pbWF0aW9uIG5vZGUgaW5kZXguXG5cdCAqL1xuXHRwdWJsaWMgc2V0QmxlbmRXZWlnaHRBdChpbmRleDpudW1iZXIgLyp1aW50Ki8sIGJsZW5kV2VpZ2h0Om51bWJlcilcblx0e1xuXHRcdHRoaXMuX2JsZW5kV2VpZ2h0c1tpbmRleF0gPSBibGVuZFdlaWdodDtcblxuXHRcdHRoaXMuX3BQb3NpdGlvbkRlbHRhRGlydHkgPSB0cnVlO1xuXHRcdHRoaXMuX3NrZWxldG9uUG9zZURpcnR5ID0gdHJ1ZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBAaW5oZXJpdERvY1xuXHQgKi9cblx0cHVibGljIF9wVXBkYXRlUG9zaXRpb25EZWx0YSgpXG5cdHtcblx0XHR0aGlzLl9wUG9zaXRpb25EZWx0YURpcnR5ID0gZmFsc2U7XG5cblx0XHR2YXIgZGVsdGE6VmVjdG9yM0Q7XG5cdFx0dmFyIHdlaWdodDpudW1iZXI7XG5cblx0XHR0aGlzLnBvc2l0aW9uRGVsdGEueCA9IDA7XG5cdFx0dGhpcy5wb3NpdGlvbkRlbHRhLnkgPSAwO1xuXHRcdHRoaXMucG9zaXRpb25EZWx0YS56ID0gMDtcblxuXHRcdGZvciAodmFyIGo6bnVtYmVyIC8qdWludCovID0gMDsgaiA8IHRoaXMuX3NrZWxldG9uQW5pbWF0aW9uTm9kZS5udW1JbnB1dHM7ICsraikge1xuXHRcdFx0d2VpZ2h0ID0gdGhpcy5fYmxlbmRXZWlnaHRzW2pdO1xuXG5cdFx0XHRpZiAod2VpZ2h0KSB7XG5cdFx0XHRcdGRlbHRhID0gdGhpcy5faW5wdXRzW2pdLnBvc2l0aW9uRGVsdGE7XG5cdFx0XHRcdHRoaXMucG9zaXRpb25EZWx0YS54ICs9IHdlaWdodCpkZWx0YS54O1xuXHRcdFx0XHR0aGlzLnBvc2l0aW9uRGVsdGEueSArPSB3ZWlnaHQqZGVsdGEueTtcblx0XHRcdFx0dGhpcy5wb3NpdGlvbkRlbHRhLnogKz0gd2VpZ2h0KmRlbHRhLno7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIFVwZGF0ZXMgdGhlIG91dHB1dCBza2VsZXRvbiBwb3NlIG9mIHRoZSBub2RlIGJhc2VkIG9uIHRoZSBibGVuZCB3ZWlnaHQgdmFsdWVzIGdpdmVuIHRvIHRoZSBpbnB1dCBub2Rlcy5cblx0ICpcblx0ICogQHBhcmFtIHNrZWxldG9uIFRoZSBza2VsZXRvbiB1c2VkIGJ5IHRoZSBhbmltYXRvciByZXF1ZXN0aW5nIHRoZSBvdXB1dCBwb3NlLlxuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVTa2VsZXRvblBvc2Uoc2tlbGV0b246U2tlbGV0b24pXG5cdHtcblx0XHR0aGlzLl9za2VsZXRvblBvc2VEaXJ0eSA9IGZhbHNlO1xuXG5cdFx0dmFyIHdlaWdodDpudW1iZXI7XG5cdFx0dmFyIGVuZFBvc2VzOkFycmF5PEpvaW50UG9zZT4gPSB0aGlzLl9za2VsZXRvblBvc2Uuam9pbnRQb3Nlcztcblx0XHR2YXIgcG9zZXM6QXJyYXk8Sm9pbnRQb3NlPjtcblx0XHR2YXIgZW5kUG9zZTpKb2ludFBvc2UsIHBvc2U6Sm9pbnRQb3NlO1xuXHRcdHZhciBlbmRUcjpWZWN0b3IzRCwgdHI6VmVjdG9yM0Q7XG5cdFx0dmFyIGVuZFF1YXQ6UXVhdGVybmlvbiwgcTpRdWF0ZXJuaW9uO1xuXHRcdHZhciBmaXJzdFBvc2U6QXJyYXk8Sm9pbnRQb3NlPjtcblx0XHR2YXIgaTpudW1iZXIgLyp1aW50Ki87XG5cdFx0dmFyIHcwOm51bWJlciwgeDA6bnVtYmVyLCB5MDpudW1iZXIsIHowOm51bWJlcjtcblx0XHR2YXIgdzE6bnVtYmVyLCB4MTpudW1iZXIsIHkxOm51bWJlciwgejE6bnVtYmVyO1xuXHRcdHZhciBudW1Kb2ludHM6bnVtYmVyIC8qdWludCovID0gc2tlbGV0b24ubnVtSm9pbnRzO1xuXG5cdFx0Ly8gOnNcblx0XHRpZiAoZW5kUG9zZXMubGVuZ3RoICE9IG51bUpvaW50cylcblx0XHRcdGVuZFBvc2VzLmxlbmd0aCA9IG51bUpvaW50cztcblxuXHRcdGZvciAodmFyIGo6bnVtYmVyIC8qdWludCovID0gMDsgaiA8IHRoaXMuX3NrZWxldG9uQW5pbWF0aW9uTm9kZS5udW1JbnB1dHM7ICsraikge1xuXHRcdFx0d2VpZ2h0ID0gdGhpcy5fYmxlbmRXZWlnaHRzW2pdO1xuXG5cdFx0XHRpZiAoIXdlaWdodClcblx0XHRcdFx0Y29udGludWU7XG5cblx0XHRcdHBvc2VzID0gdGhpcy5faW5wdXRzW2pdLmdldFNrZWxldG9uUG9zZShza2VsZXRvbikuam9pbnRQb3NlcztcblxuXHRcdFx0aWYgKCFmaXJzdFBvc2UpIHtcblx0XHRcdFx0Zmlyc3RQb3NlID0gcG9zZXM7XG5cdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBudW1Kb2ludHM7ICsraSkge1xuXHRcdFx0XHRcdGVuZFBvc2UgPSBlbmRQb3Nlc1tpXTtcblxuXHRcdFx0XHRcdGlmIChlbmRQb3NlID09IG51bGwpXG5cdFx0XHRcdFx0XHRlbmRQb3NlID0gZW5kUG9zZXNbaV0gPSBuZXcgSm9pbnRQb3NlKCk7XG5cblx0XHRcdFx0XHRwb3NlID0gcG9zZXNbaV07XG5cdFx0XHRcdFx0cSA9IHBvc2Uub3JpZW50YXRpb247XG5cdFx0XHRcdFx0dHIgPSBwb3NlLnRyYW5zbGF0aW9uO1xuXG5cdFx0XHRcdFx0ZW5kUXVhdCA9IGVuZFBvc2Uub3JpZW50YXRpb247XG5cblx0XHRcdFx0XHRlbmRRdWF0LnggPSB3ZWlnaHQqcS54O1xuXHRcdFx0XHRcdGVuZFF1YXQueSA9IHdlaWdodCpxLnk7XG5cdFx0XHRcdFx0ZW5kUXVhdC56ID0gd2VpZ2h0KnEuejtcblx0XHRcdFx0XHRlbmRRdWF0LncgPSB3ZWlnaHQqcS53O1xuXG5cdFx0XHRcdFx0ZW5kVHIgPSBlbmRQb3NlLnRyYW5zbGF0aW9uO1xuXHRcdFx0XHRcdGVuZFRyLnggPSB3ZWlnaHQqdHIueDtcblx0XHRcdFx0XHRlbmRUci55ID0gd2VpZ2h0KnRyLnk7XG5cdFx0XHRcdFx0ZW5kVHIueiA9IHdlaWdodCp0ci56O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgc2tlbGV0b24ubnVtSm9pbnRzOyArK2kpIHtcblx0XHRcdFx0XHRlbmRQb3NlID0gZW5kUG9zZXNbaV07XG5cdFx0XHRcdFx0cG9zZSA9IHBvc2VzW2ldO1xuXG5cdFx0XHRcdFx0cSA9IGZpcnN0UG9zZVtpXS5vcmllbnRhdGlvbjtcblx0XHRcdFx0XHR4MCA9IHEueDtcblx0XHRcdFx0XHR5MCA9IHEueTtcblx0XHRcdFx0XHR6MCA9IHEuejtcblx0XHRcdFx0XHR3MCA9IHEudztcblxuXHRcdFx0XHRcdHEgPSBwb3NlLm9yaWVudGF0aW9uO1xuXHRcdFx0XHRcdHRyID0gcG9zZS50cmFuc2xhdGlvbjtcblxuXHRcdFx0XHRcdHgxID0gcS54O1xuXHRcdFx0XHRcdHkxID0gcS55O1xuXHRcdFx0XHRcdHoxID0gcS56O1xuXHRcdFx0XHRcdHcxID0gcS53O1xuXHRcdFx0XHRcdC8vIGZpbmQgc2hvcnRlc3QgZGlyZWN0aW9uXG5cdFx0XHRcdFx0aWYgKHgwKngxICsgeTAqeTEgKyB6MCp6MSArIHcwKncxIDwgMCkge1xuXHRcdFx0XHRcdFx0eDEgPSAteDE7XG5cdFx0XHRcdFx0XHR5MSA9IC15MTtcblx0XHRcdFx0XHRcdHoxID0gLXoxO1xuXHRcdFx0XHRcdFx0dzEgPSAtdzE7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVuZFF1YXQgPSBlbmRQb3NlLm9yaWVudGF0aW9uO1xuXHRcdFx0XHRcdGVuZFF1YXQueCArPSB3ZWlnaHQqeDE7XG5cdFx0XHRcdFx0ZW5kUXVhdC55ICs9IHdlaWdodCp5MTtcblx0XHRcdFx0XHRlbmRRdWF0LnogKz0gd2VpZ2h0KnoxO1xuXHRcdFx0XHRcdGVuZFF1YXQudyArPSB3ZWlnaHQqdzE7XG5cblx0XHRcdFx0XHRlbmRUciA9IGVuZFBvc2UudHJhbnNsYXRpb247XG5cdFx0XHRcdFx0ZW5kVHIueCArPSB3ZWlnaHQqdHIueDtcblx0XHRcdFx0XHRlbmRUci55ICs9IHdlaWdodCp0ci55O1xuXHRcdFx0XHRcdGVuZFRyLnogKz0gd2VpZ2h0KnRyLno7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgc2tlbGV0b24ubnVtSm9pbnRzOyArK2kpXG5cdFx0XHRlbmRQb3Nlc1tpXS5vcmllbnRhdGlvbi5ub3JtYWxpemUoKTtcblx0fVxufVxuXG5leHBvcnQgPSBTa2VsZXRvbk5hcnlMRVJQU3RhdGU7Il19