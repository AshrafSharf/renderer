var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var ShaderLightingCompiler = require("awayjs-renderergl/lib/materials/compilation/ShaderLightingCompiler");
var ShaderObjectBase = require("awayjs-renderergl/lib/materials/compilation/ShaderObjectBase");
/**
 * ShaderObjectBase keeps track of the number of dependencies for "named registers" used across a pass.
 * Named registers are that are not necessarily limited to a single method. They are created by the compiler and
 * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed
 * each time a method has been compiled into the shader.
 *
 * @see RegisterPool.addUsage
 */
var ShaderLightingObject = (function (_super) {
    __extends(ShaderLightingObject, _super);
    /**
     * Creates a new MethodCompilerVO object.
     */
    function ShaderLightingObject(profile) {
        _super.call(this, profile);
    }
    /**
     * Factory method to create a concrete compiler object for this object
     *
     * @param materialPassVO
     * @returns {away.materials.ShaderLightingCompiler}
     */
    ShaderLightingObject.prototype.createCompiler = function (material, materialPass) {
        return new ShaderLightingCompiler(material, materialPass, this);
    };
    /**
     * Clears dependency counts for all registers. Called when recompiling a pass.
     */
    ShaderLightingObject.prototype.reset = function () {
        _super.prototype.reset.call(this);
        this.numLights = 0;
        this.usesLightFallOff = true;
    };
    /**
     * Adds any external world space dependencies, used to force world space calculations.
     */
    ShaderLightingObject.prototype.addWorldSpaceDependencies = function (fragmentLights) {
        _super.prototype.addWorldSpaceDependencies.call(this, fragmentLights);
        if (this.numPointLights > 0 && this.usesLights) {
            ++this.globalPosDependencies;
            if (fragmentLights)
                this.usesGlobalPosFragment = true;
        }
    };
    /**
     *
     *
     * @param renderable
     * @param stage
     * @param camera
     */
    ShaderLightingObject.prototype.setRenderState = function (renderable, stage, camera, viewProjection) {
        _super.prototype.setRenderState.call(this, renderable, stage, camera, viewProjection);
        if (this.usesLights)
            this.updateLights();
        if (this.usesProbes)
            this.updateProbes(stage);
    };
    /**
     * Updates constant data render state used by the lights. This method is optional for subclasses to implement.
     */
    ShaderLightingObject.prototype.updateLights = function () {
        var dirLight;
        var pointLight;
        var i = 0;
        var k = 0;
        var len;
        var dirPos;
        var total = 0;
        var numLightTypes = this.usesShadows ? 2 : 1;
        var l;
        var offset;
        this.ambientR = this.ambientG = this.ambientB = 0;
        l = this.lightVertexConstantIndex;
        k = this.lightFragmentConstantIndex;
        var cast = 0;
        var dirLights = this.lightPicker.directionalLights;
        offset = this.directionalLightsOffset;
        len = this.lightPicker.directionalLights.length;
        if (offset > len) {
            cast = 1;
            offset -= len;
        }
        for (; cast < numLightTypes; ++cast) {
            if (cast)
                dirLights = this.lightPicker.castingDirectionalLights;
            len = dirLights.length;
            if (len > this.numDirectionalLights)
                len = this.numDirectionalLights;
            for (i = 0; i < len; ++i) {
                dirLight = dirLights[offset + i];
                dirPos = dirLight.sceneDirection;
                this.ambientR += dirLight._iAmbientR;
                this.ambientG += dirLight._iAmbientG;
                this.ambientB += dirLight._iAmbientB;
                if (this.usesTangentSpace) {
                    var x = -dirPos.x;
                    var y = -dirPos.y;
                    var z = -dirPos.z;
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[0] * x + this._pInverseSceneMatrix[4] * y + this._pInverseSceneMatrix[8] * z;
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[1] * x + this._pInverseSceneMatrix[5] * y + this._pInverseSceneMatrix[9] * z;
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[2] * x + this._pInverseSceneMatrix[6] * y + this._pInverseSceneMatrix[10] * z;
                    this.vertexConstantData[l++] = 1;
                }
                else {
                    this.fragmentConstantData[k++] = -dirPos.x;
                    this.fragmentConstantData[k++] = -dirPos.y;
                    this.fragmentConstantData[k++] = -dirPos.z;
                    this.fragmentConstantData[k++] = 1;
                }
                this.fragmentConstantData[k++] = dirLight._iDiffuseR;
                this.fragmentConstantData[k++] = dirLight._iDiffuseG;
                this.fragmentConstantData[k++] = dirLight._iDiffuseB;
                this.fragmentConstantData[k++] = 1;
                this.fragmentConstantData[k++] = dirLight._iSpecularR;
                this.fragmentConstantData[k++] = dirLight._iSpecularG;
                this.fragmentConstantData[k++] = dirLight._iSpecularB;
                this.fragmentConstantData[k++] = 1;
                if (++total == this.numDirectionalLights) {
                    // break loop
                    i = len;
                    cast = numLightTypes;
                }
            }
        }
        // more directional supported than currently picked, need to clamp all to 0
        if (this.numDirectionalLights > total) {
            i = k + (this.numDirectionalLights - total) * 12;
            while (k < i)
                this.fragmentConstantData[k++] = 0;
        }
        total = 0;
        var pointLights = this.lightPicker.pointLights;
        offset = this.pointLightsOffset;
        len = this.lightPicker.pointLights.length;
        if (offset > len) {
            cast = 1;
            offset -= len;
        }
        else {
            cast = 0;
        }
        for (; cast < numLightTypes; ++cast) {
            if (cast)
                pointLights = this.lightPicker.castingPointLights;
            len = pointLights.length;
            for (i = 0; i < len; ++i) {
                pointLight = pointLights[offset + i];
                dirPos = pointLight.scenePosition;
                this.ambientR += pointLight._iAmbientR;
                this.ambientG += pointLight._iAmbientG;
                this.ambientB += pointLight._iAmbientB;
                if (this.usesTangentSpace) {
                    x = dirPos.x;
                    y = dirPos.y;
                    z = dirPos.z;
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[0] * x + this._pInverseSceneMatrix[4] * y + this._pInverseSceneMatrix[8] * z + this._pInverseSceneMatrix[12];
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[1] * x + this._pInverseSceneMatrix[5] * y + this._pInverseSceneMatrix[9] * z + this._pInverseSceneMatrix[13];
                    this.vertexConstantData[l++] = this._pInverseSceneMatrix[2] * x + this._pInverseSceneMatrix[6] * y + this._pInverseSceneMatrix[10] * z + this._pInverseSceneMatrix[14];
                    this.vertexConstantData[l++] = 1;
                }
                else if (!this.usesGlobalPosFragment) {
                    this.vertexConstantData[l++] = dirPos.x;
                    this.vertexConstantData[l++] = dirPos.y;
                    this.vertexConstantData[l++] = dirPos.z;
                    this.vertexConstantData[l++] = 1;
                }
                else {
                    this.fragmentConstantData[k++] = dirPos.x;
                    this.fragmentConstantData[k++] = dirPos.y;
                    this.fragmentConstantData[k++] = dirPos.z;
                    this.fragmentConstantData[k++] = 1;
                }
                this.fragmentConstantData[k++] = pointLight._iDiffuseR;
                this.fragmentConstantData[k++] = pointLight._iDiffuseG;
                this.fragmentConstantData[k++] = pointLight._iDiffuseB;
                var radius = pointLight._pRadius;
                this.fragmentConstantData[k++] = radius * radius;
                this.fragmentConstantData[k++] = pointLight._iSpecularR;
                this.fragmentConstantData[k++] = pointLight._iSpecularG;
                this.fragmentConstantData[k++] = pointLight._iSpecularB;
                this.fragmentConstantData[k++] = pointLight._pFallOffFactor;
                if (++total == this.numPointLights) {
                    // break loop
                    i = len;
                    cast = numLightTypes;
                }
            }
        }
        // more directional supported than currently picked, need to clamp all to 0
        if (this.numPointLights > total) {
            i = k + (total - this.numPointLights) * 12;
            for (; k < i; ++k)
                this.fragmentConstantData[k] = 0;
        }
    };
    /**
     * Updates constant data render state used by the light probes. This method is optional for subclasses to implement.
     */
    ShaderLightingObject.prototype.updateProbes = function (stage) {
        var probe;
        var lightProbes = this.lightPicker.lightProbes;
        var weights = this.lightPicker.lightProbeWeights;
        var len = lightProbes.length - this.lightProbesOffset;
        var addDiff = this.usesProbesForDiffuse;
        var addSpec = this.usesProbesForSpecular;
        if (!(addDiff || addSpec))
            return;
        if (len > this.numLightProbes)
            len = this.numLightProbes;
        for (var i = 0; i < len; ++i) {
            probe = lightProbes[this.lightProbesOffset + i];
            if (addDiff)
                stage.context.activateCubeTexture(this.lightProbeDiffuseIndices[i], probe.diffuseMap);
            if (addSpec)
                stage.context.activateCubeTexture(this.lightProbeSpecularIndices[i], probe.specularMap);
        }
        for (i = 0; i < len; ++i)
            this.fragmentConstantData[this.probeWeightsIndex + i] = weights[this.lightProbesOffset + i];
    };
    return ShaderLightingObject;
})(ShaderObjectBase);
module.exports = ShaderLightingObject;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9tYXRlcmlhbHMvY29tcGlsYXRpb24vc2hhZGVybGlnaHRpbmdvYmplY3QudHMiXSwibmFtZXMiOlsiU2hhZGVyTGlnaHRpbmdPYmplY3QiLCJTaGFkZXJMaWdodGluZ09iamVjdC5jb25zdHJ1Y3RvciIsIlNoYWRlckxpZ2h0aW5nT2JqZWN0LmNyZWF0ZUNvbXBpbGVyIiwiU2hhZGVyTGlnaHRpbmdPYmplY3QucmVzZXQiLCJTaGFkZXJMaWdodGluZ09iamVjdC5hZGRXb3JsZFNwYWNlRGVwZW5kZW5jaWVzIiwiU2hhZGVyTGlnaHRpbmdPYmplY3Quc2V0UmVuZGVyU3RhdGUiLCJTaGFkZXJMaWdodGluZ09iamVjdC51cGRhdGVMaWdodHMiLCJTaGFkZXJMaWdodGluZ09iamVjdC51cGRhdGVQcm9iZXMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQWVBLElBQU8sc0JBQXNCLFdBQVksb0VBQW9FLENBQUMsQ0FBQztBQUMvRyxJQUFPLGdCQUFnQixXQUFjLDhEQUE4RCxDQUFDLENBQUM7QUFHckcsQUFRQTs7Ozs7OztHQURHO0lBQ0csb0JBQW9CO0lBQVNBLFVBQTdCQSxvQkFBb0JBLFVBQXlCQTtJQXNFbERBOztPQUVHQTtJQUNIQSxTQXpFS0Esb0JBQW9CQSxDQXlFYkEsT0FBT0E7UUFFbEJDLGtCQUFNQSxPQUFPQSxDQUFDQSxDQUFDQTtJQUNoQkEsQ0FBQ0E7SUFFREQ7Ozs7O09BS0dBO0lBQ0lBLDZDQUFjQSxHQUFyQkEsVUFBc0JBLFFBQTRCQSxFQUFFQSxZQUFpQ0E7UUFFcEZFLE1BQU1BLENBQUNBLElBQUlBLHNCQUFzQkEsQ0FBQ0EsUUFBUUEsRUFBRUEsWUFBWUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7SUFDakVBLENBQUNBO0lBRURGOztPQUVHQTtJQUNJQSxvQ0FBS0EsR0FBWkE7UUFFQ0csZ0JBQUtBLENBQUNBLEtBQUtBLFdBQUVBLENBQUNBO1FBRWRBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLENB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QSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ2hJQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBO29CQUNoSUEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQTtvQkFDaklBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2xDQSxDQUFDQTtnQkFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7b0JBQ1BBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQzNDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO29CQUMzQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDM0NBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3BDQSxDQUFDQTtnQkFFREEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxRQUFRQSxDQUFDQSxVQUFVQSxDQUFDQTtnQkFDckRBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsUUFBUUEsQ0FBQ0EsVUFBVUEsQ0FBQ0E7Z0JBQ3JEQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFFBQVFBLENBQUNBLFVBQVVBLENBQUNBO2dCQUNyREEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtnQkFFbkNBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsUUFBUUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7Z0JBQ3REQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLFFBQVFBLENBQUNBLFdBQVdBLENBQUNBO2dCQUN0REEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxRQUFRQSxDQUFDQSxXQUFXQSxDQUFDQTtnQkFDdERBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBRW5DQSxFQUFFQSxDQUFDQSxDQUFDQSxFQUFFQSxLQUFLQSxJQUFJQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBO29CQUMxQ0EsQUFDQUEsYUFEYUE7b0JBQ2JBLENBQUNBLEdBQUdBLEdBQUdBLENB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O2dCQUNRQSxLQUFLQSxDQUFDQSxPQUFRQSxDQUFDQSxtQkFBbUJBLENBQUNBLElBQUlBLENBQUNBLHlCQUF5QkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsS0FBS0EsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0E7UUFDOUdBLENBQUNBO1FBRURBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLEVBQUVBLENBQUNBO1lBQ3ZCQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLElBQUlBLENBQUNBLGlCQUFpQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUM5RkEsQ0FBQ0E7SUFDRlAsMkJBQUNBO0FBQURBLENBM1VBLEFBMlVDQSxFQTNVa0MsZ0JBQWdCLEVBMlVsRDtBQUVELEFBQThCLGlCQUFyQixvQkFBb0IsQ0FBQyIsImZpbGUiOiJtYXRlcmlhbHMvY29tcGlsYXRpb24vU2hhZGVyTGlnaHRpbmdPYmplY3QuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1hdHJpeDNEXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vTWF0cml4M0RcIik7XG5pbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcblxuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9DYW1lcmFcIik7XG5pbXBvcnQgRGlyZWN0aW9uYWxMaWdodFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0RpcmVjdGlvbmFsTGlnaHRcIik7XG5pbXBvcnQgTGlnaHRQcm9iZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvTGlnaHRQcm9iZVwiKTtcbmltcG9ydCBQb2ludExpZ2h0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9Qb2ludExpZ2h0XCIpO1xuaW1wb3J0IExpZ2h0UGlja2VyQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9saWdodHBpY2tlcnMvTGlnaHRQaWNrZXJCYXNlXCIpO1xuXG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9TdGFnZVwiKTtcbmltcG9ydCBJQ29udGV4dFN0YWdlR0xcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lDb250ZXh0U3RhZ2VHTFwiKTtcblxuaW1wb3J0IFJlbmRlcmFibGVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9SZW5kZXJhYmxlQmFzZVwiKTtcbmltcG9ydCBTdGFnZUdMTWF0ZXJpYWxCYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL21hdGVyaWFscy9TdGFnZUdMTWF0ZXJpYWxCYXNlXCIpO1xuaW1wb3J0IFNoYWRlckNvbXBpbGVyQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9tYXRlcmlhbHMvY29tcGlsYXRpb24vU2hhZGVyQ29tcGlsZXJCYXNlXCIpO1xuaW1wb3J0IFNoYWRlckxpZ2h0aW5nQ29tcGlsZXJcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL21hdGVyaWFscy9jb21waWxhdGlvbi9TaGFkZXJMaWdodGluZ0NvbXBpbGVyXCIpO1xuaW1wb3J0IFNoYWRlck9iamVjdEJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9tYXRlcmlhbHMvY29tcGlsYXRpb24vU2hhZGVyT2JqZWN0QmFzZVwiKTtcbmltcG9ydCBJTGlnaHRpbmdQYXNzU3RhZ2VHTFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9tYXRlcmlhbHMvcGFzc2VzL0lMaWdodGluZ1Bhc3NTdGFnZUdMXCIpO1xuXG4vKipcbiAqIFNoYWRlck9iamVjdEJhc2Uga2VlcHMgdHJhY2sgb2YgdGhlIG51bWJlciBvZiBkZXBlbmRlbmNpZXMgZm9yIFwibmFtZWQgcmVnaXN0ZXJzXCIgdXNlZCBhY3Jvc3MgYSBwYXNzLlxuICogTmFtZWQgcmVnaXN0ZXJzIGFyZSB0aGF0IGFyZSBub3QgbmVjZXNzYXJpbHkgbGltaXRlZCB0byBhIHNpbmdsZSBtZXRob2QuIFRoZXkgYXJlIGNyZWF0ZWQgYnkgdGhlIGNvbXBpbGVyIGFuZFxuICogcGFzc2VkIG9uIHRvIG1ldGhvZHMuIFRoZSBjb21waWxlciB1c2VzIHRoZSByZXN1bHRzIHRvIHJlc2VydmUgdXNhZ2VzIHRocm91Z2ggUmVnaXN0ZXJQb29sLCB3aGljaCBjYW4gYmUgcmVtb3ZlZFxuICogZWFjaCB0aW1lIGEgbWV0aG9kIGhhcyBiZWVuIGNvbXBpbGVkIGludG8gdGhlIHNoYWRlci5cbiAqXG4gKiBAc2VlIFJlZ2lzdGVyUG9vbC5hZGRVc2FnZVxuICovXG5jbGFzcyBTaGFkZXJMaWdodGluZ09iamVjdCBleHRlbmRzIFNoYWRlck9iamVjdEJhc2Vcbntcblx0LyoqXG5cdCAqIFRoZSBmaXJzdCBpbmRleCBmb3IgdGhlIGZyYWdtZW50IGNvbnN0YW50cyBjb250YWluaW5nIHRoZSBsaWdodCBkYXRhLlxuXHQgKi9cblx0cHVibGljIGxpZ2h0RnJhZ21lbnRDb25zdGFudEluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIHN0YXJ0aW5nIGluZGV4IGlmIHRoZSB2ZXJ0ZXggY29uc3RhbnQgdG8gd2hpY2ggbGlnaHQgZGF0YSBuZWVkcyB0byBiZSB1cGxvYWRlZC5cblx0ICovXG5cdHB1YmxpYyBsaWdodFZlcnRleENvbnN0YW50SW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2VzIGZvciB0aGUgbGlnaHQgcHJvYmUgZGlmZnVzZSB0ZXh0dXJlcy5cblx0ICovXG5cdHB1YmxpYyBsaWdodFByb2JlRGlmZnVzZUluZGljZXM6QXJyYXk8bnVtYmVyPiAvKnVpbnQqLztcblxuXHQvKipcblx0ICogSW5kaWNlcyBmb3IgdGhlIGxpZ2h0IHByb2JlIHNwZWN1bGFyIHRleHR1cmVzLlxuXHQgKi9cblx0cHVibGljIGxpZ2h0UHJvYmVTcGVjdWxhckluZGljZXM6QXJyYXk8bnVtYmVyPiAvKnVpbnQqLztcblxuXHQvKipcblx0ICogVGhlIGluZGV4IG9mIHRoZSBmcmFnbWVudCBjb25zdGFudCBjb250YWluaW5nIHRoZSB3ZWlnaHRzIGZvciB0aGUgbGlnaHQgcHJvYmVzLlxuXHQgKi9cblx0cHVibGljIHByb2JlV2VpZ2h0c0luZGV4Om51bWJlcjtcblxuXHRwdWJsaWMgbnVtTGlnaHRzOm51bWJlcjtcblx0cHVibGljIHVzZXNMaWdodEZhbGxPZmY6Ym9vbGVhbjtcblxuXHRwdWJsaWMgdXNlc1NoYWRvd3M6Ym9vbGVhbjtcblxuXHRwdWJsaWMgbnVtUG9pbnRMaWdodHM6bnVtYmVyO1xuXHRwdWJsaWMgbnVtRGlyZWN0aW9uYWxMaWdodHM6bnVtYmVyO1xuXHRwdWJsaWMgbnVtTGlnaHRQcm9iZXM6bnVtYmVyO1xuXHRwdWJsaWMgcG9pbnRMaWdodHNPZmZzZXQ6bnVtYmVyO1xuXHRwdWJsaWMgZGlyZWN0aW9uYWxMaWdodHNPZmZzZXQ6bnVtYmVyO1xuXHRwdWJsaWMgbGlnaHRQcm9iZXNPZmZzZXQ6bnVtYmVyO1xuXHRwdWJsaWMgbGlnaHRQaWNrZXI6TGlnaHRQaWNrZXJCYXNlO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc2hhZGVyIHVzZXMgYW55IGxpZ2h0cy5cblx0ICovXG5cdHB1YmxpYyB1c2VzTGlnaHRzOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzaGFkZXIgdXNlcyBhbnkgbGlnaHQgcHJvYmVzLlxuXHQgKi9cblx0cHVibGljIHVzZXNQcm9iZXM6Ym9vbGVhbjtcblxuXHQvKipcblx0ICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIGxpZ2h0cyB1c2VzIGFueSBzcGVjdWxhciBjb21wb25lbnRzLlxuXHQgKi9cblx0cHVibGljIHVzZXNMaWdodHNGb3JTcGVjdWxhcjpib29sZWFuO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgcHJvYmVzIHVzZXMgYW55IHNwZWN1bGFyIGNvbXBvbmVudHMuXG5cdCAqL1xuXHRwdWJsaWMgdXNlc1Byb2Jlc0ZvclNwZWN1bGFyOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBsaWdodHMgdXNlcyBhbnkgZGlmZnVzZSBjb21wb25lbnRzLlxuXHQgKi9cblx0cHVibGljIHVzZXNMaWdodHNGb3JEaWZmdXNlOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBwcm9iZXMgdXNlcyBhbnkgZGlmZnVzZSBjb21wb25lbnRzLlxuXHQgKi9cblx0cHVibGljIHVzZXNQcm9iZXNGb3JEaWZmdXNlOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBuZXcgTWV0aG9kQ29tcGlsZXJWTyBvYmplY3QuXG5cdCAqL1xuXHRjb25zdHJ1Y3Rvcihwcm9maWxlKVxuXHR7XG5cdFx0c3VwZXIocHJvZmlsZSk7XG5cdH1cblxuXHQvKipcblx0ICogRmFjdG9yeSBtZXRob2QgdG8gY3JlYXRlIGEgY29uY3JldGUgY29tcGlsZXIgb2JqZWN0IGZvciB0aGlzIG9iamVjdFxuXHQgKlxuXHQgKiBAcGFyYW0gbWF0ZXJpYWxQYXNzVk9cblx0ICogQHJldHVybnMge2F3YXkubWF0ZXJpYWxzLlNoYWRlckxpZ2h0aW5nQ29tcGlsZXJ9XG5cdCAqL1xuXHRwdWJsaWMgY3JlYXRlQ29tcGlsZXIobWF0ZXJpYWw6U3RhZ2VHTE1hdGVyaWFsQmFzZSwgbWF0ZXJpYWxQYXNzOklMaWdodGluZ1Bhc3NTdGFnZUdMKTpTaGFkZXJDb21waWxlckJhc2Vcblx0e1xuXHRcdHJldHVybiBuZXcgU2hhZGVyTGlnaHRpbmdDb21waWxlcihtYXRlcmlhbCwgbWF0ZXJpYWxQYXNzLCB0aGlzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDbGVhcnMgZGVwZW5kZW5jeSBjb3VudHMgZm9yIGFsbCByZWdpc3RlcnMuIENhbGxlZCB3aGVuIHJlY29tcGlsaW5nIGEgcGFzcy5cblx0ICovXG5cdHB1YmxpYyByZXNldCgpXG5cdHtcblx0XHRzdXBlci5yZXNldCgpO1xuXG5cdFx0dGhpcy5udW1MaWdodHMgPSAwO1xuXHRcdHRoaXMudXNlc0xpZ2h0RmFsbE9mZiA9IHRydWU7XG5cdH1cblxuXHQvKipcblx0ICogQWRkcyBhbnkgZXh0ZXJuYWwgd29ybGQgc3BhY2UgZGVwZW5kZW5jaWVzLCB1c2VkIHRvIGZvcmNlIHdvcmxkIHNwYWNlIGNhbGN1bGF0aW9ucy5cblx0ICovXG5cdHB1YmxpYyBhZGRXb3JsZFNwYWNlRGVwZW5kZW5jaWVzKGZyYWdtZW50TGlnaHRzOmJvb2xlYW4pXG5cdHtcblx0XHRzdXBlci5hZGRXb3JsZFNwYWNlRGVwZW5kZW5jaWVzKGZyYWdtZW50TGlnaHRzKTtcblxuXHRcdGlmICh0aGlzLm51bVBvaW50TGlnaHRzID4gMCAmJiB0aGlzLnVzZXNMaWdodHMpIHtcblx0XHRcdCsrdGhpcy5nbG9iYWxQb3NEZXBlbmRlbmNpZXM7XG5cblx0XHRcdGlmIChmcmFnbWVudExpZ2h0cylcblx0XHRcdFx0dGhpcy51c2VzR2xvYmFsUG9zRnJhZ21lbnQgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKlxuXHQgKlxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxuXHQgKiBAcGFyYW0gc3RhZ2Vcblx0ICogQHBhcmFtIGNhbWVyYVxuXHQgKi9cblx0cHVibGljIHNldFJlbmRlclN0YXRlKHJlbmRlcmFibGU6UmVuZGVyYWJsZUJhc2UsIHN0YWdlOlN0YWdlLCBjYW1lcmE6Q2FtZXJhLCB2aWV3UHJvamVjdGlvbjpNYXRyaXgzRClcblx0e1xuXHRcdHN1cGVyLnNldFJlbmRlclN0YXRlKHJlbmRlcmFibGUsIHN0YWdlLCBjYW1lcmEsIHZpZXdQcm9qZWN0aW9uKTtcblxuXHRcdGlmICh0aGlzLnVzZXNMaWdodHMpXG5cdFx0XHR0aGlzLnVwZGF0ZUxpZ2h0cygpO1xuXG5cdFx0aWYgKHRoaXMudXNlc1Byb2Jlcylcblx0XHRcdHRoaXMudXBkYXRlUHJvYmVzKHN0YWdlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGVzIGNvbnN0YW50IGRhdGEgcmVuZGVyIHN0YXRlIHVzZWQgYnkgdGhlIGxpZ2h0cy4gVGhpcyBtZXRob2QgaXMgb3B0aW9uYWwgZm9yIHN1YmNsYXNzZXMgdG8gaW1wbGVtZW50LlxuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVMaWdodHMoKVxuXHR7XG5cdFx0dmFyIGRpckxpZ2h0OkRpcmVjdGlvbmFsTGlnaHQ7XG5cdFx0dmFyIHBvaW50TGlnaHQ6UG9pbnRMaWdodDtcblx0XHR2YXIgaTpudW1iZXIgPSAwO1xuXHRcdHZhciBrOm51bWJlciA9IDA7XG5cdFx0dmFyIGxlbjpudW1iZXI7XG5cdFx0dmFyIGRpclBvczpWZWN0b3IzRDtcblx0XHR2YXIgdG90YWw6bnVtYmVyID0gMDtcblx0XHR2YXIgbnVtTGlnaHRUeXBlczpudW1iZXIgPSB0aGlzLnVzZXNTaGFkb3dzPyAyIDogMTtcblx0XHR2YXIgbDpudW1iZXI7XG5cdFx0dmFyIG9mZnNldDpudW1iZXI7XG5cblx0XHR0aGlzLmFtYmllbnRSID0gdGhpcy5hbWJpZW50RyA9IHRoaXMuYW1iaWVudEIgPSAwO1xuXG5cdFx0bCA9IHRoaXMubGlnaHRWZXJ0ZXhDb25zdGFudEluZGV4O1xuXHRcdGsgPSB0aGlzLmxpZ2h0RnJhZ21lbnRDb25zdGFudEluZGV4O1xuXG5cdFx0dmFyIGNhc3Q6bnVtYmVyID0gMDtcblx0XHR2YXIgZGlyTGlnaHRzOkFycmF5PERpcmVjdGlvbmFsTGlnaHQ+ID0gdGhpcy5saWdodFBpY2tlci5kaXJlY3Rpb25hbExpZ2h0cztcblx0XHRvZmZzZXQgPSB0aGlzLmRpcmVjdGlvbmFsTGlnaHRzT2Zmc2V0O1xuXHRcdGxlbiA9IHRoaXMubGlnaHRQaWNrZXIuZGlyZWN0aW9uYWxMaWdodHMubGVuZ3RoO1xuXG5cdFx0aWYgKG9mZnNldCA+IGxlbikge1xuXHRcdFx0Y2FzdCA9IDE7XG5cdFx0XHRvZmZzZXQgLT0gbGVuO1xuXHRcdH1cblxuXHRcdGZvciAoOyBjYXN0IDwgbnVtTGlnaHRUeXBlczsgKytjYXN0KSB7XG5cdFx0XHRpZiAoY2FzdClcblx0XHRcdFx0ZGlyTGlnaHRzID0gdGhpcy5saWdodFBpY2tlci5jYXN0aW5nRGlyZWN0aW9uYWxMaWdodHM7XG5cblx0XHRcdGxlbiA9IGRpckxpZ2h0cy5sZW5ndGg7XG5cblx0XHRcdGlmIChsZW4gPiB0aGlzLm51bURpcmVjdGlvbmFsTGlnaHRzKVxuXHRcdFx0XHRsZW4gPSB0aGlzLm51bURpcmVjdGlvbmFsTGlnaHRzO1xuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcblx0XHRcdFx0ZGlyTGlnaHQgPSBkaXJMaWdodHNbb2Zmc2V0ICsgaV07XG5cdFx0XHRcdGRpclBvcyA9IGRpckxpZ2h0LnNjZW5lRGlyZWN0aW9uO1xuXG5cdFx0XHRcdHRoaXMuYW1iaWVudFIgKz0gZGlyTGlnaHQuX2lBbWJpZW50Ujtcblx0XHRcdFx0dGhpcy5hbWJpZW50RyArPSBkaXJMaWdodC5faUFtYmllbnRHO1xuXHRcdFx0XHR0aGlzLmFtYmllbnRCICs9IGRpckxpZ2h0Ll9pQW1iaWVudEI7XG5cblx0XHRcdFx0aWYgKHRoaXMudXNlc1RhbmdlbnRTcGFjZSkge1xuXHRcdFx0XHRcdHZhciB4Om51bWJlciA9IC1kaXJQb3MueDtcblx0XHRcdFx0XHR2YXIgeTpudW1iZXIgPSAtZGlyUG9zLnk7XG5cdFx0XHRcdFx0dmFyIHo6bnVtYmVyID0gLWRpclBvcy56O1xuXG5cdFx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbbCsrXSA9IHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMF0qeCArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbNF0qeSArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbOF0qejtcblx0XHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVtsKytdID0gdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsxXSp4ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs1XSp5ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs5XSp6O1xuXHRcdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW2wrK10gPSB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzJdKnggKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzZdKnkgKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzEwXSp6O1xuXHRcdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW2wrK10gPSAxO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IC1kaXJQb3MueDtcblx0XHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSAtZGlyUG9zLnk7XG5cdFx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gLWRpclBvcy56O1xuXHRcdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IDE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJMaWdodC5faURpZmZ1c2VSO1xuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJMaWdodC5faURpZmZ1c2VHO1xuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJMaWdodC5faURpZmZ1c2VCO1xuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSAxO1xuXG5cdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IGRpckxpZ2h0Ll9pU3BlY3VsYXJSO1xuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJMaWdodC5faVNwZWN1bGFyRztcblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gZGlyTGlnaHQuX2lTcGVjdWxhckI7XG5cdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IDE7XG5cblx0XHRcdFx0aWYgKCsrdG90YWwgPT0gdGhpcy5udW1EaXJlY3Rpb25hbExpZ2h0cykge1xuXHRcdFx0XHRcdC8vIGJyZWFrIGxvb3Bcblx0XHRcdFx0XHRpID0gbGVuO1xuXHRcdFx0XHRcdGNhc3QgPSBudW1MaWdodFR5cGVzO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gbW9yZSBkaXJlY3Rpb25hbCBzdXBwb3J0ZWQgdGhhbiBjdXJyZW50bHkgcGlja2VkLCBuZWVkIHRvIGNsYW1wIGFsbCB0byAwXG5cdFx0aWYgKHRoaXMubnVtRGlyZWN0aW9uYWxMaWdodHMgPiB0b3RhbCkge1xuXHRcdFx0aSA9IGsgKyAodGhpcy5udW1EaXJlY3Rpb25hbExpZ2h0cyAtIHRvdGFsKSoxMjtcblxuXHRcdFx0d2hpbGUgKGsgPCBpKVxuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSAwO1xuXHRcdH1cblxuXHRcdHRvdGFsID0gMDtcblxuXHRcdHZhciBwb2ludExpZ2h0czpBcnJheTxQb2ludExpZ2h0PiA9IHRoaXMubGlnaHRQaWNrZXIucG9pbnRMaWdodHM7XG5cdFx0b2Zmc2V0ID0gdGhpcy5wb2ludExpZ2h0c09mZnNldDtcblx0XHRsZW4gPSB0aGlzLmxpZ2h0UGlja2VyLnBvaW50TGlnaHRzLmxlbmd0aDtcblxuXHRcdGlmIChvZmZzZXQgPiBsZW4pIHtcblx0XHRcdGNhc3QgPSAxO1xuXHRcdFx0b2Zmc2V0IC09IGxlbjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2FzdCA9IDA7XG5cdFx0fVxuXG5cdFx0Zm9yICg7IGNhc3QgPCBudW1MaWdodFR5cGVzOyArK2Nhc3QpIHtcblx0XHRcdGlmIChjYXN0KVxuXHRcdFx0XHRwb2ludExpZ2h0cyA9IHRoaXMubGlnaHRQaWNrZXIuY2FzdGluZ1BvaW50TGlnaHRzO1xuXG5cdFx0XHRsZW4gPSBwb2ludExpZ2h0cy5sZW5ndGg7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuXHRcdFx0XHRwb2ludExpZ2h0ID0gcG9pbnRMaWdodHNbb2Zmc2V0ICsgaV07XG5cdFx0XHRcdGRpclBvcyA9IHBvaW50TGlnaHQuc2NlbmVQb3NpdGlvbjtcblxuXHRcdFx0XHR0aGlzLmFtYmllbnRSICs9IHBvaW50TGlnaHQuX2lBbWJpZW50Ujtcblx0XHRcdFx0dGhpcy5hbWJpZW50RyArPSBwb2ludExpZ2h0Ll9pQW1iaWVudEc7XG5cdFx0XHRcdHRoaXMuYW1iaWVudEIgKz0gcG9pbnRMaWdodC5faUFtYmllbnRCO1xuXG5cdFx0XHRcdGlmICh0aGlzLnVzZXNUYW5nZW50U3BhY2UpIHtcblx0XHRcdFx0XHR4ID0gZGlyUG9zLng7XG5cdFx0XHRcdFx0eSA9IGRpclBvcy55O1xuXHRcdFx0XHRcdHogPSBkaXJQb3MuejtcblxuXHRcdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW2wrK10gPSB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzBdKnggKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzRdKnkgKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzhdKnogKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzEyXTtcblx0XHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVtsKytdID0gdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsxXSp4ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs1XSp5ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs5XSp6ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsxM107XG5cdFx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbbCsrXSA9IHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMl0qeCArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbNl0qeSArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMTBdKnogKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzE0XTtcblx0XHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVtsKytdID0gMTtcblx0XHRcdFx0fSBlbHNlIGlmICghdGhpcy51c2VzR2xvYmFsUG9zRnJhZ21lbnQpIHtcblx0XHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVtsKytdID0gZGlyUG9zLng7XG5cdFx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbbCsrXSA9IGRpclBvcy55O1xuXHRcdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW2wrK10gPSBkaXJQb3Muejtcblx0XHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVtsKytdID0gMTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJQb3MueDtcblx0XHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJQb3MueTtcblx0XHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBkaXJQb3Muejtcblx0XHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSAxO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gcG9pbnRMaWdodC5faURpZmZ1c2VSO1xuXHRcdFx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW2srK10gPSBwb2ludExpZ2h0Ll9pRGlmZnVzZUc7XG5cdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IHBvaW50TGlnaHQuX2lEaWZmdXNlQjtcblxuXHRcdFx0XHR2YXIgcmFkaXVzOm51bWJlciA9IHBvaW50TGlnaHQuX3BSYWRpdXM7XG5cdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbaysrXSA9IHJhZGl1cypyYWRpdXM7XG5cblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gcG9pbnRMaWdodC5faVNwZWN1bGFyUjtcblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gcG9pbnRMaWdodC5faVNwZWN1bGFyRztcblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gcG9pbnRMaWdodC5faVNwZWN1bGFyQjtcblx0XHRcdFx0dGhpcy5mcmFnbWVudENvbnN0YW50RGF0YVtrKytdID0gcG9pbnRMaWdodC5fcEZhbGxPZmZGYWN0b3I7XG5cblx0XHRcdFx0aWYgKCsrdG90YWwgPT0gdGhpcy5udW1Qb2ludExpZ2h0cykge1xuXHRcdFx0XHRcdC8vIGJyZWFrIGxvb3Bcblx0XHRcdFx0XHRpID0gbGVuO1xuXHRcdFx0XHRcdGNhc3QgPSBudW1MaWdodFR5cGVzO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gbW9yZSBkaXJlY3Rpb25hbCBzdXBwb3J0ZWQgdGhhbiBjdXJyZW50bHkgcGlja2VkLCBuZWVkIHRvIGNsYW1wIGFsbCB0byAwXG5cdFx0aWYgKHRoaXMubnVtUG9pbnRMaWdodHMgPiB0b3RhbCkge1xuXHRcdFx0aSA9IGsgKyAodG90YWwgLSB0aGlzLm51bVBvaW50TGlnaHRzKSoxMjtcblxuXHRcdFx0Zm9yICg7IGsgPCBpOyArK2spXG5cdFx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFba10gPSAwO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGVzIGNvbnN0YW50IGRhdGEgcmVuZGVyIHN0YXRlIHVzZWQgYnkgdGhlIGxpZ2h0IHByb2Jlcy4gVGhpcyBtZXRob2QgaXMgb3B0aW9uYWwgZm9yIHN1YmNsYXNzZXMgdG8gaW1wbGVtZW50LlxuXHQgKi9cblx0cHJpdmF0ZSB1cGRhdGVQcm9iZXMoc3RhZ2U6U3RhZ2UpXG5cdHtcblx0XHR2YXIgcHJvYmU6TGlnaHRQcm9iZTtcblx0XHR2YXIgbGlnaHRQcm9iZXM6QXJyYXk8TGlnaHRQcm9iZT4gPSB0aGlzLmxpZ2h0UGlja2VyLmxpZ2h0UHJvYmVzO1xuXHRcdHZhciB3ZWlnaHRzOkFycmF5PG51bWJlcj4gPSB0aGlzLmxpZ2h0UGlja2VyLmxpZ2h0UHJvYmVXZWlnaHRzO1xuXHRcdHZhciBsZW46bnVtYmVyID0gbGlnaHRQcm9iZXMubGVuZ3RoIC0gdGhpcy5saWdodFByb2Jlc09mZnNldDtcblx0XHR2YXIgYWRkRGlmZjpib29sZWFuID0gdGhpcy51c2VzUHJvYmVzRm9yRGlmZnVzZTtcblx0XHR2YXIgYWRkU3BlYzpib29sZWFuID0gdGhpcy51c2VzUHJvYmVzRm9yU3BlY3VsYXI7XG5cblx0XHRpZiAoIShhZGREaWZmIHx8IGFkZFNwZWMpKVxuXHRcdFx0cmV0dXJuO1xuXG5cdFx0aWYgKGxlbiA+IHRoaXMubnVtTGlnaHRQcm9iZXMpXG5cdFx0XHRsZW4gPSB0aGlzLm51bUxpZ2h0UHJvYmVzO1xuXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbGVuOyArK2kpIHtcblx0XHRcdHByb2JlID0gbGlnaHRQcm9iZXNbIHRoaXMubGlnaHRQcm9iZXNPZmZzZXQgKyBpXTtcblxuXHRcdFx0aWYgKGFkZERpZmYpXG5cdFx0XHRcdCg8SUNvbnRleHRTdGFnZUdMPiBzdGFnZS5jb250ZXh0KS5hY3RpdmF0ZUN1YmVUZXh0dXJlKHRoaXMubGlnaHRQcm9iZURpZmZ1c2VJbmRpY2VzW2ldLCBwcm9iZS5kaWZmdXNlTWFwKTtcblxuXHRcdFx0aWYgKGFkZFNwZWMpXG5cdFx0XHRcdCg8SUNvbnRleHRTdGFnZUdMPiBzdGFnZS5jb250ZXh0KS5hY3RpdmF0ZUN1YmVUZXh0dXJlKHRoaXMubGlnaHRQcm9iZVNwZWN1bGFySW5kaWNlc1tpXSwgcHJvYmUuc3BlY3VsYXJNYXApO1xuXHRcdH1cblxuXHRcdGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSlcblx0XHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5wcm9iZVdlaWdodHNJbmRleCArIGldID0gd2VpZ2h0c1t0aGlzLmxpZ2h0UHJvYmVzT2Zmc2V0ICsgaV07XG5cdH1cbn1cblxuZXhwb3J0ID0gU2hhZGVyTGlnaHRpbmdPYmplY3Q7Il19